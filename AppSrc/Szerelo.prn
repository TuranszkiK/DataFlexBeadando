Compiling Program: C:\Repos\DataFlexBeadando\AppSrc\Szerelo.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.0\Pkg\dfallent.pkd)
79228>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardCommandBarSystem.pkg)
79228>>>// these are all the packages used in a standard MDI menubar/toolbar system
79228>>>
79228>>>Use cCJCommandBarSystem.pkg
79228>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardMenuItemClasses.pkg)
79228>>>>>Use Dfpanel.pkg
79228>>>>>Use cCJCommandBarSystem.pkg
79228>>>>>Use LanguageText.pkg
79228>>>>>
79228>>>>>
79228>>>>>Class cCJUndoMenuItem is a cCJMenuItem
79229>>>>>    
79229>>>>>    Procedure Construct_Object
79231>>>>>        Forward Send Construct_Object
79233>>>>>        Set psCaption   to C_$CaptionUndo
79234>>>>>        Set psToolTip to C_$ToolTipUndo
79235>>>>>        Set psDescription to C_$DescUndo
79236>>>>>        Set psImage to "ActionUndo.ico"
79237>>>>>        Set pbActiveUpdate to True
79238>>>>>        Set psCategory to C_$CategoryEdit
79239>>>>>        Set psShortcut to C_$Key_Ctrl_Z
79240>>>>>    End_Procedure
79241>>>>>
79241>>>>>    Procedure OnExecute Variant vCommandBarControl
79243>>>>>        Send Undo of (focus(Self))
79244>>>>>    End_Procedure
79245>>>>>    
79245>>>>>    Function IsEnabled Returns Boolean
79247>>>>>        Boolean bEnabled
79247>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
79248>>>>>        Function_Return bEnabled
79249>>>>>    End_Function
79250>>>>>         
79250>>>>>End_Class
79251>>>>>
79251>>>>>
79251>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
79252>>>>>    
79252>>>>>    Procedure Construct_Object
79254>>>>>        Forward Send Construct_Object
79256>>>>>        Set psCaption   to C_$CaptionDelete
79257>>>>>        Set psToolTip to C_$ToolTipDelete
79258>>>>>        Set psDescription to C_$DescDelete
79259>>>>>        Set psImage to "actionDelete.ico"
79260>>>>>        Set psShortcut to C_$Key_Delete
79261>>>>>        Set pbActiveUpdate to True
79262>>>>>        Set psCategory to C_$CategoryEdit
79263>>>>>    End_Procedure
79264>>>>>
79264>>>>>
79264>>>>>    Procedure OnExecute Variant vCommandBarControl
79266>>>>>        Send Delete of (focus(Self))
79267>>>>>    End_Procedure
79268>>>>>    
79268>>>>>    Function IsEnabled Returns Boolean
79270>>>>>        Boolean bEnabled
79270>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
79271>>>>>        Function_Return bEnabled
79272>>>>>    End_Function
79273>>>>>         
79273>>>>>End_Class
79274>>>>>
79274>>>>>
79274>>>>>Class cCJCutMenuItem is a cCJMenuItem
79275>>>>>    
79275>>>>>    Procedure Construct_Object
79277>>>>>        Forward Send Construct_Object
79279>>>>>        Set psCaption   to C_$CaptionCut
79280>>>>>        Set psToolTip to C_$TooltipCut
79281>>>>>        Set psDescription to C_$DescCut
79282>>>>>        Set psImage to "actionCut.ico"
79283>>>>>        Set psShortcut to C_$Key_Ctrl_X
79284>>>>>        Set pbActiveUpdate to True
79285>>>>>        Set psCategory to C_$CategoryEdit
79286>>>>>    End_Procedure
79287>>>>>
79287>>>>>
79287>>>>>    Procedure OnExecute Variant vCommandBarControl
79289>>>>>        Send Cut of (focus(Self))
79290>>>>>    End_Procedure
79291>>>>>    
79291>>>>>    Function IsEnabled Returns Boolean
79293>>>>>        Boolean bEnabled
79293>>>>>        Get CanCut of (Focus(Self)) to bEnabled
79294>>>>>        Function_Return bEnabled
79295>>>>>    End_Function
79296>>>>>         
79296>>>>>End_Class
79297>>>>>
79297>>>>>
79297>>>>>Class cCJCopyMenuItem is a cCJMenuItem
79298>>>>>    
79298>>>>>    Procedure Construct_Object
79300>>>>>        Forward Send Construct_Object
79302>>>>>        Set psCaption   to C_$CaptionCopy
79303>>>>>        Set psToolTip to C_$ToolTipCopy
79304>>>>>        Set psDescription to C_$DescCopy
79305>>>>>        Set psImage to "actionCopy.ico"
79306>>>>>        Set psShortcut to C_$Key_Ctrl_C
79307>>>>>        Set pbActiveUpdate to True
79308>>>>>        Set psCategory to C_$CategoryEdit
79309>>>>>    End_Procedure
79310>>>>>
79310>>>>>
79310>>>>>    Procedure OnExecute Variant vCommandBarControl
79312>>>>>        Send Copy of (focus(Self))
79313>>>>>    End_Procedure
79314>>>>>    
79314>>>>>    Function IsEnabled Returns Boolean
79316>>>>>        Boolean bEnabled
79316>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
79317>>>>>        Function_Return bEnabled
79318>>>>>    End_Function
79319>>>>>         
79319>>>>>End_Class
79320>>>>>
79320>>>>>
79320>>>>>Class cCJPasteMenuItem is a cCJMenuItem
79321>>>>>    
79321>>>>>    Procedure Construct_Object
79323>>>>>        Forward Send Construct_Object
79325>>>>>        Set psCaption   to C_$CaptionPaste
79326>>>>>        Set psToolTip to C_$ToolTipPaste
79327>>>>>        Set psDescription to C_$DescPaste
79328>>>>>        Set psImage to "actionPaste.ico"
79329>>>>>        Set pbActiveUpdate to True
79330>>>>>        Set psShortcut to C_$Key_Ctrl_V
79331>>>>>        Set psCategory to C_$CategoryEdit
79332>>>>>    End_Procedure
79333>>>>>
79333>>>>>
79333>>>>>    Procedure OnExecute Variant vCommandBarControl
79335>>>>>        Send Paste of (focus(Self))
79336>>>>>    End_Procedure
79337>>>>>    
79337>>>>>    Function IsEnabled Returns Boolean
79339>>>>>        Boolean bEnabled
79339>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
79340>>>>>        Function_Return bEnabled
79341>>>>>    End_Function
79342>>>>>         
79342>>>>>End_Class
79343>>>>>
79343>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
79344>>>>>    
79344>>>>>    Procedure Construct_Object
79346>>>>>        Forward Send Construct_Object
79348>>>>>        Set psCaption   to C_$CaptionSelectAll
79349>>>>>        Set psToolTip to C_$ToolTipSelectAll
79350>>>>>        Set psDescription to C_$DescSelectAll
79351>>>>>        Set pbActiveUpdate to True
79352>>>>>        Set psShortcut to C_$Key_Ctrl_A
79353>>>>>        Set psCategory to C_$CategoryEdit
79354>>>>>    End_Procedure
79355>>>>>
79355>>>>>
79355>>>>>    Procedure OnExecute Variant vCommandBarControl
79357>>>>>        Send Select_All of (focus(Self))
79358>>>>>    End_Procedure
79359>>>>>    
79359>>>>>    Function IsEnabled Returns Boolean
79361>>>>>        Boolean bEnabled
79361>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
79362>>>>>        Function_Return bEnabled
79363>>>>>    End_Function
79364>>>>>         
79364>>>>>End_Class
79365>>>>>
79365>>>>> 
79365>>>>>Class cCJExitMenuItem is a cCJMenuItem
79366>>>>>
79366>>>>>    Procedure Construct_Object
79368>>>>>        Forward Send Construct_Object
79370>>>>>        Set psCaption to C_$CaptionExit
79371>>>>>        Set psToolTip to C_$ToolTipExit
79372>>>>>        Set psDescription to C_$ToolTipExit
79373>>>>>        Set psShortcut to C_$Key_Alt_F4
79374>>>>>        Set psCategory to C_$CategoryFile
79375>>>>>    End_Procedure
79376>>>>>
79376>>>>>    Procedure OnExecute Variant vCommandBarControl
79378>>>>>        Send Exit_Application of Desktop
79379>>>>>    End_Procedure
79380>>>>>
79380>>>>>End_Class           
79381>>>>>
79381>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
79382>>>>>
79382>>>>>    Procedure Construct_Object
79384>>>>>        Forward Send Construct_Object
79386>>>>>        Set psCaption to C_$CaptionHelp
79387>>>>>        Set psDescription to C_$ToolTipHelp
79388>>>>>        Set psToolTip to C_$DescHelp
79389>>>>>        Set psImage to "ActionHelp.ico"
79390>>>>>        Set psShortcut to "F1"
79391>>>>>        Set psCategory to C_$CategoryHelp
79392>>>>>    End_Procedure
79393>>>>>    
79393>>>>>    Procedure OnExecute Variant vCommandBarControl
79395>>>>>        Send Help of (Focus(Self))
79396>>>>>    End_Procedure
79397>>>>>
79397>>>>>End_Class
79398>>>>>
79398>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
79399>>>>>
79399>>>>>    Procedure Construct_Object
79401>>>>>        Forward Send Construct_Object
79403>>>>>        Set psCaption to C_$CaptionAddStatusbar
79404>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
79405>>>>>        Set psDescription to  C_$DescAddStatusbar
79406>>>>>        Set psCategory to C_$CategoryWindow
79407>>>>>    End_Procedure
79408>>>>>
79408>>>>>    Procedure OnExecute Variant vCommandBarControl
79410>>>>>        Handle hoCommandBars hoClientArea
79410>>>>>        Get CommandBarSystemObject to hoCommandBars
79411>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79412>>>>>        If hoClientArea Begin
79414>>>>>            // the clientarea's parent panel has message
79414>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
79415>>>>>        End
79415>>>>>>
79415>>>>>    End_Procedure
79416>>>>>
79416>>>>>     Function IsChecked Returns Boolean
79418>>>>>        Boolean bOn
79418>>>>>        Handle hoCommandBars hoClientArea
79418>>>>>        Get CommandBarSystemObject to hoCommandBars
79419>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79420>>>>>        If hoClientArea Begin
79422>>>>>            // the clientarea's parent panel has message
79422>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
79423>>>>>        End
79423>>>>>>
79423>>>>>        Function_Return bOn
79424>>>>>     End_Function
79425>>>>>End_Class
79426>>>>>
79426>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
79427>>>>>
79427>>>>>    Procedure Construct_Object
79429>>>>>        Forward Send Construct_Object
79431>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
79432>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
79433>>>>>        Set psDescription to C_$DescAutoArrangeIcons
79434>>>>>        Set psCategory to C_$CategoryWindow
79435>>>>>    End_Procedure
79436>>>>>
79436>>>>>    Procedure OnExecute Variant vCommandBarControl
79438>>>>>        Handle hoCommandBars hoClientArea
79438>>>>>        Get CommandBarSystemObject to hoCommandBars
79439>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79440>>>>>        If hoClientArea Begin
79442>>>>>            // the clientarea's parent panel has message
79442>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
79443>>>>>        End
79443>>>>>>
79443>>>>>    End_Procedure
79444>>>>>    
79444>>>>>     Function IsChecked Returns Boolean
79446>>>>>        Boolean bOn
79446>>>>>        Handle hoCommandBars hoClientArea
79446>>>>>        Get CommandBarSystemObject to hoCommandBars
79447>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79448>>>>>        If hoClientArea Begin
79450>>>>>            // the clientarea's parent panel has message
79450>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
79451>>>>>        End
79451>>>>>>
79451>>>>>        Function_Return bOn
79452>>>>>     End_Function
79453>>>>>End_Class
79454>>>>>
79454>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
79455>>>>>
79455>>>>>    Procedure Construct_Object
79457>>>>>        Forward Send Construct_Object
79459>>>>>        Set psCaption to C_$CaptionRestoreMenus
79460>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
79461>>>>>        Set psDescription to C_$DescRestoreMenus
79462>>>>>        Set psCategory to C_$CategoryWindow
79463>>>>>    End_Procedure
79464>>>>>
79464>>>>>    Procedure OnExecute Variant vCommandBarControl
79466>>>>>        Handle hoCommandBars
79466>>>>>        Get CommandBarSystemObject to hoCommandBars
79467>>>>>        Send RestoreLayout of hoCommandBars
79468>>>>>    End_Procedure
79469>>>>>    
79469>>>>>End_Class
79470>>>>>
79470>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
79471>>>>>
79471>>>>>    Procedure Construct_Object
79473>>>>>        Forward Send Construct_Object
79475>>>>>        Set psCaption to C_$CaptionCascade
79476>>>>>        Set psToolTip to C_$ToolTipCascade
79477>>>>>        Set psDescription to  C_$DescCascade
79478>>>>>        Set psImage to "ActionCascade.ico"
79479>>>>>        Set psCategory to C_$CategoryWindow
79480>>>>>    End_Procedure
79481>>>>>    
79481>>>>>    Procedure OnExecute Variant vCommandBarControl
79483>>>>>        Handle hoCommandBars hoClientArea
79483>>>>>        Get CommandBarSystemObject to hoCommandBars
79484>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79485>>>>>        If hoClientArea Begin
79487>>>>>            Send Cascade_Windows of hoClientArea
79488>>>>>        End
79488>>>>>>
79488>>>>>    End_Procedure
79489>>>>>End_Class
79490>>>>>
79490>>>>>Class cCJTileHorizontally is a cCJMenuItem
79491>>>>>
79491>>>>>    Procedure Construct_Object
79493>>>>>        Forward Send Construct_Object
79495>>>>>        Set psCaption to C_$CaptionTileHorizontally 
79496>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
79497>>>>>        Set psDescription to  C_$DescTileHorizontally
79498>>>>>        Set psImage to "ActionTileHorizontally.ico"
79499>>>>>        Set psCategory to C_$CategoryWindow
79500>>>>>    End_Procedure
79501>>>>>
79501>>>>>    Procedure OnExecute Variant vCommandBarControl
79503>>>>>        Handle hoCommandBars hoClientArea
79503>>>>>        Get CommandBarSystemObject to hoCommandBars
79504>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79505>>>>>        If hoClientArea Begin
79507>>>>>            Send Tile_Windows_Horizontal of hoClientArea
79508>>>>>        End
79508>>>>>>
79508>>>>>    End_Procedure
79509>>>>>End_Class
79510>>>>>
79510>>>>>Class cCJTileVertically is a cCJMenuItem
79511>>>>>
79511>>>>>    Procedure Construct_Object
79513>>>>>        Forward Send Construct_Object
79515>>>>>        Set psCaption to C_$CaptionTileVertically  
79516>>>>>        Set psToolTip to C_$ToolTipTileVertically
79517>>>>>        Set psDescription to  C_$DescTileVertically
79518>>>>>        Set psImage to "ActionTileVertically.ico"
79519>>>>>        Set psCategory to C_$CategoryWindow
79520>>>>>    End_Procedure
79521>>>>>
79521>>>>>    Procedure OnExecute Variant vCommandBarControl
79523>>>>>        Handle hoCommandBars hoClientArea
79523>>>>>        Get CommandBarSystemObject to hoCommandBars
79524>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79525>>>>>        If hoClientArea Begin
79527>>>>>            Send Tile_Windows_Vertical of hoClientArea
79528>>>>>        End
79528>>>>>>
79528>>>>>    End_Procedure
79529>>>>>End_Class
79530>>>>>
79530>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
79531>>>>>
79531>>>>>    Procedure Construct_Object
79533>>>>>        Forward Send Construct_Object
79535>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
79536>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
79537>>>>>        Set psDescription to  C_$DescMinimizeWindows
79538>>>>>        Set psCategory to C_$CategoryWindow
79539>>>>>    End_Procedure
79540>>>>>
79540>>>>>    Procedure OnExecute Variant vCommandBarControl
79542>>>>>        Handle hoCommandBars hoClientArea
79542>>>>>        Get CommandBarSystemObject to hoCommandBars
79543>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79544>>>>>        If hoClientArea Begin
79546>>>>>            // the clientarea's parent panel has message
79546>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
79547>>>>>        End
79547>>>>>>
79547>>>>>    End_Procedure
79548>>>>>End_Class
79549>>>>>
79549>>>>>
79549>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
79550>>>>>
79550>>>>>    Procedure Construct_Object
79552>>>>>        Forward Send Construct_Object
79554>>>>>        Set psCaption to C_$CaptionRestoreWindows
79555>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
79556>>>>>        Set psDescription to  C_$DescRestoreWindows
79557>>>>>        Set psCategory to C_$CategoryWindow
79558>>>>>    End_Procedure
79559>>>>>
79559>>>>>    Procedure OnExecute Variant vCommandBarControl
79561>>>>>        Handle hoCommandBars hoClientArea
79561>>>>>        Get CommandBarSystemObject to hoCommandBars
79562>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79563>>>>>        If hoClientArea Begin
79565>>>>>            // the clientarea's parent panel has message
79565>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
79566>>>>>        End
79566>>>>>>
79566>>>>>    End_Procedure
79567>>>>>End_Class
79568>>>>>
79568>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
79569>>>>>
79569>>>>>    Procedure Construct_Object
79571>>>>>        Forward Send Construct_Object
79573>>>>>        Set psCaption to C_$CaptionArrangeIcons  
79574>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
79575>>>>>        Set psDescription to  C_$DescArrangeIcons
79576>>>>>        Set psCategory to C_$CategoryWindow
79577>>>>>    End_Procedure
79578>>>>>
79578>>>>>    Procedure OnExecute Variant vCommandBarControl
79580>>>>>        Handle hoCommandBars hoClientArea
79580>>>>>        Get CommandBarSystemObject to hoCommandBars
79581>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79582>>>>>        If hoClientArea Begin
79584>>>>>            Send Arrange_Icons of hoClientArea
79585>>>>>        End
79585>>>>>>
79585>>>>>    End_Procedure
79586>>>>>
79586>>>>>End_Class
79587>>>>>    
79587>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJAboutMenuItem.pkg)
79587>>>>>Use cCJCommandBarSystem.pkg
79587>>>>>Use LanguageText.pkg
79587>>>>>
79587>>>>>// It is expected that if you use this class that you provide an about object that is
79587>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
79587>>>>>// because you may wish to create your own custom about package.
79587>>>>>
79587>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
79588>>>>>
79588>>>>>    Procedure Construct_Object
79590>>>>>        Forward Send Construct_Object
79592>>>>>        Set psCaption to C_$CaptionAbout
79593>>>>>        Set psDescription to C_$ToolTipAbout
79594>>>>>        Set psToolTip to C_$DescAbout
79595>>>>>        Set psImage to "ActionAbout.ico"
79596>>>>>        Set psCategory to C_$CategoryHelp
79597>>>>>    End_Procedure
79598>>>>>    
79598>>>>>    Procedure OnExecute Variant vCommandBarControl
79600>>>>>        Handle hoCommandBars hoClientArea
79600>>>>>        Get CommandBarSystemObject to hoCommandBars
79601>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79602>>>>>        If hoClientArea Begin
79604>>>>>            Send Activate_About of hoClientArea
79605>>>>>        End
79605>>>>>>
79605>>>>>    End_Procedure
79606>>>>>
79606>>>>>End_Class
79607>>>>>
79607>>>>>
79607>>>Use cCJDeoMenuItemClasses.pkg
79607>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJMDIWindowsMenuItem.pkg)
79607>>>>>Use cCJCommandBarSystem.pkg
79607>>>>>
79607>>>>>Register_Function Client_ID Returns Integer
79607>>>>>
79607>>>>>// only used by cCJMDIWIndowsMenuItem
79607>>>>>Class cCJMDIWindowItem is a cCJMenuItem
79608>>>>>
79608>>>>>    Procedure Construct_Object
79610>>>>>        Forward Send Construct_Object
79612>>>>>        Property Handle phWindow 0 // object id of view
79613>>>>>        Set pbControlFlagNoMovable to True
79614>>>>>        Set pbActiveUpdate to True
79615>>>>>    End_Procedure
79616>>>>>    
79616>>>>>    Procedure OnExecute Variant vCommandBarControl
79618>>>>>        Handle hWindow
79618>>>>>        Get phWindow to hWindow
79619>>>>>        Send Activate_View of hWindow
79620>>>>>    End_Procedure
79621>>>>>    
79621>>>>>End_Class                
79622>>>>>
79622>>>>>
79622>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
79623>>>>>    
79623>>>>>    Procedure Construct_Object
79625>>>>>        Forward Send Construct_Object
79627>>>>>        Property Handle[] phArrayOfWindows
79628>>>>>        Set peControlType to xtpControlPopup
79629>>>>>        Set psCategory to C_$CategoryWindow
79630>>>>>    End_Procedure
79631>>>>>    
79631>>>>>     // This adds MDI windows to the existing menu items.
79631>>>>>     // This removes any existing windows menus and always adds a new set to the end
79631>>>>>
79631>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
79633>>>>>        Handle  hClientArea hView
79633>>>>>        String  sLabel
79633>>>>>        Integer i iWindows
79633>>>>>        Handle[] hArrayOfWindows
79634>>>>>        Variant vItem
79634>>>>>        
79634>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
79634>>>>>        // also assume that destroying an action removes all menu instances of that action
79634>>>>>        Get phArrayOfWindows to hArrayOfWindows
79635>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
79636>>>>>        For i from 0 to (iWindows-1)
79642>>>>>>
79642>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
79643>>>>>        Loop
79644>>>>>>
79644>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
79645>>>>>
79645>>>>>        // Add all views to this menu. Create the action and add the item
79645>>>>>        Move 0 to i
79646>>>>>        Get Client_Id to hClientArea // object id of client area
79647>>>>>        If (hClientArea > 0) Begin
79649>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
79650>>>>>            While (hView <> 0)
79654>>>>>                If (Active_State(hView)) Begin
79656>>>>>                    // create the action
79656>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
79657>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
79658>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
79659>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
79660>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
79662>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
79663>>>>>                    End
79663>>>>>>
79663>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
79664>>>>>                    If (i=0) Begin
79666>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
79667>>>>>                    End
79667>>>>>>
79667>>>>>                    // Create a menu item for this action
79667>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
79668>>>>>                    Increment i
79669>>>>>                End
79669>>>>>>
79669>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
79670>>>>>            Loop
79671>>>>>>
79671>>>>>        End
79671>>>>>>
79671>>>>>
79671>>>>>        Set phArrayOfWindows to hArrayOfWindows
79672>>>>>
79672>>>>>     End_Procedure
79673>>>>>     
79673>>>>>End_Class
79674>>>>>
79674>
79674>Object oHtmlHelp is a cHtmlHelp
79676>End_Object
79677>
79677>Object oApplication is a cApplication
79679>    Set peHelpType to htHtmlHelp
79680>
79680>    Object oConnection is a cConnection
79682>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\LoginEncryption.pkg)
79682>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cLoginEncryption.pkg)
79682>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCryptographer.pkg)
79682>>>>>>>Use VdfBase.pkg
79682>>>>>>>
79682>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\CryptographerConstants.pkg)
79682>>>>>>>>>//                                      
79682>>>>>>>>>// File    : CryptographerConstants.pkg
79682>>>>>>>>>//
79682>>>>>>>>>//   Author  : Ulbe Stellema
79682>>>>>>>>>//             Data Access Worldwide
79682>>>>>>>>>//
79682>>>>>>>>>//   Date    : October 4, 2009
79682>>>>>>>>>//
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>// Algorithm classes
79682>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
79682>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
79682>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
79682>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
79682>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
79682>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
79682>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
79682>>>>>>>>>
79682>>>>>>>>>// Algorithm types
79682>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
79682>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
79682>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
79682>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
79682>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
79682>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
79682>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
79682>>>>>>>>>
79682>>>>>>>>>// Generic sub-ids
79682>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
79682>>>>>>>>>
79682>>>>>>>>>// RSA sub-ids
79682>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
79682>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
79682>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
79682>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
79682>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
79682>>>>>>>>>
79682>>>>>>>>>// DSS sub-ids
79682>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
79682>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
79682>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
79682>>>>>>>>>
79682>>>>>>>>>// DES sub_ids
79682>>>>>>>>>Define ALG_SID_DES                      for 1
79682>>>>>>>>>Define ALG_SID_3DES                     for 3
79682>>>>>>>>>Define ALG_SID_DESX                     for 4
79682>>>>>>>>>Define ALG_SID_IDEA                     for 5
79682>>>>>>>>>Define ALG_SID_CAST                     for 6
79682>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
79682>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
79682>>>>>>>>>Define ALG_SID_3DES_112                 for 9
79682>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
79682>>>>>>>>>Define ALG_SID_RC5                      for 13
79682>>>>>>>>>Define ALG_SID_AES_128                  for 14
79682>>>>>>>>>Define ALG_SID_AES_192                  for 15
79682>>>>>>>>>Define ALG_SID_AES_256                  for 16
79682>>>>>>>>>Define ALG_SID_AES                      for 17
79682>>>>>>>>>
79682>>>>>>>>>// Fortezza sub-ids
79682>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
79682>>>>>>>>>Define ALG_SID_TEK                      for 11
79682>>>>>>>>>
79682>>>>>>>>>// RC2 sub-ids
79682>>>>>>>>>Define ALG_SID_RC2                      for 2
79682>>>>>>>>>
79682>>>>>>>>>// Stream cipher sub-ids
79682>>>>>>>>>Define ALG_SID_RC4                      for 1
79682>>>>>>>>>Define ALG_SID_SEAL                     for 2
79682>>>>>>>>>
79682>>>>>>>>>// Diffie-Hellman sub-ids
79682>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
79682>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
79682>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
79682>>>>>>>>>Define ALG_SID_KEA                      for 4
79682>>>>>>>>>
79682>>>>>>>>>// Hash sub ids
79682>>>>>>>>>Define ALG_SID_MD2                      for 1
79682>>>>>>>>>Define ALG_SID_MD4                      for 2
79682>>>>>>>>>Define ALG_SID_MD5                      for 3
79682>>>>>>>>>Define ALG_SID_SHA                      for 4
79682>>>>>>>>>Define ALG_SID_SHA1                     for 4
79682>>>>>>>>>Define ALG_SID_MAC                      for 5
79682>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
79682>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
79682>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
79682>>>>>>>>>Define ALG_SID_HMAC                     for 9
79682>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
79682>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
79682>>>>>>>>>Define ALG_SID_SHA_256                  for 12
79682>>>>>>>>>Define ALG_SID_SHA_384                  for 13
79682>>>>>>>>>Define ALG_SID_SHA_512                  for 14
79682>>>>>>>>>
79682>>>>>>>>>// secure channel sub ids
79682>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
79682>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
79682>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
79682>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
79682>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
79682>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
79682>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
79682>>>>>>>>>
79682>>>>>>>>>// algorithm identifier definitions
79682>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
79682>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
79682>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
79682>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
79682>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
79682>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
79682>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
79682>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
79682>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
79682>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
79682>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
79682>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
79682>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
79682>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
79682>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
79682>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
79682>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
79682>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
79682>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
79682>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
79682>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
79682>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
79682>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
79682>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
79682>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
79682>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
79682>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
79682>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
79682>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
79682>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
79682>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
79682>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
79682>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
79682>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
79682>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
79682>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
79682>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
79682>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
79682>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
79682>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
79682>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
79682>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
79682>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
79682>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
79682>>>>>>>>>
79682>>>>>>>>>// Providers
79682>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
79682>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
79682>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
79682>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
79682>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
79682>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
79682>>>>>>>>>
79682>>>>>>>>>// dwFlags definitions for CryptAcquireContext
79682>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
79682>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
79682>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
79682>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
79682>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
79682>>>>>>>>>
79682>>>>>>>>>// dwFlag definitions for CryptGenKey
79682>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
79682>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
79682>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
79682>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
79682>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
79682>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
79682>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
79682>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
79682>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
79682>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
79682>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
79682>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
79682>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
79682>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
79682>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
79682>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
79682>>>>>>>>>
79682>>>>>>>>>// Provider types
79682>>>>>>>>>Define PROV_RSA_FULL                    for 1
79682>>>>>>>>>Define PROV_RSA_SIG                     for 2
79682>>>>>>>>>Define PROV_DSS                         for 3
79682>>>>>>>>>Define PROV_FORTEZZA                    for 4
79682>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
79682>>>>>>>>>Define PROV_SSL                         for 6
79682>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
79682>>>>>>>>>Define PROV_DSS_DH                      for 13
79682>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
79682>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
79682>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
79682>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
79682>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
79682>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
79682>>>>>>>>>Define PROV_RNG                         for 21
79682>>>>>>>>>Define PROV_INTEL_SEC                   for 22
79682>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
79682>>>>>>>>>Define PROV_RSA_AES                     for 24
79682>>>>>>>>>
79682>>>>>>>>>// KP_MODE
79682>>>>>>>>>// KP_MODE
79682>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
79682>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
79682>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
79682>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
79682>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
79682>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
79682>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
79682>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
79682>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
79682>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
79682>>>>>>>>>
79682>>>>>>>>>// dwParam definitions for CryptGetKeyParam
79682>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
79682>>>>>>>>>Define KP_SALT                          for 2       // Salt value
79682>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
79682>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
79682>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
79682>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
79682>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
79682>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
79682>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
79682>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
79682>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
79682>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
79682>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
79682>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
79682>>>>>>>>>Define KP_Y                             for 15      // Y value
79682>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
79682>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
79682>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
79682>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
79682>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
79682>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
79682>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
79682>>>>>>>>>Define KP_RP                            for 23
79682>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
79682>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
79682>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
79682>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
79682>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
79682>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
79682>>>>>>>>>Define KP_KEYVAL                        for 30
79682>>>>>>>>>Define KP_ADMIN_PIN                     for 31
79682>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
79682>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
79682>>>>>>>>>Define KP_PREHASH                       for 34
79682>>>>>>>>>Define KP_ROUNDS                        for 35
79682>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
79682>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
79682>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
79682>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
79682>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
79682>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
79682>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
79682>>>>>>>>>
79682>>>>>>>>>// dwParam definitions for CryptGetHashParam
79682>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
79682>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
79682>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
79682>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
79682>>>>>>>>>
79682>>>>>>>>>// key BLOB types
79682>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
79682>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
79682>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
79682>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
79682>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
79682>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
79682>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
79682>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
79682>>>>>>>>>
79682>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
79682>>>>>>>>>
79682>>>>>>>>>//  Structure cryptimportkey
79682>>>>>>>>>Struct PUBLICKEYSTRUC
79682>>>>>>>>>    UChar    bType
79682>>>>>>>>>    UChar    bVersion
79682>>>>>>>>>    UShort   reserved
79682>>>>>>>>>    UInteger aiKeyAlg
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>Struct tPLAINTEXTKEYBLOB
79682>>>>>>>>>    PUBLICKEYSTRUC hdr
79682>>>>>>>>>    PUBLICKEYSTRUC hdr
79682>>>>>>>>>    UInteger       dwKeySize
79682>>>>>>>>>//    UChar[]        rgbKeyData
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
79682>>>>>>>>>Struct HMAC_INFO
79682>>>>>>>>>    UInteger HashAlgid
79682>>>>>>>>>    Pointer pbInnerString
79682>>>>>>>>>    DWord cbInnerString
79682>>>>>>>>>    Pointer pbOuterString
79682>>>>>>>>>    DWord cbOuterString
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
79683>>>>>>>>>
79683>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
79684>>>>>>>>>
79684>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
79685>>>>>>>>>
79685>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
79686>>>>>>>>>
79686>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
79687>>>>>>>>>
79687>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
79688>>>>>>>>>
79688>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
79689>>>>>>>>>
79689>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
79690>>>>>>>>>
79690>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
79691>>>>>>>>>
79691>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
79692>>>>>>>>>    
79692>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
79693>>>>>>>>>
79693>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
79694>>>>>>>>>
79694>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
79695>>>>>>>>>
79695>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
79696>>>>>>>>>    
79696>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
79697>>>>>>>>>    
79697>>>>>>>
79697>>>>>>>Class cCryptographer is a cObject
79698>>>>>>>    
79698>>>>>>>    // Procedure : Construct_Object
79698>>>>>>>    // Purpose   : Object constructor
79698>>>>>>>    Procedure Construct_Object
79700>>>>>>>        Forward Send Construct_Object
79702>>>>>>>
79702>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
79703>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
79704>>>>>>>        Property Integer    piCipher    CALG_RC4
79705>>>>>>>        Property Integer    piHash      CALG_MD5
79706>>>>>>>        
79706>>>>>>>        // Private properties
79706>>>>>>>        Property Handle     Private_phProv
79707>>>>>>>    End_Procedure
79708>>>>>>>    
79708>>>>>>>    
79708>>>>>>>    // Function : AcquireContext
79708>>>>>>>    // Purpose  : Acquire key container handle
79708>>>>>>>    Function AcquireContext Returns Handle
79710>>>>>>>        Integer iProvider
79710>>>>>>>        String sProvider
79710>>>>>>>        Handle hProv
79710>>>>>>>        Boolean bOk
79710>>>>>>>        Address addrProv
79710>>>>>>>        
79710>>>>>>>        Move 0 to hProv
79711>>>>>>>        Get piProvider to iProvider
79712>>>>>>>        Get psProvider to sProvider
79713>>>>>>>        
79713>>>>>>>        //  Determine address to be passed as provider
79713>>>>>>>        If (Trim(sProvider) <> "") Begin
79715>>>>>>>            Move (AddressOf(sProvider)) to addrProv
79716>>>>>>>        End
79716>>>>>>>>
79716>>>>>>>        Else Begin
79717>>>>>>>            Move 0 to addrProv
79718>>>>>>>        End
79718>>>>>>>>
79718>>>>>>>        
79718>>>>>>>        //  Acquire Crypto Context
79718>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
79719>>>>>>>        If (not(bOk) or hProv = 0) Begin
79721>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
79722>>>>>>>        End
79722>>>>>>>>
79722>>>>>>>        
79722>>>>>>>        If (not(bOk) or hProv = 0) Begin
79724>>>>>>>            // Fallback to original
79724>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
79725>>>>>>>            
79725>>>>>>>            If (not(bOk) or hProv = 0) Begin
79727>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
79728>>>>>>>            End
79728>>>>>>>>
79728>>>>>>>        End
79728>>>>>>>>
79728>>>>>>>        Set Private_phProv to hProv
79729>>>>>>>        
79729>>>>>>>        Function_Return hProv
79730>>>>>>>    End_Function
79731>>>>>>>    
79731>>>>>>>    // Function : ReleaseContext
79731>>>>>>>    // Purpose  : Releases key container handle
79731>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
79733>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
79734>>>>>>>    End_Function
79735>>>>>>>    
79735>>>>>>>    // Function : CreateHash
79735>>>>>>>    // Purpose  : Creates hash object
79735>>>>>>>    Function CreateHash Handle hProv Returns Handle
79737>>>>>>>        Integer iAlgorithm
79737>>>>>>>        Handle hHash
79737>>>>>>>        Boolean bOk
79737>>>>>>>        
79737>>>>>>>        Move 0 to hHash
79738>>>>>>>        Get piHash to iAlgorithm
79739>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
79740>>>>>>>        
79740>>>>>>>        Function_Return hHash
79741>>>>>>>    End_Function
79742>>>>>>>    
79742>>>>>>>    // Function : DestroyHash
79742>>>>>>>    // Purpose  : Destroys the hash object
79742>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
79744>>>>>>>        Function_Return (CryptDestroyHash(hHash))
79745>>>>>>>    End_Function
79746>>>>>>>    
79746>>>>>>>    // Function : HashData
79746>>>>>>>    // Purpose  : Adds data to hash object
79746>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
79748>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
79749>>>>>>>    End_Function
79750>>>>>>>    
79750>>>>>>>    // Function : DeriveKey
79750>>>>>>>    // Purpose  : Generates session key
79750>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
79752>>>>>>>        Integer iAlgorithm
79752>>>>>>>        Handle hKey
79752>>>>>>>        Boolean bOk
79752>>>>>>>        
79752>>>>>>>        Move 0 to hKey
79753>>>>>>>        Get piCipher to iAlgorithm
79754>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
79755>>>>>>>        
79755>>>>>>>        Function_Return hKey
79756>>>>>>>    End_Function
79757>>>>>>>    
79757>>>>>>>    // Function : ImportPlainTextKey
79757>>>>>>>    // Purpose  : Imports a plain text key
79757>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
79759>>>>>>>        tPLAINTEXTKEYBLOB blobhead
79759>>>>>>>        tPLAINTEXTKEYBLOB blobhead
79759>>>>>>>        Boolean   bSuccess
79759>>>>>>>        Handle    hKey
79759>>>>>>>        Integer   iHeadSize iKeySize
79759>>>>>>>        UChar[]   ucaKeyblob
79760>>>>>>>        Integer iVoid
79760>>>>>>>    
79760>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
79761>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
79762>>>>>>>    
79762>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
79763>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
79764>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
79765>>>>>>>        Move iKeySize           to blobhead.dwKeySize
79766>>>>>>>    
79766>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
79767>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
79768>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
79769>>>>>>>    
79769>>>>>>>        Move 0 to hKey
79770>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
79771>>>>>>>        If (not(bSuccess)) Begin 
79773>>>>>>>            Move (ShowLastError()) to iVoid
79774>>>>>>>        End
79774>>>>>>>>
79774>>>>>>>    
79774>>>>>>>        Function_Return hKey
79775>>>>>>>    End_Function
79776>>>>>>>
79776>>>>>>>    // Function : DestroyKey
79776>>>>>>>    // Purpose  : Destroys the key
79776>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
79778>>>>>>>        Function_Return (CryptDestroyKey(hKey))
79779>>>>>>>    End_Function
79780>>>>>>>    
79780>>>>>>>    // Function : KeyParameter
79780>>>>>>>    // Purpose  : Retrieves key data
79780>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
79782>>>>>>>        Integer iBuffer iLen
79782>>>>>>>        Boolean bOk
79782>>>>>>>        
79782>>>>>>>        Move (SizeOfType(Integer)) to iLen
79783>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
79784>>>>>>>        Function_Return iBuffer
79785>>>>>>>    End_Function
79786>>>>>>>    
79786>>>>>>>    // Function : HashValue
79786>>>>>>>    // Purpose  : Retrieves a hash value
79786>>>>>>>    Function HashValue Handle lhHash Returns String
79788>>>>>>>        Pointer lpSize
79788>>>>>>>        Pointer lpHash
79788>>>>>>>        String  lsSize
79788>>>>>>>        String  lsHash
79788>>>>>>>        Integer liResult
79788>>>>>>>
79788>>>>>>>        Move (Repeat(Character(0),4)) to lsSize
79789>>>>>>>        GetAddress of lsSize to lpSize
79790>>>>>>>
79790>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,lpSize,0)) to liResult
79791>>>>>>>        If (liResult = 0) Function_Return ""
79794>>>>>>>
79794>>>>>>>        Move (Repeat(Character(0),BytesTodWord(lsSize,1))) to lsHash
79795>>>>>>>        GetAddress of lsHash to lpHash
79796>>>>>>>
79796>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,lpHash,lpSize,0)) to liResult
79797>>>>>>>        If (liResult = 0) Function_Return ""
79800>>>>>>>
79800>>>>>>>        Function_Return lsHash
79801>>>>>>>    End_Function  // HashValue
79802>>>>>>>    
79802>>>>>>>            
79802>>>>>>>    // Function : Encrypt
79802>>>>>>>    // Purpose  : Encrypts data
79802>>>>>>>    Function Encrypt String sPassword String sData Returns String
79804>>>>>>>        Handle hProv hHash hKey
79804>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
79804>>>>>>>        Boolean bOk
79804>>>>>>>        
79804>>>>>>>        Get AcquireContext to hProv
79805>>>>>>>        If (hProv) Begin
79807>>>>>>>            Get CreateHash hProv to hHash
79808>>>>>>>            If (hHash) Begin
79810>>>>>>>                Get HashData hHash sPassword to bOk
79811>>>>>>>                If (bOk) Begin
79813>>>>>>>                    Get piCipher to iAlgorithm
79814>>>>>>>                    Get DeriveKey hProv hHash to hKey
79815>>>>>>>                End // If (bOk) Begin            
79815>>>>>>>>
79815>>>>>>>                Get DestroyHash hHash to bOk
79816>>>>>>>            End // If (hHash) Begin
79816>>>>>>>>
79816>>>>>>>            
79816>>>>>>>            If (hKey) Begin
79818>>>>>>>                //  First call to determine resulting data size
79818>>>>>>>                Move (Length(sData)) to iDataLen
79819>>>>>>>                Move (Length(sData)) to iCipherLen
79820>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
79821>>>>>>>                
79821>>>>>>>                //  Reserve space in string
79821>>>>>>>                If (iDataLen < iCipherLen) Begin
79823>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
79824>>>>>>>                End
79824>>>>>>>>
79824>>>>>>>                
79824>>>>>>>                //  Call to really decrypt
79824>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
79825>>>>>>>                //If (not(bOk)) Begin
79825>>>>>>>                    //Move "" to sData
79825>>>>>>>                    //Move (GetLastError()) to iErr
79825>>>>>>>                //End
79825>>>>>>>                
79825>>>>>>>                Get DestroyKey hKey to bOk
79826>>>>>>>            End // If (hKey) Begin
79826>>>>>>>>
79826>>>>>>>            Get ReleaseContext hProv to bOk
79827>>>>>>>        End // If (hProv) Begin
79827>>>>>>>>
79827>>>>>>>        Function_Return sData
79828>>>>>>>    End_Function
79829>>>>>>>    
79829>>>>>>>    // Function : Decrypt
79829>>>>>>>    // Purpose  : Decrypts data
79829>>>>>>>    Function Decrypt String sPassword String sData Returns String
79831>>>>>>>        Handle hProv hHash hKey
79831>>>>>>>        Integer iAlgorithm iDataLen
79831>>>>>>>        Boolean bOk
79831>>>>>>>        
79831>>>>>>>        Get AcquireContext to hProv
79832>>>>>>>        If (hProv) Begin
79834>>>>>>>            Get CreateHash hProv to hHash
79835>>>>>>>            If (hHash) Begin
79837>>>>>>>                Get HashData hHash sPassword to bOk
79838>>>>>>>                If (bOk) Begin
79840>>>>>>>                    Get piCipher to iAlgorithm
79841>>>>>>>                    Get DeriveKey hProv hHash to hKey
79842>>>>>>>                End // If (bOk) Begin            
79842>>>>>>>>
79842>>>>>>>                Get DestroyHash hHash to bOk
79843>>>>>>>            End // If (hHash) Begin
79843>>>>>>>>
79843>>>>>>>            
79843>>>>>>>            If (hKey) Begin
79845>>>>>>>                Move (Length(sData)) to iDataLen
79846>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
79847>>>>>>>                //If (bOk = False) Move "" to sData
79847>>>>>>>                
79847>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
79847>>>>>>>                If (Length(sData) > iDataLen) Begin
79849>>>>>>>                    Move (Left(sData, iDataLen)) to sData
79850>>>>>>>                End
79850>>>>>>>>
79850>>>>>>>                
79850>>>>>>>                Get DestroyKey hKey to bOk
79851>>>>>>>            End // If (hKey) Begin
79851>>>>>>>>
79851>>>>>>>            Get ReleaseContext hProv to bOk
79852>>>>>>>        End // If (hProv) Begin
79852>>>>>>>>
79852>>>>>>>        Function_Return sData
79853>>>>>>>    End_Function
79854>>>>>>>    
79854>>>>>>>    //  Function : GenerateRandom
79854>>>>>>>    //  Purpose  : Generates random data.
79854>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
79856>>>>>>>        Handle hProv
79856>>>>>>>        UChar[] uaResult
79857>>>>>>>        Boolean bRes
79857>>>>>>>        
79857>>>>>>>        Get AcquireContext to hProv
79858>>>>>>>        
79858>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
79859>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
79860>>>>>>>        
79860>>>>>>>        Get ReleaseContext hProv to bRes
79861>>>>>>>        
79861>>>>>>>        Function_Return uaResult
79862>>>>>>>    End_Function
79863>>>>>>>    
79863>>>>>>>    //  Function : GenerateRandomString
79863>>>>>>>    //  Purpose  : Generates random data and does a base64 encoding to properly present it as a string.
79863>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
79865>>>>>>>        String sResult
79865>>>>>>>        UChar[] aData
79866>>>>>>>        Address pBase64
79866>>>>>>>        Integer iVoid
79866>>>>>>>
79866>>>>>>>        Get GenerateRandom iLenght to aData
79867>>>>>>>        
79867>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
79868>>>>>>>        Move pBase64 to sResult
79869>>>>>>>        Move (Free(pBase64)) to iVoid    
79870>>>>>>>        
79870>>>>>>>        Function_Return (Left(sResult, iLenght))
79871>>>>>>>    End_Function
79872>>>>>>>
79872>>>>>>>End_Class
79873>>>>>
79873>>>>>Class cLoginEncryption is a cObject
79874>>>>>    
79874>>>>>    Procedure Construct_Object
79876>>>>>        Forward Send Construct_Object
79878>>>>>        // this must be set to a multi (40ish) character random key
79878>>>>>        Property String psEncryptPassword ""
79879>>>>>    
79879>>>>>        Object oDataCrypter is a cCryptographer
79881>>>>>            Set piHash to CALG_SHA_256
79882>>>>>            Set piCipher to CALG_AES_256
79883>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
79884>>>>>            Set piProvider to PROV_RSA_AES
79885>>>>>        End_Object
79886>>>>>    End_Procedure
79887>>>>>        
79887>>>>>    // This can be augmented to return a password encryption key using any
79887>>>>>    // hidden mechanism desired.    
79887>>>>>    Function GetEncryptionPassword Returns String
79889>>>>>        String sPassword
79889>>>>>        Get psEncryptPassword to sPassword    
79890>>>>>        Function_Return sPassword
79891>>>>>    End_Function
79892>>>>>    
79892>>>>>    // EncryptPassword:
79892>>>>>    
79892>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
79892>>>>>    //
79892>>>>>    // Params:
79892>>>>>    //   sPlainText     String to encrypt.
79892>>>>>    // Returns:
79892>>>>>    //   Base64 encoded hash.
79892>>>>>    Function EncryptPassword String sPlainText Returns String
79894>>>>>        String sEncryptPassword sBinary sBase64
79894>>>>>        Address pBase64
79894>>>>>        Integer iVoid
79894>>>>>        
79894>>>>>        //  Encrypt Key
79894>>>>>        Get GetEncryptionPassword to sEncryptPassword
79895>>>>>        If (sEncryptPassword = "") Begin
79897>>>>>            Error DFERR_PROGRAM "No encryption password set" 
79898>>>>>>
79898>>>>>        End
79898>>>>>>
79898>>>>>        
79898>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
79899>>>>>        
79899>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
79901>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
79902>>>>>>
79902>>>>>            Function_Return ""
79903>>>>>        End
79903>>>>>>
79903>>>>>        
79903>>>>>        //  Encode binary hash to Base64
79903>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
79904>>>>>        Move pBase64 to sBase64
79905>>>>>        Move (Free(pBase64)) to iVoid
79906>>>>>        
79906>>>>>        Function_Return sBase64
79907>>>>>    End_Function
79908>>>>>    
79908>>>>>    
79908>>>>>    // DecryptPassword:
79908>>>>>    
79908>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
79908>>>>>    //
79908>>>>>    // Params:
79908>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
79908>>>>>    // Returns:
79908>>>>>    //   Readable plain text password
79908>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
79910>>>>>        String sEncryptPassword sPlainText sBinary
79910>>>>>        Boolean bIsHex
79910>>>>>        Integer iLen iVoid
79910>>>>>        Address pBinary
79910>>>>>        
79910>>>>>        If (sBase64EncryptedPassword <> "") Begin
79912>>>>>            //  Decode from Base64
79912>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
79913>>>>>            
79913>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
79914>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
79915>>>>>            
79915>>>>>            Move (Free(pBinary)) to iVoid
79916>>>>>    
79916>>>>>            //  Encrypted binary hash to string
79916>>>>>            Get GetEncryptionPassword to sEncryptPassword
79917>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
79918>>>>>        End
79918>>>>>>
79918>>>>>        
79918>>>>>        Function_Return sPlainText
79919>>>>>    End_Function
79920>>>>>End_Class
79921>>>>>    
79921>>>
79921>>>Object oLoginEncryption is a cLoginEncryption
79923>>>
79923>>>    // this must be created in your appsrc directory and must contain an encryption
79923>>>    // key that is set to psEncryptPassword. It will look something like this
79923>>>    //
79923>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
79923>>>    //  
Including file: LoginEncryptionKey.inc    (C:\Repos\DataFlexBeadando\AppSrc\LoginEncryptionKey.inc)
79923>>>>// Studio generated login encryption key
79923>>>>Set psEncryptPassword to "8eH5|`Xs0c>fum6W8E6^}#@XhoWPuDN)Usf_t<]("
79924>>>>
79924>>>    
79924>>>    // use this to register this object to your cConnection Object. This object
79924>>>    // must be created after the cConnection object
79924>>>    Move Self to ghoLoginEncryption
79925>>>End_Object
79926>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DatabaseLoginDialog.dg)
79926>>>
79926>>>Use Windows.pkg
79926>>>Use cConnection.pkg
79926>>>Use dfLine.pkg
79926>>>
79926>>>Object oDatabaseLoginDialog is a ModalPanel
79928>>>    Set Label to "Database Login"
79929>>>    Set Location to 2 2
79930>>>    Set Size to 110 211
79931>>>
79931>>>    Property String psId
79933>>>    Property Boolean pbOk False
79935>>>    Property Boolean pbChanged False
79937>>>    Property Boolean pbAllowRemember True
79939>>>
79939>>>    // this registers this object with the cConnection object.
79939>>>    Move Self to ghoLoginConnectDialog
79940>>>
79940>>>    Object oUserIDForm is a Form
79942>>>        Set Label to "User Name"
79943>>>        Set Size to 13 85
79944>>>        Set Location to 34 79
79945>>>        Set Label_Col_Offset to 64
79946>>>                Set peAnchors to anTopLeftRight
79947>>>    End_Object
79948>>>
79948>>>    Object oPwdForm is a Form
79950>>>        Set Size to 13 85
79951>>>        Set Location to 49 79
79952>>>        Set Label_Col_Offset to 64
79953>>>        Set Password_State to True
79954>>>                Set peAnchors to anTopLeftRight
79955>>>        Set Label to "Password"
79956>>>    End_Object
79957>>>
79957>>>    Object oTrustedConnection is a CheckBox
79959>>>        Set Size to 10 50
79960>>>        Set Location to 65 79
79961>>>        Set Label to "Trusted Connection"
79962>>>    End_Object
79963>>>
79963>>>    Object oRemember is a CheckBox
79965>>>        Set Size to 10 50
79966>>>        Set Location to 79 14
79967>>>        Set Label to "Remember and don't ask again"
79968>>>        Set Checked_State to True
79969>>>    End_Object
79970>>>
79970>>>    Object oLogin_btn is a Button
79972>>>        Set Label to "&Login"
79973>>>        Set Location to 92 102
79974>>>        Set peAnchors to anBottomRight
79975>>>        Set Default_State to True
79976>>>
79976>>>        Procedure OnClick
79979>>>            Boolean bTrust
79979>>>            String sUser sPwd sConn sErr sId
79979>>>            Integer iError
79979>>>            Get psId to sId
79980>>>            Get Value of oUserIDForm to sUser
79981>>>            Get Value of oPwdForm to sPwd
79982>>>            Get Checked_State of oTrustedConnection to bTrust
79983>>>            
79983>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
79984>>>            If (iError=0) Begin
79986>>>                Set pbOk to True
79987>>>                Set pbChanged to True
79988>>>                // using Stop_UI instead of close_panel keeps it running when the dialog
79988>>>                // is the only dialog and it closes
79988>>>                Send Stop_UI
79989>>>//                Send Close_Panel
79989>>>            End
79989>>>>
79989>>>            Else Begin
79990>>>                Get psErrorText of ghoConnection to sErr
79991>>>                Send UserError sErr "Login Error"
79992>>>            End
79992>>>>
79992>>>        End_Procedure
79993>>>    End_Object
79994>>>
79994>>>    Object oCancel_btn is a Button
79996>>>        Set Label to "&Cancel"
79997>>>        Set Location to 92 157
79998>>>        Set peAnchors to anBottomRight
79999>>>
79999>>>        Procedure OnClick
80002>>>            Send Stop_UI
80003>>>//            Send Close_Panel
80003>>>        End_Procedure
80004>>>    End_Object
80005>>>
80005>>>    Object oConnectionIdInfo is a TextBox
80007>>>        Set Size to 10 50
80008>>>        Set Location to 4 14
80009>>>        Set Label to 'Connection Id='
80010>>>    End_Object
80011>>>
80011>>>    Object oConnectionServerInfo is a TextBox
80013>>>        Set Size to 10 50
80014>>>        Set Location to 16 14
80015>>>        Set Label to 'Server'
80016>>>    End_Object
80017>>>
80017>>>    Object oLineControl1 is a LineControl
80019>>>        Set Size to 2 202
80020>>>        Set Location to 29 5
80021>>>    End_Object
80022>>>
80022>>>    Function LoginConnectIdDialog String sId Returns Boolean
80025>>>         Boolean bOk bChanged bTrusted bAllowRemember bRemember
80025>>>         String sUser sPwd sDescription
80025>>>         tConnection Connect
80025>>>         tConnection Connect
80025>>>         
80025>>>         Get pbAllowRemember to bAllowRemember
80026>>>         
80026>>>
80026>>>         If not bAllowRemember Begin
80028>>>            Set Enabled_State of oRemember to bRemember
80029>>>            Set Visible_State of oRemember to bRemember
80030>>>         End
80030>>>>
80030>>>         
80030>>>         Get ConnectionIdInfo of ghoConnection sId to Connect
80031>>>         Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
80032>>>         Set Value of oConnectionServerInfo to Connect.sString
80033>>>
80033>>>         Set psId to sId
80034>>>         Set pbOk to False
80035>>>         Set pbChanged to False
80036>>>         Set Value of oUserIDForm to Connect.sUID
80037>>>         Set Value of oPwdForm to ""
80038>>>         
80038>>>         Send Popup
80039>>>         
80039>>>         Get pbOk to bOk
80040>>>         Get pbChanged to bChanged
80041>>>         If (bChanged and bOk) Begin
80043>>>            If bAllowRemember Begin
80045>>>                Get Checked_State of oRemember to bRemember
80046>>>                If bRemember Begin
80048>>>                    Get Checked_State of oTrustedConnection to bTrusted
80049>>>                    If not (bTrusted) Begin
80051>>>                        Get Value of oUserIDForm to sUser
80052>>>                        Get Value of oPwdForm to sPwd
80053>>>                    End
80053>>>>
80053>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
80054>>>                 End
80054>>>>
80054>>>             End
80054>>>>
80054>>>         End
80054>>>>
80054>>>         Function_Return bOk
80055>>>    End_Function
80056>>>    
80056>>>    
80056>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
80057>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
80058>>>End_Object
80059>>>
80059>    End_Object
80060>
80060>End_Object
80061>
80061>Object oToolTipController is a cToolTipController
80063>    Move Self to ghoToolTipController
80064>End_Object
80065>
80065>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oEditContextMenu.pkg)
80065>>>Use cCJStandardMenuItemClasses.pkg
80065>>>
80065>>>Object oEditContextMenu is a cCJContextMenu
80067>>>    
80067>>>    Move Self to Default_Form_Floating_Menu_ID
80068>>>    
80068>>>    Object oUndoMenuItem is a cCJUndoMenuItem
80070>>>    End_Object
80071>>>    
80071>>>    Object oCutMenuItem is a cCJCutMenuItem
80073>>>        Set pbControlBeginGroup to True
80074>>>    End_Object
80075>>>    
80075>>>    Object oCopyMenuItem is a cCJCopyMenuItem
80077>>>    End_Object
80078>>>
80078>>>    Object oPasteMenuItem is a cCJPasteMenuItem
80080>>>    End_Object
80081>>>
80081>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
80083>>>    End_Object
80084>>>
80084>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
80086>>>        Set pbControlBeginGroup to True
80087>>>    End_Object
80088>>>
80088>>>End_Object
80089>>>
80089>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oDEOEditContextMenu17.pkg)
80089>>>Use Windows.pkg
80089>>>Use cCJStandardMenuItemClasses.pkg
80089>>>Use cCJDeoMenuItemClasses.pkg
80089>>>
80089>>>
80089>>>Object oDEOEditContextMenu17 is a cCJContextMenu
80091>>>    
80091>>>    Move Self to Default_dbFloating_Menu_ID
80092>>>    
80092>>>    Object oUndoMenuItem is a cCJUndoMenuItem
80094>>>    End_Object
80095>>>    
80095>>>    Object oCutMenuItem is a cCJCutMenuItem
80097>>>        Set pbControlBeginGroup to True
80098>>>    End_Object
80099>>>    
80099>>>    Object oCopyMenuItem is a cCJCopyMenuItem
80101>>>    End_Object
80102>>>
80102>>>    Object oPasteMenuItem is a cCJPasteMenuItem
80104>>>    End_Object
80105>>>
80105>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
80107>>>    End_Object
80108>>>
80108>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
80110>>>        Set pbControlBeginGroup to True
80111>>>    End_Object
80112>>>
80112>>>    Object oPromptMenuItem is a cCJPromptMenuItem
80114>>>        Set pbControlBeginGroup to True
80115>>>    End_Object
80116>>>
80116>>>    Object oFindNextMenu is a cCJFindNextMenuItem
80118>>>        Set pbControlBeginGroup to True
80119>>>    End_Object
80120>>>
80120>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
80122>>>    End_Object
80123>>>
80123>>>    Object oClearMenuItem is a cCJClearMenuItem
80125>>>        Set pbControlBeginGroup to True
80126>>>    End_Object
80127>>>
80127>>>    Object oClearAllMenu is a cCJClearAllMenuItem
80129>>>    End_Object
80130>>>
80130>>>    Object oSaveMenu is a cCJSaveMenuItem
80132>>>    End_Object
80133>>>    
80133>>>    Object oDeleteMenu is a cCJDeleteMenuItem
80135>>>    End_Object
80136>>>
80136>>>    Object oRememberitem is a cCJRememberFieldMenuItem
80138>>>        Set pbControlBeginGroup to True
80139>>>    End_Object
80140>>>
80140>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
80142>>>    End_Object
80143>>>
80143>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
80145>>>    End_Object
80146>>>
80146>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
80148>>>    End_Object
80149>>>
80149>>>End_Object
80150>
80150>Object oMain is a Panel
80152>    Set Label To "My Project"
80153>    Set Location to 4 3
80154>    Set Size to 300 450
80155>
80155>    Object oCommandBarSystem is a cCJCommandBarSystem
80157>        Set pbTimerUpdate to True
80158>        Set peVisualTheme to xtpThemeOffice2013Outlook
80159>        Set pbAutoResizeIcons to True
80160>
80160>        Procedure OnCreateCommandBars
80163>            Handle hoOptions
80163>            Get OptionsObject to hoOptions
80164>            Forward Send OnCreateCommandBars
80166>        End_Procedure
80167>
80167>        Object oMenuBar is a cCJMenuBar
80169>
80169>            Object oFileMenu is a cCJMenuItem
80171>                Set peControlType to xtpControlPopup          
80172>                Set psCaption   to "&File"
80173>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
80174>                Set psCategory to "Menus"
80175>
80175>                Object oClearMenuItem is a cCJClearMenuItem
80177>                    Set pbAddToDesignerMenu to True
80178>                End_Object
80179>
80179>                Object oClearAllMenu is a cCJClearAllMenuItem
80181>                    Set pbAddToDesignerMenu to True
80182>                End_Object
80183>
80183>                Object oPromptMenuItem is a cCJPromptMenuItem
80185>                    Set pbAddToDesignerMenu to True
80186>                    Set pbControlBeginGroup to True
80187>                End_Object
80188>
80188>                Object oFindMenuItem is a cCJFindMenuItem
80190>                    Set pbAddToDesignerMenu to True
80191>                    Set pbControlBeginGroup to True
80192>                End_Object
80193>
80193>                Object oFindNextMenu is a cCJFindNextMenuItem
80195>                    Set pbAddToDesignerMenu to True
80196>                End_Object
80197>
80197>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
80199>                    Set pbAddToDesignerMenu to True
80200>                End_Object
80201>
80201>                Object oFindFirstMenu is a cCJFindFirstMenuItem
80203>                    Set pbAddToDesignerMenu to True
80204>                End_Object
80205>
80205>                Object oFindLastMenu is a cCJFindLastMenuItem
80207>                    Set pbAddToDesignerMenu to True
80208>                End_Object
80209>
80209>                Object oSaveMenuItem is a cCJSaveMenuItem
80211>                    Set pbAddToDesignerMenu to True
80212>                    Set pbControlBeginGroup to True
80213>                End_Object
80214>
80214>                Object oDeleteMenuItem is a cCJDeleteMenuItem
80216>                    Set pbAddToDesignerMenu to True
80217>                End_Object
80218>
80218>                Object oExitMenu is a cCJExitMenuItem
80220>                    Set pbControlBeginGroup to True
80221>                End_Object
80222>
80222>            End_Object
80223>
80223>            Object oViewMenu is a cCJMenuItem
80225>                Set peControlType to xtpControlPopup
80226>                Set psCaption to "&View"
80227>                Set psToolTip to "View"
80228>                Set psDescription to "Available Views"
80229>
80229>                Object oAutoMenuItem is a cCJMenuItem
80231>                    Set psCaption to "Auto"
80232>                    Set psTooltip to "Auto"
80233>                
80233>                    Procedure OnExecute Variant vCommandBarControl
80236>                        Handle hoClient
80236>                        Get Client_Id to hoClient
80237>                        Send Activate_oAuto of hoClient
80238>                    End_Procedure
80239>                End_Object
80240>
80240>                Object oMunkaMenuItem is a cCJMenuItem
80242>                    Set psCaption to "Munka"
80243>                    Set psTooltip to "Munka"
80244>                
80244>                    Procedure OnExecute Variant vCommandBarControl
80247>                        Handle hoClient
80247>                        Get Client_Id to hoClient
80248>                        Send Activate_oMunka of hoClient
80249>                    End_Procedure
80250>                End_Object
80251>
80251>                Object oUgyfelMenuItem is a cCJMenuItem
80253>                    Set psCaption to "Ugyfel"
80254>                    Set psTooltip to "Ugyfel"
80255>                
80255>                    Procedure OnExecute Variant vCommandBarControl
80258>                        Handle hoClient
80258>                        Get Client_Id to hoClient
80259>                        Send Activate_oUgyfel of hoClient
80260>                    End_Procedure
80261>                End_Object
80262>
80262>                Object oMunkalapMenuItem is a cCJMenuItem
80264>                    Set psCaption to "Munkalap"
80265>                    Set psTooltip to "Munkalap"
80266>                
80266>                    Procedure OnExecute Variant vCommandBarControl
80269>                        Handle hoClient
80269>                        Get Client_Id to hoClient
80270>                        Send Activate_oMunkalap of hoClient
80271>                    End_Procedure
80272>                End_Object
80273>
80273>                Object oMunkalapKeszitesMenuItem is a cCJMenuItem
80275>                    Set psCaption to "MunkalapKeszites"
80276>                    Set psTooltip to "MunkalapKeszites"
80277>                
80277>                    Procedure OnExecute Variant vCommandBarControl
80280>                        Handle hoClient
80280>                        Get Client_Id to hoClient
80281>                        Send Activate_oMunkalapKeszites of hoClient
80282>                    End_Procedure
80283>                End_Object
80284>            End_Object
80285>            
80285>            Object oReportMenu is a cCJMenuItem
80287>                Set peControlType to xtpControlPopup
80288>                Set psCaption to "&Report"
80289>                Set psToolTip to "Report"
80290>                Set psDescription to "Available Reports"
80291>
80291>                Object oGyakorisagRiportMenuItem is a cCJMenuItem
80293>                    Set psCaption to "GyakorisagRiport"
80294>                    Set psTooltip to "GyakorisagRiport"
80295>                
80295>                    Procedure OnExecute Variant vCommandBarControl
80298>                        Handle hoClient
80298>                        Get Client_Id to hoClient
80299>                        Send Activate_oGyakorisagRiport of hoClient
80300>                    End_Procedure
80301>                End_Object
80302>
80302>                Object oReportMenuItem is a cCJMenuItem
80304>                    Set psCaption to "Report"
80305>                    Set psTooltip to "Report"
80306>                
80306>                    Procedure OnExecute Variant vCommandBarControl
80309>                        Handle hoClient
80309>                        Get Client_Id to hoClient
80310>                        Send Activate_oReport of hoClient
80311>                    End_Procedure
80312>                End_Object
80313>            End_Object
80314>
80314>            Object oNavigateMenu is a cCJMenuItem
80316>                Set peControlType to xtpControlPopup      
80317>                Set psCaption to "&Navigate"    
80318>                Set psTooltip to "Navigate"    
80319>                Set psDescription to "Move to different areas of the application"
80320>
80320>                Object oNextAreaMenu is a cCJNextAreaMenu
80322>                End_Object
80323>
80323>                Object oPriorAreaMenu is a cCJPriorAreaMenu
80325>                End_Object
80326>
80326>                Object oNextViewMenu is a cCJNextViewMenu
80328>                End_Object
80329>
80329>                Object oPriorViewMenu is a cCJPriorViewMenu
80331>                End_Object
80332>
80332>                Object oPromptMenu is a cCJPromptMenuItem
80334>                    Set pbControlBeginGroup to True
80335>                End_Object
80336>
80336>                Object oZoomMenu is a cCJZoomMenuItem
80338>                End_Object
80339>
80339>            End_Object
80340>
80340>            Object oWindowMenu is a cCJMDIWindowsMenuItem
80342>                Set peControlType to xtpControlPopup
80343>                Set psCaption to "&Window"
80344>                Set psToolTip to "Window"
80345>                Set psDescription to "Display Current Views and set other display options."    
80346>
80346>                // These are the static windows items. More will be created in onInitPopup 
80346>                Object oDisplayOptionsMenu is a cCJMenuItem
80348>                    Set peControlType to xtpControlPopup          
80349>                    Set psCaption to "&Display Options"
80350>                    Set psToolTip to "Display Options"
80351>                    Set psDescription to "Set display options"
80352>
80352>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
80354>                    End_Object
80355>
80355>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
80357>                    End_Object
80358>
80358>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
80360>                        Set pbControlBeginGroup to True
80361>                    End_Object
80362>
80362>                End_Object
80363>
80363>                Object oCascadeMenu is a cCJCascadeMenuItem
80365>                    Set pbControlBeginGroup to True
80366>                End_Object
80367>
80367>                Object oHorizTile is a cCJTileHorizontally
80369>                End_Object
80370>
80370>                Object oVertTile is a cCJTileVertically
80372>                End_Object
80373>
80373>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
80375>                    Set pbControlBeginGroup to True
80376>                End_Object
80377>
80377>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
80379>                End_Object
80380>
80380>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
80382>                    Set pbControlBeginGroup to True
80383>                End_Object
80384>
80384>            End_Object
80385>
80385>            Object oHelpMenu is a cCJMenuItem
80387>                Set peControlType to xtpControlPopup    
80388>                Set psCaption to "&Help"
80389>                Set psDescription to "Access Information for learning and using this DataFlex application."
80390>                Set psToolTip to "Help"
80391>
80391>                Object oHelpMenuItem is a cCJHelpMenuItem 
80393>                End_Object
80394>
80394>                Object oAboutMenuItem is a cCJAboutMenuItem
80396>                End_Object
80397>
80397>            End_Object
80398>
80398>        End_Object
80399>
80399>        Object oFindToolBar is a cCJToolbar
80401>            Set psTitle to "Finding Toolbar"
80402>
80402>            Object oFindFirstTool is a cCJFindFirstMenuItem
80404>            End_Object
80405>
80405>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
80407>            End_Object
80408>
80408>            Object oFindMenuTool is a cCJFindMenuItem
80410>            End_Object
80411>
80411>            Object oFindNextTool is a cCJFindNextMenuItem
80413>            End_Object
80414>
80414>            Object oFindLastTool is a cCJFindLastMenuItem
80416>            End_Object
80417>
80417>            Object oPromptToolItem is a cCJPromptMenuItem
80419>                Set pbControlBeginGroup to True
80420>            End_Object
80421>
80421>        End_Object
80422>
80422>        Object oFileToolBar is a cCJToolbar
80424>            Set psTitle to "Data Entry Toolbar"
80425>
80425>            Object oClearToolItem is a cCJClearMenuItem
80427>                Set peControlStyle to xtpButtonIconAndCaption
80428>            End_Object
80429>
80429>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
80431>                Set peControlStyle to xtpButtonIconAndCaption
80432>            End_Object
80433>
80433>            Object oSaveToolItem is a cCJSaveMenuItem
80435>                Set peControlStyle to xtpButtonIconAndCaption
80436>                Set pbControlBeginGroup to True
80437>            End_Object
80438>
80438>            Object oDeleteToolItem is a cCJDeleteMenuItem
80440>                Set peControlStyle to xtpButtonIconAndCaption
80441>            End_Object
80442>
80442>        End_Object
80443>
80443>        Object oEditToolBar is a cCJToolbar
80445>            Set psTitle to "Edit Toolbar"
80446>
80446>            Object oCutToolbarItem is a cCJCutMenuItem
80448>            End_Object
80449>
80449>            Object oCopyToolbarItem is a cCJCopyMenuItem
80451>            End_Object
80452>
80452>            Object oPasteToolbarItem is a cCJPasteMenuItem
80454>            End_Object
80455>
80455>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
80457>                Set pbControlBeginGroup to True
80458>            End_Object
80459>
80459>        End_Object
80460>
80460>        Object oRememberToolbar is a cCJToolbar
80462>            Set psTitle to C_$Remember
80463>
80463>            Object oRememberItems is a cCJMenuItem
80465>
80465>                Set peControlType to xtpControlPopup
80466>                Set peControlStyle to xtpButtonCaption
80467>                Set psCaption to C_$Remember
80468>                
80468>                Object oMenuItem is a cCJRememberFieldMenuItem
80470>                    Set peControlStyle to xtpButtonIconAndCaption
80471>                End_Object
80472>                
80472>                Object oMenuItem is a cCJRememberLastFieldMenuItem
80474>                    Set peControlStyle to xtpButtonIconAndCaption
80475>                End_Object
80476>                
80476>                Object oMenuItem is a cCJUnRememberFieldMenuItem
80478>                    Set peControlStyle to xtpButtonIconAndCaption
80479>                End_Object
80480>                
80480>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
80482>                    Set peControlStyle to xtpButtonIconAndCaption
80483>                End_Object
80484>
80484>            End_Object
80485>            
80485>        End_Object
80486>        
80486>        Object oStatusBar is a cCJStatusBar
80488>
80488>            Object oStatusPane1 is a cCJStatusBarPane
80490>                Set piID to sbpIDIdlePane
80491>                Set pbStyleStretch to True
80492>            End_Object
80493>
80493>            Object oStatusPane2 is a cCJStatusBarPane
80495>                Set phoViewPane to Self
80496>                Set pbStyleStretch to True
80497>            End_Object
80498>
80498>        End_Object
80499>
80499>    End_Object
80500>
80500>    Object oClientArea is a ClientArea
80502>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\StdAbout.pkg)
80502>>>//************************************************************************
80502>>>// Confidential Trade Secret.
80502>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
80502>>>// as an unpublished work.  All rights reserved.
80502>>>// DataFlex is a registered trademark of Data Access Corporation.
80502>>>//
80502>>>//************************************************************************
80502>>>//************************************************************************
80502>>>//
80502>>>// $File name  : StdAbout.pkg
80502>>>// $File title : Standard about object package for VDF
80502>>>// Notice      :
80502>>>// $Author(s)  : John Tuohy
80502>>>//
80502>>>// $Rev History
80502>>>//
80502>>>// JT 06/27/97   File created
80502>>>//************************************************************************
80502>>>
80502>>>// This provides a quick and simple way to create an about package for a program.
80502>>>// You need to create a message inside you client area called Activate_About.
80502>>>// Within this message you should send the message DoAbout passing needed
80502>>>// string information.
80502>>>//
80502>>>//       Procedure Activate_About
80502>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
80502>>>//       End_Procedure
80502>>>//    where: sTitle =     Name of application. If none provided, uses caption
80502>>>//                        bar title
80502>>>//           sVersion   = Version Line. If none provided, will be blank
80502>>>//           sCopyRight = Copyright Line. If none provided, will be blank
80502>>>//           sAuthor    = Author name, blank if none provided
80502>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
80502>>>//                        is used.
80502>>>// It is expected that you will place this in your own object package. For
80502>>>// example an order about package may look like this:
80502>>>//
80502>>>//   // OrderAbout.pkg
80502>>>//   Use StdAbout.pkg
80502>>>//   Procedure Activate_About
80502>>>//      String sTitle sCopyright sVersion sAuthor
80502>>>//      Move "My Order Entry System" to sTitle
80502>>>//      Move "Version 2.1" to sVersion
80502>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
80502>>>//      Move "John Smith"  to sAuthor
80502>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
80502>>>//   end_procedure
80502>>>//   // end of file.
80502>>>
80502>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfabout.pkg)
80502>>>>>//************************************************************************
80502>>>>>// Confidential Trade Secret.
80502>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
80502>>>>>// as an unpublished work.  All rights reserved.
80502>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
80502>>>>>//
80502>>>>>//************************************************************************
80502>>>>>//************************************************************************
80502>>>>>//
80502>>>>>// $File name  : DfAbout.pkg
80502>>>>>// $File title : About class support
80502>>>>>// Notice      :
80502>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
80502>>>>>//
80502>>>>>// $Rev History
80502>>>>>//
80502>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
80502>>>>>//                Windows for the size first. 
80502>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
80502>>>>>//                with anchor technique. Removed unnessary property in the
80502>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
80502>>>>>//                object To better look in Windows XP. Repositioned the close
80502>>>>>//                button in the sysinfo dialog To line up with the display area
80502>>>>>//                Replaced obsolete code and techniques. Removed dead code.
80502>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
80502>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
80502>>>>>//                the global Workspace object, if it is present
80502>>>>>// JJT 11/05/98   Added version information
80502>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
80502>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
80502>>>>>//                workspace package.
80502>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
80502>>>>>//                class can create this object.
80502>>>>>//                Cleaned up the interface (used correct classes and messages)
80502>>>>>//                Added workspace reporting support To sys-info.
80502>>>>>//                Turned off wrapping in the sys-info editor.
80502>>>>>// KR  ??/??/96   File created
80502>>>>>//************************************************************************
80502>>>>>Use LanguageText.pkg
80502>>>>>Use Windows.pkg
80502>>>>>Use DFbitmap.pkg
80502>>>>>Use GlobalFunctionsProcedures.pkg
80502>>>>>Use cTextEdit.pkg
80502>>>>>
80502>>>>>Use cli.pkg
80502>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DFBTRDRV.PKG)
80502>>>>>>>//****************************************************************************
80502>>>>>>>//
80502>>>>>>>// $File name  : DFBTRDRV.PKG
80502>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
80502>>>>>>>// Notice      : This package contains constants and commands, used to call
80502>>>>>>>//               specific functions in the DFBTRDRV.
80502>>>>>>>// $Author(s)  : Eddy Kleinjan
80502>>>>>>>//
80502>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
80502>>>>>>>// Created     : 01-07-97 @ 12:00:00
80502>>>>>>>//
80502>>>>>>>// Changed     : 04-04-2001.
80502>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
80502>>>>>>>//
80502>>>>>>>// Changed     : June 6, 2001
80502>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
80502>>>>>>>//
80502>>>>>>>//               Added DFBTR_DDF_OWNER command.
80502>>>>>>>//
80502>>>>>>>// Changed     : June 12, 2001
80502>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
80502>>>>>>>//
80502>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
80502>>>>>>>//
80502>>>>>>>// Changed     : August 4, 2004
80502>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
80502>>>>>>>//
80502>>>>>>>//               Added cDfbtrdrvHandler class.
80502>>>>>>>//               New functions in this class:
80502>>>>>>>//                  Function CKRevision Returns String
80502>>>>>>>//                  Function CkUsesUri Returns Integer
80502>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
80502>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
80502>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
80502>>>>>>>//
80502>>>>>>>// Changed     : September 30, 2005
80502>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
80502>>>>>>>//
80502>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
80502>>>>>>>//****************************************************************************
80502>>>>>>>Use Ui
80502>>>>>>>//
80502>>>>>>>// Driver Indentification
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//*** Driver attributes
80502>>>>>>>//
80502>>>>>>>// Call_Driver functions ID's
80502>>>>>>>//
80502>>>>>>>//
80502>>>>>>>// DFBTRFN_CONVERT_FILE options
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// DFBTRFN_SET_OWNER options
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to create all vars which may be needed
80502>>>>>>>// in other commands.
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to set the owner of a Btrieve file.
80502>>>>>>>// File must have been opened.
80502>>>>>>>// Filenumber needs to be passed.
80502>>>>>>>// To clear set the owner to "".
80502>>>>>>>// Examples:
80502>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
80502>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
80502>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
80502>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
80502>>>>>>>// To clear:
80502>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to parse DFBTR_SET_OWNVER
80502>>>>>>>// options.
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to parse for Callback
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to clear the owner of a Btrieve file.
80502>>>>>>>// File must have been opened.
80502>>>>>>>// Filenumber needs to be passed.
80502>>>>>>>// Examples:
80502>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to add a owner name to the internal list of ownernames
80502>>>>>>>// which will be tries when opening files.
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to remove all owners from the internal list of ownernames
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to set the owner name to be used when opening the DDF files.
80502>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
80502>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
80502>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to change the transaction type.
80502>>>>>>>// Valid types are:
80502>>>>>>>//     DFBTRTT_NONE
80502>>>>>>>//     DFBTRTT_EXCLUSIVE
80502>>>>>>>//     DFBTRTT_CONCURRENT
80502>>>>>>>//
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to get the current transaction type.
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to set explicit_locking
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to get explicit locking
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//
80502>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
80502>>>>>>>//
80502>>>>>>>
80502>>>>>>>//*****************************************************************************
80502>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
80502>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
80502>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
80502>>>>>>>//*****************************************************************************
80502>>>>>>>
80502>>>>>>>Class cDFBtrDrvHandler Is An Array
80503>>>>>>>
80503>>>>>>>    Procedure Construct_Object Integer iImage
80505>>>>>>>        Forward Send Construct_object iImage
80507>>>>>>>
80507>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
80508>>>>>>>    End_Procedure // Construct_Object
80509>>>>>>>
80509>>>>>>>
80509>>>>>>>
80509>>>>>>>    //***
80509>>>>>>>    //*** Function: CKRevsion
80509>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
80509>>>>>>>    //***
80509>>>>>>>
80509>>>>>>>    Function CKRevision Returns String
80511>>>>>>>        Local String  sDriverID
80511>>>>>>>        Local String  sRevision
80511>>>>>>>        Local String  sVoid
80511>>>>>>>        Local Integer iRetval
80511>>>>>>>
80511>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80511>>>>>>>        // This error would otherwise be raised when we have an older
80511>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80511>>>>>>>        Send Ignore_error To Error_object_Id 20491
80512>>>>>>>        Get psDriverID To sDriverID
80513>>>>>>>        Move (Repeat(" ", 255)) To sRevision
80514>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
80519>>>>>>>        Send Trap_Error To Error_object_Id 20491
80520>>>>>>>        If (Trim(sRevision) = "") Begin
80522>>>>>>>            // Unable to get the revision. return all zeroes.
80522>>>>>>>            Move "0.0.0.0" To sRevision
80523>>>>>>>        End
80523>>>>>>>>
80523>>>>>>>        Function_Return sRevision
80524>>>>>>>    End_Function // CKRevision
80525>>>>>>>
80525>>>>>>>    Function CkUsesUri Returns Integer
80527>>>>>>>        Local String  sDriverID
80527>>>>>>>        Local String  sVoid1
80527>>>>>>>        Local String  sVoid2
80527>>>>>>>        Local Integer iRetval
80527>>>>>>>
80527>>>>>>>        Get psDriverID To sDriverID
80528>>>>>>>
80528>>>>>>>        Move 0 To iRetval
80529>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80529>>>>>>>        // This error would otherwise be raised when we have an older
80529>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
80529>>>>>>>        Send Ignore_error To Error_object_Id 20491
80530>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
80535>>>>>>>        Send Trap_Error To Error_object_Id 20491
80536>>>>>>>
80536>>>>>>>        Function_Return iRetval
80537>>>>>>>    End_Function // CKUsesUri
80538>>>>>>>
80538>>>>>>>
80538>>>>>>>
80538>>>>>>>    //***
80538>>>>>>>    //*** Function: ExtractPartFromRevsion
80538>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
80538>>>>>>>    //***
80538>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
80538>>>>>>>    //***
80538>>>>>>>
80538>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
80540>>>>>>>        Local Integer iPartRev
80540>>>>>>>        Local Integer iCurrentPart
80540>>>>>>>        Local Integer iSeparatorPos
80540>>>>>>>
80540>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
80543>>>>>>>
80543>>>>>>>        Move 0 To iCurrentPart
80544>>>>>>>        Repeat
80544>>>>>>>>
80544>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
80545>>>>>>>            If (iSeparatorPos > 0) Begin
80547>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
80548>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
80549>>>>>>>                Increment iCurrentPart
80550>>>>>>>            End
80550>>>>>>>>
80550>>>>>>>            Else If (sRevision <> "") Begin
80553>>>>>>>                Move sRevision To iPartRev
80554>>>>>>>                Move "" To sRevision
80555>>>>>>>                Increment iCurrentPart
80556>>>>>>>            End
80556>>>>>>>>
80556>>>>>>>            Else ;                Move -1 To iPartRev
80558>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
80560>>>>>>>
80560>>>>>>>        Function_Return iPartRev
80561>>>>>>>    End_Function // EcxtractPartFromRevision
80562>>>>>>>
80562>>>>>>>
80562>>>>>>>
80562>>>>>>>    //***
80562>>>>>>>    //*** Function: CKMajorRevision
80562>>>>>>>    //*** Purpose : Returns the major revision of the CK
80562>>>>>>>    //***
80562>>>>>>>
80562>>>>>>>    Function CKMajorRevision Returns Integer
80564>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
80565>>>>>>>    End_Function // CKMajorRevision
80566>>>>>>>
80566>>>>>>>
80566>>>>>>>
80566>>>>>>>    //***
80566>>>>>>>    //*** Function: CKMinorRevision
80566>>>>>>>    //*** Purpose : Returns the minor revision of the CK
80566>>>>>>>    //***
80566>>>>>>>
80566>>>>>>>    Function CKMinorRevision Returns Integer
80568>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
80569>>>>>>>    End_Function // CKMinorRevision
80570>>>>>>>
80570>>>>>>>
80570>>>>>>>
80570>>>>>>>    //***
80570>>>>>>>    //*** Function: CKReleaseRevision
80570>>>>>>>    //*** Purpose : Returns the release revision of the CK
80570>>>>>>>    //***
80570>>>>>>>
80570>>>>>>>    Function CKReleaseRevision Returns Integer
80572>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
80573>>>>>>>    End_Function // CKReleaseRevision
80574>>>>>>>
80574>>>>>>>
80574>>>>>>>
80574>>>>>>>    //***
80574>>>>>>>    //*** Function: CKBuildRevision
80574>>>>>>>    //*** Purpose : Returns the major revision of the CK
80574>>>>>>>    //***
80574>>>>>>>
80574>>>>>>>    Function CKBuildRevision Returns Integer
80576>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
80577>>>>>>>    End_Function // CKBuildRevision
80578>>>>>>>
80578>>>>>>>
80578>>>>>>>
80578>>>>>>>    //***
80578>>>>>>>    //*** Function: IsMinimalRevision
80578>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
80578>>>>>>>    //***
80578>>>>>>>
80578>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
80580>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
80583>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
80586>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
80589>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
80592>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
80595>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
80599>>>>>>>            End
80599>>>>>>>>
80599>>>>>>>        End
80599>>>>>>>>
80599>>>>>>>
80599>>>>>>>        Function_Return (FALSE)
80600>>>>>>>    End_Function // IsMinimalRevision
80601>>>>>>>
80601>>>>>>>    //   Functions to query the Pervasive.SQL version:
80601>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
80601>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
80601>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
80601>>>>>>>    //
80601>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
80601>>>>>>>    //   in the following format:
80601>>>>>>>    //       <version>.<revision>.<type>
80601>>>>>>>    //   possible values for <type>:
80601>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
80601>>>>>>>    //         server using Workgroup authentication mode
80601>>>>>>>    //       C for client cache engine
80601>>>>>>>    //       D for DOS workstation
80601>>>>>>>    //       N for client Requester
80601>>>>>>>    //       S for NetWare server
80601>>>>>>>    //       T for 32-bit Windows server engine
80601>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
80601>>>>>>>    //
80601>>>>>>>    //   example:
80601>>>>>>>    //       8.50.T
80601>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
80601>>>>>>>    //   32-bits Windows server.
80601>>>>>>>    //
80601>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
80601>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
80601>>>>>>>    //
80601>>>>>>>    //   If the version information is not available or can not be obtained
80601>>>>>>>    //   the functions will return "0.0.0"
80601>>>>>>>
80601>>>>>>>
80601>>>>>>>    //***
80601>>>>>>>    //*** Function: PSQLRequesterVersionInfo
80601>>>>>>>    //*** Purpose : Returns the version information of the
80601>>>>>>>    //***           Pervasive.SQL Client requester.
80601>>>>>>>
80601>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
80603>>>>>>>
80603>>>>>>>        Local String  sDriverID
80603>>>>>>>        Local String  sVersion
80603>>>>>>>        Local String  sVoid
80603>>>>>>>        Local Integer iRetval
80603>>>>>>>
80603>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80603>>>>>>>        // This error would otherwise be raised when we have an older
80603>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80603>>>>>>>        Send Ignore_error To Error_object_Id 20491
80604>>>>>>>        Get psDriverID To sDriverID
80605>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80606>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80611>>>>>>>        Send Trap_Error To Error_object_Id 20491
80612>>>>>>>        If (Trim(sVersion) = "") Begin
80614>>>>>>>            // Unable to get the revision. return all zeroes.
80614>>>>>>>            Move "0.0.0" To sVersion
80615>>>>>>>        End
80615>>>>>>>>
80615>>>>>>>        Function_Return sVersion
80616>>>>>>>    End_Function //  PSQLRequesterVersion
80617>>>>>>>
80617>>>>>>>    //***
80617>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
80617>>>>>>>    //*** Purpose : Returns the version information of the
80617>>>>>>>    //***           Pervasive.SQL Local Engine
80617>>>>>>>
80617>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
80619>>>>>>>
80619>>>>>>>        Local String  sDriverID
80619>>>>>>>        Local String  sVersion
80619>>>>>>>        Local String  sVoid
80619>>>>>>>        Local Integer iRetval
80619>>>>>>>
80619>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80619>>>>>>>        // This error would otherwise be raised when we have an older
80619>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80619>>>>>>>        Send Ignore_error To Error_object_Id 20491
80620>>>>>>>        Get psDriverID To sDriverID
80621>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80622>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80627>>>>>>>        Send Trap_Error To Error_object_Id 20491
80628>>>>>>>        If (Trim(sVersion) = "") Begin
80630>>>>>>>            // Unable to get the revision. return all zeroes.
80630>>>>>>>            Move "0.0.0" To sVersion
80631>>>>>>>        End
80631>>>>>>>>
80631>>>>>>>        Function_Return sVersion
80632>>>>>>>    End_Function //  PSQLLocalEngineVersion
80633>>>>>>>
80633>>>>>>>    //***
80633>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
80633>>>>>>>    //*** Purpose : Returns the version information of the
80633>>>>>>>    //***           Pervasive.SQL Server Engine
80633>>>>>>>
80633>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
80635>>>>>>>
80635>>>>>>>        Local String  sDriverID
80635>>>>>>>        Local String  sVersion
80635>>>>>>>        Local String  sVoid
80635>>>>>>>        Local Integer iRetval
80635>>>>>>>
80635>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80635>>>>>>>        // This error would otherwise be raised when we have an older
80635>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80635>>>>>>>        Send Ignore_error To Error_object_Id 20491
80636>>>>>>>        Get psDriverID To sDriverID
80637>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80638>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80643>>>>>>>        Send Trap_Error To Error_object_Id 20491
80644>>>>>>>        If (Trim(sVersion) = "") Begin
80646>>>>>>>            // Unable to get the revision. return all zeroes.
80646>>>>>>>            Move "0.0.0" To sVersion
80647>>>>>>>        End
80647>>>>>>>>
80647>>>>>>>        Function_Return sVersion
80648>>>>>>>    End_Function //  PSQLServerEngineVersion
80649>>>>>>>
80649>>>>>>>End_Class // cDfbtrdrvHandler
80650>>>>>>>
80650>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\MSSqldrv.pkg)
80650>>>>>>>//*****************************************************************************
80650>>>>>>>//*** MSSQLDRV.PKG                                                          ***
80650>>>>>>>//***                                                                       ***
80650>>>>>>>//*** Author: Ben Weijers                                                   ***
80650>>>>>>>//***         Data Access Nederland                                         ***
80650>>>>>>>//***         29 June 1998                                                  ***
80650>>>>>>>//***                                                                       ***
80650>>>>>>>//***                                                                       ***
80650>>>>>>>//*** Purpose:                                                              ***
80650>>>>>>>//***   Package that declares MS SQL driver constants and functions.        ***
80650>>>>>>>//****                                                                      ***
80650>>>>>>>//***   This package can be used by developers who want to add Data Access  ***
80650>>>>>>>//***   MS SQL Client specific code to a DataFlex application.              ***
80650>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
80650>>>>>>>//***             Changed EnumerateServers function to use the highest      ***
80650>>>>>>>//***             available SQL Server client driver.                       ***
80650>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
80650>>>>>>>//***             mssqldrv.pkg                                              ***
80650>>>>>>>//***   Updated:  November 6th 2013 (Current CK build: 6.0.0.19)            ***
80650>>>>>>>//***             Added constants for SQL Server specific native types      ***
80650>>>>>>>//***             ( var...(max) types, money types, datetime types)         ***
80650>>>>>>>//*****************************************************************************
80650>>>>>>>
80650>>>>>>>Use Cli.pkg
80650>>>>>>>Use SQL.pkg
80650>>>>>>>
80650>>>>>>>//*** Driver Indentification
80650>>>>>>>
80650>>>>>>>//*** Error number constants
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>// SQL Server spcific types. 
80650>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
80650>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
80650>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
80650>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
80650>>>>>>>
80650>>>>>>>// SQL Server spcific types. 
80650>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
80650>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
80650>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
80650>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
80650>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
80650>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
80650>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>//*****************************************************************************
80650>>>>>>>//*** MSSQL_SetConstraint <FileNum> <ConstraintText>                        ***
80650>>>>>>>//***                                                                       ***
80650>>>>>>>//***   Setup a constraint for a file.                                      ***
80650>>>>>>>//*****************************************************************************
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>
80650>>>>>>>Class cMSSQLHandler Is A cCLIHandler
80651>>>>>>>
80651>>>>>>>    Procedure Construct_Object
80653>>>>>>>        Forward Send Construct_Object
80655>>>>>>>
80655>>>>>>>        Set psDriverID To MSSQLDRV_ID
80656>>>>>>>    End_Procedure // Construct_Object
80657>>>>>>>
80657>>>>>>>
80657>>>>>>>
80657>>>>>>>    //***
80657>>>>>>>    //*** Function: ExtractList
80657>>>>>>>    //*** Purpose : Extract the list from the out connect string.
80657>>>>>>>    //***
80657>>>>>>>
80657>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
80659>>>>>>>        Local String  sItem
80659>>>>>>>        Local Integer iStart
80659>>>>>>>        Local Integer iEnd
80659>>>>>>>
80659>>>>>>>        If (hoStore = 0) ;            Move Current_object To hoStore
80662>>>>>>>
80662>>>>>>>        Send Delete_Data To hoStore
80663>>>>>>>        Move (Pos("{", sOutConnStr)) To iStart
80664>>>>>>>        While (iStart > 0)
80668>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) To sOutConnStr
80669>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 To iStart
80672>>>>>>>            Else Begin
80673>>>>>>>                Move (Pos(",", sOutConnStr)) To iStart
80674>>>>>>>                Move (Pos("}", sOutConnStr)) To iEnd
80675>>>>>>>                If ((iStart = 0) Or (iEnd < iStart)) ;                    Move iEnd To iStart
80678>>>>>>>
80678>>>>>>>                If (iStart > 0) ;                    Set Value Of hoStore Item (Item_Count(Current_Object)) To (Left(sOutConnStr, iStart - 1))
80681>>>>>>>
80681>>>>>>>                If (iStart = iEnd) ;                    Move 0 To iStart
80684>>>>>>>            End
80684>>>>>>>>
80684>>>>>>>        Loop
80685>>>>>>>>
80685>>>>>>>
80685>>>>>>>        Function_Return (Item_Count(hoStore))
80686>>>>>>>    End_Procedure // ExtractList
80687>>>>>>>
80687>>>>>>>
80687>>>>>>>
80687>>>>>>>    //***
80687>>>>>>>    //*** Function: BrowseConnect
80687>>>>>>>    //*** Purpose : Call the driver's browse connect function
80687>>>>>>>    //***
80687>>>>>>>
80687>>>>>>>    Function BrowseConnect String sInConnStr Returns String
80689>>>>>>>        Local String  sDriver
80689>>>>>>>        Local String  sOutConnStr
80689>>>>>>>        Local Integer iArg
80689>>>>>>>        Local Integer iRetval
80689>>>>>>>
80689>>>>>>>        Get psDriverID To sDriver
80690>>>>>>>        If (sDriver <> "") Begin
80692>>>>>>>            Move (Repeat(" ", 8192)) To sOutConnStr
80693>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
80698>>>>>>>        End
80698>>>>>>>>
80698>>>>>>>
80698>>>>>>>        Function_Return sOutConnStr
80699>>>>>>>    End_Function// BrowseConnect
80700>>>>>>>
80700>>>>>>>
80700>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
80702>>>>>>>        Local String  sDriver
80702>>>>>>>        Local String  sOutConnStr
80702>>>>>>>        Local Integer iArg
80702>>>>>>>        Local Integer iRetval
80702>>>>>>>        
80702>>>>>>>        Move 1 to iArg // Browses only local
80703>>>>>>>
80703>>>>>>>        Get psDriverID to sDriver
80704>>>>>>>        If (sDriver <> "") Begin
80706>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
80707>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
80712>>>>>>>        End
80712>>>>>>>>
80712>>>>>>>
80712>>>>>>>        Function_Return sOutConnStr
80713>>>>>>>    End_Function// BrowseConnect
80714>>>>>>>
80714>>>>>>>
80714>>>>>>>    Function DriverIndex String sDriver Returns Integer
80716>>>>>>>    
80716>>>>>>>        Local String  sCurrentDriver
80716>>>>>>>        Local Integer iNumberOfDrivers iDriver iCount
80716>>>>>>>    
80716>>>>>>>        Move 0 to iDriver
80717>>>>>>>    
80717>>>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
80720>>>>>>>        For iCount from 1 to iNumberOfDrivers
80726>>>>>>>>
80726>>>>>>>    
80726>>>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
80729>>>>>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriver) ) Begin
80731>>>>>>>                Move iCount to iDriver
80732>>>>>>>            End
80732>>>>>>>>
80732>>>>>>>        Loop
80733>>>>>>>>
80733>>>>>>>    
80733>>>>>>>        Function_Return iDriver
80734>>>>>>>    
80734>>>>>>>    End_Function 
80735>>>>>>>
80735>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
80737>>>>>>>        
80737>>>>>>>        Local String  sServerList
80737>>>>>>>        Local Integer iNumServers
80737>>>>>>>        Local Integer iDriver
80737>>>>>>>        Local Integer iClientVersion
80737>>>>>>>        Local String  sDriver
80737>>>>>>>        
80737>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
80738>>>>>>>
80738>>>>>>>        If (iDriver) Begin
80740>>>>>>>                
80740>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
80743>>>>>>>            
80743>>>>>>>            Case Begin
80743>>>>>>>    
80743>>>>>>>                Case (iClientVersion = SQLSERVER2016CLIENT)
80745>>>>>>>                    Move SQLSERVER2016DRVRSTR to sDriver
80746>>>>>>>                    Case Break
80747>>>>>>>    
80747>>>>>>>                Case (iClientVersion = SQLSERVER2014CLIENT)
80750>>>>>>>                    Move SQLSERVER2014DRVRSTR to sDriver
80751>>>>>>>                    Case Break
80752>>>>>>>            
80752>>>>>>>                Case (iClientVersion = SQLSERVER2012CLIENT)
80755>>>>>>>                    Move SQLSERVER2012DRVRSTR to sDriver
80756>>>>>>>                    Case Break
80757>>>>>>>    
80757>>>>>>>                Case (iClientVersion = SQLSERVER2008CLIENT)
80760>>>>>>>                    Move SQLSERVER2008DRVRSTR to sDriver
80761>>>>>>>                    Case Break
80762>>>>>>>    
80762>>>>>>>                Case (iClientVersion = SQLSERVER2005CLIENT)
80765>>>>>>>                    Move SQLSERVER2005DRVRSTR to sDriver
80766>>>>>>>                    Case Break
80767>>>>>>>            
80767>>>>>>>                Case (iClientVersion = SQLSERVER2000CLIENT)
80770>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
80771>>>>>>>                    Case Break
80772>>>>>>>            
80772>>>>>>>                Case Else
80772>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
80773>>>>>>>            
80773>>>>>>>            Case End
80773>>>>>>>    
80773>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
80774>>>>>>>            If (iNetworkLocal = 0) Begin
80776>>>>>>>                Get BrowseConnect sDriver to sServerList
80777>>>>>>>            End
80777>>>>>>>>
80777>>>>>>>            Else Begin
80778>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
80779>>>>>>>            End
80779>>>>>>>>
80779>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
80780>>>>>>>        End
80780>>>>>>>>
80780>>>>>>>        
80780>>>>>>>        Function_Return iNumServers
80781>>>>>>>        
80781>>>>>>>    End_Function
80782>>>>>>>
80782>>>>>>>    //***
80782>>>>>>>    //*** Procedure: EnumerateServers
80782>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
80782>>>>>>>    //***            This function will return all SQL Server instances on the network. 
80782>>>>>>>    //***            This may take a long time. 
80782>>>>>>>    //***            To enumerate only local SQL Server instances use EnumerateServersLocal 
80782>>>>>>>    Function EnumerateServers Returns Integer
80784>>>>>>>
80784>>>>>>>        Local Integer iNumServers
80784>>>>>>>        Local Integer iNetworkLocal
80784>>>>>>>        
80784>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
80785>>>>>>>        
80785>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
80786>>>>>>>        
80786>>>>>>>        Function_Return iNumServers
80787>>>>>>>        
80787>>>>>>>    End_Function
80788>>>>>>>
80788>>>>>>>
80788>>>>>>>    //***
80788>>>>>>>    //*** Procedure: EnumerateServersLocal
80788>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
80788>>>>>>>    //***            This function will return only return SQL Server instance on the local machine
80788>>>>>>>    //***            To enumerate all SQL Server instances in a network use EnumerateServers
80788>>>>>>>    Function EnumerateServersLocal Returns Integer
80790>>>>>>>
80790>>>>>>>        Local Integer iNumServers
80790>>>>>>>        Local Integer iNetworkLocal
80790>>>>>>>        
80790>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
80791>>>>>>>        
80791>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
80792>>>>>>>        
80792>>>>>>>        Function_Return iNumServers
80793>>>>>>>        
80793>>>>>>>    End_Function
80794>>>>>>>
80794>>>>>>>    
80794>>>>>>>
80794>>>>>>>    //***
80794>>>>>>>    //*** Function: EnumerateDatabases
80794>>>>>>>    //*** Purpose : Enumerate database in a given server.
80794>>>>>>>    //***
80794>>>>>>>
80794>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
80796>>>>>>>        Local Integer hoSQL
80796>>>>>>>        Local String  sConnect
80796>>>>>>>        Local String  sDatabase
80796>>>>>>>        Local Integer hdbc
80796>>>>>>>        Local Integer hstmt
80796>>>>>>>        Local Integer iFetchResult
80796>>>>>>>
80796>>>>>>>        If (Num_Arguments < 3) ;            Move "" To sPassWord
80799>>>>>>>        If (Num_Arguments < 2) ;            Move "" To sUser
80802>>>>>>>
80802>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") To sConnect
80805>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") To sConnect
80807>>>>>>>
80807>>>>>>>        Object oEnumDBSQLmanager Is A cSQLHandleManager
80809>>>>>>>            Move Current_Object To hoSQL
80810>>>>>>>        End_Object // oEnumDBSQLManager
80811>>>>>>>
80811>>>>>>>        If (hoSQL <> 0) Begin
80813>>>>>>>            Get SQLConnect Of hoSQL "MSSQLDRV" sConnect To hdbc
80814>>>>>>>            If (hdbc <> 0) Begin
80816>>>>>>>                Get SQLOpen Of hdbc To hstmt
80817>>>>>>>                If (hstmt <> 0) Begin
80819>>>>>>>                    //*** We could do a direct select on the sysdatabases table but we use
80819>>>>>>>                    //*** the stored procedure sp_database instead. SQL Server recommends this
80819>>>>>>>                    //*** approach in case meta data might change, the stored procedure will
80819>>>>>>>                    //*** stay the same.
80819>>>>>>>                    Send SQLSetProcedureName To hstmt "sp_databases"
80820>>>>>>>                    Send SQLCall To hstmt
80821>>>>>>>                    Repeat
80821>>>>>>>>
80821>>>>>>>                        Get SQLFetch Of hstmt To iFetchResult
80822>>>>>>>                        If (iFetchResult <> 0) Begin
80824>>>>>>>                            Get SQLColumnValue Of hstmt 1 To sDatabase
80825>>>>>>>                            Set Value Item (Item_Count(Current_Object)) To sDatabase
80826>>>>>>>                        End
80826>>>>>>>>
80826>>>>>>>                    Until (iFetchResult = 0)
80828>>>>>>>
80828>>>>>>>                    Send SQLClose To hstmt
80829>>>>>>>                End
80829>>>>>>>>
80829>>>>>>>                Send SQLDisconnect To hdbc
80830>>>>>>>            End
80830>>>>>>>>
80830>>>>>>>        End
80830>>>>>>>>
80830>>>>>>>        Send Destroy_Object To hoSQL
80831>>>>>>>
80831>>>>>>>        Function_return (Item_Count(Current_Object))
80832>>>>>>>    End_Function // EnumerateDatabases
80833>>>>>>>
80833>>>>>>>
80833>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
80835>>>>>>>        
80835>>>>>>>        Local String  sSqlServerClientVersionName
80835>>>>>>>        
80835>>>>>>>            
80835>>>>>>>        Case Begin
80835>>>>>>>
80835>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
80837>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
80838>>>>>>>                Case Break
80839>>>>>>>
80839>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
80842>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
80843>>>>>>>                Case Break
80844>>>>>>>        
80844>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
80847>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
80848>>>>>>>                Case Break
80849>>>>>>>
80849>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
80852>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
80853>>>>>>>                Case Break
80854>>>>>>>
80854>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
80857>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
80858>>>>>>>                Case Break
80859>>>>>>>        
80859>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
80862>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
80863>>>>>>>                Case Break
80864>>>>>>>        
80864>>>>>>>            Case Else
80864>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
80865>>>>>>>        
80865>>>>>>>        Case End
80865>>>>>>>    
80865>>>>>>>        
80865>>>>>>>        Function_Return sSqlServerClientVersionName
80866>>>>>>>        
80866>>>>>>>    End_Function
80867>>>>>>>
80867>>>>>>>
80867>>>>>>>End_Class // cMSSQLHandler
80868>>>>>>>
80868>>>>>
80868>>>>>
80868>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
80869>>>>>
80869>>>>>Register_Function phoWorkspace Returns Handle
80869>>>>>Register_Function Help_filename Returns String
80869>>>>>Register_Function GetHelpFile Returns String
80869>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
80869>>>>>
80869>>>>>//****************************************************************************
80869>>>>>// $Module type: FUNCTION
80869>>>>>// $Module name: Network_User_Name
80869>>>>>// $Author     : AK/VOO/KCR
80869>>>>>// Created     : 09-24-96 @ 19:17
80869>>>>>//
80869>>>>>// Description
80869>>>>>//    This function reads the current username Of windows and returns that
80869>>>>>//    name or an text unknown user
80869>>>>>//
80869>>>>>// $Rev History
80869>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
80869>>>>>//  07/25/2003  Replaced obsolete code
80869>>>>>//  09/24/1996  Module header created
80869>>>>>//****************************************************************************
80869>>>>>Function Network_User_Name for cDesktop Returns String
80871>>>>>    String sName
80871>>>>>    Integer iRetval iLength
80871>>>>>
80871>>>>>    Move 0 to iLength
80872>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
80873>>>>>    ZeroString iLength to sName
80874>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
80875>>>>>
80875>>>>>    If (iRetval = NO_ERROR) Begin
80877>>>>>        Function_Return (CString (sName))
80878>>>>>    End
80878>>>>>>
80878>>>>>    
80878>>>>>    Function_Return "User Unknown"
80879>>>>>End_Function
80880>>>>>
80880>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
80880>>>>>Type MEMORYSTATUS
80880>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
80880>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
80880>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
80880>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
80880>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
80880>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
80880>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
80880>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
80880>>>>>End_Type // MEMORYSTATUS
80880>>>>>
80880>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
80881>>>>>
80881>>>>>Struct tWinMemoryStatusEx
80881>>>>>    UInteger dwLength                
80881>>>>>    UInteger dwMemoryLoad          
80881>>>>>    UBigInt ullTotalPhys           
80881>>>>>    UBigInt ullAvailPhys           
80881>>>>>    UBigInt ullTotalPageFile       
80881>>>>>    UBigInt ullAvailPageFile       
80881>>>>>    UBigInt ullTotalVirtual        
80881>>>>>    UBigInt ullAvailVirtual        
80881>>>>>    UBigInt ullAvailExtendedVirtual
80881>>>>>End_Struct
80881>>>>>
80881>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
80882>>>>>
80882>>>>>Class SysinfoDisplay is a cTextEdit
80883>>>>>    Procedure Construct_Object
80885>>>>>        Forward Send Construct_Object
80887>>>>>
80887>>>>>        Set Location To 6 6
80888>>>>>        Set Size To 110 255
80889>>>>>        Set Read_Only_State To True
80890>>>>>        Set pbWrap to False
80891>>>>>    End_Procedure
80892>>>>>
80892>>>>>    //****************************************************************************
80892>>>>>    // $Module type: PROCEDURE
80892>>>>>    // $Module name: Show_Current_Directory
80892>>>>>    // $Author     : VOO
80892>>>>>    // Created     : 06-10-96 @ 15:24
80892>>>>>    //
80892>>>>>    // Description
80892>>>>>    //    This method will show the name Of the current directory in the system
80892>>>>>    //    information box
80892>>>>>    //
80892>>>>>    // $Rev History
80892>>>>>    //    06-10-96  Module header created
80892>>>>>    //****************************************************************************
80892>>>>>    Procedure Show_Current_Directory
80894>>>>>        String sDir
80894>>>>>
80894>>>>>        Get_Current_Directory To sDir
80895>>>>>
80895>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
80896>>>>>    End_Procedure
80897>>>>>
80897>>>>>    Procedure Show_Windows_Directory
80899>>>>>        String sWindir
80899>>>>>
80899>>>>>        Get_Windows_Directory To sWindir
80900>>>>>
80900>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
80901>>>>>    End_Procedure
80902>>>>>
80902>>>>>    Procedure Show_Current_User
80904>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
80905>>>>>    End_Procedure
80906>>>>>
80906>>>>>    Procedure Show_Number_Format
80908>>>>>        Integer iFormat
80908>>>>>        String sFormatText
80908>>>>>
80908>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
80911>>>>>        Move (Character (iFormat)) To sFormatText
80912>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
80913>>>>>
80913>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
80916>>>>>        Move (Character (iFormat)) to sFormatText
80917>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
80918>>>>>    End_Procedure
80919>>>>>
80919>>>>>    Procedure Show_Filelist_Name
80921>>>>>        String sFilename
80921>>>>>
80921>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
80924>>>>>
80924>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
80925>>>>>        Send AppendTextLn ""
80926>>>>>    End_Procedure
80927>>>>>
80927>>>>>    Procedure Show_Lock_Delay
80929>>>>>        Integer iLockdelay
80929>>>>>
80929>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
80932>>>>>
80932>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
80933>>>>>    End_Procedure
80934>>>>>
80934>>>>>    Procedure Show_Lock_Timeout
80936>>>>>        Integer iLockTimeout
80936>>>>>
80936>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
80939>>>>>
80939>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
80940>>>>>    End_Procedure
80941>>>>>
80941>>>>>    Procedure Show_Screen_Size
80943>>>>>        Integer iYscreensize iXscreensize
80943>>>>>
80943>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
80944>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
80945>>>>>
80945>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
80946>>>>>    End_Procedure
80947>>>>>
80947>>>>>    Procedure Show_Page_Size
80949>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
80950>>>>>    End_procedure
80951>>>>>
80951>>>>>    Procedure Show_Date
80953>>>>>        Date dToday
80953>>>>>
80953>>>>>        Sysdate dToday
80954>>>>>
80954>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
80955>>>>>    End_procedure
80956>>>>>
80956>>>>>    Procedure Show_Date_Format
80958>>>>>        Integer iDateFormat
80958>>>>>        String sDateFormat
80958>>>>>
80958>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
80961>>>>>        Case Begin
80961>>>>>            Case (iDateFormat = DF_DATE_USA)
80963>>>>>                Move C_$USA To sDateFormat
80964>>>>>                Case Break
80965>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
80968>>>>>                Move C_$European To sDateFormat
80969>>>>>                Case Break
80970>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
80973>>>>>                Move C_$Military To sDateFormat
80974>>>>>                Case Break
80975>>>>>            Case Else
80975>>>>>                Move C_$UnknownDateType To sDateFormat
80976>>>>>                Case Break
80977>>>>>        Case End
80977>>>>>
80977>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
80978>>>>>    End_Procedure
80979>>>>>
80979>>>>>    Procedure Show_Systemresources
80981>>>>>        tWinMemoryStatusEx MemoryStatusInfo
80981>>>>>        tWinMemoryStatusEx MemoryStatusInfo
80981>>>>>        Integer iRetval
80981>>>>>
80981>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
80982>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
80983>>>>>        If (iRetval = 0) Begin
80985>>>>>            Move (ShowLastError ()) to iRetval
80986>>>>>        End
80986>>>>>>
80986>>>>>
80986>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
80987>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
80988>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
80989>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
80990>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
80991>>>>>    End_Procedure
80992>>>>>
80992>>>>>    Procedure Show_Registration
80994>>>>>        String sRegName
80994>>>>>        Integer iSN iMaxUsers
80994>>>>>
80994>>>>>        Registration sRegName iSN
80995>>>>>>
80995>>>>>        
80995>>>>>        Get_Licensed_Max_Users to iMaxUsers
80996>>>>>
80996>>>>>        Send AppendTextLn ""
80997>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
80998>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
80999>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
81000>>>>>    End_Procedure
81001>>>>>
81001>>>>>    //****************************************************************************
81001>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
81001>>>>>    // To the workspace object passing the an object and message To send back
81001>>>>>    // To this object. It is expected that the workspace object will send this
81001>>>>>    // message for every line Of information it wants displayed (passing the
81001>>>>>    // information To be displayed
81001>>>>>    //****************************************************************************
81001>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
81001>>>>>
81001>>>>>    Procedure Show_ServicePack
81003>>>>>        String sKey sVersionDescription sVersion 
81003>>>>>        Handle hoRegistry
81003>>>>>        Boolean bExists bOpened
81003>>>>>        
81003>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
81004>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
81005>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
81006>>>>>
81006>>>>>        Move C_DFVersionRegistryRoot to sKey
81007>>>>>        Get KeyExists of hoRegistry sKey to bExists
81008>>>>>        If (bExists) Begin
81010>>>>>            Get OpenKey of hoRegistry sKey to bOpened
81011>>>>>            If (bOpened) Begin
81013>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
81014>>>>>                If (bExists) Begin
81016>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
81017>>>>>                End
81017>>>>>>
81017>>>>>                
81017>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
81018>>>>>                If (bExists) Begin
81020>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
81021>>>>>                End                
81021>>>>>>
81021>>>>>                Send CloseKey of hoRegistry
81022>>>>>            End
81022>>>>>>
81022>>>>>        End
81022>>>>>>
81022>>>>>        Send Destroy of hoRegistry
81023>>>>>
81023>>>>>        If (sVersionDescription <> "") Begin
81025>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
81026>>>>>           Send AppendTextLn ""
81027>>>>>        End
81027>>>>>>
81027>>>>>    End_Procedure
81028>>>>>    
81028>>>>>
81028>>>>>    Procedure Show_WorkspaceInformation
81030>>>>>        Integer hoWorkspace
81030>>>>>
81030>>>>>        If (ghoApplication <> 0) Begin
81032>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
81033>>>>>            If (hoWorkspace <> 0) Begin
81035>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
81036>>>>>                Send AppendTextLn ""
81037>>>>>            End
81037>>>>>>
81037>>>>>        End
81037>>>>>>
81037>>>>>    End_Procedure
81038>>>>>
81038>>>>>    //****************************************************************************
81038>>>>>    // If connection ids are used, we will send the message EnumerateConnections
81038>>>>>    // to the connection manager object passing the an object and message to send 
81038>>>>>    // back to this object. It is expected that the connection manager object will 
81038>>>>>    // send this message for every line Of information it wants displayed (passing 
81038>>>>>    // the information To be displayed
81038>>>>>    //****************************************************************************
81038>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
81038>>>>>
81038>>>>>    Procedure Show_ConnectionIdInformation
81040>>>>>        If (ghoConnection > 0) Begin
81042>>>>>            Send AppendTextLn ""
81043>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
81044>>>>>        End
81044>>>>>>
81044>>>>>    End_Procedure
81045>>>>>
81045>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
81047>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
81048>>>>>    End_Function
81049>>>>>
81049>>>>>    Procedure Show_Versions
81051>>>>>        Integer iVersion iRevision iBuild
81051>>>>>
81051>>>>>        Version_Information iVersion iRevision iBuild
81053>>>>>
81053>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
81054>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
81055>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
81056>>>>>    End_Procedure
81057>>>>>    
81057>>>>>    Function CKRevisionNumber String sDriverID Returns String
81059>>>>>        Handle hoCLIHandler
81059>>>>>        Handle hoDFBtrDrvHandler
81059>>>>>        String sCKRevision
81059>>>>>
81059>>>>>
81059>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
81061>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
81062>>>>>            Set psDriverID of hoCLIHandler to sDriverID
81063>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
81064>>>>>            Send Destroy of hoCLIHandler
81065>>>>>        End
81065>>>>>>
81065>>>>>        Else Begin
81066>>>>>            If (sDriverID = "DFBTRDRV") Begin
81068>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
81069>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
81070>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
81071>>>>>                Send Destroy of hoDFBtrDrvHandler
81072>>>>>            End
81072>>>>>>
81072>>>>>        End
81072>>>>>>
81072>>>>>        
81072>>>>>        Function_Return sCKRevision
81073>>>>>    End_Function
81074>>>>>    
81074>>>>>    
81074>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
81076>>>>>        
81076>>>>>        If (sDriverID = "DATAFLEX") Begin
81078>>>>>            Function_Return False
81079>>>>>        End
81079>>>>>>
81079>>>>>    
81079>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
81080>>>>>    End_Function    
81081>>>>>
81081>>>>>
81081>>>>>    //***
81081>>>>>    //*** BW
81081>>>>>    //*** Procedure: Show_Drivers
81081>>>>>    //*** Purpose  : Show loaded database drivers
81081>>>>>    //***
81081>>>>>
81081>>>>>    Procedure Show_Drivers
81083>>>>>        String sCurrentDriver sRevNumber
81083>>>>>        String sLoadedDrivers sClientDriver
81083>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
81083>>>>>        Boolean bOK 
81083>>>>>        Handle hoMsqlDrv
81083>>>>>
81083>>>>>        Move "" To sLoadedDrivers
81084>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
81087>>>>>        For iCount from 1 to iNumberOfDrivers
81093>>>>>>
81093>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
81096>>>>>            If (sLoadedDrivers <> "") Begin
81098>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
81099>>>>>            End
81099>>>>>>
81099>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
81100>>>>>            If (bOK) Begin
81102>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
81104>>>>>                    Move iCount to iMSSQLIndex
81105>>>>>                End
81105>>>>>>
81105>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
81106>>>>>                // if mssqldrv, show the client number
81106>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
81107>>>>>            End
81107>>>>>>
81107>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
81108>>>>>        Loop
81109>>>>>>
81109>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
81110>>>>>        If (iMSSQLIndex>0) Begin
81112>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
81115>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
81116>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
81117>>>>>            Send Destroy of hoMsqlDrv
81118>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
81119>>>>>        End
81119>>>>>>
81119>>>>>    End_Procedure
81120>>>>>
81120>>>>>    Procedure Show_HelpFile
81122>>>>>        String sHelpFile
81122>>>>>        Integer eHelpType
81122>>>>>
81122>>>>>        If (ghoApplication <> 0) Begin
81124>>>>>            Get peHelpType Of ghoApplication To eHelpType
81125>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
81127>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
81128>>>>>            End
81128>>>>>>
81128>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
81131>>>>>                Get Help_filename Of Help_object_id To sHelpFile
81132>>>>>            End
81132>>>>>>
81132>>>>>            Else Begin
81133>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
81134>>>>>            End
81134>>>>>>
81134>>>>>
81134>>>>>            Send AppendTextLn ""
81135>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
81136>>>>>        End
81136>>>>>>
81136>>>>>    End_Procedure
81137>>>>>
81137>>>>>    Procedure Show_EnterAsTab
81139>>>>>        Boolean bEnterKeyAsTabKey
81139>>>>>        String sText
81139>>>>>
81139>>>>>        If (ghoApplication <> 0) Begin
81141>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
81142>>>>>            If (bEnterKeyAsTabKey) Begin
81144>>>>>                Move "True" To sText
81145>>>>>            End
81145>>>>>>
81145>>>>>            Else Begin
81146>>>>>                Move "False" To sText
81147>>>>>            End
81147>>>>>>
81147>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
81148>>>>>        End
81148>>>>>>
81148>>>>>    End_Procedure
81149>>>>>
81149>>>>>    //****************************************************************************
81149>>>>>    // $Module type: PROCEDURE
81149>>>>>    // $Module name: Add_Focus
81149>>>>>    // $Author     : VOO
81149>>>>>    // Created     : 24-09-96 @ 19:43
81149>>>>>    //
81149>>>>>    // Description
81149>>>>>    //    During activation we will remove the old information and add the newly
81149>>>>>    //    found systeminformation
81149>>>>>    //
81149>>>>>    // $Rev History
81149>>>>>    //    24-09-96  Module header created
81149>>>>>    //****************************************************************************
81149>>>>>    Procedure Add_Focus Integer hoRoot
81151>>>>>        Forward Send Add_Focus hoRoot
81153>>>>>
81153>>>>>        Send Delete_Data
81154>>>>>
81154>>>>>        Set Changed_State To False
81155>>>>>        Set Read_Only_State To True
81156>>>>>
81156>>>>>        Send Show_ServicePack
81157>>>>>        Send Show_Versions   
81158>>>>>        Send Show_Drivers         
81159>>>>>        If (ghoConnection <> 0) Begin
81161>>>>>            Send Show_ConnectionIdInformation
81162>>>>>        End
81162>>>>>>
81162>>>>>        Send Show_HelpFile
81163>>>>>        Send Show_Current_Directory
81164>>>>>        Send Show_Filelist_Name          
81165>>>>>        If (ghoApplication <> 0) Begin
81167>>>>>            Send Show_WorkSpaceInformation // added To show WS info
81168>>>>>        End
81168>>>>>>
81168>>>>>        Send Show_Current_User 
81169>>>>>        Send Show_Windows_Directory 
81170>>>>>        Send Show_Screen_Size
81171>>>>>        Send Show_Page_Size
81172>>>>>        Send Show_EnterAsTab        
81173>>>>>        Send Show_Number_Format
81174>>>>>        Send Show_Date_Format
81175>>>>>        Send Show_Lock_Delay
81176>>>>>        Send Show_Lock_Timeout
81177>>>>>        Send Show_Date
81178>>>>>        Send Show_Systemresources
81179>>>>>        Send Show_Registration
81180>>>>>        Send Beginning_of_Data
81181>>>>>
81181>>>>>        Set Icon to 'default.ico'
81182>>>>>    End_Procedure
81183>>>>>End_Class
81184>>>>>
81184>>>>>//****************************************************************************
81184>>>>>// $Module type: OBJECT
81184>>>>>// $Module name: Sysinfo_Dialog
81184>>>>>// $Author     : VOO
81184>>>>>// Created     : 24-09-96 @ 18:47
81184>>>>>//
81184>>>>>// Description
81184>>>>>//    This object shows the systeminformation on the screen
81184>>>>>//
81184>>>>>// $Rev History
81184>>>>>//    24-09-96  Module header created
81184>>>>>//****************************************************************************
81184>>>>>Class SysInfoDialog Is A ModalPanel
81185>>>>>    Procedure Construct_Object
81187>>>>>        Forward Send Construct_Object
81189>>>>>
81189>>>>>        Set Label to C_$SystemInformation
81190>>>>>        Set Size to 140 267
81191>>>>>        Set piMinSize to 140 267
81192>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
81193>>>>>        Set Border_Style to Border_Thick
81194>>>>>
81194>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
81196>>>>>            Set peAnchors to anAll
81197>>>>>        End_Object
81198>>>>>
81198>>>>>        Object oCloseButton Is A Button
81200>>>>>            Set Label To C_$Close
81201>>>>>            Set Location To 120 210
81202>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
81203>>>>>            Set Default_State To True
81204>>>>>            Set peAnchors to anBottomRight
81205>>>>>        End_Object
81206>>>>>
81206>>>>>        On_Key kCancel Send Close_Panel
81207>>>>>    End_Procedure
81208>>>>>End_Class
81209>>>>>
81209>>>>>// Purpose:
81209>>>>>//
81209>>>>>// Ken Ross 12/17/96 5:16PM
81209>>>>>//
81209>>>>>Class AboutDialog Is A ModalPanel
81210>>>>>    Procedure Construct_Object
81212>>>>>        String sVdfRootDir
81212>>>>>
81212>>>>>        Forward Send Construct_Object
81214>>>>>
81214>>>>>        Set Label To C_$About
81215>>>>>        Set Size to 89 212
81216>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
81217>>>>>
81217>>>>>        Object oSysInfoDialog Is A SysInfoDialog
81219>>>>>        End_Object
81220>>>>>
81220>>>>>        Object oBox Is A Container3d
81222>>>>>            Set Border_Style To Border_StaticEdge
81223>>>>>            Set Size to 63 202
81224>>>>>            Set Location To 4 5
81225>>>>>
81225>>>>>            Object oAboutGraphic Is A BitmapContainer
81227>>>>>                Set Border_Style To Border_None
81228>>>>>                Set Bitmap_Style To Bitmap_Center
81229>>>>>                Set Size To 48 48
81230>>>>>                Set Location To 7 2
81231>>>>>            End_Object
81232>>>>>
81232>>>>>            Object oProductName Is A TextBox
81234>>>>>                Set Label To C_$ProductName
81235>>>>>                Set Size To 10 45
81236>>>>>                Set Location To 8 53
81237>>>>>            End_Object
81238>>>>>
81238>>>>>            Object oVersion Is A TextBox
81240>>>>>                Set Label To C_$Version
81241>>>>>                Set Size To 10 25
81242>>>>>                Set Location To 21 53
81243>>>>>            End_Object
81244>>>>>
81244>>>>>            Object oCopyright Is A TextBox
81246>>>>>                Set Label To C_$Copyright
81247>>>>>                Set Size To 10 31
81248>>>>>                Set Location To 34 53
81249>>>>>            End_Object
81250>>>>>
81250>>>>>            Object oAuthor Is A TextBox
81252>>>>>                Set Label To C_$Author
81253>>>>>                Set Size To 10 22
81254>>>>>                Set Location To 46 53
81255>>>>>            End_Object
81256>>>>>        End_Object
81257>>>>>
81257>>>>>        Object oOKButton Is A Button
81259>>>>>            On_Item C_$OK Send Close_Panel
81260>>>>>            Set Size To 14 50
81261>>>>>            Set Location To 71 157
81262>>>>>        End_Object
81263>>>>>
81263>>>>>        Object oSysInfoButton Is A Button
81265>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
81266>>>>>            Set Size To 14 50
81267>>>>>            Set Location To 71 101
81268>>>>>        End_Object
81269>>>>>
81269>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
81270>>>>>
81270>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
81271>>>>>    End_Procedure
81272>>>>>
81272>>>>>    Procedure Set ProductName String sProductName
81274>>>>>        Set Label Of oProductName To sProductName
81275>>>>>    End_Procedure
81276>>>>>
81276>>>>>    Procedure Set Version String sVersion
81278>>>>>        Set Label Of oVersion To sVersion
81279>>>>>    End_Procedure
81280>>>>>
81280>>>>>    Procedure Set Copyright string sCopyright
81282>>>>>        Set Label Of oCopyright To sCopyright
81283>>>>>    End_Procedure
81284>>>>>
81284>>>>>    Procedure Set Author String sAuthor
81286>>>>>        Set Label Of oAuthor To sAuthor
81287>>>>>    End_Procedure
81288>>>>>
81288>>>>>    Procedure Set Logo string sLogo
81290>>>>>        // square bitmaps Of 42x42 work best
81290>>>>>        Set Bitmap Of oAboutGraphic To sLogo
81291>>>>>    End_Procedure
81292>>>>>
81292>>>>>    Procedure Show_Sysinfo
81294>>>>>        Send Popup_Modal Of oSysinfoDialog
81295>>>>>    End_Procedure
81296>>>>>
81296>>>>>    Procedure End_Construct_Object
81298>>>>>        Handle hoVersionInfo
81298>>>>>        Boolean bIncluded
81298>>>>>        Integer iMajor iMinor iRelease iBuild
81298>>>>>        String sLabel
81298>>>>>
81298>>>>>        Get Label Of oVersion To sLabel
81299>>>>>        If (sLabel = C_$VERSION) Begin
81301>>>>>            // set it To the version info Of the program, if available
81301>>>>>            If (ghoApplication <> 0) Begin
81303>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
81304>>>>>                If (hoVersionInfo <> 0) Begin
81306>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
81307>>>>>                    If (bIncluded) Begin
81309>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
81310>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
81311>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
81312>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
81313>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
81314>>>>>                        Set Version to sLabel
81315>>>>>                    End
81315>>>>>>
81315>>>>>                End
81315>>>>>>
81315>>>>>            End
81315>>>>>>
81315>>>>>        End
81315>>>>>>
81315>>>>>
81315>>>>>        Forward Send End_Construct_Object
81317>>>>>    End_Procedure
81318>>>>>End_Class
81319>>>
81319>>>// *************************************************************************
81319>>>//  Public message. This is the default message. It is expected that you will
81319>>>//   create your own message to override this
81319>>>// *************************************************************************
81319>>>
81319>>>Procedure Activate_About
81322>>>   Send DoAbout "" "" "" "" ""
81323>>>End_Procedure
81324>>>
81324>>>// *************************************************************************
81324>>>//  Public message. It is expected that you will send this message (most
81324>>>//  likely from Activate_About. This creates an about object, activates it
81324>>>//  and destroys it when done. It is not exepected that you will augment this.
81324>>>// *************************************************************************
81324>>>
81324>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
81327>>>        integer hoObj hoMain
81327>>>
81327>>>        // create object
81327>>>        Object About is an AboutDialog
81329>>>            // if no title passed use the label of the main panel
81329>>>            // (if a main panel exists).
81329>>>            if sTitle     eq '' Begin
81331>>>                Get Main_Window of desktop to hoMain
81332>>>                if hoMain Get Label of hoMain to sTitle
81335>>>            end
81335>>>>
81335>>>            set productname to sTitle
81336>>>            set version     to sVersion
81337>>>            set copyright   to sCopyRight
81338>>>            set author      to sAuthor
81339>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
81342>>>            Move self to hoObj // object Id
81343>>>        End_Object
81344>>>        Send Popup   of hoObj    // popup the about object
81345>>>        Send Destroy of hoObj // when done, it will be destroyed
81346>>>End_procedure
81347>        Use Auto.vw
Including file: Auto.vw    (C:\Repos\DataFlexBeadando\AppSrc\Auto.vw)
81347>>>// C:\Repos\DataFlexBeadando\AppSrc\Auto.vw
81347>>>// Auto
81347>>>//
81347>>>
81347>>>Use DFClient.pkg
81347>>>Use DFEntry.pkg
81347>>>
81347>>>Use cAutoDataDictionary.dd
Including file: cAutoDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cAutoDataDictionary.dd)
81347>>>>>Use DataDict.pkg
81347>>>>>
81347>>>>>Open Auto
Including file: Auto.fd    (C:\Repos\DataFlexBeadando\DDSrc\Auto.fd)
81349>>>>>Open Munkalap
Including file: Munkalap.fd    (C:\Repos\DataFlexBeadando\DDSrc\Munkalap.fd)
81351>>>>>
81351>>>>>Register_Object Auto_sl
81351>>>>>
81351>>>>>Class cAutoDataDictionary is a DataDictionary
81352>>>>>    
81352>>>>>    Procedure Construct_Object
81354>>>>>        Forward Send Construct_Object
81356>>>>>        Set Main_File to Auto.File_Number
81357>>>>>
81357>>>>>        Set Add_Client_File to Munkalap.File_Number
81358>>>>>
81358>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81359>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81360>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81361>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81362>>>>>
81362>>>>>        Set Field_Label_Long Field Auto.Id to "Azonost"
81363>>>>>        Set Field_Label_Short Field Auto.Id to "Azon."
81364>>>>>        Set Field_Prompt_Object Field Auto.Id to Auto_sl
81365>>>>>
81365>>>>>        Set Field_Label_Long Field Auto.Alvazszam to "Alvzszm"
81366>>>>>        Set Field_Label_Short Field Auto.Alvazszam to "Alv."
81367>>>>>        Set Field_Prompt_Object Field Auto.Alvazszam to Auto_sl
81368>>>>>
81368>>>>>        Set Field_Label_Long Field Auto.Motorszam to "Motorszm"
81369>>>>>        Set Field_Label_Short Field Auto.Motorszam to "Motorsz."
81370>>>>>        Set Field_Prompt_Object Field Auto.Motorszam to Auto_sl
81371>>>>>
81371>>>>>        Set Field_Label_Long Field Auto.Marka to "Mrka"
81372>>>>>        Set Field_Label_Short Field Auto.Marka to "Mrka"
81373>>>>>
81373>>>>>        Set Field_Label_Long Field Auto.Tipus to "Tipus"
81374>>>>>        Set Field_Label_Short Field Auto.Tipus to "Tipus"
81375>>>>>
81375>>>>>        Set Field_Label_Long Field Auto.Evjarat to "Evjarat"
81376>>>>>        Set Field_Label_Short Field Auto.Evjarat to "Evj,"
81377>>>>>
81377>>>>>        Set Field_Label_Long Field Auto.UtolsoSzerviz to "Utols szervz"
81378>>>>>        Set Field_Label_Short Field Auto.UtolsoSzerviz to "Utol. szv."
81379>>>>>
81379>>>>>        Set Field_Label_Long Field Auto.KmAllas to "Kilmter lls"
81380>>>>>        Set Field_Label_Short Field Auto.KmAllas to "Km ll."
81381>>>>>
81381>>>>>    End_Procedure
81382>>>>>
81382>>>>>End_Class
81383>>>>>
81383>>>>>Use Auto.sl
Including file: Auto.sl    (C:\Repos\DataFlexBeadando\AppSrc\Auto.sl)
81383>>>>>>>// Auto.sl
81383>>>>>>>// Auto Lookup List
81383>>>>>>>
81383>>>>>>>Use DFClient.pkg
81383>>>>>>>Use cDbCJGridPromptList.pkg
81383>>>>>>>Use cDbCJGridColumn.pkg
81383>>>>>>>Use Windows.pkg
81383>>>>>>>
81383>>>>>>>Use cAutoDataDictionary.dd
81383>>>>>>>
81383>>>>>>>CD_Popup_Object Auto_sl is a dbModalPanel
81401>>>>>>>>
81401>>>>>>>    Set Location to 5 5
81402>>>>>>>    Set Size to 134 610
81403>>>>>>>    Set Label To "Auto Lookup List"
81404>>>>>>>    Set Border_Style to Border_Thick
81405>>>>>>>    Set Minimize_Icon to False
81406>>>>>>>
81406>>>>>>>
81406>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
81408>>>>>>>    End_Object 
81409>>>>>>>
81409>>>>>>>    Set Main_DD To oAuto_DD
81410>>>>>>>    Set Server  To oAuto_DD
81411>>>>>>>
81411>>>>>>>
81411>>>>>>>
81411>>>>>>>    Object oSelList is a cDbCJGridPromptList
81413>>>>>>>        Set Size to 105 600
81414>>>>>>>        Set Location to 5 5
81415>>>>>>>        Set peAnchors to anAll
81416>>>>>>>        Set psLayoutSection to "Auto_sl_oSelList"
81417>>>>>>>        Set Ordering to 1
81418>>>>>>>        Set pbAutoServer to True
81419>>>>>>>
81419>>>>>>>        Object oAuto_Id is a cDbCJGridColumn
81421>>>>>>>            Entry_Item Auto.Id
81422>>>>>>>            Set piWidth to 63
81423>>>>>>>            Set psCaption to "Azon."
81424>>>>>>>        End_Object 
81425>>>>>>>
81425>>>>>>>        Object oAuto_Alvazszam is a cDbCJGridColumn
81427>>>>>>>            Entry_Item Auto.Alvazszam
81428>>>>>>>            Set piWidth to 210
81429>>>>>>>            Set psCaption to "Alv."
81430>>>>>>>        End_Object 
81431>>>>>>>
81431>>>>>>>        Object oAuto_Motorszam is a cDbCJGridColumn
81433>>>>>>>            Entry_Item Auto.Motorszam
81434>>>>>>>            Set piWidth to 210
81435>>>>>>>            Set psCaption to "Motorsz."
81436>>>>>>>        End_Object 
81437>>>>>>>
81437>>>>>>>        Object oAuto_Marka is a cDbCJGridColumn
81439>>>>>>>            Entry_Item Auto.Marka
81440>>>>>>>            Set piWidth to 210
81441>>>>>>>            Set psCaption to "Mrka"
81442>>>>>>>        End_Object 
81443>>>>>>>
81443>>>>>>>        Object oAuto_Tipus is a cDbCJGridColumn
81445>>>>>>>            Entry_Item Auto.Tipus
81446>>>>>>>            Set piWidth to 210
81447>>>>>>>            Set psCaption to "Tipus"
81448>>>>>>>        End_Object 
81449>>>>>>>
81449>>>>>>>        Object oAuto_Evjarat is a cDbCJGridColumn
81451>>>>>>>            Entry_Item Auto.Evjarat
81452>>>>>>>            Set piWidth to 49
81453>>>>>>>            Set psCaption to "Evj,"
81454>>>>>>>        End_Object 
81455>>>>>>>
81455>>>>>>>        Object oAuto_UtolsoSzerviz is a cDbCJGridColumn
81457>>>>>>>            Entry_Item Auto.UtolsoSzerviz
81458>>>>>>>            Set piWidth to 105
81459>>>>>>>            Set psCaption to "Utol. szv."
81460>>>>>>>        End_Object 
81461>>>>>>>
81461>>>>>>>        Object oAuto_KmAllas is a cDbCJGridColumn
81463>>>>>>>            Entry_Item Auto.KmAllas
81464>>>>>>>            Set piWidth to 105
81465>>>>>>>            Set psCaption to "Km ll."
81466>>>>>>>        End_Object 
81467>>>>>>>
81467>>>>>>>
81467>>>>>>>    End_Object 
81468>>>>>>>
81468>>>>>>>    Object oOk_bn is a Button
81470>>>>>>>        Set Label to "&Ok"
81471>>>>>>>        Set Location to 115 447
81472>>>>>>>        Set peAnchors to anBottomRight
81473>>>>>>>
81473>>>>>>>        Procedure OnClick
81476>>>>>>>            Send OK of oSelList
81477>>>>>>>        End_Procedure
81478>>>>>>>
81478>>>>>>>    End_Object 
81479>>>>>>>
81479>>>>>>>    Object oCancel_bn is a Button
81481>>>>>>>        Set Label to "&Cancel"
81482>>>>>>>        Set Location to 115 501
81483>>>>>>>        Set peAnchors to anBottomRight
81484>>>>>>>
81484>>>>>>>        Procedure OnClick
81487>>>>>>>            Send Cancel of oSelList
81488>>>>>>>        End_Procedure
81489>>>>>>>
81489>>>>>>>    End_Object 
81490>>>>>>>
81490>>>>>>>    Object oSearch_bn is a Button
81492>>>>>>>        Set Label to "&Search..."
81493>>>>>>>        Set Location to 115 555
81494>>>>>>>        Set peAnchors to anBottomRight
81495>>>>>>>
81495>>>>>>>        Procedure OnClick
81498>>>>>>>            Send Search of oSelList
81499>>>>>>>        End_Procedure
81500>>>>>>>
81500>>>>>>>    End_Object 
81501>>>>>>>
81501>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81502>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81503>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81504>>>>>>>
81504>>>>>>>
81504>>>>>>>CD_End_Object // Auto_sl
81506>>>>>>>>
81506>>>
81506>>>ACTIVATE_VIEW Activate_oAuto FOR oAuto
81516>>>>
81516>>>Object oAuto is a dbView
81518>>>    Set Location to 5 5
81519>>>    Set Size to 98 349
81520>>>    Set Label To "Auto"
81521>>>    Set Border_Style to Border_Thick
81522>>>
81522>>>
81522>>>    Object oAuto_DD is a cAutoDataDictionary
81524>>>    End_Object 
81525>>>
81525>>>    Set Main_DD To oAuto_DD
81526>>>    Set Server  To oAuto_DD
81527>>>
81527>>>
81527>>>
81527>>>    Object oAutoId is a dbForm
81529>>>        Entry_Item Auto.Id
81530>>>        Set Size to 13 42
81531>>>        Set Location to 5 51
81532>>>        Set peAnchors to anTopLeftRight
81533>>>        Set Label to "Azonost"
81534>>>        Set Label_Justification_mode to jMode_Left
81535>>>        Set Label_Col_Offset to 46
81536>>>        Set Label_row_Offset to 0
81537>>>    End_Object 
81538>>>
81538>>>    Object oAutoAlvazszam is a dbForm
81540>>>        Entry_Item Auto.Alvazszam
81541>>>        Set Size to 13 126
81542>>>        Set Location to 20 51
81543>>>        Set peAnchors to anTopLeftRight
81544>>>        Set Label to "Alvzszm"
81545>>>        Set Label_Justification_mode to jMode_Left
81546>>>        Set Label_Col_Offset to 46
81547>>>        Set Label_row_Offset to 0
81548>>>    End_Object 
81549>>>
81549>>>    Object oAutoMotorszam is a dbForm
81551>>>        Entry_Item Auto.Motorszam
81552>>>        Set Size to 13 126
81553>>>        Set Location to 20 218
81554>>>        Set peAnchors to anTopRight
81555>>>        Set Label to "Motorszm"
81556>>>        Set Label_Justification_mode to jMode_Left
81557>>>        Set Label_Col_Offset to 36
81558>>>        Set Label_row_Offset to 0
81559>>>    End_Object 
81560>>>
81560>>>    Object oAutoMarka is a dbForm
81562>>>        Entry_Item Auto.Marka
81563>>>        Set Size to 13 126
81564>>>        Set Location to 35 51
81565>>>        Set peAnchors to anTopLeftRight
81566>>>        Set Label to "Mrka"
81567>>>        Set Label_Justification_mode to jMode_Left
81568>>>        Set Label_Col_Offset to 46
81569>>>        Set Label_row_Offset to 0
81570>>>    End_Object 
81571>>>
81571>>>    Object oAutoTipus is a dbForm
81573>>>        Entry_Item Auto.Tipus
81574>>>        Set Size to 13 126
81575>>>        Set Location to 35 201
81576>>>        Set peAnchors to anTopRight
81577>>>        Set Label to "Tipus"
81578>>>        Set Label_Justification_mode to jMode_Left
81579>>>        Set Label_Col_Offset to 19
81580>>>        Set Label_row_Offset to 0
81581>>>    End_Object 
81582>>>
81582>>>    Object oAutoEvjarat is a dbForm
81584>>>        Entry_Item Auto.Evjarat
81585>>>        Set Size to 13 34
81586>>>        Set Location to 50 51
81587>>>        Set peAnchors to anTopLeftRight
81588>>>        Set Label to "Evjarat"
81589>>>        Set Label_Justification_mode to jMode_Left
81590>>>        Set Label_Col_Offset to 46
81591>>>        Set Label_row_Offset to 0
81592>>>    End_Object 
81593>>>
81593>>>    Object oAutoUtolsoSzerviz is a dbForm
81595>>>        Entry_Item Auto.UtolsoSzerviz
81596>>>        Set Size to 13 66
81597>>>        Set Location to 65 51
81598>>>        Set peAnchors to anTopLeftRight
81599>>>        Set Label to "Utols szervz"
81600>>>        Set Label_Justification_mode to jMode_Left
81601>>>        Set Label_Col_Offset to 46
81602>>>        Set Label_row_Offset to 0
81603>>>    End_Object 
81604>>>
81604>>>    Object oAutoKmAllas is a dbForm
81606>>>        Entry_Item Auto.KmAllas
81607>>>        Set Size to 13 66
81608>>>        Set Location to 80 51
81609>>>        Set peAnchors to anTopLeftRight
81610>>>        Set Label to "Kilmter lls"
81611>>>        Set Label_Justification_mode to jMode_Left
81612>>>        Set Label_Col_Offset to 46
81613>>>        Set Label_row_Offset to 0
81614>>>    End_Object 
81615>>>
81615>>>
81615>>>End_Object 
81616>        Use Munka.vw
Including file: Munka.vw    (C:\Repos\DataFlexBeadando\AppSrc\Munka.vw)
81616>>>// C:\Repos\DataFlexBeadando\AppSrc\Munka.vw
81616>>>// Munka
81616>>>//
81616>>>
81616>>>Use DFClient.pkg
81616>>>Use DFEntry.pkg
81616>>>
81616>>>Use cMunkaDataDictionary.dd
Including file: cMunkaDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkaDataDictionary.dd)
81616>>>>>Use DataDict.pkg
81616>>>>>
81616>>>>>Open Munka
Including file: Munka.fd    (C:\Repos\DataFlexBeadando\DDSrc\Munka.fd)
81618>>>>>Open MunkaMunkalap
Including file: MunkaMunkalap.fd    (C:\Repos\DataFlexBeadando\DDSrc\MunkaMunkalap.fd)
81620>>>>>
81620>>>>>Register_Object Munka_sl
81620>>>>>
81620>>>>>Class cMunkaDataDictionary is a DataDictionary
81621>>>>>    
81621>>>>>    Procedure Construct_Object
81623>>>>>        Forward Send Construct_Object
81625>>>>>        Set Main_File to Munka.File_Number
81626>>>>>
81626>>>>>        Set Add_Client_File to MunkaMunkalap.File_Number
81627>>>>>
81627>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81628>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81629>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81630>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81631>>>>>
81631>>>>>        Set Field_Label_Long Field Munka.Id to "Munka azonost"
81632>>>>>        Set Field_Label_Short Field Munka.Id to "Munka azon."
81633>>>>>        Set Field_Prompt_Object Field Munka.Id to Munka_sl
81634>>>>>
81634>>>>>        Set Field_Label_Long Field Munka.Name to "Nv"
81635>>>>>        Set Field_Label_Short Field Munka.Name to "Nv"
81636>>>>>        Set Field_Prompt_Object Field Munka.Name to Munka_sl
81637>>>>>
81637>>>>>        Set Field_Label_Long Field Munka.Leiras to "Lers"
81638>>>>>        Set Field_Label_Short Field Munka.Leiras to "Lers"
81639>>>>>
81639>>>>>        Set Field_Label_Long Field Munka.Egysegar to "Egysgr"
81640>>>>>        Set Field_Label_Short Field Munka.Egysegar to "Egysgr"
81641>>>>>
81641>>>>>    End_Procedure
81642>>>>>
81642>>>>>End_Class
81643>>>>>
81643>>>>>Use Munka.sl
Including file: Munka.sl    (C:\Repos\DataFlexBeadando\AppSrc\Munka.sl)
81643>>>>>>>// Munka.sl
81643>>>>>>>// Munka Lookup List
81643>>>>>>>
81643>>>>>>>Use DFClient.pkg
81643>>>>>>>Use cDbCJGridPromptList.pkg
81643>>>>>>>Use cDbCJGridColumn.pkg
81643>>>>>>>Use Windows.pkg
81643>>>>>>>
81643>>>>>>>Use cMunkaDataDictionary.dd
81643>>>>>>>
81643>>>>>>>CD_Popup_Object Munka_sl is a dbModalPanel
81661>>>>>>>>
81661>>>>>>>    Set Location to 5 5
81662>>>>>>>    Set Size to 134 309
81663>>>>>>>    Set Label To "Munka Lookup List"
81664>>>>>>>    Set Border_Style to Border_Thick
81665>>>>>>>    Set Minimize_Icon to False
81666>>>>>>>
81666>>>>>>>
81666>>>>>>>    Object oMunka_DD is a cMunkaDataDictionary
81668>>>>>>>    End_Object 
81669>>>>>>>
81669>>>>>>>    Set Main_DD To oMunka_DD
81670>>>>>>>    Set Server  To oMunka_DD
81671>>>>>>>
81671>>>>>>>
81671>>>>>>>
81671>>>>>>>    Object oSelList is a cDbCJGridPromptList
81673>>>>>>>        Set Size to 105 299
81674>>>>>>>        Set Location to 5 5
81675>>>>>>>        Set peAnchors to anAll
81676>>>>>>>        Set psLayoutSection to "Munka_sl_oSelList"
81677>>>>>>>        Set Ordering to 1
81678>>>>>>>        Set pbAutoServer to True
81679>>>>>>>
81679>>>>>>>        Object oMunka_Id is a cDbCJGridColumn
81681>>>>>>>            Entry_Item Munka.Id
81682>>>>>>>            Set piWidth to 85
81683>>>>>>>            Set psCaption to "Munka azon."
81684>>>>>>>        End_Object 
81685>>>>>>>
81685>>>>>>>        Object oMunka_Name is a cDbCJGridColumn
81687>>>>>>>            Entry_Item Munka.Name
81688>>>>>>>            Set piWidth to 210
81689>>>>>>>            Set psCaption to "Nv"
81690>>>>>>>        End_Object 
81691>>>>>>>
81691>>>>>>>        Object oMunka_Leiras is a cDbCJGridColumn
81693>>>>>>>            Entry_Item Munka.Leiras
81694>>>>>>>            Set piWidth to 105
81695>>>>>>>            Set psCaption to "Lers"
81696>>>>>>>        End_Object 
81697>>>>>>>
81697>>>>>>>        Object oMunka_Egysegar is a cDbCJGridColumn
81699>>>>>>>            Entry_Item Munka.Egysegar
81700>>>>>>>            Set piWidth to 105
81701>>>>>>>            Set psCaption to "Egysgr"
81702>>>>>>>        End_Object 
81703>>>>>>>
81703>>>>>>>
81703>>>>>>>    End_Object 
81704>>>>>>>
81704>>>>>>>    Object oOk_bn is a Button
81706>>>>>>>        Set Label to "&Ok"
81707>>>>>>>        Set Location to 115 146
81708>>>>>>>        Set peAnchors to anBottomRight
81709>>>>>>>
81709>>>>>>>        Procedure OnClick
81712>>>>>>>            Send OK of oSelList
81713>>>>>>>        End_Procedure
81714>>>>>>>
81714>>>>>>>    End_Object 
81715>>>>>>>
81715>>>>>>>    Object oCancel_bn is a Button
81717>>>>>>>        Set Label to "&Cancel"
81718>>>>>>>        Set Location to 115 200
81719>>>>>>>        Set peAnchors to anBottomRight
81720>>>>>>>
81720>>>>>>>        Procedure OnClick
81723>>>>>>>            Send Cancel of oSelList
81724>>>>>>>        End_Procedure
81725>>>>>>>
81725>>>>>>>    End_Object 
81726>>>>>>>
81726>>>>>>>    Object oSearch_bn is a Button
81728>>>>>>>        Set Label to "&Search..."
81729>>>>>>>        Set Location to 115 254
81730>>>>>>>        Set peAnchors to anBottomRight
81731>>>>>>>
81731>>>>>>>        Procedure OnClick
81734>>>>>>>            Send Search of oSelList
81735>>>>>>>        End_Procedure
81736>>>>>>>
81736>>>>>>>    End_Object 
81737>>>>>>>
81737>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81738>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81739>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81740>>>>>>>
81740>>>>>>>
81740>>>>>>>CD_End_Object // Munka_sl
81742>>>>>>>>
81742>>>
81742>>>ACTIVATE_VIEW Activate_oMunka FOR oMunka
81752>>>>
81752>>>Object oMunka is a dbView
81754>>>    Set Location to 5 5
81755>>>    Set Size to 38 251
81756>>>    Set Label To "Munka"
81757>>>    Set Border_Style to Border_Thick
81758>>>
81758>>>
81758>>>    Object oMunka_DD is a cMunkaDataDictionary
81760>>>    End_Object 
81761>>>
81761>>>    Set Main_DD To oMunka_DD
81762>>>    Set Server  To oMunka_DD
81763>>>
81763>>>
81763>>>
81763>>>    Object oMunkaId is a dbForm
81765>>>        Entry_Item Munka.Id
81766>>>        Set Size to 13 42
81767>>>        Set Location to 5 59
81768>>>        Set peAnchors to anTopLeftRight
81769>>>        Set Label to "Munka azonost"
81770>>>        Set Label_Justification_mode to jMode_Left
81771>>>        Set Label_Col_Offset to 54
81772>>>        Set Label_row_Offset to 0
81773>>>    End_Object 
81774>>>
81774>>>    Object oMunkaName is a dbForm
81776>>>        Entry_Item Munka.Name
81777>>>        Set Size to 13 126
81778>>>        Set Location to 5 120
81779>>>        Set peAnchors to anTopRight
81780>>>        Set Label to "Nv"
81781>>>        Set Label_Justification_mode to jMode_Left
81782>>>        Set Label_Col_Offset to 14
81783>>>        Set Label_row_Offset to 0
81784>>>    End_Object 
81785>>>
81785>>>    Object oMunkaLeiras is a dbForm
81787>>>        Entry_Item Munka.Leiras
81788>>>        Set Size to 13 66
81789>>>        Set Location to 20 59
81790>>>        Set peAnchors to anTopLeftRight
81791>>>        Set Label to "Lers"
81792>>>        Set Label_Justification_mode to jMode_Left
81793>>>        Set Label_Col_Offset to 54
81794>>>        Set Label_row_Offset to 0
81795>>>    End_Object 
81796>>>
81796>>>    Object oMunkaEgysegar is a dbForm
81798>>>        Entry_Item Munka.Egysegar
81799>>>        Set Size to 13 66
81800>>>        Set Location to 20 159
81801>>>        Set peAnchors to anTopRight
81802>>>        Set Label to "Egysgr"
81803>>>        Set Label_Justification_mode to jMode_Left
81804>>>        Set Label_Col_Offset to 29
81805>>>        Set Label_row_Offset to 0
81806>>>    End_Object 
81807>>>
81807>>>
81807>>>End_Object 
81808>        Use Ugyfel.vw
Including file: Ugyfel.vw    (C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.vw)
81808>>>// C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.vw
81808>>>// Ugyfel
81808>>>//
81808>>>
81808>>>Use DFClient.pkg
81808>>>Use DFEntry.pkg
81808>>>
81808>>>Use cUgyfelDataDictionary.dd
Including file: cUgyfelDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cUgyfelDataDictionary.dd)
81808>>>>>Use DataDict.pkg
81808>>>>>
81808>>>>>Open Ugyfel
Including file: Ugyfel.fd    (C:\Repos\DataFlexBeadando\DDSrc\Ugyfel.fd)
81810>>>>>Open Munkalap
81812>>>>>
81812>>>>>Register_Object Ugyfel_sl
81812>>>>>
81812>>>>>Class cUgyfelDataDictionary is a DataDictionary
81813>>>>>    
81813>>>>>    Procedure Construct_Object
81815>>>>>        Forward Send Construct_Object
81817>>>>>        Set Main_File to Ugyfel.File_Number
81818>>>>>
81818>>>>>        Set Add_Client_File to Munkalap.File_Number
81819>>>>>
81819>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81820>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81821>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81822>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81823>>>>>
81823>>>>>        Set Field_Label_Long Field Ugyfel.Id to "gyfl azonost"
81824>>>>>        Set Field_Label_Short Field Ugyfel.Id to "gyf. azon."
81825>>>>>        Set Field_Prompt_Object Field Ugyfel.Id to Ugyfel_sl
81826>>>>>
81826>>>>>        Set Field_Label_Long Field Ugyfel.Nev to "Nv"
81827>>>>>        Set Field_Label_Short Field Ugyfel.Nev to "Nv"
81828>>>>>        Set Field_Prompt_Object Field Ugyfel.Nev to Ugyfel_sl
81829>>>>>
81829>>>>>        Set Field_Mask Field Ugyfel.Adoszam to "########-#-##"
81830>>>>>        Set Field_Label_Long Field Ugyfel.Adoszam to "Adszm"
81831>>>>>        Set Field_Label_Short Field Ugyfel.Adoszam to "A.sz."
81832>>>>>
81832>>>>>        Set Field_Label_Long Field Ugyfel.Cim to "Cm"
81833>>>>>        Set Field_Label_Short Field Ugyfel.Cim to "Cm"
81834>>>>>
81834>>>>>        Set Field_Label_Long Field Ugyfel.Telefon to "Telefon"
81835>>>>>        Set Field_Label_Short Field Ugyfel.Telefon to "tel."
81836>>>>>        Set Field_Mask Field Ugyfel.Telefon to "+##-##-###-####"
81837>>>>>
81837>>>>>        Set Field_Label_Long Field Ugyfel.Bankszamla to "Bankszmla"
81838>>>>>        Set Field_Label_Short Field Ugyfel.Bankszamla to "Bszla."
81839>>>>>        Set Field_Mask Field Ugyfel.Bankszamla to "#######-########-########"
81840>>>>>
81840>>>>>    End_Procedure
81841>>>>>
81841>>>>>End_Class
81842>>>>>
81842>>>>>Use Ugyfel.sl
Including file: Ugyfel.sl    (C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.sl)
81842>>>>>>>// Ugyfel.sl
81842>>>>>>>// Ugyfel Lookup List
81842>>>>>>>
81842>>>>>>>Use DFClient.pkg
81842>>>>>>>Use cDbCJGridPromptList.pkg
81842>>>>>>>Use cDbCJGridColumn.pkg
81842>>>>>>>Use Windows.pkg
81842>>>>>>>
81842>>>>>>>Use cUgyfelDataDictionary.dd
81842>>>>>>>
81842>>>>>>>CD_Popup_Object Ugyfel_sl is a dbModalPanel
81860>>>>>>>>
81860>>>>>>>    Set Location to 5 5
81861>>>>>>>    Set Size to 134 610
81862>>>>>>>    Set Label To "Ugyfel Lookup List"
81863>>>>>>>    Set Border_Style to Border_Thick
81864>>>>>>>    Set Minimize_Icon to False
81865>>>>>>>
81865>>>>>>>
81865>>>>>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
81867>>>>>>>    End_Object 
81868>>>>>>>
81868>>>>>>>    Set Main_DD To oUgyfel_DD
81869>>>>>>>    Set Server  To oUgyfel_DD
81870>>>>>>>
81870>>>>>>>
81870>>>>>>>
81870>>>>>>>    Object oSelList is a cDbCJGridPromptList
81872>>>>>>>        Set Size to 105 600
81873>>>>>>>        Set Location to 5 5
81874>>>>>>>        Set peAnchors to anAll
81875>>>>>>>        Set psLayoutSection to "Ugyfel_sl_oSelList"
81876>>>>>>>        Set Ordering to 1
81877>>>>>>>        Set pbAutoServer to True
81878>>>>>>>
81878>>>>>>>        Object oUgyfel_Id is a cDbCJGridColumn
81880>>>>>>>            Entry_Item Ugyfel.Id
81881>>>>>>>            Set piWidth to 77
81882>>>>>>>            Set psCaption to "gyf. azon."
81883>>>>>>>        End_Object 
81884>>>>>>>
81884>>>>>>>        Object oUgyfel_Nev is a cDbCJGridColumn
81886>>>>>>>            Entry_Item Ugyfel.Nev
81887>>>>>>>            Set piWidth to 262
81888>>>>>>>            Set psCaption to "Nv"
81889>>>>>>>        End_Object 
81890>>>>>>>
81890>>>>>>>        Object oUgyfel_Adoszam is a cDbCJGridColumn
81892>>>>>>>            Entry_Item Ugyfel.Adoszam
81893>>>>>>>            Set piWidth to 136
81894>>>>>>>            Set psCaption to "A.sz."
81895>>>>>>>        End_Object 
81896>>>>>>>
81896>>>>>>>        Object oUgyfel_Cim is a cDbCJGridColumn
81898>>>>>>>            Entry_Item Ugyfel.Cim
81899>>>>>>>            Set piWidth to 262
81900>>>>>>>            Set psCaption to "Cm"
81901>>>>>>>        End_Object 
81902>>>>>>>
81902>>>>>>>        Object oUgyfel_Telefon is a cDbCJGridColumn
81904>>>>>>>            Entry_Item Ugyfel.Telefon
81905>>>>>>>            Set piWidth to 126
81906>>>>>>>            Set psCaption to "tel."
81907>>>>>>>        End_Object 
81908>>>>>>>
81908>>>>>>>        Object oUgyfel_Bankszamla is a cDbCJGridColumn
81910>>>>>>>            Entry_Item Ugyfel.Bankszamla
81911>>>>>>>            Set piWidth to 262
81912>>>>>>>            Set psCaption to "Bszla."
81913>>>>>>>        End_Object 
81914>>>>>>>
81914>>>>>>>
81914>>>>>>>    End_Object 
81915>>>>>>>
81915>>>>>>>    Object oOk_bn is a Button
81917>>>>>>>        Set Label to "&Ok"
81918>>>>>>>        Set Location to 115 447
81919>>>>>>>        Set peAnchors to anBottomRight
81920>>>>>>>
81920>>>>>>>        Procedure OnClick
81923>>>>>>>            Send OK of oSelList
81924>>>>>>>        End_Procedure
81925>>>>>>>
81925>>>>>>>    End_Object 
81926>>>>>>>
81926>>>>>>>    Object oCancel_bn is a Button
81928>>>>>>>        Set Label to "&Cancel"
81929>>>>>>>        Set Location to 115 501
81930>>>>>>>        Set peAnchors to anBottomRight
81931>>>>>>>
81931>>>>>>>        Procedure OnClick
81934>>>>>>>            Send Cancel of oSelList
81935>>>>>>>        End_Procedure
81936>>>>>>>
81936>>>>>>>    End_Object 
81937>>>>>>>
81937>>>>>>>    Object oSearch_bn is a Button
81939>>>>>>>        Set Label to "&Search..."
81940>>>>>>>        Set Location to 115 555
81941>>>>>>>        Set peAnchors to anBottomRight
81942>>>>>>>
81942>>>>>>>        Procedure OnClick
81945>>>>>>>            Send Search of oSelList
81946>>>>>>>        End_Procedure
81947>>>>>>>
81947>>>>>>>    End_Object 
81948>>>>>>>
81948>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81949>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81950>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81951>>>>>>>
81951>>>>>>>
81951>>>>>>>CD_End_Object // Ugyfel_sl
81953>>>>>>>>
81953>>>
81953>>>ACTIVATE_VIEW Activate_oUgyfel FOR oUgyfel
81963>>>>
81963>>>Object oUgyfel is a dbView
81965>>>    Set Location to 5 5
81966>>>    Set Size to 83 350
81967>>>    Set Label To "Ugyfel"
81968>>>    Set Border_Style to Border_Thick
81969>>>
81969>>>
81969>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
81971>>>    End_Object 
81972>>>
81972>>>    Set Main_DD To oUgyfel_DD
81973>>>    Set Server  To oUgyfel_DD
81974>>>
81974>>>
81974>>>
81974>>>    Object oUgyfelId is a dbForm
81976>>>        Entry_Item Ugyfel.Id
81977>>>        Set Size to 13 42
81978>>>        Set Location to 5 57
81979>>>        Set peAnchors to anTopLeftRight
81980>>>        Set Label to "gyfl azonost"
81981>>>        Set Label_Justification_mode to jMode_Left
81982>>>        Set Label_Col_Offset to 52
81983>>>        Set Label_row_Offset to 0
81984>>>    End_Object 
81985>>>
81985>>>    Object oUgyfelNev is a dbForm
81987>>>        Entry_Item Ugyfel.Nev
81988>>>        Set Size to 13 250
81989>>>        Set Location to 20 57
81990>>>        Set peAnchors to anTopLeftRight
81991>>>        Set Label to "Nv"
81992>>>        Set Label_Justification_mode to jMode_Left
81993>>>        Set Label_Col_Offset to 52
81994>>>        Set Label_row_Offset to 0
81995>>>    End_Object 
81996>>>
81996>>>    Object oUgyfelAdoszam is a dbForm
81998>>>        Entry_Item Ugyfel.Adoszam
81999>>>        Set Size to 13 84
82000>>>        Set Location to 35 57
82001>>>        Set peAnchors to anTopLeftRight
82002>>>        Set Label to "Adszm"
82003>>>        Set Label_Justification_mode to jMode_Left
82004>>>        Set Label_Col_Offset to 52
82005>>>        Set Label_row_Offset to 0
82006>>>    End_Object 
82007>>>
82007>>>    Object oUgyfelCim is a dbForm
82009>>>        Entry_Item Ugyfel.Cim
82010>>>        Set Size to 13 250
82011>>>        Set Location to 50 57
82012>>>        Set peAnchors to anTopLeftRight
82013>>>        Set Label to "Cm"
82014>>>        Set Label_Justification_mode to jMode_Left
82015>>>        Set Label_Col_Offset to 52
82016>>>        Set Label_row_Offset to 0
82017>>>    End_Object 
82018>>>
82018>>>    Object oUgyfelTelefon is a dbForm
82020>>>        Entry_Item Ugyfel.Telefon
82021>>>        Set Size to 13 78
82022>>>        Set Location to 65 57
82023>>>        Set peAnchors to anTopLeftRight
82024>>>        Set Label to "Telefon"
82025>>>        Set Label_Justification_mode to jMode_Left
82026>>>        Set Label_Col_Offset to 52
82027>>>        Set Label_row_Offset to 0
82028>>>    End_Object 
82029>>>
82029>>>    Object oUgyfelBankszamla is a dbForm
82031>>>        Entry_Item Ugyfel.Bankszamla
82032>>>        Set Size to 13 168
82033>>>        Set Location to 65 177
82034>>>        Set peAnchors to anTopRight
82035>>>        Set Label to "Bankszmla"
82036>>>        Set Label_Justification_mode to jMode_Left
82037>>>        Set Label_Col_Offset to 37
82038>>>        Set Label_row_Offset to 0
82039>>>    End_Object 
82040>>>
82040>>>
82040>>>End_Object 
82041>        Use Munkalap.vw
Including file: Munkalap.vw    (C:\Repos\DataFlexBeadando\AppSrc\Munkalap.vw)
82041>>>// C:\Repos\DataFlexBeadando\AppSrc\Munkalap.vw
82041>>>// Munkalap
82041>>>//
82041>>>
82041>>>Use DFClient.pkg
82041>>>Use DFEntry.pkg
82041>>>Use cDbCJGrid.pkg
82041>>>Use cDbCJGridColumn.pkg
82041>>>
82041>>>Use cUgyfelDataDictionary.dd
82041>>>Use cAutoDataDictionary.dd
82041>>>Use cMunkalapDataDictionary.dd
Including file: cMunkalapDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkalapDataDictionary.dd)
82041>>>>>Use DataDict.pkg
82041>>>>>
82041>>>>>Open Munkalap
82043>>>>>Open Auto
82045>>>>>Open Ugyfel
82047>>>>>Open MunkaMunkalap
82049>>>>>
82049>>>>>Register_Object Munkalap_sl
82049>>>>>
82049>>>>>Class cMunkalapDataDictionary is a DataDictionary
82050>>>>>    
82050>>>>>    Procedure Construct_Object
82052>>>>>        Forward Send Construct_Object
82054>>>>>        Set Main_File to Munkalap.File_Number
82055>>>>>
82055>>>>>        Set Add_Client_File to MunkaMunkalap.File_Number
82056>>>>>
82056>>>>>        Set Add_Server_File to Auto.File_Number
82057>>>>>        Set Add_Server_File to Ugyfel.File_Number
82058>>>>>
82058>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
82059>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
82060>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
82061>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
82062>>>>>
82062>>>>>        Set Field_Label_Long Field Munkalap.Id to "Munkalap azonost"
82063>>>>>        Set Field_Label_Short Field Munkalap.Id to "Munkalap azon."
82064>>>>>        Set Field_Prompt_Object Field Munkalap.Id to Munkalap_sl
82065>>>>>
82065>>>>>        Set Field_Label_Long Field Munkalap.Rogzites to "Rgzts"
82066>>>>>        Set Field_Label_Short Field Munkalap.Rogzites to "Rgz."
82067>>>>>
82067>>>>>        Set Field_Prompt_Object Field Munkalap.UgyfelId to Munkalap_sl
82068>>>>>
82068>>>>>        Set Field_Prompt_Object Field Munkalap.AutoId to Munkalap_sl
82069>>>>>
82069>>>>>        Set Field_Label_Long Field Munkalap.Behozatal to "Behozatal"
82070>>>>>        Set Field_Label_Short Field Munkalap.Behozatal to "Behoz."
82071>>>>>
82071>>>>>        Set Field_Label_Long Field Munkalap.Elvitel to "Elvitel"
82072>>>>>        Set Field_Label_Short Field Munkalap.Elvitel to "Elvitel"
82073>>>>>
82073>>>>>        Set Field_Label_Long Field Munkalap.Akm to "Kilmter eltte"
82074>>>>>        Set Field_Label_Short Field Munkalap.Akm to "Km eltte"
82075>>>>>
82075>>>>>        Set Field_Label_Long Field Munkalap.Bkm to "Kilmterlls utns"
82076>>>>>        Set Field_Label_Short Field Munkalap.Bkm to "Km utna"
82077>>>>>
82077>>>>>    End_Procedure
82078>>>>>
82078>>>>>End_Class
82079>>>>>
82079>>>>>Use Munkalap.sl
Including file: Munkalap.sl    (C:\Repos\DataFlexBeadando\AppSrc\Munkalap.sl)
82079>>>>>>>// Munkalap.sl
82079>>>>>>>// Munkalap Lookup List
82079>>>>>>>
82079>>>>>>>Use DFClient.pkg
82079>>>>>>>Use cDbCJGridPromptList.pkg
82079>>>>>>>Use cDbCJGridColumn.pkg
82079>>>>>>>Use Windows.pkg
82079>>>>>>>
82079>>>>>>>Use cUgyfelDataDictionary.dd
82079>>>>>>>Use cAutoDataDictionary.dd
82079>>>>>>>Use cMunkalapDataDictionary.dd
82079>>>>>>>
82079>>>>>>>CD_Popup_Object Munkalap_sl is a dbModalPanel
82097>>>>>>>>
82097>>>>>>>    Set Location to 5 5
82098>>>>>>>    Set Size to 134 450
82099>>>>>>>    Set Label To "Munkalap Lookup List"
82100>>>>>>>    Set Border_Style to Border_Thick
82101>>>>>>>    Set Minimize_Icon to False
82102>>>>>>>
82102>>>>>>>
82102>>>>>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82104>>>>>>>    End_Object 
82105>>>>>>>
82105>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
82107>>>>>>>    End_Object 
82108>>>>>>>
82108>>>>>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
82110>>>>>>>        Set DDO_Server To oAuto_DD
82111>>>>>>>        Set DDO_Server To oUgyfel_DD
82112>>>>>>>    End_Object 
82113>>>>>>>
82113>>>>>>>    Set Main_DD To oMunkalap_DD
82114>>>>>>>    Set Server  To oMunkalap_DD
82115>>>>>>>
82115>>>>>>>
82115>>>>>>>
82115>>>>>>>    Object oSelList is a cDbCJGridPromptList
82117>>>>>>>        Set Size to 105 440
82118>>>>>>>        Set Location to 5 5
82119>>>>>>>        Set peAnchors to anAll
82120>>>>>>>        Set psLayoutSection to "Munkalap_sl_oSelList"
82121>>>>>>>        Set Ordering to 1
82122>>>>>>>        Set pbAutoServer to True
82123>>>>>>>
82123>>>>>>>        Object oMunkalap_Id is a cDbCJGridColumn
82125>>>>>>>            Entry_Item Munkalap.Id
82126>>>>>>>            Set piWidth to 101
82127>>>>>>>            Set psCaption to "Munkalap azon."
82128>>>>>>>        End_Object 
82129>>>>>>>
82129>>>>>>>        Object oMunkalap_Rogzites is a cDbCJGridColumn
82131>>>>>>>            Entry_Item Munkalap.Rogzites
82132>>>>>>>            Set piWidth to 105
82133>>>>>>>            Set psCaption to "Rgz."
82134>>>>>>>        End_Object 
82135>>>>>>>
82135>>>>>>>        Object oUgyfel_Id is a cDbCJGridColumn
82137>>>>>>>            Entry_Item Ugyfel.Id
82138>>>>>>>            Set piWidth to 63
82139>>>>>>>            Set psCaption to "UgyfelId"
82140>>>>>>>        End_Object 
82141>>>>>>>
82141>>>>>>>        Object oAuto_Id is a cDbCJGridColumn
82143>>>>>>>            Entry_Item Auto.Id
82144>>>>>>>            Set piWidth to 63
82145>>>>>>>            Set psCaption to "AutoId"
82146>>>>>>>        End_Object 
82147>>>>>>>
82147>>>>>>>        Object oMunkalap_Behozatal is a cDbCJGridColumn
82149>>>>>>>            Entry_Item Munkalap.Behozatal
82150>>>>>>>            Set piWidth to 105
82151>>>>>>>            Set psCaption to "Behoz."
82152>>>>>>>        End_Object 
82153>>>>>>>
82153>>>>>>>        Object oMunkalap_Elvitel is a cDbCJGridColumn
82155>>>>>>>            Entry_Item Munkalap.Elvitel
82156>>>>>>>            Set piWidth to 105
82157>>>>>>>            Set psCaption to "Elvitel"
82158>>>>>>>        End_Object 
82159>>>>>>>
82159>>>>>>>        Object oMunkalap_Akm is a cDbCJGridColumn
82161>>>>>>>            Entry_Item Munkalap.Akm
82162>>>>>>>            Set piWidth to 105
82163>>>>>>>            Set psCaption to "Km eltte"
82164>>>>>>>        End_Object 
82165>>>>>>>
82165>>>>>>>        Object oMunkalap_Bkm is a cDbCJGridColumn
82167>>>>>>>            Entry_Item Munkalap.Bkm
82168>>>>>>>            Set piWidth to 105
82169>>>>>>>            Set psCaption to "Km utna"
82170>>>>>>>        End_Object 
82171>>>>>>>
82171>>>>>>>
82171>>>>>>>    End_Object 
82172>>>>>>>
82172>>>>>>>    Object oOk_bn is a Button
82174>>>>>>>        Set Label to "&Ok"
82175>>>>>>>        Set Location to 115 287
82176>>>>>>>        Set peAnchors to anBottomRight
82177>>>>>>>
82177>>>>>>>        Procedure OnClick
82180>>>>>>>            Send OK of oSelList
82181>>>>>>>        End_Procedure
82182>>>>>>>
82182>>>>>>>    End_Object 
82183>>>>>>>
82183>>>>>>>    Object oCancel_bn is a Button
82185>>>>>>>        Set Label to "&Cancel"
82186>>>>>>>        Set Location to 115 341
82187>>>>>>>        Set peAnchors to anBottomRight
82188>>>>>>>
82188>>>>>>>        Procedure OnClick
82191>>>>>>>            Send Cancel of oSelList
82192>>>>>>>        End_Procedure
82193>>>>>>>
82193>>>>>>>    End_Object 
82194>>>>>>>
82194>>>>>>>    Object oSearch_bn is a Button
82196>>>>>>>        Set Label to "&Search..."
82197>>>>>>>        Set Location to 115 395
82198>>>>>>>        Set peAnchors to anBottomRight
82199>>>>>>>
82199>>>>>>>        Procedure OnClick
82202>>>>>>>            Send Search of oSelList
82203>>>>>>>        End_Procedure
82204>>>>>>>
82204>>>>>>>    End_Object 
82205>>>>>>>
82205>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
82206>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
82207>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
82208>>>>>>>
82208>>>>>>>
82208>>>>>>>CD_End_Object // Munkalap_sl
82210>>>>>>>>
82210>>>Use cMunkaDataDictionary.dd
82210>>>Use cMunkaMunkalapDataDictionary.dd
Including file: cMunkaMunkalapDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkaMunkalapDataDictionary.dd)
82210>>>>>Use DataDict.pkg
82210>>>>>
82210>>>>>Open MunkaMunkalap
82212>>>>>Open Munkalap
82214>>>>>Open Munka
82216>>>>>
82216>>>>>Class cMunkaMunkalapDataDictionary is a DataDictionary
82217>>>>>    
82217>>>>>    Procedure Construct_Object
82219>>>>>        Forward Send Construct_Object
82221>>>>>        Set Main_File to MunkaMunkalap.File_Number
82222>>>>>
82222>>>>>        Set Add_Server_File to Munkalap.File_Number
82223>>>>>        Set Add_Server_File to Munka.File_Number
82224>>>>>
82224>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
82225>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
82226>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
82227>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
82228>>>>>
82228>>>>>    End_Procedure
82229>>>>>
82229>>>>>End_Class
82230>>>
82230>>>ACTIVATE_VIEW Activate_oMunkalap FOR oMunkalap
82240>>>>
82240>>>Object oMunkalap is a dbView
82242>>>    Set Location to 5 5
82243>>>    Set Size to 249 369
82244>>>    Set Label To "Munkalap"
82245>>>    Set Border_Style to Border_Thick
82246>>>
82246>>>
82246>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82248>>>    End_Object 
82249>>>
82249>>>    Object oAuto_DD is a cAutoDataDictionary
82251>>>    End_Object 
82252>>>
82252>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
82254>>>        Set DDO_Server To oAuto_DD
82255>>>        Set DDO_Server To oUgyfel_DD
82256>>>        // this lets you save a new parent DD from within child DD
82256>>>        Set Allow_Foreign_New_Save_State to True
82257>>>    End_Object 
82258>>>
82258>>>    Object oMunka_DD is a cMunkaDataDictionary
82260>>>    End_Object 
82261>>>
82261>>>    Object oMunkaMunkalap_DD is a cMunkaMunkalapDataDictionary
82263>>>        Set DDO_Server To oMunkalap_DD
82264>>>        Set DDO_Server To oMunka_DD
82265>>>        Set Constrain_File To Munkalap.File_Number
82266>>>    End_Object 
82267>>>
82267>>>    Set Main_DD To oMunkalap_DD
82268>>>    Set Server  To oMunkalap_DD
82269>>>
82269>>>
82269>>>
82269>>>    Object oMunkalapId is a dbForm
82271>>>        Entry_Item Munkalap.Id
82272>>>        Set Size to 13 42
82273>>>        Set Location to 5 68
82274>>>        Set peAnchors to anTopLeftRight
82275>>>        Set Label to "Munkalap azonost"
82276>>>        Set Label_Justification_mode to jMode_Left
82277>>>        Set Label_Col_Offset to 63
82278>>>        Set Label_row_Offset to 0
82279>>>    End_Object 
82280>>>
82280>>>    Object oUgyfelId is a dbForm
82282>>>        Entry_Item Ugyfel.Id
82283>>>        Set Size to 13 42
82284>>>        Set Location to 20 68
82285>>>        Set peAnchors to anTopLeftRight
82286>>>        Set Label to "gyfl azonost"
82287>>>        Set Label_Justification_mode to jMode_Left
82288>>>        Set Label_Col_Offset to 63
82289>>>        Set Label_row_Offset to 0
82290>>>    End_Object 
82291>>>
82291>>>    Object oUgyfelNev is a dbForm
82293>>>        Entry_Item Ugyfel.Nev
82294>>>        Set Size to 13 250
82295>>>        Set Location to 35 68
82296>>>        Set peAnchors to anTopLeftRight
82297>>>        Set Label to "Nv"
82298>>>        Set Label_Justification_mode to jMode_Left
82299>>>        Set Label_Col_Offset to 63
82300>>>        Set Label_row_Offset to 0
82301>>>    End_Object 
82302>>>
82302>>>    Object oAutoId is a dbForm
82304>>>        Entry_Item Auto.Id
82305>>>        Set Size to 13 42
82306>>>        Set Location to 50 68
82307>>>        Set peAnchors to anTopLeftRight
82308>>>        Set Label to "Azonost"
82309>>>        Set Label_Justification_mode to jMode_Left
82310>>>        Set Label_Col_Offset to 63
82311>>>        Set Label_row_Offset to 0
82312>>>    End_Object 
82313>>>
82313>>>    Object oAutoAlvazszam is a dbForm
82315>>>        Entry_Item Auto.Alvazszam
82316>>>        Set Size to 13 126
82317>>>        Set Location to 65 68
82318>>>        Set peAnchors to anTopLeftRight
82319>>>        Set Label to "Alvzszm"
82320>>>        Set Label_Justification_mode to jMode_Left
82321>>>        Set Label_Col_Offset to 63
82322>>>        Set Label_row_Offset to 0
82323>>>    End_Object 
82324>>>
82324>>>    Object oAutoMotorszam is a dbForm
82326>>>        Entry_Item Auto.Motorszam
82327>>>        Set Size to 13 126
82328>>>        Set Location to 80 68
82329>>>        Set peAnchors to anTopLeftRight
82330>>>        Set Label to "Motorszm"
82331>>>        Set Label_Justification_mode to jMode_Left
82332>>>        Set Label_Col_Offset to 63
82333>>>        Set Label_row_Offset to 0
82334>>>    End_Object 
82335>>>
82335>>>    Object oMunkalapRogzites is a dbForm
82337>>>        Entry_Item Munkalap.Rogzites
82338>>>        Set Size to 13 66
82339>>>        Set Location to 95 68
82340>>>        Set peAnchors to anTopLeftRight
82341>>>        Set Label to "Rgzts"
82342>>>        Set Label_Justification_mode to jMode_Left
82343>>>        Set Label_Col_Offset to 63
82344>>>        Set Label_row_Offset to 0
82345>>>    End_Object 
82346>>>
82346>>>    Object oMunkalapBehozatal is a dbForm
82348>>>        Entry_Item Munkalap.Behozatal
82349>>>        Set Size to 13 66
82350>>>        Set Location to 110 68
82351>>>        Set peAnchors to anTopLeftRight
82352>>>        Set Label to "Behozatal"
82353>>>        Set Label_Justification_mode to jMode_Left
82354>>>        Set Label_Col_Offset to 63
82355>>>        Set Label_row_Offset to 0
82356>>>    End_Object 
82357>>>
82357>>>    Object oMunkalapElvitel is a dbForm
82359>>>        Entry_Item Munkalap.Elvitel
82360>>>        Set Size to 13 66
82361>>>        Set Location to 125 68
82362>>>        Set peAnchors to anTopLeftRight
82363>>>        Set Label to "Elvitel"
82364>>>        Set Label_Justification_mode to jMode_Left
82365>>>        Set Label_Col_Offset to 63
82366>>>        Set Label_row_Offset to 0
82367>>>    End_Object 
82368>>>
82368>>>    Object oMunkalapAkm is a dbForm
82370>>>        Entry_Item Munkalap.Akm
82371>>>        Set Size to 13 66
82372>>>        Set Location to 140 68
82373>>>        Set peAnchors to anTopLeftRight
82374>>>        Set Label to "Kilmter eltte"
82375>>>        Set Label_Justification_mode to jMode_Left
82376>>>        Set Label_Col_Offset to 63
82377>>>        Set Label_row_Offset to 0
82378>>>    End_Object 
82379>>>
82379>>>    Object oMunkalapBkm is a dbForm
82381>>>        Entry_Item Munkalap.Bkm
82382>>>        Set Size to 13 66
82383>>>        Set Location to 155 68
82384>>>        Set peAnchors to anTopLeftRight
82385>>>        Set Label to "Kilmterlls utns"
82386>>>        Set Label_Justification_mode to jMode_Left
82387>>>        Set Label_Col_Offset to 63
82388>>>        Set Label_row_Offset to 0
82389>>>    End_Object 
82390>>>
82390>>>    Object oDetailGrid is a cDbCJGrid
82392>>>        Set Size to 66 359
82393>>>        Set Location to 178 5
82394>>>        Set Server to oMunkaMunkalap_DD
82395>>>        Set Ordering to 1
82396>>>        Set peAnchors to anAll
82397>>>        Set psLayoutSection to "oMunkalap_oDetailGrid"
82398>>>        Set pbAllowInsertRow to False
82399>>>        Set pbHeaderPrompts to True
82400>>>
82400>>>        Object oMunka_Id is a cDbCJGridColumn
82402>>>            Entry_Item Munka.Id
82403>>>            Set piWidth to 85
82404>>>            Set psCaption to "Munka azon."
82405>>>        End_Object 
82406>>>
82406>>>        Object oMunka_Name is a cDbCJGridColumn
82408>>>            Entry_Item Munka.Name
82409>>>            Set piWidth to 210
82410>>>            Set psCaption to "Nv"
82411>>>        End_Object 
82412>>>
82412>>>        Object oMunka_Leiras is a cDbCJGridColumn
82414>>>            Entry_Item Munka.Leiras
82415>>>            Set piWidth to 105
82416>>>            Set psCaption to "Lers"
82417>>>        End_Object 
82418>>>
82418>>>        Object oMunka_Egysegar is a cDbCJGridColumn
82420>>>            Entry_Item Munka.Egysegar
82421>>>            Set piWidth to 105
82422>>>            Set psCaption to "Egysgr"
82423>>>        End_Object 
82424>>>
82424>>>        Object oMunkaMunkalap_Darab is a cDbCJGridColumn
82426>>>            Entry_Item MunkaMunkalap.Darab
82427>>>            Set piWidth to 105
82428>>>            Set psCaption to "Darab"
82429>>>        End_Object 
82430>>>
82430>>>    End_Object 
82431>>>
82431>>>    //-----------------------------------------------------------------------
82431>>>    // Create custom confirmation messages for save and delete
82431>>>    // We must create the new functions and assign verify messages
82431>>>    // to them.
82431>>>    //-----------------------------------------------------------------------
82431>>>
82431>>>    Function ConfirmDeleteHeader Returns Boolean
82434>>>        Boolean bFail
82434>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
82435>>>        Function_Return bFail
82436>>>    End_Function 
82437>>>
82437>>>    // Only confirm on the saving of new records
82437>>>    Function ConfirmSaveHeader Returns Boolean
82440>>>        Boolean bNoSave bHasRecord
82440>>>        Handle  hoSrvr
82440>>>        Get Server to hoSrvr
82441>>>        Get HasRecord of hoSrvr to bHasRecord
82442>>>        If not bHasRecord Begin
82444>>>            Get Confirm "Save this NEW header?" to bNoSave
82445>>>        End
82445>>>>
82445>>>        Function_Return bNoSave
82446>>>    End_Function 
82447>>>
82447>>>    // Define alternate confirmation Messages
82447>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
82448>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
82449>>>    // Saves in header should not clear the view
82449>>>    Set Auto_Clear_Deo_State to False
82450>>>
82450>>>
82450>>>End_Object 
82451>        Use GyakorisagRiport.rv
Including file: GyakorisagRiport.rv    (C:\Repos\DataFlexBeadando\AppSrc\GyakorisagRiport.rv)
82451>>>// GyakorisagRiport.rv
82451>>>// GyakorisagRiport
82451>>>Register_Object oReport
82451>>>
82451>>>Use DFRptVw.pkg
82451>>>Use cWinReport2.pkg
Including file: cWinReport2.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cWinReport2.pkg)
82451>>>>>// cWinReport2.pkg
82451>>>>>
82451>>>>>// defines support for new Winprint2 cWinReport2 class
82451>>>>>
82451>>>>>
82451>>>>>Use DFRpt.pkg              // BasicReport RO Class for VDF
82451>>>>>Use WinPrint2.pkg          // WinPrint2 engine
Including file: Winprint2.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Winprint2.pkg)
82451>>>>>>>// WinPrint2.pkg
82451>>>>>>>//
82451>>>>>>>Use windows.pkg
82451>>>>>>>Use LanguageText.pkg
82451>>>>>>>Use DLL.pkg
82451>>>>>>>Use WinPrint2_Api.pkg
Including file: WinPrint2_API.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\WinPrint2_API.pkg)
82451>>>>>>>>>//WinPrint2_API.pkg
82451>>>>>>>>>
82451>>>>>>>>>Use DLL.pkg
82451>>>>>>>>>
82451>>>>>>>>>External_Function WP_IsPrinterValid "IsPrinterValid" WinPrint.dll ;Returns Boolean // True if the the current printer is a valid one. False, otherwise.
82452>>>>>>>>>
82452>>>>>>>>>External_Function WP_ArePrintersInstalled "ArePrintersInstalled" WinPrint.dll ; // determines whether at least one printer is installedReturns Boolean // True, if a printer is installed, False if it is not.
82453>>>>>>>>>
82453>>>>>>>>>External_Function WP_ExecutePrinterSetupDialog "ExecutePrinterSetupDialog" WinPrint.dll ; // displays the "printer setup" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
82454>>>>>>>>>
82454>>>>>>>>>External_Function WP_ExecutePrintDialog "ExecutePrintDialog" WinPrint.dll ; // displays the "Print" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
82455>>>>>>>>>
82455>>>>>>>>>External_Function WP_GetCurrentDevice "GetCurrentDevice" WinPrint.dll ; // retrieves the name of the current printer device    Address aDevice ; // address of the string (255 chars) that will hold the device name upon returnReturns Boolean // True, if success; False if error occurred
82456>>>>>>>>>
82456>>>>>>>>>External_Function WP_GetPrintDialogFlags "GetPrintDialogFlags" WinPrint.dll ; // retrieves the current print optionsReturns UInteger // array of flags representing print-related options that are currently set
82457>>>>>>>>>
82457>>>>>>>>>External_Function WP_GetUserDefinedPapersize "GetUserDefinedPapersize" WinPrint.dll ;  // gets the size of user-defined paperReturns UInteger // // hi-word=length; lo-word=width
82458>>>>>>>>>
82458>>>>>>>>>External_Function WP_IsPrintDialogFlagSet "IsPrintDialogFlagSet" WinPrint.dll ; // determines whether a specific print-flag is set    UInteger iFlag ; // the printer flagReturns Boolean // True, if the flag is set; False, if it isn't
82459>>>>>>>>>
82459>>>>>>>>>External_Function WP_SelectPrinter "SelectPrinter" WinPrint.dll ; // selects a printer programatically    String sDevice; // the name of the printerReturns Boolean // True, if success; False, if error (such as an invalid printer name)
82460>>>>>>>>>
82460>>>>>>>>>External_Function WP_SetFirstPagePaperSource "SetFirstPagePaperSource"  WinPrint.dll ;        Integer iBin ; // the bim constantReturns Boolean // True if success, false if error
82461>>>>>>>>>
82461>>>>>>>>>External_Function WP_SetNumberOfPrintCopies "SetNumberOfPrintCopies" WinPrint.dll ; // sets the number of copies to print    UInteger iNumCopies; // number of copies to makeReturns Boolean // Always True
82462>>>>>>>>>
82462>>>>>>>>>External_Function WP_SetSpecificPrintDialogFlag "SetSpecificPrintDialogFlag" WinPrint.dll; // Sets/unsets one printer flag    UInteger fFlag; // printer flagReturns Boolean // True, if success; False if error occurred
82463>>>>>>>>>
82463>>>>>>>>>External_Function WP_SetPrintDialogFlags "SetPrintDialogFlags" WinPrint.dll; // Sets/unsets all printer flags in one call    UInteger fFlags; // printer flagsReturns Boolean // True, if success; False if error occurred
82464>>>>>>>>>
82464>>>>>>>>>External_Function WP_SetUserDefinedPapersize "SetUserDefinedPapersize" WinPrint.dll ;  // sets the size of user-defined paper    UInteger iPaperSize ; // hi-word=length; lo-word=widthReturns Boolean // True, if success; False if error occurred
82465>>>>>>>>>
82465>>>>>>>>>External_Function WP_SetFontStyle "SetFontStyle" WinPrint.dll ; // sets multiple font attributes    Integer iStyles ; // series of flagsReturns Boolean // always True
82466>>>>>>>>>
82466>>>>>>>>>External_Function WP_SetFontBold "SetFontBold" WinPrint.dll ; // toggles the bold attribute of the current font    Boolean bBold ; // True to switch bold attribute on; False to switch it offReturns Boolean // always True
82467>>>>>>>>>
82467>>>>>>>>>External_Function WP_SetFontItalic "SetFontItalic" WinPrint.dll ; // toggles the italic attribute of the current font    Boolean bItalic ; // True to switch italic attribute on; False to switch it offReturns Boolean  // always True
82468>>>>>>>>>
82468>>>>>>>>>External_Function WP_SetFontUnderline "SetFontUnderline" WinPrint.dll ; // toggles the underline attribute of the current font    Boolean bUnderline ; // True to switch underline attribute on; False to switch it offReturns Boolean  // always True
82469>>>>>>>>>
82469>>>>>>>>>External_Function WP_SetFontStrikeout "SetFontStrikeout" WinPrint.dll ; // toggles the strikeout attribute of the current font    Boolean bStrikeout ; // True to switch strikeout attribute on; False to switch it offReturns Boolean  // always True
82470>>>>>>>>>
82470>>>>>>>>>External_Function WP_SetFontColor "SetFontColor" WinPrint.dll ; // sets the color of the current font    Integer iColor ; // color of the fontReturns Boolean  // always True
82471>>>>>>>>>
82471>>>>>>>>>External_Function WP_SetFontHeight "SetFontHeight" WinPrint.dll ; // sets the height of the font    UInteger iHeight ; // height of the font in points (multiplied by 100. Eg 12.5 point should be sent as 1250)Returns Boolean  // always True
82472>>>>>>>>>
82472>>>>>>>>>External_Function WP_SetFontName "SetFontName" WinPrint.dll ; // Sets the name of the font to use    String sFontName ; // name of the font to useReturns Boolean  // always True
82473>>>>>>>>>
82473>>>>>>>>>External_Function WP_DrawBitmap "DrawBitmap" WinPrint.dll ; // Draws a bitmap (BMP, JPG)    String  sBitmap;                 // Name of the bitmap    Integer iLeft;                   // distance from left edge to draw bitmap    Integer iTop;                    // distance from top edge to draw bitmap    Integer iWidth;                  // width of the bitmap    Integer iHeight;                 // height of the bitmap    Boolean bUpdateCurrentPosition;  // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
82474>>>>>>>>>
82474>>>>>>>>>External_Function WP_DrawEllipse "DrawEllipse" WinPrint.dll ; // draws an elipse within a bounding rectangle    Integer iLeft;                   // distance from left edge to draw the ellipse    Integer iTop;                    // distance from top edge to draw the ellipse    Integer iWidth;                  // width of the bounding rectangle    Integer iHeight;                 // height of the bounding rectangle    Integer iBorderColor;            // color of the ellipse's edge    Integer iFillColor;              // internal color of the ellipse    Boolean  bFill;                  // should the ellipse be filled? (False=transparent)    UInteger iThickness;             // thickness of the elipse    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the ellipse be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82475>>>>>>>>>
82475>>>>>>>>>External_Function WP_DrawLine "DrawLine" WinPrint.dll ; // draws a line from the current position    Integer iLeft;                   // distance from left edge to draw the line    Integer iTop;                    // distance from top edge to draw the line    Integer iLength;                 // length of the line    Boolean  bHorizontal;            // draw horizontal? (False=vertical)    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
82476>>>>>>>>>
82476>>>>>>>>>External_Function WP_DrawRectangle "DrawRectangle" WinPrint.dll ; // draws a rectangle    Integer iLeft;                   // distance from left edge to draw the rectangle    Integer iTop;                    // distance from top edge to draw the rectangle    Integer iWidth;                  // width of the rectangle    Integer iHeight;                 // height of the rectangle    Integer iBorderColor;            // color of the rectangle's border    Integer iFillColor;              // internal color of the rectangle    Boolean  bFill;                  // should the rectangle be filled? (False=transparent)    UInteger iThickness;             // thickness of the rectangle's border    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the rectangle be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82477>>>>>>>>>
82477>>>>>>>>>External_Function WP_DrawXYLine "DrawXYLine" WinPrint.dll ; // draws a line between two points    Integer iLeftStart;              // distance from left edge to draw from    Integer iTopStart;               // distance from top edge to draw from    Integer iLeftEnd;                // distance from left edge to draw to    Integer iTopEnd;                 // distance from top edge to draw to    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the line be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82478>>>>>>>>>
82478>>>>>>>>>External_Function WP_SetAbsoluteMargins "SetAbsoluteMargins" WinPrint.dll ; // modifies the top/bottom non-printable margin    UInteger iTop;      // the top margin offset    UInteger iBottom;   // the bottom margin offset    Boolean  bAllPages; // should all pages be affected? True=AllPages; False=first page onlyReturns Boolean // always True
82479>>>>>>>>>
82479>>>>>>>>>External_Function WP_SetMargins "SetMargins" WinPrint.dll ; // Sets the user-margins    UInteger iLeft;   // the left margin    UInteger iTop;    // the top margin    UInteger iRight;  // the right margin    UInteger iBottom; // the bottom marginReturns Boolean // always True
82480>>>>>>>>>
82480>>>>>>>>>External_Function WP_CreateDiagram "CreateDiagram" WinPrint.dll ; // Creates a new diagram    UInteger eType;       // type of diagram (Bar, Line, Pie)    UInteger eEffect;     // how it is drawn (2d or 3d, etc)    UInteger iWidth;      // width of the diagram    UInteger iHeight;     // height of the diagram    Boolean  bDrawXyAxis; // draw the xy-axis (for bar charts only)?Returns Handle // unique id for the diagram used in other diagram funtions
82481>>>>>>>>>
82481>>>>>>>>>External_Function WP_AddDiagramEntry "AddDiagramEntry" WinPrint.dll ; // Adds an item into a diagram    Handle   hDiagram;          // diagram handle returned by CreateDiagram()    String   sValueDescription; // description of the item    String   sValue;            // value of the item    Integer iBorderColor;       // color of the item's border    Integer iFillColor;         // color of the item's interior    Boolean  bFilled;           // should the item be drawn filled (with iFillColor), or transparent?    UInteger iNumDecimals;      // Number of decimals in the sValue argument    UInteger eValueOrPercent;   // How the value should be displayed (as value or percentage, etc)    Boolean  bExploded;         // should the value be "pulled out" (pie charts only)Returns Boolean // True, if success; False, if error
82482>>>>>>>>>
82482>>>>>>>>>External_Function WP_DrawDiagram "DrawDiagram" WinPrint.dll ; // draws a diagram    Handle   hDiagram;               // diagram handle returned by CreateDiagram()    UInteger iLeft;                  // x-coordinate to draw the diagram    UInteger iTop;                   // y-coordinate to draw the diagram    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if success; False, if error
82483>>>>>>>>>
82483>>>>>>>>>External_Function WP_LockDiagram "LockDiagram" WinPrint.dll ; // Locks a diagram so that no more entries can be added    Handle hDiagram; // diagram handle returned by CreateDiagram()Returns Boolean // True, if success; False, if error
82484>>>>>>>>>
82484>>>>>>>>>External_Function WP_SetDiagramCaption "SetDiagramCaption" WinPrint.dll ; // Sets the caption of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sCaption; // the diagram's captionReturns Boolean // True, if success; False, if error
82485>>>>>>>>>
82485>>>>>>>>>External_Function WP_SetDiagramXText "SetDiagramXText" WinPrint.dll ; // Sets the horizontal label of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sText;    // the diagram's horizonal labelReturns Boolean // True, if success; False, if error
82486>>>>>>>>>
82486>>>>>>>>>External_Function WP_SetDiagramYText "SetDiagramYText" WinPrint.dll ; // Sets the vertical label of a diagram    Handle  hDiagram;      // diagram handle returned by CreateDiagram()    String  sText;         // the diagram's vertical label    Boolean bVerticalText; // should the text be drawn vertically (False=horizontally)Returns Boolean // True, if success; False, if error
82487>>>>>>>>>
82487>>>>>>>>>External_Function WP_BeginHeader "BeginHeader" WinPrint.dll ; // creates a new header    UInteger iHeaderType; // the type of header    UInteger iSubHeaderNum; // for subheaders, then number (1-0)Returns Boolean // always True
82488>>>>>>>>>
82488>>>>>>>>>External_Function WP_EndHeader "EndHeader" WinPrint.dll ; // declares the end of the current headerReturns Boolean // always True
82489>>>>>>>>>
82489>>>>>>>>>External_Function WP_SetExtraLineCheck "SetExtraLineCheck" WinPrint.dll ; // forces a soft page break if header plus number of lines don't fit on page    UInteger iNumLines; // number of lines in addition to header required before forcing a soft page-breakReturns Boolean; // always True
82490>>>>>>>>>External_Function WP_SetHeaderFrame "SetHeaderFrame" WinPrint.dll ; // sets the style, color and frame of a header    UInteger eFrame;     // style of frame (margin-to-margin, etc)    Integer iColor;      // color of the frame's edge    UInteger iThickness; // thickness of the frame    Integer iFillCol;    // the internal color of the frame (only used if bBilled=True)    Boolean  bFilled;    // True, if the frame should be filled with the iFillColor (False=Transparent)Returns Boolean // Always True
82491>>>>>>>>>
82491>>>>>>>>>External_Function WP_SetHeaderMargin "SetHeaderMargin" WinPrint.dll ; // Sets a margin of space on the inside and outside of the current header    UInteger eType;      // Specifies which margin areas is being set.    Integer  iSize;      // Size of the margin setting in the current report metricsReturns Boolean  // False if document is not started
82492>>>>>>>>>
82492>>>>>>>>>External_Function WP_SetHeaderPlacement "SetHeaderPlacement" WinPrint.dll ; // placement (left, center or right) of the header    UInteger ePlacement; // placed left, center or rightReturns Boolean //always True
82493>>>>>>>>>
82493>>>>>>>>>External_Function WP_SetHeaderWrap "SetHeaderWrap" WinPrint.dll ; // determines whether the current header is drawn on soft page-breaks    Boolean bWrap; // True, to wrap onto following pages; False, for current page onlyReturns Boolean // always True
82494>>>>>>>>>
82494>>>>>>>>>External_Function WP_WriteHeader "WriteHeader" WinPrint.dll ; // writes a header to the current page    UInteger eHeaderType;   // type of header    UInteger iSubHeaderNum; // for subheaders, the number (1-9)Returns Boolean // True, if success; False, if error
82495>>>>>>>>>
82495>>>>>>>>>External_Function WP_RGBToDFPrintColor "RGBToDFPrintColor" WinPrint.dll ; // converts R, G, and B values into a composite color that WinPrint expects    UInteger iRed;   // red component (1-255)    UInteger iGreen; // green component (1-255)    UInteger iBlue;  // blue component (1-255)Returns Integer // composite color
82496>>>>>>>>>
82496>>>>>>>>>External_Function WP_GetMetrics "GetMetrics" WinPrint.dll ; // gets the current unit of measurementReturns UInteger // unit of measurement (Inch or CM)
82497>>>>>>>>>
82497>>>>>>>>>External_Function WP_SetMetrics "SetMetrics" WinPrint.dll ; // sets the unit of measurement   UInteger eMetrics; // Inch or CMReturns Boolean // always True
82498>>>>>>>>>
82498>>>>>>>>>External_Function WP_ClearDocument "ClearDocument" WinPrint.dll ; // clears the resources of the document from memoryReturns Boolean // always True
82499>>>>>>>>>
82499>>>>>>>>>External_Function WP_NewDocument "NewDocument" WinPrint.dll ; // starts a new document, but preserves the printer settings   Boolean bAutoPreview ; // Should the Previewer be displayed immediatelyReturns Boolean // True, if success; False, if an error occurred
82500>>>>>>>>>
82500>>>>>>>>>External_Function WP_EndDocument "EndDocument" WinPrint.dll ; // Indicates that the document is finishedReturns Boolean // always True
82501>>>>>>>>>
82501>>>>>>>>>External_Function WP_ClearPrinter "ClearPrinter" WinPrint.dll ; // clears all printer and document resourcesReturns Boolean // True, if success; False, if an error occurred
82502>>>>>>>>>
82502>>>>>>>>>External_Function WP_ConfirmLines "ConfirmLines" WinPrint.dll ; // ensures that a specified number of lines will fit on the page; if not, a soft page-break is performed automatically    UInteger iNumLines; // number of lines that must fit on the pageReturns Boolean // True, if success; False, if an error occurred
82503>>>>>>>>>
82503>>>>>>>>>External_Function WP_CreatePage "CreatePage" WinPrint.dll ; // creates a new page of specified columns   UInteger iNumColumns; // number of columns (zero= no columns)Returns UInteger; // page number that was created
82504>>>>>>>>>External_Function WP_PreviewDocument "PreviewDocument" WinPrint.dll ; // previews the current document    Boolean bPrintDialog; // Determines whether the Print Dialog (range, etc) is displayed when the "print" button is clicked in the preview window.    Boolean bPrintSetup;  // Determines whether the Print Setup button is enabled (allows to change orientation, etc)    Boolean bPrint;       // Determines whether the Print button is enabledReturns Handle // non-zero = hViewerProcess; zero= error
82505>>>>>>>>>
82505>>>>>>>>>External_Function WP_ClosePreview "ClosePreview" WinPrint.dll ; // closes the preview windowReturns Boolean // True, if closed; False, if an error occurred (such as it not being already open)
82506>>>>>>>>>
82506>>>>>>>>>External_Function WP_PrintDocument "PrintDocument" WinPrint.dll ; // prints the current document    Handle hWndParent; // window handle of object to use for any modal outputReturns Boolean // True, if success; False, if an error occurred
82507>>>>>>>>>
82507>>>>>>>>>External_Function WP_SetAlign "SetAlign" WinPrint.dll ; // align future text    UInteger eAlign; // left, center or rightReturns Boolean // always True
82508>>>>>>>>>
82508>>>>>>>>>External_Function WP_WriteText "WriteText" WinPrint.dll ; // write text to the current position or column    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iColumnNum;        // number of the column to write to (zero=no column, use current position)    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
82509>>>>>>>>>
82509>>>>>>>>>External_Function WP_WriteTextAtPosition "WriteTextAtPosition" WinPrint.dll ; // writes text to a specific position    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iPosition;         // horizontal position to write the text    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
82510>>>>>>>>>
82510>>>>>>>>>External_Function WP_SetProgressCaption "SetProgressCaption" WinPrint.dll ;    String sProgressCaption ;Returns Boolean
82511>>>>>>>>>
82511>>>>>>>>>External_Function WP_SetReportTitle     "SetReportTitle"     WinPrint.dll ;    String sCaption ;Returns Boolean
82512>>>>>>>>>
82512>>>>>>>>>External_Function WP_ViewerWantsToClose "ViewerWantsToClose" WinPrint.dll ;Returns Integer
82513>>>>>>>>>
82513>>>>>>>>>External_Function WP_DisplayMessageBox  "DisplayMessageBox"  WinPrint.dll ;    String sCaption String sText ;Returns Integer
82514>>>>>>>>>
82514>>>>>>>>>External_Function WP_GetViewerWindow "GetViewerWindow" Winprint.dll ;Returns Handle
82515>>>>>>>>>
82515>>>>>>>>>External_Function WP_GetDocumentStatus "GetDocumentStatus" Winprint.dll ;Returns Integer // returns dsNotStarted, dsStarted, or dsFinished
82516>>>>>>>>>
82516>>>>>>>Use WinPrint_Constants.pkg
82516>>>>>>>Use Rgb.pkg
82516>>>>>>>Use GlobalFunctionsProcedures.pkg
82516>>>>>>>
82516>>>>>>>DEFINE INFINITE for -1
82516>>>>>>>DEFINE WAIT_TIMEOUT for |CI$00000102
82516>>>>>>>
82516>>>>>>>
82516>>>>>>>DEFINE QS_KEY            for |CI$0001
82516>>>>>>>DEFINE QS_MOUSEMOVE      for |CI$0002
82516>>>>>>>DEFINE QS_MOUSEBUTTON    for |CI$0004
82516>>>>>>>DEFINE QS_POSTMESSAGE    for |CI$0008
82516>>>>>>>DEFINE QS_TIMER          for |CI$0010
82516>>>>>>>DEFINE QS_PAINT          for |CI$0020
82516>>>>>>>DEFINE QS_SENDMESSAGE    for |CI$0040
82516>>>>>>>DEFINE QS_HOTKEY         for |CI$0080
82516>>>>>>>DEFINE QS_ALLPOSTMESSAGE for |CI$0100
82516>>>>>>>DEFINE QS_MOUSE          for (QS_MOUSEMOVE ior QS_MOUSEBUTTON)
82516>>>>>>>DEFINE QS_INPUT          for (QS_MOUSE ior QS_KEY)
82516>>>>>>>DEFINE QS_ALLEVENTS      for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY)
82516>>>>>>>DEFINE QS_ALLINPUT       for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY ior QS_SENDMESSAGE)
82516>>>>>>>
82516>>>>>>>External_Function WaitForSingleObject "WaitForSingleObject" Kernel32.dll Handle hHandle Dword dwMilliseconds Returns DWord
82517>>>>>>>External_Function GetCurrentProcessId "GetCurrentProcessId" Kernel32.dll Returns DWord
82518>>>>>>>External_Function GetCurrentProcess "GetCurrentProcess" Kernel32.dll Returns DWord
82519>>>>>>>
82519>>>>>>>External_Function MsgWaitForMultipleObjects "MsgWaitForMultipleObjects" User32.dll ;    DWORD nCount;             // number of handles in the object handle array    Address pHandles;     // pointer to the object-handle array    Boolean fWaitAll;     // wait for all or wait for one    DWORD dwMilliseconds; // time-out interval in milliseconds    DWORD dwWakeMask;     // type of input events to wait forReturns Dword
82520>>>>>>>
82520>>>>>>>Use GlobalFunctionsProcedures.pkg
82520>>>>>>>
82520>>>>>>>Class cWinPrint2 is a cObject // JJT: Will we need a windows handle for this like old one
82521>>>>>>>    Procedure Construct_Object
82523>>>>>>>        forward send construct_object
82525>>>>>>>
82525>>>>>>>        //*** internal properties
82525>>>>>>>        Property Integer DFCurrent_Color       0
82526>>>>>>>        Property String  DFCurrent_OutPut      "WinPrint"
82527>>>>>>>        Property Integer DFCurrent_Diagram     0
82528>>>>>>>        Property Integer DFCurrent_HeaderType  0
82529>>>>>>>        Property Integer DFCurrent_HeaderNr    0
82530>>>>>>>        Property Number  DFCurrent_FontSize    10
82531>>>>>>>        Property String  DFCurrent_Font        "Arial"
82532>>>>>>>
82532>>>>>>>        //*** Default values for margins 2.53 CM = 1 inch
82532>>>>>>>        Property Number  DFLeft_Margin    2.53
82533>>>>>>>        Property Number  DFTop_Margin     2.53
82534>>>>>>>        Property Number  DFright_Margin   2.53
82535>>>>>>>        Property Number  DFBottom_Margin  2.53
82536>>>>>>>
82536>>>>>>>        // If WP1 this defaults to false. In 2, it is true which means that the print job
82536>>>>>>>        // dialog appears when you hitprint in previewer.
82536>>>>>>>        Property Integer PrintDlgInPreview   1
82537>>>>>>>         // This does nothing in Wp2 (because you can't to this anyway)
82537>>>>>>>        Property Integer EnablePrintSetupFromPreview  True
82538>>>>>>>        Property Integer EnablePrintFromPreview  1
82539>>>>>>>
82539>>>>>>>        // is the GUI Suspended. This is privately maintained and is used
82539>>>>>>>        // to figure out if a preview panel is up or not
82539>>>>>>>        Property Integer pbIsSuspended False
82540>>>>>>>
82540>>>>>>>        Object oDFColorArray is an Array
82542>>>>>>>           //Moved into array
82542>>>>>>>           Set Value  0  To RGB_WHITE
82543>>>>>>>           Set Value  1  To RGB_RED
82544>>>>>>>           Set Value  2  To RGB_BLUE
82545>>>>>>>           Set Value  3  To RGB_GREEN
82546>>>>>>>           Set Value  4  To RGB_YELLOW
82547>>>>>>>           Set Value  5  To RGB_GREY
82548>>>>>>>           Set Value  6  To RGB_CYAN
82549>>>>>>>           Set Value  7  To RGB_MAGENTA
82550>>>>>>>           Set Value  8  To RGB_DRED
82551>>>>>>>           Set Value  9  To RGB_DBLUE
82552>>>>>>>           Set Value  10 To RGB_DGREEN
82553>>>>>>>           Set Value  11 To RGB_DYELLOW
82554>>>>>>>           Set Value  12 To RGB_DGREY
82555>>>>>>>           Set Value  13 To RGB_DCYAN
82556>>>>>>>           Set Value  14 To RGB_DMAGENTA
82557>>>>>>>           Set Value  15 To RGB_BLACK
82558>>>>>>>        End_Object
82559>>>>>>>
82559>>>>>>>        Object oDiagramArray is an Array
82561>>>>>>>        End_Object
82562>>>>>>>
82562>>>>>>>    End_Procedure
82563>>>>>>>
82563>>>>>>>    Function ViewerWantsToClose returns Boolean
82565>>>>>>>        Function_return (WP_ViewerWantsToClose())
82566>>>>>>>    end_Function
82567>>>>>>>
82567>>>>>>>    Function IsViewerActive returns boolean
82569>>>>>>>        Function_Return (WP_GetViewerWindow()<>0)
82570>>>>>>>    end_function
82571>>>>>>>
82571>>>>>>>    Function IsPrinterValid Returns Boolean
82573>>>>>>>        Function_Return (WP_IsPrinterValid()<>0)
82574>>>>>>>    End_Function
82575>>>>>>>
82575>>>>>>>    Function ArePrintersInstalled returns boolean
82577>>>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
82578>>>>>>>    End_Function
82579>>>>>>>
82579>>>>>>>
82579>>>>>>>    // returns docucument state: dsNotStarted, dsStarted, dsFinished
82579>>>>>>>    Function DocumentStatus returns Integer
82581>>>>>>>        Function_Return (WP_GetDocumentStatus())
82582>>>>>>>    end_function
82583>>>>>>>
82583>>>>>>>    // Might still be called from report class. Leave dummy stub
82583>>>>>>>    Procedure DFZeroCounters
82585>>>>>>>    End_Procedure
82586>>>>>>>
82586>>>>>>>    //***
82586>>>>>>>    Function DFNewPage Integer Columns Returns Integer
82588>>>>>>>        Integer iPageNum
82588>>>>>>>        // This returns a page number used in report object....(this may change)
82588>>>>>>>        Move (WP_CreatePage(Columns)) To iPageNum
82589>>>>>>>        If (iPageNum=0) Begin
82591>>>>>>>            Error DFERR_WINPRINT DFPrintError900
82592>>>>>>>>
82592>>>>>>>        End
82592>>>>>>>>
82592>>>>>>>        Function_Return iPageNum
82593>>>>>>>    End_Function
82594>>>>>>>
82594>>>>>>>    //***Return handle to use for winprint dialog. If main_window
82594>>>>>>>    //   exists, use it. Else, get object's handle
82594>>>>>>>    Function Report_Window_Handle returns handle
82596>>>>>>>        Handle hWnd
82596>>>>>>>        Handle hoObj
82596>>>>>>>        Get Focus of desktop to hoObj // start with the focus
82597>>>>>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
82598>>>>>>>        function_return hWnd
82599>>>>>>>    End_Function
82600>>>>>>>
82600>>>>>>>
82600>>>>>>>    //***
82600>>>>>>>    Function DFPrintDialog Returns Boolean
82602>>>>>>>        Handle hwnd
82602>>>>>>>        Boolean bOk
82602>>>>>>>
82602>>>>>>>        Get Report_Window_Handle to hWnd
82603>>>>>>>        Move (WP_ExecutePrintDialog(hwnd)) To bOk
82604>>>>>>>
82604>>>>>>>        Function_Return bOk
82605>>>>>>>    End_Function
82606>>>>>>>
82606>>>>>>>
82606>>>>>>>    //*** You can only invoke the print setup if the report is cleared. If you try to to do this in
82606>>>>>>>    //    the wrong state you will get an error.
82606>>>>>>>    Function DFPrintSetupDialog Returns Boolean
82608>>>>>>>        Handle hwnd
82608>>>>>>>        Boolean bOk
82608>>>>>>>        Integer iStatus
82608>>>>>>>        Get ArePrintersInstalled to bOk
82609>>>>>>>        If not bOk Begin
82611>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
82612>>>>>>>>
82612>>>>>>>        End
82612>>>>>>>>
82612>>>>>>>        Else Begin
82613>>>>>>>            Get DocumentStatus to iStatus
82614>>>>>>>            
82614>>>>>>>            If (iStatus=dsNotStarted) Begin
82616>>>>>>>                Get Report_Window_Handle to hWnd
82617>>>>>>>                Move (WP_ExecutePrinterSetupDialog(hwnd)) to bOk
82618>>>>>>>                
82618>>>>>>>                // test that the selected printer is valid....
82618>>>>>>>                If bOK Begin
82620>>>>>>>                    Get IsPrinterValid to bOk // if printer not valid, it's not ok
82621>>>>>>>                    If not bOk Begin
82623>>>>>>>                        Error DFERR_WINPRINT DFPrintError936  // could not select a valid printer
82624>>>>>>>>
82624>>>>>>>                    End
82624>>>>>>>>
82624>>>>>>>                End
82624>>>>>>>>
82624>>>>>>>            End
82624>>>>>>>>
82624>>>>>>>            Else Begin
82625>>>>>>>               Error DFERR_WINPRINT DFPrintError966      // cannot change printer when report is active
82626>>>>>>>>
82626>>>>>>>            End
82626>>>>>>>>
82626>>>>>>>        End
82626>>>>>>>>
82626>>>>>>>        Function_Return bOk
82627>>>>>>>    End_Function
82628>>>>>>>
82628>>>>>>>
82628>>>>>>>    //*** Provided for backwards compatibility. DFPrintSetupDialog is more flexible because it returns a
82628>>>>>>>    //    false if cancel was selected.
82628>>>>>>>    Procedure DFPrintSetup
82630>>>>>>>        Boolean bOk
82630>>>>>>>        Get DFPrintSetupDialog to bOk
82631>>>>>>>    End_Procedure
82632>>>>>>>
82632>>>>>>>    //*** This invokes the print job dialog, prints the report, then clears the report document.
82632>>>>>>>    //    This should be called after the report is complete.
82632>>>>>>>    Procedure DFPrint
82634>>>>>>>        Integer bOk
82634>>>>>>>        Get DFPrintDialog To bOk
82635>>>>>>>        If bOk Begin
82637>>>>>>>            Send DFPrintDoc
82638>>>>>>>            Send DFClearDoc
82639>>>>>>>        End
82639>>>>>>>>
82639>>>>>>>    End_Procedure
82640>>>>>>>
82640>>>>>>>    Procedure DFSuspendGui boolean bSuspend
82642>>>>>>>        If (bSuspend<>pbIsSuspended(self)) begin
82644>>>>>>>            Send SuspendGui of Desktop bSuspend
82645>>>>>>>            Set pbIsSuspended to bSuspend
82646>>>>>>>        end
82646>>>>>>>>
82646>>>>>>>    end_procedure
82647>>>>>>>
82647>>>>>>>    // this is protected so that the queue is only pumped if the
82647>>>>>>>    // gui is suspended.
82647>>>>>>>    Procedure PumpMsgQueue
82649>>>>>>>        If (pbIsSuspended(self)) begin
82651>>>>>>>            Send PumpMsgQueue of desktop // permit painting
82652>>>>>>>        end
82652>>>>>>>>
82652>>>>>>>    end_procedure
82653>>>>>>>
82653>>>>>>>
82653>>>>>>>    //*** This does a modeless preview. This is what you'd want during
82653>>>>>>>    //    report generation and it may be what you want for report viewing.
82653>>>>>>>    Procedure DFPreviewNoWait
82655>>>>>>>        Boolean bOk
82655>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
82655>>>>>>>        integer iStatus
82655>>>>>>>        Get PrintDlgInPreview to bPrntDlg
82656>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
82657>>>>>>>        Get EnablePrintFromPreview to bPrint
82658>>>>>>>        Get DocumentStatus to iStatus
82659>>>>>>>        If (iStatus=dsStarted) begin
82661>>>>>>>            Send DfSuspendGui True
82662>>>>>>>        end
82662>>>>>>>>
82662>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To bOk
82663>>>>>>>        If not bOk Begin
82665>>>>>>>            Error DFERR_WINPRINT DFPrintError901
82666>>>>>>>>
82666>>>>>>>            Send DfSuspendGui False
82667>>>>>>>        End
82667>>>>>>>>
82667>>>>>>>    End_Procedure
82668>>>>>>>
82668>>>>>>>
82668>>>>>>>    //*** This does a modal preview. You might want this for report
82668>>>>>>>    //    viewing as the program knows when the viewer is closed
82668>>>>>>>    // Note that this is a private message and it was never intended that this
82668>>>>>>>    // should be used. We expect winprint reports to use modeless viewers.
82668>>>>>>>    Procedure DFPreviewWait
82670>>>>>>>        Handle hViewerProcess
82670>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
82670>>>>>>>        Integer iRetVal
82670>>>>>>>        Integer hwMain hMain
82670>>>>>>>
82670>>>>>>>        Get PrintDlgInPreview to bPrntDlg
82671>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
82672>>>>>>>        Get EnablePrintFromPreview to bPrint
82673>>>>>>>
82673>>>>>>>        Send DfSuspendGui True
82674>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To hViewerProcess
82675>>>>>>>
82675>>>>>>>        If (hViewerProcess = 0) Begin
82677>>>>>>>            Error DFERR_WINPRINT DFPrintError901
82678>>>>>>>>
82678>>>>>>>        End
82678>>>>>>>>
82678>>>>>>>        Else Begin
82679>>>>>>>            // We need to wait for either the Viewer to close, or a WM_PAINT message in the thread's queue...
82679>>>>>>>            Repeat
82679>>>>>>>>
82679>>>>>>>               Move (MsgWaitForMultipleObjects(1, AddressOf(hViewerProcess), False, INFINITE, QS_PAINT)) To iRetVal
82680>>>>>>>               Send PumpMsgQueue // permit painting
82681>>>>>>>            Until (iRetVal = 0) // 0 means that the viewer process terminated
82683>>>>>>>        end
82683>>>>>>>>
82683>>>>>>>        Send DfSuspendGui False
82684>>>>>>>
82684>>>>>>>       // Do what we can to force VDF application to the top.
82684>>>>>>>       // As 12.0 dfSuspendGUI actually properly disables the underlying windows. When the viewer
82684>>>>>>>       // is closed it cannot give the focus back to this so it goes elsewhere. This will force it
82684>>>>>>>       // back. 
82684>>>>>>>
82684>>>>>>>       Get main_window of desktop to hMain
82685>>>>>>>       If hMain Begin
82687>>>>>>>          Get window_handle of hMain to hwMain
82688>>>>>>>          If hwMain Begin
82690>>>>>>>              If (GetForegroundWindow()<>hwMain) Begin
82692>>>>>>>                  Move (SetForegroundWindow(hwMain)) to hwMain
82693>>>>>>>              End
82693>>>>>>>>
82693>>>>>>>          End
82693>>>>>>>>
82693>>>>>>>       End
82693>>>>>>>>
82693>>>>>>>
82693>>>>>>>    End_Procedure
82694>>>>>>>
82694>>>>>>>    Procedure DfPreview
82696>>>>>>>        send DfPreviewNoWait
82697>>>>>>>    end_procedure
82698>>>>>>>
82698>>>>>>>
82698>>>>>>>    //***
82698>>>>>>>    Procedure DFPrintDoc
82700>>>>>>>        Handle hwnd
82700>>>>>>>        Boolean bOk
82700>>>>>>>        Get Report_Window_Handle to hWnd
82701>>>>>>>        Move (WP_PrintDocument(hwnd)) To bOk
82702>>>>>>>
82702>>>>>>>        If not bOk Begin
82704>>>>>>>            Error DFERR_WINPRINT DFPrintError902
82705>>>>>>>>
82705>>>>>>>        End
82705>>>>>>>>
82705>>>>>>>    End_Procedure
82706>>>>>>>
82706>>>>>>>
82706>>>>>>>    //***
82706>>>>>>>    Procedure DFClearDoc
82708>>>>>>>        Boolean bOk
82708>>>>>>>        Get ArePrintersInstalled to bOk
82709>>>>>>>        If bOk begin
82711>>>>>>>            Move (WP_ClearDocument()) To bOk
82712>>>>>>>            Send DFSuspendGUI False
82713>>>>>>>            If not bOk Begin
82715>>>>>>>               Error DFERR_WINPRINT DFPrintError903 // error number right?
82716>>>>>>>>
82716>>>>>>>            End
82716>>>>>>>>
82716>>>>>>>        End
82716>>>>>>>>
82716>>>>>>>    End_Procedure
82717>>>>>>>
82717>>>>>>>    Procedure DFNewDoc Boolean bAutoPreview
82719>>>>>>>        Boolean bOk
82719>>>>>>>        // this is the most likely place we will encounter when we start a report. Check for
82719>>>>>>>        // printers and return an explicit error to make it easy to identify the error
82719>>>>>>>        Get ArePrintersInstalled to bOk
82720>>>>>>>        If not bOk begin
82722>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
82723>>>>>>>>
82723>>>>>>>        end
82723>>>>>>>>
82723>>>>>>>        else begin
82724>>>>>>>            Send DfClearDoc //JJT - a new doc should always start with a clear
82725>>>>>>>            If bAutoPreview Send DFSuspendGUI True
82728>>>>>>>            Move (WP_NewDocument(bAutoPreview)) To bOk
82729>>>>>>>
82729>>>>>>>            If not bOk Begin
82731>>>>>>>               Error DFERR_WINPRINT DFPrintError902  // could not print document
82732>>>>>>>>
82732>>>>>>>               Send DFSuspendGUI False
82733>>>>>>>            End
82733>>>>>>>>
82733>>>>>>>        end
82733>>>>>>>>
82733>>>>>>>    End_Procedure
82734>>>>>>>
82734>>>>>>>    //***
82734>>>>>>>    Procedure DFSetFont String sFontName
82736>>>>>>>        boolean bOk
82736>>>>>>>        Move (WP_SetFontName(sFontName)) To bOk
82737>>>>>>>
82737>>>>>>>        If not bOK Begin
82739>>>>>>>            Error DFERR_WINPRINT DFPrintError904
82740>>>>>>>>
82740>>>>>>>        End
82740>>>>>>>>
82740>>>>>>>    End_Procedure
82741>>>>>>>
82741>>>>>>>
82741>>>>>>>    //***
82741>>>>>>>    Procedure DFSetFontSize Integer iHeight Integer iWidth
82743>>>>>>>        boolean bOk
82743>>>>>>>        // note that width is ignored in new implementation
82743>>>>>>>        Move (WP_SetFontHeight(iHeight)) To bOk
82744>>>>>>>
82744>>>>>>>        If not bOK Begin
82746>>>>>>>            Error DFERR_WINPRINT  DFPrintError905
82747>>>>>>>>
82747>>>>>>>        End
82747>>>>>>>>
82747>>>>>>>    End_Procedure
82748>>>>>>>
82748>>>>>>>
82748>>>>>>>    //***
82748>>>>>>>    Procedure DFSetFontStyle DWORD dwStyle
82750>>>>>>>        boolean bOk
82750>>>>>>>        Move (WP_SetFontStyle(dwStyle)) To bOk
82751>>>>>>>
82751>>>>>>>        If not bOK Begin
82753>>>>>>>            Error DFERR_WINPRINT DFPrintError906
82754>>>>>>>>
82754>>>>>>>        End
82754>>>>>>>>
82754>>>>>>>    End_Procedure
82755>>>>>>>
82755>>>>>>>
82755>>>>>>>    //***
82755>>>>>>>    Procedure DFSetUnderline boolean bUnderline
82757>>>>>>>        boolean bOk
82757>>>>>>>
82757>>>>>>>        Move (WP_SetFontUnderline(bUnderline)) To bOk
82758>>>>>>>
82758>>>>>>>        If not bOK Begin
82760>>>>>>>            Error DFERR_WINPRINT DFPrintError907
82761>>>>>>>>
82761>>>>>>>        End
82761>>>>>>>>
82761>>>>>>>    End_Procedure
82762>>>>>>>
82762>>>>>>>
82762>>>>>>>    //***
82762>>>>>>>    Procedure DFSetBold Boolean bBold
82764>>>>>>>        Boolean bOk
82764>>>>>>>
82764>>>>>>>        Move (WP_SetFontBold(bBold)) To bOk
82765>>>>>>>
82765>>>>>>>        If not bOK Begin
82767>>>>>>>            Error DFERR_WINPRINT DFPrintError908
82768>>>>>>>>
82768>>>>>>>        End
82768>>>>>>>>
82768>>>>>>>    End_Procedure
82769>>>>>>>
82769>>>>>>>
82769>>>>>>>    //***
82769>>>>>>>    Procedure DFSetItalic Boolean bItalic
82771>>>>>>>        Boolean bOk
82771>>>>>>>
82771>>>>>>>        Move (WP_SetFontItalic(bItalic)) To bOk
82772>>>>>>>
82772>>>>>>>        If not bOK Begin
82774>>>>>>>            Error DFERR_WINPRINT DFPrintError909
82775>>>>>>>>
82775>>>>>>>        End
82775>>>>>>>>
82775>>>>>>>    End_Procedure
82776>>>>>>>
82776>>>>>>>
82776>>>>>>>    //***
82776>>>>>>>    Procedure DFSetStrikeout Boolean bStrikeout
82778>>>>>>>        Boolean bOk
82778>>>>>>>
82778>>>>>>>        Move (WP_SetFontStrikeout(bStrikeout)) To bOk
82779>>>>>>>
82779>>>>>>>        If not bOK Begin
82781>>>>>>>            Error DFERR_WINPRINT DFPrintError910
82782>>>>>>>>
82782>>>>>>>        End
82782>>>>>>>>
82782>>>>>>>    End_Procedure
82783>>>>>>>
82783>>>>>>>
82783>>>>>>>    //***
82783>>>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
82785>>>>>>>        Boolean bOk
82785>>>>>>>        integer iLeft iRight iTop iBottom
82785>>>>>>>
82785>>>>>>>        Move (nLeft   * 100) to iLeft
82786>>>>>>>        Move (nRight  * 100) to iRight
82787>>>>>>>        Move (nTop    * 100) to iTop
82788>>>>>>>        Move (nBottom * 100) to iBottom
82789>>>>>>>
82789>>>>>>>        Move (WP_SetMargins(iLeft,iTop,iRight,iBottom)) To bOk
82790>>>>>>>
82790>>>>>>>        If bOk Begin
82792>>>>>>>            Set DFLeft_Margin   To nLeft
82793>>>>>>>            Set DFTop_Margin    To nTop
82794>>>>>>>            Set DFRight_Margin  To nRight
82795>>>>>>>            Set DFBottom_Margin To nBottom
82796>>>>>>>        End
82796>>>>>>>>
82796>>>>>>>        Else Begin
82797>>>>>>>            Error DFERR_WINPRINT DFPrintError911
82798>>>>>>>>
82798>>>>>>>        End
82798>>>>>>>>
82798>>>>>>>    End_Procedure
82799>>>>>>>
82799>>>>>>>
82799>>>>>>>    //***
82799>>>>>>>    Procedure DFSetLeftMargin Number nLeft
82801>>>>>>>        number  nTop nRight nBottom
82801>>>>>>>        Get DFTop_Margin    To nTop
82802>>>>>>>        Get DFRight_Margin  To nRight
82803>>>>>>>        Get DFBottom_Margin To nBottom
82804>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82805>>>>>>>    End_Procedure
82806>>>>>>>
82806>>>>>>>
82806>>>>>>>    //***
82806>>>>>>>    Procedure DFSetRightMargin Number nRight
82808>>>>>>>        number  nLeft nTop nBottom
82808>>>>>>>        Get DFLeft_Margin   To nLeft
82809>>>>>>>        Get DFTop_Margin    To nTop
82810>>>>>>>        Get DFBottom_Margin To nBottom
82811>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82812>>>>>>>    End_Procedure
82813>>>>>>>
82813>>>>>>>
82813>>>>>>>    //***
82813>>>>>>>    Procedure DFSetTopMargin Number nTop
82815>>>>>>>        number  nLeft nRight nBottom
82815>>>>>>>        Get DFLeft_Margin   To nLeft
82816>>>>>>>        Get DFRight_Margin  To nRight
82817>>>>>>>        Get DFBottom_Margin To nBottom
82818>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82819>>>>>>>    End_Procedure
82820>>>>>>>
82820>>>>>>>
82820>>>>>>>    //***
82820>>>>>>>    Procedure DFSetBottomMargin Number nBottom
82822>>>>>>>        number  nLeft nTop nRight
82822>>>>>>>        Get DFLeft_Margin   To nLeft
82823>>>>>>>        Get DFTop_Margin    To nTop
82824>>>>>>>        Get DFRight_Margin  To nRight
82825>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82826>>>>>>>    End_Procedure
82827>>>>>>>
82827>>>>>>>
82827>>>>>>>    //***
82827>>>>>>>    Procedure DFWriteText String sText Integer iStyle Integer iColumn Integer iDecimal Boolean bNewLineAfterPrint
82829>>>>>>>        Boolean bOk
82829>>>>>>>
82829>>>>>>>        Send DFSetFontStyle iStyle
82830>>>>>>>        Get ToAnsi sText To sText
82831>>>>>>>        Move (WP_WriteText(sText,bNewLineAfterPrint,iColumn,iDecimal,0)) To bOk
82832>>>>>>>        If not bOk Begin
82834>>>>>>>            Error DFERR_WINPRINT DFPrintError918
82835>>>>>>>>
82835>>>>>>>        End
82835>>>>>>>>
82835>>>>>>>        Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
82836>>>>>>>    End_Procedure
82837>>>>>>>
82837>>>>>>>    //***
82837>>>>>>>    Procedure DFWrite String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
82839>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
82841>>>>>>>            Move (Rtrim(sText)) to sText
82842>>>>>>>        end
82842>>>>>>>>
82842>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal False
82843>>>>>>>    End_Procedure
82844>>>>>>>
82844>>>>>>>    //***
82844>>>>>>>    Procedure DFWriteLn String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
82846>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
82848>>>>>>>            Move (Rtrim(sText)) to sText
82849>>>>>>>        end
82849>>>>>>>>
82849>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal True
82850>>>>>>>    End_Procedure
82851>>>>>>>
82851>>>>>>>
82851>>>>>>>    //***
82851>>>>>>>    Procedure DFWriteTextAtPosition String sText integer iStyle Number nPosition Integer iDecimal ;                                    Number nMaxLength Boolean bNewLineAfterPrint
82853>>>>>>>        Boolean bOk
82853>>>>>>>        Integer iPosition iMaxLength
82853>>>>>>>        Send DFSetFontStyle iStyle
82854>>>>>>>        Get ToAnsi sText To sText
82855>>>>>>>        Move (nPosition * 100) to iPosition
82856>>>>>>>        Move (nMaxLength * 100) to iMaxLength
82857>>>>>>>        Move (WP_WriteTextAtPosition(sText,bNewLineAfterPrint,iPosition,iDecimal,iMaxLength)) To bOk
82858>>>>>>>        If not bOk Begin
82860>>>>>>>            Error DFERR_WINPRINT DFPrintError922
82861>>>>>>>>
82861>>>>>>>        End
82861>>>>>>>>
82861>>>>>>>         Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
82862>>>>>>>    End_Procedure
82863>>>>>>>
82863>>>>>>>    //***
82863>>>>>>>    Procedure DFWritePos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
82865>>>>>>>        Number nMax
82865>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
82867>>>>>>>            Move (Rtrim(sText)) to sText
82868>>>>>>>        end
82868>>>>>>>>
82868>>>>>>>
82868>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
82871>>>>>>>        Else ;            Move nMaxLength to nMax
82873>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax False
82874>>>>>>>    End_Procedure
82875>>>>>>>
82875>>>>>>>    //***
82875>>>>>>>    Procedure DFWriteLnPos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
82877>>>>>>>        Number nMax
82877>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
82879>>>>>>>            Move (Rtrim(sText)) to sText
82880>>>>>>>        end
82880>>>>>>>>
82880>>>>>>>
82880>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
82883>>>>>>>        Else ;            Move nMaxLength to nMax
82885>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax True
82886>>>>>>>    End_Procedure
82887>>>>>>>
82887>>>>>>>    Procedure DFSetMetrics String sMetrics
82889>>>>>>>        integer eMetrics
82889>>>>>>>        // for backwards compatibility support both string names and integer enumerations
82889>>>>>>>        // it is better to use the enumeration value
82889>>>>>>>        If (sMetrics="INCH" or sMetrics="CM") Begin
82891>>>>>>>            Set DFCurrent_Metrics to sMetrics
82892>>>>>>>        end
82892>>>>>>>>
82892>>>>>>>        else Begin
82893>>>>>>>            Move sMetrics to eMetrics
82894>>>>>>>            Move (WP_SetMetrics(eMetrics)) To eMetrics
82895>>>>>>>        End
82895>>>>>>>>
82895>>>>>>>    End_Procedure
82896>>>>>>>
82896>>>>>>>    Function DFGetMetrics Returns Integer
82898>>>>>>>        Integer eMetrics
82898>>>>>>>        Move (WP_GetMetrics()) To eMetrics
82899>>>>>>>        Function_return eMetrics
82900>>>>>>>    End_Function
82901>>>>>>>
82901>>>>>>>
82901>>>>>>>    //**** Properties Maintained for compatibility with old Winprint (obsolete)
82901>>>>>>>    Function DFCurrent_Metrics returns string
82903>>>>>>>        Integer eMetrics
82903>>>>>>>        Get DFGetMetrics to eMetrics
82904>>>>>>>        Function_return (if(eMetrics=WPM_INCH,"INCH","CM"))
82905>>>>>>>    end_function
82906>>>>>>>
82906>>>>>>>    Procedure Set DFCurrent_Metrics string sCMorINCH
82908>>>>>>>        Send DFSetMetrics (if(sCMorINCH="INCH", WPM_INCH, WPM_CM))
82909>>>>>>>    End_Procedure
82910>>>>>>>
82910>>>>>>>
82910>>>>>>>
82910>>>>>>>
82910>>>>>>>
82910>>>>>>>    //***
82910>>>>>>>    Procedure DFBeginHeaderType Integer iHeaderNr Integer eHeaderType
82912>>>>>>>        Boolean bOk
82912>>>>>>>
82912>>>>>>>        If (eHeaderType=DFSubHeader or eHeaderType=DFSubTotal) Begin
82914>>>>>>>            //*** Do nothing for the moment
82914>>>>>>>        End
82914>>>>>>>>
82914>>>>>>>        Else ;            Move 0 to iHeaderNr // If the user made a mistake
82916>>>>>>>
82916>>>>>>>        Set DFCurrent_HeaderType To eHeaderType
82917>>>>>>>        Set DFCurrent_HeaderNr   To iHeaderNr
82918>>>>>>>
82918>>>>>>>        Move (WP_BeginHeader(eHeaderType, iHeaderNr)) To bOk
82919>>>>>>>
82919>>>>>>>        If not bOk Begin
82921>>>>>>>            Error DFERR_WINPRINT DFPrintError925
82922>>>>>>>>
82922>>>>>>>        End
82922>>>>>>>>
82922>>>>>>>    End_Procedure
82923>>>>>>>
82923>>>>>>>
82923>>>>>>>    //***
82923>>>>>>>    Procedure DFEndHeaderType
82925>>>>>>>        Boolean bOk
82925>>>>>>>
82925>>>>>>>        Move (WP_EndHeader()) To bOk
82926>>>>>>>
82926>>>>>>>        if not bOk begin
82928>>>>>>>            Error DFERR_WINPRINT DFPrintError926
82929>>>>>>>>
82929>>>>>>>        End
82929>>>>>>>>
82929>>>>>>>    End_Procedure
82930>>>>>>>
82930>>>>>>>
82930>>>>>>>    //***
82930>>>>>>>    Procedure DFWriteHeaderType Integer iHeaderNr Integer eHeaderType
82932>>>>>>>        Boolean bOk
82932>>>>>>>        Move (WP_WriteHeader(eHeaderType, iHeaderNr)) To bOk
82933>>>>>>>        if not bOk begin
82935>>>>>>>            Error DFERR_WINPRINT DFPrintError927
82936>>>>>>>>
82936>>>>>>>        End
82936>>>>>>>>
82936>>>>>>>    End_Procedure
82937>>>>>>>
82937>>>>>>>
82937>>>>>>>    //***
82937>>>>>>>    Procedure DFHeaderPosition Integer ePlace
82939>>>>>>>        Boolean bOk
82939>>>>>>>
82939>>>>>>>         Move (WP_SetHeaderPlacement(ePlace)) To bOk
82940>>>>>>>
82940>>>>>>>         if not bOk begin
82942>>>>>>>            Error DFERR_WINPRINT DFPrintError929
82943>>>>>>>>
82943>>>>>>>        End
82943>>>>>>>>
82943>>>>>>>    End_Procedure
82944>>>>>>>
82944>>>>>>>
82944>>>>>>>    //***
82944>>>>>>>    Procedure DFHeaderFrameType Integer eFrame integer iColor Number nWeight;                                Integer iFillColor Boolean bFillFrame
82946>>>>>>>        Integer iWeight
82946>>>>>>>        Boolean bOk
82946>>>>>>>
82946>>>>>>>        move (nWeight*100) To iWeight
82947>>>>>>>
82947>>>>>>>        Move (WP_SetHeaderFrame(eFrame,iColor,iWeight,iFillColor,bFillFrame)) To bOk
82948>>>>>>>
82948>>>>>>>         if not bOk begin
82950>>>>>>>            Error DFERR_WINPRINT DFPrintError930
82951>>>>>>>>
82951>>>>>>>        End
82951>>>>>>>>
82951>>>>>>>    End_Procedure
82952>>>>>>>
82952>>>>>>>  Procedure DFHeaderMargin Integer eType Number nSize
82954>>>>>>>        Boolean bOk
82954>>>>>>>        Integer iSize
82954>>>>>>>
82954>>>>>>>        move (nSize * 100) to iSize
82955>>>>>>>
82955>>>>>>>        move (WP_SetHeaderMargin(eType, iSize)) To bOk
82956>>>>>>>
82956>>>>>>>        if not bOk begin
82958>>>>>>>            Error DFERR_WINPRINT DFPrintError930
82959>>>>>>>>
82959>>>>>>>        end
82959>>>>>>>>
82959>>>>>>>    End_Procedure
82960>>>>>>>
82960>>>>>>>
82960>>>>>>>    //***
82960>>>>>>>    Procedure DFHeaderWrap Integer eOnOff
82962>>>>>>>         Boolean bOk
82962>>>>>>>
82962>>>>>>>         Move (WP_SetHeaderWrap(eOnOff)) To bOk
82963>>>>>>>
82963>>>>>>>         if not bOk begin
82965>>>>>>>            Error DFERR_WINPRINT DFPrintError931
82966>>>>>>>>
82966>>>>>>>        End
82966>>>>>>>>
82966>>>>>>>    End_Procedure
82967>>>>>>>
82967>>>>>>>    //***
82967>>>>>>>    Procedure DFWriteBMP String sFileName Number nStartX Number nStartY Number nHeight Number nWidth Boolean bUCp
82969>>>>>>>        Boolean bOk
82969>>>>>>>        Integer iStartX iStartY iHeight iWidth
82969>>>>>>>
82969>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX to iStartX
82972>>>>>>>        else ;            move (nStartX*100) To iStartX
82974>>>>>>>
82974>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY to iStartY
82977>>>>>>>        else ;            move (nStartY*100) To iStartY
82979>>>>>>>
82979>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
82982>>>>>>>        else ;            move (nWidth*100) To iWidth
82984>>>>>>>
82984>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
82987>>>>>>>        else ;            move (nHeight*100) To iHeight
82989>>>>>>>
82989>>>>>>>        Get_File_Path sFileName To sFileName
82990>>>>>>>        Move (WP_DrawBitmap(sFileName,iStartX,iStartY,iWidth,iHeight,bUCp)) to bOk
82991>>>>>>>
82991>>>>>>>        If not bOk Begin
82993>>>>>>>            Error DFERR_WINPRINT DFPrintError932
82994>>>>>>>>
82994>>>>>>>        End
82994>>>>>>>>
82994>>>>>>>    End_Procedure
82995>>>>>>>
82995>>>>>>>
82995>>>>>>>    //***
82995>>>>>>>    Procedure DFHeaderLineCheck Integer iLines
82997>>>>>>>        Boolean bOk
82997>>>>>>>
82997>>>>>>>         Move (WP_SetExtraLineCheck(iLines)) To bOk
82998>>>>>>>
82998>>>>>>>        If not bOk begin
83000>>>>>>>            Error DFERR_WINPRINT DFPrintError934
83001>>>>>>>>
83001>>>>>>>        End
83001>>>>>>>>
83001>>>>>>>    End_Procedure
83002>>>>>>>
83002>>>>>>>
83002>>>>>>>    //***
83002>>>>>>>    Procedure DFPrintFlags Integer Flags
83004>>>>>>>        Boolean bOk
83004>>>>>>>
83004>>>>>>>         Move (WP_SetPrintDialogFlags(Flags)) To bOk
83005>>>>>>>
83005>>>>>>>        If not bOk begin
83007>>>>>>>            Error DFERR_WINPRINT DFPrintError935
83008>>>>>>>>
83008>>>>>>>        End
83008>>>>>>>>
83008>>>>>>>    End_Procedure
83009>>>>>>>
83009>>>>>>>
83009>>>>>>>    //*** obsolete and maintained for winprint-I backwards compatibility (maybe should be removed)
83009>>>>>>>    //
83009>>>>>>>    Procedure DFSelectPrinter String sDriver String sDevice String sPort Boolean bUpdate
83011>>>>>>>        Send DFSetDevice sDevice
83012>>>>>>>    End_Procedure
83013>>>>>>>
83013>>>>>>>    //*** Preferred usage for WinprintII
83013>>>>>>>    Procedure DFSetDevice String sDevice
83015>>>>>>>        Boolean bOk
83015>>>>>>>
83015>>>>>>>        Move (WP_SelectPrinter(sDevice)) To bOk
83016>>>>>>>
83016>>>>>>>        If not bOk Begin
83018>>>>>>>            Error DFERR_WINPRINT DFPrintError936
83019>>>>>>>>
83019>>>>>>>        End
83019>>>>>>>>
83019>>>>>>>    End_Procedure
83020>>>>>>>
83020>>>>>>>    Procedure DFPrinterBinFirstPage Integer eBin
83022>>>>>>>        Boolean bOk
83022>>>>>>>
83022>>>>>>>         Move (WP_SetFirstPagePaperSource(eBin)) To bOk
83023>>>>>>>
83023>>>>>>>        If not bOk Begin
83025>>>>>>>            Error DFERR_WINPRINT DFPrintError937
83026>>>>>>>>
83026>>>>>>>        End
83026>>>>>>>>
83026>>>>>>>    End_Procedure
83027>>>>>>>
83027>>>>>>>
83027>>>>>>>    //***
83027>>>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
83029>>>>>>>        Integer iColor
83029>>>>>>>
83029>>>>>>>         Move (WP_RGBToDFPrintColor(iRed,iGreen,iBlue)) To iColor
83030>>>>>>>
83030>>>>>>>        If (iColor=0) Begin
83032>>>>>>>            Error DFERR_WINPRINT DFPrintError938
83033>>>>>>>>
83033>>>>>>>        End
83033>>>>>>>>
83033>>>>>>>        Function_Return iColor
83034>>>>>>>    End_Function
83035>>>>>>>
83035>>>>>>>
83035>>>>>>>    //***
83035>>>>>>>    Procedure DFSetDFColor Dword dwColor
83037>>>>>>>        Integer bOk
83037>>>>>>>
83037>>>>>>>         Move (WP_SetFontColor(dwColor)) To bOk
83038>>>>>>>
83038>>>>>>>        If not bOk Begin
83040>>>>>>>            Error DFERR_WINPRINT DFPrintError939
83041>>>>>>>>
83041>>>>>>>        End
83041>>>>>>>>
83041>>>>>>>    End_Procedure
83042>>>>>>>
83042>>>>>>>
83042>>>>>>>    //***
83042>>>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
83044>>>>>>>        Boolean bOk
83044>>>>>>>        Integer iTop iBottom
83044>>>>>>>
83044>>>>>>>        move (nTop*100)    To iTop
83045>>>>>>>        move (nBottom*100) To iBottom
83046>>>>>>>
83046>>>>>>>        Move (WP_SetAbsoluteMargins(iTop,iBottom,bAllPages)) To bOk
83047>>>>>>>
83047>>>>>>>        If Not bOk Begin
83049>>>>>>>            Error DFERR_WINPRINT DFPrintError940
83050>>>>>>>>
83050>>>>>>>        End
83050>>>>>>>>
83050>>>>>>>    End_Procedure
83051>>>>>>>
83051>>>>>>>
83051>>>>>>>    //***
83051>>>>>>>    Procedure DFSetJMode Integer eAlign
83053>>>>>>>        Boolean bOk
83053>>>>>>>
83053>>>>>>>        Move (WP_SetAlign(eAlign)) To bOk
83054>>>>>>>
83054>>>>>>>        If Not bOk Begin
83056>>>>>>>            Error DFERR_WINPRINT DFPrintError941
83057>>>>>>>>
83057>>>>>>>        End
83057>>>>>>>>
83057>>>>>>>    End_Procedure
83058>>>>>>>
83058>>>>>>>
83058>>>>>>>    //***
83058>>>>>>>    Procedure DFWriteEllip Number nStartX Number nStartY Number nHeight Number nWidth ;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
83060>>>>>>>
83060>>>>>>>        Boolean bOk
83060>>>>>>>        Integer iWeight
83060>>>>>>>        Integer iStartX iStartY iHeight iWidth
83060>>>>>>>
83060>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
83063>>>>>>>        else ;            move (nStartX*100) To iStartX
83065>>>>>>>
83065>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
83068>>>>>>>        else ;            move (nStartY*100) To iStartY
83070>>>>>>>
83070>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
83073>>>>>>>        else ;            move (nWidth*100) To iWidth
83075>>>>>>>
83075>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
83078>>>>>>>        else ;            move (nHeight*100) To iHeight
83080>>>>>>>
83080>>>>>>>        move (nWeight*100) To iWeight
83081>>>>>>>
83081>>>>>>>
83081>>>>>>>        Move (WP_DrawEllipse(iStartX,iStartY,iWidth,iHeight,;                        dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
83082>>>>>>>
83082>>>>>>>        If Not bOk Begin
83084>>>>>>>            Error DFERR_WINPRINT DFPrintError942
83085>>>>>>>>
83085>>>>>>>        End
83085>>>>>>>>
83085>>>>>>>    End_Procedure
83086>>>>>>>
83086>>>>>>>
83086>>>>>>>
83086>>>>>>>
83086>>>>>>>    //***
83086>>>>>>>    Procedure DFWriteRect Number nStartX Number nStartY Number nHeight Number nWidth;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
83088>>>>>>>
83088>>>>>>>        Boolean bOk
83088>>>>>>>        Integer iWeight
83088>>>>>>>        Integer iStartX iStartY iHeight iWidth
83088>>>>>>>
83088>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
83091>>>>>>>        else ;            move (nStartX*100) To iStartX
83093>>>>>>>
83093>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
83096>>>>>>>        else ;            move (nStartY*100) To iStartY
83098>>>>>>>
83098>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
83101>>>>>>>        else ;            move (nWidth*100) To iWidth
83103>>>>>>>
83103>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
83106>>>>>>>        else ;            move (nHeight*100) To iHeight
83108>>>>>>>
83108>>>>>>>        move (nWeight*100) To iWeight
83109>>>>>>>
83109>>>>>>>        Move (WP_DrawRectangle(iStartX,iStartY,iWidth,iHeight,;                            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
83110>>>>>>>
83110>>>>>>>        If Not bOk Begin
83112>>>>>>>            Error DFERR_WINPRINT DFPrintError944
83113>>>>>>>>
83113>>>>>>>        End
83113>>>>>>>>
83113>>>>>>>    End_Procedure
83114>>>>>>>
83114>>>>>>>
83114>>>>>>>
83114>>>>>>>
83114>>>>>>>    //***
83114>>>>>>>    Procedure DFLineCheck Integer iLines
83116>>>>>>>        Boolean bOk
83116>>>>>>>
83116>>>>>>>        Move (WP_ConfirmLines(iLines)) To bOk
83117>>>>>>>
83117>>>>>>>        If Not bOk Begin
83119>>>>>>>            Error DFERR_WINPRINT DFPrintError946
83120>>>>>>>>
83120>>>>>>>        End
83120>>>>>>>>
83120>>>>>>>    End_Procedure
83121>>>>>>>
83121>>>>>>>
83121>>>>>>>    //***
83121>>>>>>>    Procedure DFCreateDiagram Integer eType Integer eFx Number nHeight Number nWidth Integer bXyAxis
83123>>>>>>>        Handle hDiagram
83123>>>>>>>        Integer iWidth iHeight
83123>>>>>>>
83123>>>>>>>        move (nHeight*100) To iHeight
83124>>>>>>>        move (nWidth*100)  To iWidth
83125>>>>>>>
83125>>>>>>>        Set DFCurrent_Color To 0
83126>>>>>>>
83126>>>>>>>        Move (WP_CreateDiagram(eType,eFx,iWidth,iHeight,bXyAxis)) To hDiagram
83127>>>>>>>
83127>>>>>>>        If (hDiagram) Begin
83129>>>>>>>            Error DFERR_WINPRINT DFPrintError947
83130>>>>>>>>
83130>>>>>>>        End
83130>>>>>>>>
83130>>>>>>>        Else Begin
83131>>>>>>>            Set DFCurrent_Diagram To hDiagram
83132>>>>>>>        end
83132>>>>>>>>
83132>>>>>>>    End_Procedure
83133>>>>>>>
83133>>>>>>>
83133>>>>>>>    //***
83133>>>>>>>    Procedure DFDiagram_Item handle hDiagram String sLabel Number nValue;                             Dword dwBColor Dword dwFColor Integer eFill;                             Integer iDec Integer eValueOrPercent Integer eExt
83135>>>>>>>
83135>>>>>>>        Boolean bOk
83135>>>>>>>        Integer iCurrColor iValue
83135>>>>>>>
83135>>>>>>>        If (dwFColor = -1) Begin
83137>>>>>>>            Get DFCurrent_Color To iCurrColor
83138>>>>>>>            Increment iCurrColor
83139>>>>>>>            If (iCurrColor>15) Move 1 To iCurrColor
83142>>>>>>>            Set DFCurrent_Color To iCurrColor
83143>>>>>>>            Get DFGetColor iCurrColor To dwFColor
83144>>>>>>>        End
83144>>>>>>>>
83144>>>>>>>
83144>>>>>>>        Move (nValue *100) to iValue
83145>>>>>>>
83145>>>>>>>        Get ToAnsi sLabel To sLabel
83146>>>>>>>
83146>>>>>>>        Move (WP_AddDiagramEntry(hDiagram,sLabel,iValue,dwBColor,dwFColor,eFill,iDec,eValueorPercent,eExt)) To bOk
83147>>>>>>>
83147>>>>>>>        If not bOk Begin
83149>>>>>>>            Error DFERR_WINPRINT DFPrintError948
83150>>>>>>>>
83150>>>>>>>        End
83150>>>>>>>>
83150>>>>>>>    End_Procedure
83151>>>>>>>
83151>>>>>>>
83151>>>>>>>    //***
83151>>>>>>>    Procedure DFLockDiagram Handle hDiagram
83153>>>>>>>        Boolean bOk
83153>>>>>>>
83153>>>>>>>        Move (WP_LockDiagram(hDiagram)) To bOk
83154>>>>>>>
83154>>>>>>>        If not bOk Begin
83156>>>>>>>            Error DFERR_WINPRINT DFPrintError949
83157>>>>>>>>
83157>>>>>>>        End
83157>>>>>>>>
83157>>>>>>>    End_Procedure
83158>>>>>>>
83158>>>>>>>
83158>>>>>>>
83158>>>>>>>    //***
83158>>>>>>>    Procedure DFDrawDiagram Handle hDiagram Number nYPos Number nXPos Boolean bUCp
83160>>>>>>>        Boolean bOk
83160>>>>>>>        Integer iXPos
83160>>>>>>>        Integer iYPos
83160>>>>>>>
83160>>>>>>>        move (nXPos*100) To iXPos
83161>>>>>>>        move (nYPos*100) To iYPos
83162>>>>>>>
83162>>>>>>>        If nYPos Eq -999 Move -999 To iYPos
83165>>>>>>>
83165>>>>>>>        Move (WP_DrawDiagram(hDiagram,iXPos,iYPos,bUCp)) To bOk
83166>>>>>>>
83166>>>>>>>        If not bOk Begin
83168>>>>>>>            Error DFERR_WINPRINT DFPrintError950
83169>>>>>>>>
83169>>>>>>>        End
83169>>>>>>>>
83169>>>>>>>    End_Procedure
83170>>>>>>>
83170>>>>>>>
83170>>>>>>>
83170>>>>>>>    //***
83170>>>>>>>    Procedure DFDiagramLabel handle hDiagram String sLabel
83172>>>>>>>        Boolean bOk
83172>>>>>>>        Integer iLabelLen
83172>>>>>>>
83172>>>>>>>        Get ToAnsi sLabel To sLabel
83173>>>>>>>
83173>>>>>>>        Move (WP_SetDiagramCaption(hDiagram,sLabel)) To bOk
83174>>>>>>>
83174>>>>>>>        if not bOk Begin
83176>>>>>>>            Error DFERR_WINPRINT DFPrintError952
83177>>>>>>>>
83177>>>>>>>        End
83177>>>>>>>>
83177>>>>>>>    End_Procedure
83178>>>>>>>
83178>>>>>>>
83178>>>>>>>    //***
83178>>>>>>>    Procedure DFDiagramXLabel handle hDiagram String sLabel
83180>>>>>>>        Boolean bOk
83180>>>>>>>        Get ToAnsi sLabel To sLabel
83181>>>>>>>
83181>>>>>>>        Move (WP_SetDiagramXText(hDiagram,sLabel)) To bOk
83182>>>>>>>
83182>>>>>>>        if not bOk Begin
83184>>>>>>>            Error DFERR_WINPRINT DFPrintError953
83185>>>>>>>>
83185>>>>>>>        End
83185>>>>>>>>
83185>>>>>>>    End_Procedure
83186>>>>>>>
83186>>>>>>>
83186>>>>>>>    //***
83186>>>>>>>    Procedure DFDiagramYLabel handle hDiagram String sLabel Boolean bVertical
83188>>>>>>>        Boolean bOk
83188>>>>>>>        Get ToAnsi sLabel To sLabel
83189>>>>>>>
83189>>>>>>>        Move (WP_SetDiagramYText(hDiagram,sLabel,bVertical)) To bOk
83190>>>>>>>
83190>>>>>>>        if not bOk Begin
83192>>>>>>>            Error DFERR_WINPRINT DFPrintError954
83193>>>>>>>>
83193>>>>>>>        End
83193>>>>>>>>
83193>>>>>>>    End_Procedure
83194>>>>>>>
83194>>>>>>>
83194>>>>>>>    //***
83194>>>>>>>    Procedure DFWriteXYLine Number nStartX Number nStartY Number nStopX Number nStopY;              Dword dwColor Number nWeight Boolean bWrap Boolean bUCp
83196>>>>>>>
83196>>>>>>>        Boolean bOk
83196>>>>>>>        Integer iStartX iStartY iStopX iStopY
83196>>>>>>>        Integer iWeight
83196>>>>>>>
83196>>>>>>>        move (nStartX*100)  To iStartX
83197>>>>>>>        move (nStartY*100)  To iStartY
83198>>>>>>>        move (nStopX*100)   To iStopX
83199>>>>>>>        move (nStopY*100)   To iStopY
83200>>>>>>>
83200>>>>>>>        move (nWeight*100) To iWeight
83201>>>>>>>
83201>>>>>>>        If (nStopY  = -998) Move -998 To iStopY
83204>>>>>>>        If (nStopX  = -998) Move -998 To iStopX
83207>>>>>>>
83207>>>>>>>        If (nStartY  = -999) Move -999 To iStartY
83210>>>>>>>        If (nStartX  = -999) Move -999 To iStartX
83213>>>>>>>
83213>>>>>>>        Move (WP_DrawXYLine(iStartX,iStartY,iStopX,iStopY,dwColor,iWeight,bUCp,bWrap)) To bOk
83214>>>>>>>
83214>>>>>>>        if not bOk Begin
83216>>>>>>>            Error DFERR_WINPRINT DFPrintError955
83217>>>>>>>>
83217>>>>>>>        End
83217>>>>>>>>
83217>>>>>>>    End_Procedure
83218>>>>>>>
83218>>>>>>>
83218>>>>>>>    //***
83218>>>>>>>    Procedure DFWriteLine Number nStartX Number nStartY Number nLength;                          Boolean bHorizontal Dword dwColor Number nWeight Boolean bUCp
83220>>>>>>>
83220>>>>>>>        Boolean bOk
83220>>>>>>>        Integer iStartX iStartY iLength
83220>>>>>>>        Integer iWeight
83220>>>>>>>
83220>>>>>>>        move (nStartX*100)  To iStartX
83221>>>>>>>        move (nStartY*100)  To iStartY
83222>>>>>>>        move (nLength*100)  To iLength
83223>>>>>>>        move (nWeight*100)  To iWeight
83224>>>>>>>
83224>>>>>>>        If (nStartY = -999) Move -999 To iStartY
83227>>>>>>>        If (nStartX = -999) Move -999 To iStartX
83230>>>>>>>        If (nLength = -998) Move -998 To iLength
83233>>>>>>>
83233>>>>>>>        Move (WP_DrawLine(iSTartX,iStartY,iLength,bHorizontal,dwColor,iWeight,bUCp)) To bOk
83234>>>>>>>
83234>>>>>>>        if not bOk Begin
83236>>>>>>>            Error DFERR_WINPRINT DFPrintError956
83237>>>>>>>>
83237>>>>>>>        End
83237>>>>>>>>
83237>>>>>>>    End_Procedure
83238>>>>>>>
83238>>>>>>>
83238>>>>>>>    //***
83238>>>>>>>    Procedure DFClearPrinter
83240>>>>>>>        Boolean bOk
83240>>>>>>>
83240>>>>>>>        Move (WP_ClearPrinter()) To bOk
83241>>>>>>>
83241>>>>>>>        If not bOk Begin
83243>>>>>>>            Error DFERR_WINPRINT DFPrintError957
83244>>>>>>>>
83244>>>>>>>        End
83244>>>>>>>>
83244>>>>>>>    End_Procedure
83245>>>>>>>
83245>>>>>>>
83245>>>>>>>
83245>>>>>>>    //***
83245>>>>>>>     Function DFGetCurrentDevice Returns String
83247>>>>>>>        Boolean bOk
83247>>>>>>>        String  sDFStr
83247>>>>>>>        Address pDFStr
83247>>>>>>>
83247>>>>>>>        Move (Repeat( Character(0), 255 )) to sDFStr
83248>>>>>>>        GetAddress of sDFStr to pDFStr
83249>>>>>>>
83249>>>>>>>        Move (WP_GetCurrentDevice(pDFStr)) To bOk
83250>>>>>>>
83250>>>>>>>        If not bOk Begin
83252>>>>>>>            Error DFERR_WINPRINT DFPrintError959
83253>>>>>>>>
83253>>>>>>>        End
83253>>>>>>>>
83253>>>>>>>
83253>>>>>>>        Move (CString(sDFStr)) To sDFStr
83254>>>>>>>        Function_Return sDFStr
83255>>>>>>>     End_Function
83256>>>>>>>
83256>>>>>>>
83256>>>>>>>    // Note: DfGetCurrentPort and DFGetCurrentDriver do not exist in winprint2. Trying to
83256>>>>>>>    //       use these will result in a runtime error (which is good - don't use them)
83256>>>>>>>
83256>>>>>>>
83256>>>>>>>    //***
83256>>>>>>>     Function DFGetPrintDialogFlags Returns Dword
83258>>>>>>>        Dword dwRetVal
83258>>>>>>>
83258>>>>>>>        Move (WP_GetPrintDialogFlags()) To dwRetVal
83259>>>>>>>
83259>>>>>>>        Function_Return dwRetVal
83260>>>>>>>     End_Function
83261>>>>>>>
83261>>>>>>>
83261>>>>>>>    //***
83261>>>>>>>    //*** Returns PRN_TRUE=  if the flag is set     (1)
83261>>>>>>>    //*** Returns PRN_FALSE= If the flag not is set (0)
83261>>>>>>>    //***
83261>>>>>>>     Function DFCheckPrintDialogFlag Dword dwPDFlag Returns Boolean
83263>>>>>>>        Boolean bIsSet
83263>>>>>>>
83263>>>>>>>        Move (WP_IsPrintDialogFlagSet(dwPDFlag)) To bIsSet
83264>>>>>>>
83264>>>>>>>        Function_Return bIsSet
83265>>>>>>>     End_Function
83266>>>>>>>
83266>>>>>>>
83266>>>>>>>    //***
83266>>>>>>>     Procedure DFSetSpecPrintFlag Dword dwPDFlag
83268>>>>>>>        Boolean bOk
83268>>>>>>>
83268>>>>>>>        Move (WP_SetSpecificPrintDialogFlag(dwPDFlag)) To bOk
83269>>>>>>>
83269>>>>>>>        If not bOk Begin
83271>>>>>>>            Error DFERR_WINPRINT DFPrintError961
83272>>>>>>>>
83272>>>>>>>        End
83272>>>>>>>>
83272>>>>>>>     End_Procedure
83273>>>>>>>
83273>>>>>>>
83273>>>>>>>    //***
83273>>>>>>>     Function DFGetUserDefinedLength Returns Number
83275>>>>>>>        Integer iRetVal
83275>>>>>>>        Number  nRetVal
83275>>>>>>>
83275>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
83276>>>>>>>
83276>>>>>>>        If (iRetVal=0) Begin
83278>>>>>>>            Error DFERR_WINPRINT DFPrintError962
83279>>>>>>>>
83279>>>>>>>            Function_Return 0
83280>>>>>>>        End
83280>>>>>>>>
83280>>>>>>>
83280>>>>>>>        Move (Hi(iRetVal)) To nRetVal
83281>>>>>>>        move (nRetVal/100) To nRetVal //Returns CM
83282>>>>>>>
83282>>>>>>>        Function_Return nRetVal
83283>>>>>>>     End_Function
83284>>>>>>>
83284>>>>>>>
83284>>>>>>>    //***
83284>>>>>>>     Function DFGetUserDefinedWidth Returns Number
83286>>>>>>>        Integer iRetVal
83286>>>>>>>        Number  nRetVal
83286>>>>>>>
83286>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
83287>>>>>>>
83287>>>>>>>        If (iRetVal=0) Begin
83289>>>>>>>            Error DFERR_WINPRINT DFPrintError963
83290>>>>>>>>
83290>>>>>>>            Function_Return 0
83291>>>>>>>        End
83291>>>>>>>>
83291>>>>>>>
83291>>>>>>>        Move (Low(iRetVal)) To nRetVal
83292>>>>>>>        Move (nRetVal/100) To nRetVal //Returns CM
83293>>>>>>>
83293>>>>>>>        Function_Return nRetVal
83294>>>>>>>     End_Function
83295>>>>>>>
83295>>>>>>>
83295>>>>>>>    //*** To be set in CM
83295>>>>>>>     Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
83297>>>>>>>        Integer bOk
83297>>>>>>>        Integer iLength iWidth iSize
83297>>>>>>>
83297>>>>>>>        move (nLength*100) To iLength
83298>>>>>>>        move (nWidth*100)  To iWidth
83299>>>>>>>        move ((iLength*65536)+iWidth) To iSize
83300>>>>>>>
83300>>>>>>>        Move (WP_SetUserDefinedPapersize(iSize)) To bOk
83301>>>>>>>
83301>>>>>>>        If not bOk Begin
83303>>>>>>>            Error DFERR_WINPRINT DFPrintError964
83304>>>>>>>>
83304>>>>>>>        End
83304>>>>>>>>
83304>>>>>>>     End_Procedure
83305>>>>>>>
83305>>>>>>>     Procedure DFSetNumberOfCopies Integer iNrOfCopies
83307>>>>>>>        Boolean bOk
83307>>>>>>>
83307>>>>>>>        Move (WP_SetNumberOfPrintCopies(iNrOfCopies)) to bOk
83308>>>>>>>
83308>>>>>>>        If not bOk Begin
83310>>>>>>>            Error DFERR_WINPRINT DFPrintError965
83311>>>>>>>>
83311>>>>>>>        end
83311>>>>>>>>
83311>>>>>>>     End_Procedure
83312>>>>>>>
83312>>>>>>>
83312>>>>>>>
83312>>>>>>>
83312>>>>>>>    //*************************************************************
83312>>>>>>>    //*** This procedures and functions are used when building  ***
83312>>>>>>>    //*** complex graphics when you need to change value of the ***
83312>>>>>>>    //*** current diagram, so you can mix diagrams within each  ***
83312>>>>>>>    //*** other.                                                ***
83312>>>>>>>    //*************************************************************
83312>>>>>>>
83312>>>>>>>
83312>>>>>>>    Function DFGetCurrentDiagram Returns Integer
83314>>>>>>>        Integer iRetVal
83314>>>>>>>        Get DFCurrent_Diagram To iRetVal
83315>>>>>>>        Function_Return iRetVal
83316>>>>>>>    End_Function
83317>>>>>>>
83317>>>>>>>    Procedure DFSetCurrentDiagram Integer iDiagram
83319>>>>>>>        Set DFCurrent_Diagram To iDiagram
83320>>>>>>>    End_Procedure
83321>>>>>>>
83321>>>>>>>    Procedure DFSetDiagramList Integer iItem Integer iDiagram
83323>>>>>>>        Set Value of oDiagramArray iItem To iDiagram
83324>>>>>>>    End_Procedure
83325>>>>>>>
83325>>>>>>>    Function DFGetDiagramList Integer iItem Returns Integer
83327>>>>>>>        Integer iRetVal
83327>>>>>>>        Get Value of oDiagramArray iItem To iRetVal
83328>>>>>>>        Function_Return iRetVal
83329>>>>>>>    End_Function
83330>>>>>>>
83330>>>>>>>    Procedure DFClearDiagramList
83332>>>>>>>        Send Delete_Data To oDiagramArray
83333>>>>>>>    End_Procedure
83334>>>>>>>
83334>>>>>>>
83334>>>>>>>    Function DFGetColor Integer iColor Returns Dword
83336>>>>>>>        Dword   dwRetVal
83336>>>>>>>        Get Value of oDFColorArray iColor To dwRetVal
83337>>>>>>>        Function_Return dwRetVal
83338>>>>>>>    End_Function
83339>>>>>>>
83339>>>>>>>    Function DFGetCurrentColor Returns Dword
83341>>>>>>>        Dword   dwRetVal
83341>>>>>>>        Integer iCurrColor
83341>>>>>>>
83341>>>>>>>        Get DFCurrent_Color To iCurrColor
83342>>>>>>>        Get DFGetColor iCurrColor To dwRetVal
83343>>>>>>>
83343>>>>>>>        Function_Return dwRetVal
83344>>>>>>>    End_Function
83345>>>>>>>
83345>>>>>>>    Procedure DFEndDocument
83347>>>>>>>        integer iVoid
83347>>>>>>>        Move (WP_EndDocument()) To iVoid
83348>>>>>>>        Send DfSuspendGui False
83349>>>>>>>    End_procedure
83350>>>>>>>
83350>>>>>>>    Procedure DFClosePreview
83352>>>>>>>        integer iVoid
83352>>>>>>>        Move (WP_ClosePreview()) To iVoid
83353>>>>>>>        Send DfSuspendGui False
83354>>>>>>>    End_procedure
83355>>>>>>>
83355>>>>>>>    Procedure SetProgressCaption string sCaption
83357>>>>>>>        integer iVoid
83357>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
83358>>>>>>>        Move (WP_SetProgressCaption(sCaption)) To iVoid
83359>>>>>>>    End_procedure
83360>>>>>>>
83360>>>>>>>    Procedure SetReportTitle string sTitle
83362>>>>>>>        integer iVoid
83362>>>>>>>        Move (ToAnsi(sTitle)) to sTitle
83363>>>>>>>        Move (WP_SetReportTitle(sTitle)) To iVoid
83364>>>>>>>    End_procedure
83365>>>>>>>
83365>>>>>>>    Function PreviewYesNoBox string sCaption string sText returns integer
83367>>>>>>>        integer eResult
83367>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
83368>>>>>>>        Move (ToAnsi(sText))    to sText
83369>>>>>>>        Move (WP_DisplayMessageBox(sCaption, sText)) To eResult
83370>>>>>>>        Function_return eResult
83371>>>>>>>    end_function
83372>>>>>>>
83372>>>>>>>    // internal function, used to extract different printer flags ranges based on
83372>>>>>>>    // the print flag integer. These flags use a decimal style of packing information
83372>>>>>>>    // where different printer options (paper, bin, etc) use different ranges and
83372>>>>>>>    // different steps. Everything above iTopVal is removed and everything that is not
83372>>>>>>>    // within the iStep range is removed.
83372>>>>>>>    Function PrintFlagRange integer iTopVal integer iStep returns integer
83374>>>>>>>        integer iFgs iFg
83374>>>>>>>        Get DFGetPrintDialogFlags to iFg
83375>>>>>>>        Move (mod(iFg,iTopVal) / iStep * iStep ) to iFg
83376>>>>>>>        function_return iFg
83377>>>>>>>    end_Function
83378>>>>>>>
83378>>>>>>>    Procedure DFSetPrinterPaper integer ePaperType
83380>>>>>>>        Send DFSetSpecPrintFlag ePaperType
83381>>>>>>>    End_Procedure
83382>>>>>>>
83382>>>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
83384>>>>>>>        integer ePaperType
83384>>>>>>>        Get PrintFlagRange 500 10 to ePaperType // 10-490 in steps of 10
83385>>>>>>>        function_return ePaperType
83386>>>>>>>    End_Function
83387>>>>>>>
83387>>>>>>>
83387>>>>>>>    Procedure DFSetPrinterBin integer eBinType
83389>>>>>>>        Send DFSetSpecPrintFlag eBinType
83390>>>>>>>    End_Procedure
83391>>>>>>>
83391>>>>>>>    Function DFGetPrinterBin returns integer //eBinType
83393>>>>>>>        integer eBinType
83393>>>>>>>        Get PrintFlagRange 10000 500 to eBinType // 1000-9000 steps 500
83394>>>>>>>        function_return eBinType
83395>>>>>>>    End_Function
83396>>>>>>>
83396>>>>>>>
83396>>>>>>>    Procedure DFSetPrinterResolution integer eResType
83398>>>>>>>        Send DFSetSpecPrintFlag eResType
83399>>>>>>>    End_Procedure
83400>>>>>>>
83400>>>>>>>    Function DFGetPrinterResolution returns integer //eResType
83402>>>>>>>        integer eResType
83402>>>>>>>        Get PrintFlagRange 50000 10000 to eResType // 10000-500000 steps 10000
83403>>>>>>>        function_return eResType
83404>>>>>>>    End_Function
83405>>>>>>>
83405>>>>>>>
83405>>>>>>>    Procedure DFSetLandscape boolean bIsLandscape
83407>>>>>>>        Send DFSetSpecPrintFlag (If(bIsLandscape,DF_Landscape,DF_Portrait))
83408>>>>>>>    End_Procedure
83409>>>>>>>
83409>>>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
83411>>>>>>>        boolean bIsLandscape
83411>>>>>>>        Get DFCheckPrintDialogFlag DF_Landscape to bIsLandscape
83412>>>>>>>        function_return bIsLandscape
83413>>>>>>>    End_Function
83414>>>>>>>
83414>>>>>>>    Function RGBToWPColor integer iRgb returns integer
83416>>>>>>>        integer iRed iGreen iBlue
83416>>>>>>>        integer iWPColor
83416>>>>>>>        Move (R_from_rgb(iRGB)) to iRed
83417>>>>>>>        Move (G_from_rgb(iRGB)) to iGreen
83418>>>>>>>        Move (B_from_rgb(iRGB)) to iBlue
83419>>>>>>>        Get DfGetDfColor iRed iGreen iBlue to iWPColor
83420>>>>>>>        function_Return iWPColor
83421>>>>>>>    end_function
83422>>>>>>>
83422>>>>>>>
83422>>>>>>>
83422>>>>>>>End_Class
83423>>>>>>>
83423>>>>>>>Global_Variable Integer ghoWinPrint2
83423>>>>>>>
83423>>>>>>>Get Create of desktop U_cWinPrint2 to ghoWinPrint2
83424>>>>>>>
83424>>>>>>>
83424>>>>>Use Winprint_Commands.pkg  // commands used by this class
83424>>>>>
83424>>>>>Class cWinReport2 is a BasicReport
83425>>>>>
83425>>>>>    Procedure Construct_Object
83427>>>>>        Forward send construct_object
83429>>>>>
83429>>>>>        Date Today
83429>>>>>        Sysdate Today
83430>>>>>
83430>>>>>        // should use built in DF function CurrentDateTime()
83430>>>>>        Property Date  RptToday    Today
83431>>>>>
83431>>>>>        Object RptTotal is an Array
83433>>>>>        End_Object
83434>>>>>
83434>>>>>        // If true, report is output upon completion. Either preview
83434>>>>>        // or printer depending on output_device_mode
83434>>>>>        Property Boolean AutoOutput_State True
83435>>>>>
83435>>>>>        // When a new page is created (DFNew_Page) and the number
83435>>>>>        // of columns is not passed, this is used.
83435>>>>>        Property Integer Print_Columns 0
83436>>>>>
83436>>>>>        // This determines if a DFNew_Page should be executed when the
83436>>>>>        // report starts. In some rare cases, you would not want this to
83436>>>>>        // occur until a subheader
83436>>>>>        Property Boolean AutoNew_Page_State True
83437>>>>>
83437>>>>>        // Output device (print or preview). Normally this is delegated to
83437>>>>>        // the report view.
83437>>>>>        //
83437>>>>>
83437>>>>>        Property Integer Private.Output_Device_Mode PRINT_TO_UNDEFINED
83438>>>>>
83438>>>>>        Property Handle phoWinPrint  ghoWinPrint2 // the report engine to use.
83439>>>>>
83439>>>>>        // JJT: For now this is for testing.
83439>>>>>        Property boolean pbModalViewer False
83440>>>>>
83440>>>>>        Property boolean pbMultiReports False
83441>>>>>
83441>>>>>        Property boolean pbFirstPagePrinted false
83442>>>>>
83442>>>>>    End_Procedure
83443>>>>>
83443>>>>>    // returns the current status of Winprint Document object. dsNotStarted, dsStarted, dsFinished
83443>>>>>    // note that the status can reflect a status from a different report. The winprint object is global.
83443>>>>>    Function DocumentStatus returns Boolean
83445>>>>>        integer iStatus
83445>>>>>        Get DocumentStatus of (phoWinprint(self)) to iStatus
83446>>>>>        function_return iStatus
83447>>>>>    End_function
83448>>>>>
83448>>>>>    Function IsViewerActive Returns Boolean
83450>>>>>        Boolean bIsActive
83450>>>>>        Get IsViewerActive of (phoWinPrint(Self)) to bIsActive
83451>>>>>        Function_Return bIsActive
83452>>>>>    End_Function
83453>>>>>
83453>>>>>    Function IsPrinterValid Returns Boolean
83455>>>>>        Function_Return (WP_IsPrinterValid()<>0)
83456>>>>>    End_Function
83457>>>>>
83457>>>>>    Function ArePrintersInstalled Returns Boolean
83459>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
83460>>>>>    End_Function
83461>>>>>
83461>>>>>
83461>>>>>    // All subtotal commands use the outer main report. This makes it easier to keep
83461>>>>>    // track of these numbers
83461>>>>>
83461>>>>>    Procedure Add_SubTotal Integer iCounter Number nData
83463>>>>>        Number nValue
83463>>>>>        Integer iObj
83463>>>>>        Move (RptTotal(Main_Report_Id(Self))) to iObj
83464>>>>>        Get Number_Value of iObj iCounter To nValue
83465>>>>>        Add nData To nValue
83466>>>>>        Set Array_Value of iObj iCounter To nValue
83467>>>>>    End_Procedure
83468>>>>>
83468>>>>>    Procedure Clr_SubTotal Integer iCounter
83470>>>>>        Set Array_Value of (RptTotal(Main_Report_Id(Self))) iCounter To 0
83471>>>>>    End_Procedure
83472>>>>>
83472>>>>>    Procedure Clr_AllSubTotals
83474>>>>>        Send Delete_Data of (RptTotal(Main_Report_Id(Self)))
83475>>>>>    End_Procedure
83476>>>>>
83476>>>>>    Function Sum_SubTotal Integer iTotal Returns Number
83478>>>>>        Number nRetVal
83478>>>>>        Get Number_Value of (RptTotal(Main_Report_Id(Self))) iTotal To nRetVal
83479>>>>>        Function_Return nRetVal
83480>>>>>    End_Function
83481>>>>>
83481>>>>>    //Return sub-total and clear accumulator
83481>>>>>    //
83481>>>>>    Function SubTotal Integer iTotal Returns Number
83483>>>>>        Number nRetVal
83483>>>>>        Get Sum_SubTotal  iTotal to nRetVal
83484>>>>>        Send Clr_SubTotal iTotal
83485>>>>>        Function_Return nRetVal
83486>>>>>    End_Function
83487>>>>>
83487>>>>>
83487>>>>>    // Note: Cols is optional. If no argument is passed it will use
83487>>>>>    //       the object's property Print_Columns (0 by default)
83487>>>>>    //
83487>>>>>    Procedure DFNew_Page Integer Cols
83489>>>>>        Integer PageNumber Columns
83489>>>>>        Boolean bFirstPagePrinted
83489>>>>>        // If no args passed used default setting
83489>>>>>        If (Num_Arguments=0) ;           Move (Print_Columns(Main_Report_id(Self))) to Columns
83492>>>>>        Else ;           Move Cols to Columns
83494>>>>>        Set Page_Feed   to -2   // No FormFeed
83495>>>>>        If (Child_Rpt_State(self)) ;            Send DFNew_Page of (Main_Report_Id(Self)) Columns
83498>>>>>        Else Begin
83499>>>>>            // we only want to print report_header once. When report starts
83499>>>>>            // this is set true, after the first print it is false. You can set
83499>>>>>            // this to true before and explicit dfNew_page to force a header
83499>>>>>            Get pbFirstPagePrinted to bFirstPagePrinted
83500>>>>>            Get  DFNewPage of (phoWinPrint(self)) Columns To PageNumber
83501>>>>>            If (PageNumber<>0) begin // if 0, it failed
83503>>>>>                Set No_PageCheck_State to True
83504>>>>>
83504>>>>>                //Top section
83504>>>>>                Send Page_Top
83505>>>>>                If Not bFirstPagePrinted Send Report_Header
83508>>>>>                Send Page_Header
83509>>>>>                Send Page_Title
83510>>>>>
83510>>>>>                Set New_Page_State to False
83511>>>>>                Set Page_End_State to False
83512>>>>>                Set No_PageCheck_State to False        // No longer Paging
83513>>>>>                Set pbFirstPagePrinted to True
83514>>>>>            End
83514>>>>>>
83514>>>>>        End
83514>>>>>>
83514>>>>>
83514>>>>>        // Footer section
83514>>>>>        //
83514>>>>>        // DO NOT CHANGE THE ORDER OF BOTTOM SECTIONS !!!!!
83514>>>>>        //
83514>>>>>
83514>>>>>        Send Page_Bottom
83515>>>>>
83515>>>>>        // in WinPrint it is not possible to replace Page_Footer
83515>>>>>        // with Report_Footer. If you use Report_Footer you will
83515>>>>>        // have both Page_Footer and Report_Footer
83515>>>>>        //
83515>>>>>        //If LastTime eq 0 Send Page_Footer
83515>>>>>        //else             Send Report_Footer
83515>>>>>
83515>>>>>        Send Page_Footer
83516>>>>>        Send Page_Total
83517>>>>>    End_Procedure
83518>>>>>
83518>>>>>    Procedure Ending_Main_Report
83520>>>>>        Boolean bCancel bMultiReports
83520>>>>>
83520>>>>>        Get Cancelled_state to bCancel
83521>>>>>        Get pbMultiReports to bMultiReports
83522>>>>>
83522>>>>>        Forward Send Ending_Main_Report
83524>>>>>
83524>>>>>        If bCancel Begin
83526>>>>>            Send DFEndDocument
83527>>>>>            Send DFClearDoc // this will also close the previewer
83528>>>>>        end
83528>>>>>>
83528>>>>>        Else Begin
83529>>>>>            Send Report_Footer
83530>>>>>
83530>>>>>            // if multi-reports, we don't do an end of report yet. The programmer must
83530>>>>>            // manually end the report by sending EndMultiReport
83530>>>>>            If (not(bMultiReports)) begin
83532>>>>>                Send EndWinPrintReport
83533>>>>>            end
83533>>>>>>
83533>>>>>
83533>>>>>        end
83533>>>>>>
83533>>>>>
83533>>>>>    End_Procedure
83534>>>>>
83534>>>>>    // This must get called when you are running multiple reports (pbMultiReport).
83534>>>>>    // Send this when the last report is complete.
83534>>>>>    Procedure EndMultiReport
83536>>>>>        Send EndWinPrintReport
83537>>>>>    End_procedure
83538>>>>>
83538>>>>>
83538>>>>>    Procedure EndWinPrintReport
83540>>>>>        Boolean bAutoOutput
83540>>>>>        integer iStatus eMode
83540>>>>>        Get DocumentStatus to iStatus
83541>>>>>        If (iStatus<>dsStarted) procedure_return
83544>>>>>
83544>>>>>        // this tells winprint that the report is complete
83544>>>>>        Send DFEndDocument
83545>>>>>        // if auto-output we print or display automatically.
83545>>>>>        // for winprint2, if in preview mode you must do this so the previewer can enter
83545>>>>>        // a modal state (which it may or may not need to do).
83545>>>>>        Get AutoOutput_state to bAutoOutput
83546>>>>>        Get Output_device_mode to eMode
83547>>>>>        If (bAutoOutput or eMode=PRINT_TO_WINDOW) begin
83549>>>>>            Send PrintReport
83550>>>>>            // if auto output, we assume that you are done when it is all over
83550>>>>>            // we only can do this with the modal viewer
83550>>>>>            If (bAutoOutput and pbModalViewer(self)) begin
83552>>>>>                Send DFClearDoc
83553>>>>>            end
83553>>>>>>
83553>>>>>        end
83553>>>>>>
83553>>>>>
83553>>>>>    End_Procedure
83554>>>>>
83554>>>>>
83554>>>>>    Function Setup_Report Returns Integer
83556>>>>>        Integer iErr iStatus eMode
83556>>>>>        Boolean bActiveViewer bChildReport bMultiReports bOk
83556>>>>>
83556>>>>>        Get Child_rpt_state to bChildReport
83557>>>>>
83557>>>>>        If not bChildReport Begin
83559>>>>>
83559>>>>>            // This makes sure that we are pointing to the new winprint2 engine object.
83559>>>>>            // normally this will be the new winprint, but it can be redirected
83559>>>>>            Get phoWinPrint to WinPrintID
83560>>>>>
83560>>>>>            // winprint must have installed printer. If not installed, generate error and stop the report
83560>>>>>            Get ArePrintersInstalled to bOk
83561>>>>>            If not bOk Begin
83563>>>>>                Error DFERR_WINPRINT C_$NoInstalledPrinters
83564>>>>>>
83564>>>>>                Function_Return 1
83565>>>>>            End
83565>>>>>>
83565>>>>>
83565>>>>>            // check if selected printer is valid. If not, generate error and stop the report
83565>>>>>            Get IsPrinterValid to bOk
83566>>>>>            If not bOk Begin
83568>>>>>                Error DFERR_WINPRINT DFPrintError936    // Could not select a valid printer
83569>>>>>>
83569>>>>>                Function_Return 1
83570>>>>>            End
83570>>>>>>
83570>>>>>
83570>>>>>            // make sure it is ok to start a new report but try to be smart about it.
83570>>>>>            // if a report is active (dsstarted or dsFinished) check to see if it is
83570>>>>>            // finished w/ no viewer. If so, assume the user closed the report and is done
83570>>>>>            // so just clear the report. If a viewer is present, declare an error.
83570>>>>>            Get DocumentStatus to iStatus
83571>>>>>            Get pbMultiReports to bMultiReports
83572>>>>>            // multi-report only in-progress is multi and it is started
83572>>>>>            Move (bMultiReports and iStatus=dsStarted) to bMultiReports
83573>>>>>            If not bMultiReports Begin
83575>>>>>                If (iStatus<>dsNotStarted) Begin
83577>>>>>                    Get IsViewerActive to bActiveViewer
83578>>>>>                    If (iStatus=dsFinished and not(bActiveViewer)) Begin
83580>>>>>                        Send DfClearDoc
83581>>>>>                    End
83581>>>>>>
83581>>>>>                    Else Begin
83582>>>>>                        Error DFERR_WINPRINT DFPrintError967
83583>>>>>>
83583>>>>>                        Function_Return 1
83584>>>>>                    End
83584>>>>>>
83584>>>>>                End
83584>>>>>>
83584>>>>>
83584>>>>>                // all new reports by default allow printing from viewer and they have the print job set up when you select print
83584>>>>>                // if you need to change these defaults, you can change these inside of Starting_main_report
83584>>>>>                // We only do this with non-multi-reports.
83584>>>>>                Send DFSetPrintDlgInPreview      True
83585>>>>>                Send DFSetEnablePrintFromPreview True
83586>>>>>
83586>>>>>            End
83586>>>>>>
83586>>>>>
83586>>>>>            // In the new winprint, this message is not needed and is a stub. For
83586>>>>>            // now it is in here for compatibility purposes
83586>>>>>            //You MUST always start a new report with this procedure
83586>>>>>            Send DFZeroCounters of (phoWinPrint(Self))
83587>>>>>            Send Clr_AllSubTotals
83588>>>>>
83588>>>>>        End
83588>>>>>>
83588>>>>>
83588>>>>>        Forward Get Setup_report to iErr
83590>>>>>
83590>>>>>        If (iErr=0) Begin
83592>>>>>            If not bChildReport Begin
83594>>>>>                // if part of a multi-report we don't do a new doc
83594>>>>>                If not bMultiReports Begin
83596>>>>>                    Get Output_Device_Mode to eMode
83597>>>>>                    Send DFNewDoc of (phoWinPrint(Self))  (eMode = PRINT_TO_WINDOW) // pass True of display while printing
83598>>>>>                End
83598>>>>>>
83598>>>>>                // Do new page if not part of a multi-report and we say don't do a new page
83598>>>>>                If (not(bMultiReports) or AutoNew_Page_State(Self)) Begin
83600>>>>>                    Set pbFirstPagePrinted to False // tells new page that this is the first time for this report
83601>>>>>                    Send DFNew_page
83602>>>>>                End
83602>>>>>>
83602>>>>>            End
83602>>>>>>
83602>>>>>        End
83602>>>>>>
83602>>>>>        Function_Return iErr
83603>>>>>    End_Function
83604>>>>>
83604>>>>>
83604>>>>>
83604>>>>>    // Cancel RO behavior - there is no device to close
83604>>>>>    //
83604>>>>>    Procedure Close_Output_Device
83606>>>>>    End_Procedure
83607>>>>>
83607>>>>>    // Cancel RO Behavior
83607>>>>>    //
83607>>>>>    Procedure Initialize_Output_Device
83609>>>>>    End_procedure
83610>>>>>
83610>>>>>
83610>>>>>    Function Output_Device_Mode Returns Integer
83612>>>>>        Integer hoId
83612>>>>>        String DevMode
83612>>>>>        Get Private.Output_Device_Mode to DevMode
83613>>>>>        If (DevMode=PRINT_TO_UNDEFINED) Begin
83615>>>>>            Get Report_View_Id to hoId
83616>>>>>            If hoID ;                Get OutPut_Device_Mode of hoID to DevMode
83619>>>>>            If (DevMode=PRINT_TO_UNDEFINED) ;                Move PRINT_TO_WINDOW to DevMode
83622>>>>>        End
83622>>>>>>
83622>>>>>        Function_Return DevMode
83623>>>>>    End_Function // Output_Destination
83624>>>>>
83624>>>>>    Procedure Set Output_Device_Mode Integer DevMode
83626>>>>>        Set Private.Output_Device_Mode to DevMode
83627>>>>>    End_Procedure // Set Output_Device
83628>>>>>
83628>>>>>    // displays a metric ruler in .5 increments. This can be
83628>>>>>    // sent to make it easy to see how fields and labels should
83628>>>>>    // be moved for alignment.
83628>>>>>    //
83628>>>>>    Procedure ShowRuler
83630>>>>>        integer i
83630>>>>>        number n
83630>>>>>        for i from 0 to 30
83636>>>>>>
83636>>>>>            Send DFWritePos of (phoWinPrint(self)) (String(i)) FONT_DEFAULT i -1 0
83637>>>>>            Move (i+.5) to n
83638>>>>>            Send DFWritePos of (phoWinPrint(self)) "." FONT_DEFAULT n -1 0
83639>>>>>        Loop
83640>>>>>>
83640>>>>>        Send DFWriteln of (phoWinPrint(self)) ''  FONT_DEFAULT FONT_DEFAULT -1
83641>>>>>    End_procedure
83642>>>>>
83642>>>>>      // status panel related agumentations to handle the auto-previewer
83642>>>>>
83642>>>>>      Procedure Update_Status string sVal
83644>>>>>         Integer eMode
83644>>>>>         Get Output_device_mode to eMode
83645>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83647>>>>>            Send SetProgressCaption  of (phoWinPrint(self)) sVal
83648>>>>>         End
83648>>>>>>
83648>>>>>         Else Begin
83649>>>>>            forward Send Update_Status sVal
83651>>>>>         end
83651>>>>>>
83651>>>>>      End_Procedure
83652>>>>>
83652>>>>>      Procedure Start_Status
83654>>>>>         Integer eMode
83654>>>>>         string sTitle sCaption
83654>>>>>         Get Output_device_mode to eMode
83655>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83657>>>>>            Get Report_Caption to sCaption
83658>>>>>            Get Report_Title to sTitle
83659>>>>>            If (sTitle<>"" and sCaption<>"") begin
83661>>>>>                Move ( sCaption- ":" * sTitle) to sTitle
83662>>>>>            end
83662>>>>>>
83662>>>>>            else begin
83663>>>>>                Move (sCaption - sTitle) to sTitle
83664>>>>>            end
83664>>>>>>
83664>>>>>            Send SetReportTitle of (phoWinPrint(self)) sTitle
83665>>>>>         End
83665>>>>>>
83665>>>>>         Else Begin
83666>>>>>            forward Send Start_status
83668>>>>>         end
83668>>>>>>
83668>>>>>      End_Procedure
83669>>>>>
83669>>>>>      Procedure Resume_Status
83671>>>>>         Integer eMode
83671>>>>>         Get Output_device_mode to eMode
83672>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83674>>>>>            Send DfPreviewNoWait of (phoWinPrint(self))
83675>>>>>         End
83675>>>>>>
83675>>>>>         Else Begin
83676>>>>>            forward Send Resume_Status
83678>>>>>         end
83678>>>>>>
83678>>>>>      End_Procedure
83679>>>>>
83679>>>>>      Procedure End_Status
83681>>>>>         Integer eMode
83681>>>>>         Get Output_device_mode to eMode
83682>>>>>         If (error_processing_state(self)) Begin
83684>>>>>            Send DFClosePreview
83685>>>>>         end
83685>>>>>>
83685>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83687>>>>>         End
83687>>>>>>
83687>>>>>         Else Begin
83688>>>>>            forward Send End_Status
83690>>>>>         end
83690>>>>>>
83690>>>>>      End_Procedure
83691>>>>>
83691>>>>>    Function Report_Interrupt Returns Integer
83693>>>>>         integer eStat
83693>>>>>         String sMess
83693>>>>>         Boolean bActiveViewer
83693>>>>>         Get IsViewerActive to bActiveViewer
83694>>>>>         If (Error_Check_State(self)) begin
83696>>>>>            Move C_$AnErrorWishToCancel to sMess
83697>>>>>         end
83697>>>>>>
83697>>>>>         Else begin
83698>>>>>            Move  C_$CancelThisReport to sMess
83699>>>>>         end
83699>>>>>>
83699>>>>>         If bActiveViewer Begin
83701>>>>>            Get PreviewYesNoBox of (phoWinPrint(self)) C_$ReportInterrupt sMess to eStat
83702>>>>>         end
83702>>>>>>
83702>>>>>         Else Begin
83703>>>>>            Get YesNo_Box sMess C_$ReportInterrupt to eStat
83704>>>>>         End
83704>>>>>>
83704>>>>>
83704>>>>>         Function_Return (eStat=MBR_YES)
83705>>>>>
83705>>>>>  End_Function
83706>>>>>
83706>>>>>  Function Test_KeyPressed Returns Integer
83708>>>>>     Boolean bStop bError bActiveViewer
83708>>>>>     integer eMode
83708>>>>>     // winreport will do this also, but this makes sure that this gets called
83708>>>>>     // for each body loop -- even if the body loop prints nothing
83708>>>>>     Send PumpMsgQueue of (phoWinPrint(self)) // permit painting
83709>>>>>     Get IsViewerActive to bActiveViewer
83710>>>>>     Get Output_device_mode to eMode
83711>>>>>     If bActiveViewer Begin
83713>>>>>        Get ViewerWantsToClose of (phoWinPrint(self)) to bStop
83714>>>>>        Get Error_Check_State to bError
83715>>>>>        if (bStop or bError) begin
83717>>>>>            Get Report_Interrupt to bStop
83718>>>>>        end
83718>>>>>>
83718>>>>>     end
83718>>>>>>
83718>>>>>     Else Begin
83719>>>>>        Forward Get Test_KeyPressed to bStop
83721>>>>>        If (eMode=PRINT_TO_WINDOW and not(bStop)) Begin
83723>>>>>            Send DfPreviewNoWait
83724>>>>>        end
83724>>>>>>
83724>>>>>     End
83724>>>>>>
83724>>>>>
83724>>>>>     Function_Return bStop
83725>>>>>  End_Function
83726>>>>>
83726>>>>>    Procedure OnClosingView
83728>>>>>        Send DFClearDoc
83729>>>>>    end_procedure
83730>>>>>
83730>>>>>
83730>>>>>    // Attempt to make this as intuitive as possible. You cannot invoke this when a
83730>>>>>    // report is active. If a report is not finished, you cannot do this.
83730>>>>>    // If a report is finsihed it may or may not have a viewer present.
83730>>>>>    // If a viewer is not present, we will clear the exising report (making the assumption
83730>>>>>    // that a modeless viewer was closed and the report will not be invoked again). If a viewer
83730>>>>>    // is active, we will pass this through to the winprint object which will show an error
83730>>>>>
83730>>>>>    Function DFPrintSetupDialog Returns Boolean// invoke printer setup dialog
83732>>>>>        Integer iStatus
83732>>>>>        Boolean bActiveViewer bOk
83732>>>>>        // we must have printers installed for this to work
83732>>>>>        Get ArePrintersInstalled to bOk
83733>>>>>        If not bOk Begin
83735>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
83736>>>>>>
83736>>>>>        End
83736>>>>>>
83736>>>>>        Else Begin
83737>>>>>            Get DocumentStatus to iStatus
83738>>>>>            If (iStatus=dsFinished) Begin
83740>>>>>                Get IsViewerActive to bActiveViewer
83741>>>>>                If not bActiveViewer Begin
83743>>>>>                    Send DfClearDoc
83744>>>>>                End
83744>>>>>>
83744>>>>>            End
83744>>>>>>
83744>>>>>            // the winprint object will generate an error if the status is not dsNotStarted.
83744>>>>>            // we want those errors
83744>>>>>            Get DFPrintSetupDialog of (phoWinPrint(Self)) to bOk
83745>>>>>        End
83745>>>>>>
83745>>>>>        Function_Return bOk
83746>>>>>    End_Procedure
83747>>>>>
83747>>>>>    // It is better to use DFPrintSetupDialog which tells you if the dialog was canceled
83747>>>>>    Procedure DFPrintSetup // invoke printer setup dialog
83749>>>>>        Boolean bOk
83749>>>>>        Get DFPrintSetupDialog to bOk
83750>>>>>    End_Procedure
83751>>>>>
83751>>>>>    Procedure DFClearDoc // clear document, remove viewer
83753>>>>>        Send DFClearDoc of (phoWinPrint(self))
83754>>>>>    end_procedure
83755>>>>>
83755>>>>>    Procedure DFEndDocument // tell winprint that the report is complete
83757>>>>>        Send DfEndDocument of (phoWinPrint(self))
83758>>>>>    end_procedure
83759>>>>>
83759>>>>>    Procedure DFClosePreview //close the previewer, does not clear the document
83761>>>>>        Send DfClosePreview of (phoWinPrint(self))
83762>>>>>    end_procedure
83763>>>>>
83763>>>>>    Procedure DFPrintDialog // popup print job dialog
83765>>>>>        Send DFPrintDialog of (phoWinPrint(self))
83766>>>>>    End_procedure
83767>>>>>
83767>>>>>    Procedure DFPrint // print with printer dialog
83769>>>>>        Send DFPrint of (phoWinPrint(self))
83770>>>>>    End_procedure
83771>>>>>
83771>>>>>    Procedure DFPrintDoc // print without printer dialog
83773>>>>>        Send DFPrintDoc of (phoWinPrint(self))
83774>>>>>    End_Procedure
83775>>>>>
83775>>>>>    Procedure DFPreviewWait // invoke previewer in modal mode
83777>>>>>       Send DFPreviewWait of (phoWinPrint(self))
83778>>>>>    End_Procedure
83779>>>>>
83779>>>>>    Procedure DFPreviewNoWait // invoke previwer in modeless mode
83781>>>>>       Send DFPreviewNoWait of (phoWinPrint(self))
83782>>>>>    End_Procedure
83783>>>>>
83783>>>>>    Procedure DFPreview // invokde previewer based on pbModalViewer property
83785>>>>>       Boolean bModalViewer
83785>>>>>       Get pbModalViewer to bModalViewer
83786>>>>>       If bModalViewer Begin
83788>>>>>           Send DFPreviewWait
83789>>>>>       end
83789>>>>>>
83789>>>>>       else Begin
83790>>>>>           Send DFPreviewNoWait
83791>>>>>       end
83791>>>>>>
83791>>>>>   End_Procedure
83792>>>>>
83792>>>>>    // Print report to appropriate device (printer, preview) based
83792>>>>>    // on output_device_mode
83792>>>>>    //
83792>>>>>    Procedure PrintReport
83794>>>>>        Integer eMode
83794>>>>>        Get OutPut_Device_Mode to eMode
83795>>>>>        If ((eMode=PRINT_TO_WINDOW) or (eMode=DEFERRED_PRINT_TO_WINDOW)) Begin
83797>>>>>           Send DFPreview
83798>>>>>        end
83798>>>>>>
83798>>>>>        Else If (eMode=PRINT_TO_PRINTER_NO_DIALOG) Begin
83801>>>>>           Send DFPrintDoc // print, no print job dialog
83802>>>>>        end
83802>>>>>>
83802>>>>>        Else Begin // (eMode=PRINT_TO_PRINTER)
83803>>>>>           Send DFPrint // print with print job dialog
83804>>>>>        end
83804>>>>>>
83804>>>>>    End_Procedure
83805>>>>>
83805>>>>>
83805>>>>>    Procedure DFSetPrinterPaper integer ePaperType
83807>>>>>        Send DFSetPrinterPaper of (phoWinPrint(self)) ePaperType
83808>>>>>    End_Procedure
83809>>>>>
83809>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
83811>>>>>        integer ePaperType
83811>>>>>        Get DFGetPrinterPaper of (phoWinPrint(self)) to ePaperType
83812>>>>>        Function_return ePaperType
83813>>>>>    end_function
83814>>>>>
83814>>>>>
83814>>>>>    Procedure DFSetPrinterBin integer eBinType
83816>>>>>        Send DFSetPrinterBin of (phoWinPrint(self)) eBinType
83817>>>>>    End_Procedure
83818>>>>>
83818>>>>>    Function DFGetPrinterBin returns integer //eBinType
83820>>>>>        integer eBinType
83820>>>>>        Get DFGetPrinterBin of (phoWinPrint(self)) to eBinType
83821>>>>>        Function_return eBinType
83822>>>>>    end_function
83823>>>>>
83823>>>>>
83823>>>>>    Procedure DFSetPrinterResolution integer eResType
83825>>>>>        Send DFSetPrinterResolution of (phoWinPrint(self)) eResType
83826>>>>>    End_Procedure
83827>>>>>
83827>>>>>    Function DFGetPrinterResolution returns integer //eResType
83829>>>>>        Boolean eResType
83829>>>>>        Get DFGetPrinterResolution of (phoWinPrint(self)) to eResType
83830>>>>>        Function_return eResType
83831>>>>>    end_function
83832>>>>>
83832>>>>>
83832>>>>>    Procedure DFSetLandscape boolean bIsLandscape
83834>>>>>        Send DFSetLandscape of (phoWinPrint(self)) bIsLandscape
83835>>>>>    End_Procedure
83836>>>>>
83836>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
83838>>>>>        Boolean bIsLandscape
83838>>>>>        Get DFGetLandscape of (phoWinPrint(self)) to bIsLandscape
83839>>>>>        Function_return bIsLandscape
83840>>>>>    end_function
83841>>>>>
83841>>>>>    Procedure DFSetMetrics integer eType
83843>>>>>        Send DFSetMetrics of (phoWinPrint(self)) eType
83844>>>>>    End_Procedure
83845>>>>>
83845>>>>>    Function DFGetMetrics returns integer
83847>>>>>        integer eType
83847>>>>>        Get DFGetMetrics of (phoWinPrint(self)) to eType
83848>>>>>        Function_return eType
83849>>>>>    end_function
83850>>>>>
83850>>>>>
83850>>>>>    Procedure DFSetPrintDlgInPreview boolean bShowDialog
83852>>>>>        Set PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
83853>>>>>    End_Procedure
83854>>>>>
83854>>>>>    Function DFGetPrintDlgInPreview returns boolean
83856>>>>>        boolean bShowDialog
83856>>>>>        Get PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
83857>>>>>        Function_return bShowDialog
83858>>>>>    end_function
83859>>>>>
83859>>>>>
83859>>>>>    Procedure DFSetEnablePrintFromPreview boolean bEnablePrint
83861>>>>>        Set EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
83862>>>>>    End_Procedure
83863>>>>>
83863>>>>>    Function DFGetEnablePrintFromPreview returns boolean
83865>>>>>        boolean bEnablePrint
83865>>>>>        Get EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
83866>>>>>        Function_return bEnablePrint
83867>>>>>    end_function
83868>>>>>
83868>>>>>
83868>>>>>
83868>>>>>    Procedure DFSetMargins number nLeft number nTop number nRight number nBottom
83870>>>>>        Send DFSetMargins of (phoWinPrint(self)) nLeft nTop nRight nBottom
83871>>>>>    End_Procedure
83872>>>>>
83872>>>>>    Procedure DFSetTopBottom number nTop number nBottom Boolean bAllPages
83874>>>>>        Send DFSetTopBottom of (phoWinPrint(self)) nTop nBottom bAllPages
83875>>>>>    End_Procedure
83876>>>>>
83876>>>>>
83876>>>>>    Procedure DFSetDevice string sPrinterName
83878>>>>>        Send DFSetDevice of (phoWinPrint(self)) sPrinterName
83879>>>>>    End_Procedure
83880>>>>>
83880>>>>>    Function DFGetCurrentDevice returns string // sPrinterName
83882>>>>>        String sPrinterName
83882>>>>>        Get DFGetCurrentDevice of (phoWinPrint(self)) to sPrinterName
83883>>>>>        Function_return sPrinterName
83884>>>>>    end_function
83885>>>>>
83885>>>>>
83885>>>>>    Procedure DFSetUserDefinedPapersize number nLength number nWidth
83887>>>>>        Send DFSetUserDefinedPapersize of (phoWinPrint(self)) nLength nWidth
83888>>>>>    End_Procedure
83889>>>>>
83889>>>>>    Function DFGetUserDefinedLength returns number
83891>>>>>        number nSize
83891>>>>>        Get DFGetUserDefinedLength of (phoWinPrint(self)) to nSize
83892>>>>>        Function_return nSize
83893>>>>>    end_function
83894>>>>>
83894>>>>>    Function DFGetUserDefinedWidth returns number
83896>>>>>        number nSize
83896>>>>>        Get DFGetUserDefinedWidth of (phoWinPrint(self)) to nSize
83897>>>>>        Function_return nSize
83898>>>>>    end_function
83899>>>>>
83899>>>>>
83899>>>>>    Procedure DFSetNumberOfCopies integer iCopies
83901>>>>>        Send DFSetNumberOfCopies of (phoWinPrint(self)) iCopies
83902>>>>>    End_Procedure
83903>>>>>
83903>>>>>    Procedure DFPrinterBinFirstPage integer eBinType
83905>>>>>        Send DFPrinterBinFirstPage of (phoWinPrint(self)) eBinType
83906>>>>>    End_Procedure
83907>>>>>
83907>>>>>    Procedure DFClearPrinter
83909>>>>>        Send DFClearPrinter of (phoWinPrint(self))
83910>>>>>    End_Procedure
83911>>>>>
83911>>>>>    Function DFGetDFColor integer iRed integer iGreen integer iBlue returns integer
83913>>>>>        integer iWPColor
83913>>>>>        Get DFGetDFColor of (phoWinPrint(self)) iRed iGreen iBlue to iWPColor
83914>>>>>        Function_return iWPColor
83915>>>>>    end_function
83916>>>>>
83916>>>>>    Function RGBToWPColor integer iRgb returns integer
83918>>>>>        integer iWPColor
83918>>>>>        Get RGBToWPColor of (phoWinPrint(self)) iRGB to iWPColor
83919>>>>>        Function_return iWPColor
83920>>>>>    end_function
83921>>>>>
83921>>>>>
83921>>>>>End_Class
83922>>>Use Windows.pkg
83922>>>
83922>>>Use cUgyfelDataDictionary.dd
83922>>>Use cAutoDataDictionary.dd
83922>>>Use cMunkalapDataDictionary.dd
83922>>>
83922>>>ACTIVATE_VIEW Activate_oGyakorisagRiport FOR oGyakorisagRiport
83932>>>>
83932>>>Object oGyakorisagRiport is a ReportView
83934>>>    Set Location to 6 6
83935>>>    Set Size to 60 202
83936>>>    Set Label To "GyakorisagRiport"
83937>>>
83937>>>
83937>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
83939>>>    End_Object 
83940>>>
83940>>>    Object oAuto_DD is a cAutoDataDictionary
83942>>>    End_Object 
83943>>>
83943>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
83945>>>        Set DDO_Server To oAuto_DD
83946>>>        Set DDO_Server To oUgyfel_DD
83947>>>    End_Object 
83948>>>
83948>>>    Set Main_DD To oMunkalap_DD
83949>>>
83949>>>
83949>>>
83949>>>
83949>>>    Object oPrintTo is a RadioGroup
83951>>>        Set Size to 38 118
83952>>>        Set Location to 10 12
83953>>>        Set Label to "Send Report to"
83954>>>
83954>>>        Object oRadio1 is a Radio
83956>>>            Set Label to "Report Viewer"
83957>>>            Set Size to 10 61
83958>>>            Set Location to 12 6
83959>>>            Set Status_Help to "Prints the report to screen"
83960>>>        End_Object 
83961>>>
83961>>>        Object oRadio2 is a Radio
83963>>>            Set Label to "Printer"
83964>>>            Set Size to 10 42
83965>>>            Set Location to 24 6
83966>>>            Set Status_Help to "Prints the report to printer"
83967>>>        End_Object 
83968>>>
83968>>>
83968>>>        Function IsToPrinter Returns boolean
83971>>>            integer iRadio
83971>>>            Get Current_radio to iRadio
83972>>>            Function_return (iRadio=1)
83973>>>        End_Function 
83974>>>
83974>>>    End_Object 
83975>>>
83975>>>    Object oBtnPrint is a Button
83977>>>        Set Label to "Print"
83978>>>        Set Location to 5 140
83979>>>        Set Status_Help to "Print the Selected report"
83980>>>        Set Default_State to TRUE
83981>>>        Procedure OnClick
83984>>>            Send StartReport
83985>>>        End_Procedure
83986>>>    End_Object 
83987>>>
83987>>>    Object oBtnPrinterSetup is a Button
83989>>>        Set Label to "Printer Setup"
83990>>>        Set Location to 22 140
83991>>>        Set Status_Help to "Set up printer for report"
83992>>>        Procedure OnClick
83995>>>            Send DFPrintSetup of oReport
83996>>>        End_Procedure
83997>>>    End_Object 
83998>>>
83998>>>    Object oBtnCancel is a Button
84000>>>        Set Label to "Cancel"
84001>>>        Set Location to 39 140
84002>>>        Set Status_Help to "Close this Panel"
84003>>>        Procedure OnClick
84006>>>            Send Close_Panel
84007>>>        End_Procedure
84008>>>    End_Object 
84009>>>
84009>>>
84009>>>
84009>>>    Object oReport is a cWinReport2
84011>>>
84011>>>        Set Report_Title to "GyakorisagRiport"
84012>>>
84012>>>        // Set DDO, Index and breaks for the report
84012>>>        Set Server to oMunkalap_DD
84013>>>        Set Ordering to 1
84014>>>        // Report_Breaks file.field // no breaks in this report
84014>>>
84014>>>        Function Starting_Main_Report Returns Integer
84017>>>            Boolean bErr
84017>>>            Send DFSetMetrics wpm_cm
84018>>>            Send DFSetmargins 1 1 1 1
84019>>>            //Send DFSetLandscape false // This can be used to force a page orientation
84019>>>            Forward Get Starting_Main_Report to bErr
84021>>>            Function_return bErr
84022>>>        End_Function 
84023>>>
84023>>>        // Page_Top is printed first at the top margin of each page
84023>>>        Procedure Page_Top 
84026>>>            string  sFont
84026>>>            integer iFontSize
84026>>>
84026>>>            Move "arial" to sFont
84027>>>            Move 10 to iFontSize
84028>>>
84028>>>            DFFont sFont
84029>>>            DFFontSize iFontSize
84030>>>            DFBeginHeader DFPageTop
84031>>>                DFHeaderFrame Hdr_NoFrame
84032>>>                DFHeaderPos   Hdr_Left
84033>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
84034>>>            DFEndHeader
84036>>>
84036>>>        End_Procedure 
84037>>>
84037>>>        // Report_Header is printed once in a report after Page_Top
84037>>>        //Procedure Report_Header
84037>>>        //    string  sFont
84037>>>        //    integer iFontSize
84037>>>        //    Move "arial" to sFont
84037>>>        //    Move 10 to iFontSize
84037>>>        //    DFFont sFont
84037>>>        //    DFFontSize iFontSize
84037>>>        //    DFBeginHeader  DFReportHeader
84037>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84037>>>        //        DFHeaderPos    Hdr_Left
84037>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84037>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
84037>>>        //    DFEndHeader
84037>>>        //End_Procedure
84037>>>
84037>>>        Procedure Page_Header 
84040>>>            integer iFill iBorder iStyle
84040>>>            string  sFont sReportTitle
84040>>>            integer iFontSize
84040>>>
84040>>>            Move "arial" to sFont
84041>>>            Move 16 to iFontSize
84042>>>            Move (Font_bold + rgb_White) to iStyle
84043>>>            Move (rgb_dGrey) to iFill
84044>>>            Move (rgb_dGrey) to iBorder
84045>>>            Get Report_Title to sReportTitle
84046>>>
84046>>>            DFFont sFont
84047>>>            DFFontSize iFontSize
84048>>>            DFBeginHeader DFPageHeader
84049>>>                DFHeaderPos   Hdr_Left
84050>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84051>>>                DFWritelnPos sReportTitle 0.1 iStyle
84052>>>                DFHeaderMargin HM_BottomOuter 0.08
84053>>>            DFEndHeader
84055>>>
84055>>>        End_Procedure 
84056>>>
84056>>>        Procedure Page_Title 
84059>>>            string  sFont 
84059>>>            integer iFontSize iHeaderStyle iFill iBorder
84059>>>
84059>>>            Move "arial" to sFont
84060>>>            Move 10 to iFontSize
84061>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
84062>>>            Move (rgb_Grey) to iFill
84063>>>            Move (rgb_Grey) to iBorder
84064>>>
84064>>>            DFFont sFont
84065>>>            DFFontSize iFontSize
84066>>>            DFBeginHeader DFPageTitle
84067>>>                DFHeaderPos   Hdr_Left
84068>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84069>>>                DFHeaderMargin HM_TopInner    0.04
84070>>>                DFHeaderMargin HM_BottomInner 0.04
84071>>>                DFHeaderMargin HM_BottomOuter 0.08
84072>>>
84072>>>                DFWritePos "Mrka"                        0.08 iHeaderStyle -1 4.26
84073>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
84074>>>                DFWriteLn
84075>>>            DFEndHeader
84077>>>
84077>>>        End_Procedure 
84078>>>
84078>>>        Procedure Body 
84081>>>            string  sFont 
84081>>>            integer iFontSize iStyle
84081>>>
84081>>>            Move "arial" to sFont
84082>>>            Move 10 to iFontSize
84083>>>            Move (font_default) to iStyle
84084>>>
84084>>>            DFFont sFont
84085>>>            DFFontSize iFontSize
84086>>>
84086>>>            DFWritePos Auto.Marka                     0.08 iStyle -1 4.26
84087>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
84088>>>            DFWriteLn
84089>>>
84089>>>        End_Procedure 
84090>>>
84090>>>        // Totals appear at the end of the report before Report_Footer
84090>>>        //Procedure Total
84090>>>        //    string  sFont
84090>>>        //    integer iFontSize
84090>>>        //    Move "arial" to sFont
84090>>>        //    Move 10 to iFontSize
84090>>>        //    DFFont sFont
84090>>>        //    DFFontSize iFontSize
84090>>>        //    DFBeginHeader  DFTotal
84090>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84090>>>        //        DFHeaderPos    Hdr_Left
84090>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84090>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
84090>>>        //    DFEndHeader
84090>>>        //End_Procedure
84090>>>
84090>>>        // Report_Footer is printed once on the last page before Page_Footer
84090>>>        //Procedure Report_Footer
84090>>>        //    string  sFont
84090>>>        //    integer iFontSize
84090>>>        //    Move "arial" to sFont
84090>>>        //    Move 10 to iFontSize
84090>>>        //    DFFont sFont
84090>>>        //    DFFontSize iFontSize
84090>>>        //    DFBeginHeader DFReportFooter
84090>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84090>>>        //        DFHeaderPos    Hdr_Left
84090>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84090>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
84090>>>        //    DFEndHeader
84090>>>        //End_Procedure
84090>>>
84090>>>        // // Page_Footer is printed on each page before Page_Bottom
84090>>>        //Procedure Page_Footer
84090>>>        //    string  sFont
84090>>>        //    integer iFontSize
84090>>>        //    Move "arial" to sFont
84090>>>        //    Move 10 to iFontSize
84090>>>        //    DFFont sFont
84090>>>        //    DFFontSize iFontSize
84090>>>        //    DFBeginHeader DFPageFooter
84090>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84090>>>        //        DFHeaderPos    Hdr_Left
84090>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84090>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
84090>>>        //    DFEndHeader
84090>>>        //End_Procedure
84090>>>
84090>>>
84090>>>        // Page_Bottom is printed last at the bottom margin of each page
84090>>>        Procedure Page_Bottom 
84093>>>            string sFont
84093>>>            integer iFontSize iBorder iStyle
84093>>>            DateTime dtDT
84093>>>
84093>>>            Move (CurrentDateTime()) to dtDT
84094>>>
84094>>>            Move "arial" to sFont
84095>>>            Move 10 to iFontSize
84096>>>            Move (font_default) to iStyle
84097>>>            Move (rgb_dGrey) to iBorder
84098>>>
84098>>>            DFFont sFont
84099>>>            DFFontSize iFontSize
84100>>>            DFBeginHeader DFPageBottom
84101>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
84102>>>                DFHeaderPos Hdr_Left
84103>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
84104>>>            DFEndHeader
84106>>>
84106>>>        End_Procedure 
84107>>>
84107>>>        // Returns string with description of selection ranges
84107>>>        // Pass: Selection title, start value and end value. Return: description
84107>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
84110>>>            string sText
84110>>>            If (sStart=""  AND sStop="")  function_return ""
84113>>>            If (sStart="0" AND sStop="0") function_return ""
84116>>>            If (sStart<>"" AND sStop<>"") begin
84118>>>                Move ("between" * sStart * "and" * sStop) to sText
84119>>>            end
84119>>>>
84119>>>            Else if (sStart > "") begin
84122>>>                Move ("starting at" * sStart) to sText
84123>>>            end
84123>>>>
84123>>>            Else if (sStop > "") begin
84126>>>                Move ("up to" * sStop) to sText
84127>>>            End
84127>>>>
84127>>>            function_return (sTitle * sText)
84128>>>        End_Function
84129>>>
84129>>>    End_Object 
84130>>>
84130>>>    Procedure StartReport 
84133>>>        Boolean bToPrinter
84133>>>
84133>>>        // determine if direct print
84133>>>        Get IsToPrinter of oPrintTo to bToPrinter
84134>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
84135>>>
84135>>>        // run the report
84135>>>        Send Run_Report of oReport
84136>>>
84136>>>    End_Procedure 
84137>>>
84137>>>End_Object 
84138>        Use Report.rv
Including file: Report.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report.rv)
84138>>>// Report.rv
84138>>>// Report
84138>>>Register_Object oReport
84138>>>Use DFRptVw.pkg
84138>>>Use cWinReport2.pkg
84138>>>Use Windows.pkg
84138>>>
84138>>>Use cUgyfelDataDictionary.dd
84138>>>Use cAutoDataDictionary.dd
84138>>>Use cMunkalapDataDictionary.dd
84138>>>
84138>>>ACTIVATE_VIEW Activate_oReport FOR oReport
84148>>>>
84148>>>Object oReport is a ReportView
84150>>>    Set Location to 6 6
84151>>>    Set Size to 60 202
84152>>>    Set Label To "Report"
84153>>>
84153>>>
84153>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
84155>>>    End_Object 
84156>>>
84156>>>    Object oAuto_DD is a cAutoDataDictionary
84158>>>    End_Object 
84159>>>
84159>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84161>>>        Set DDO_Server To oAuto_DD
84162>>>        Set DDO_Server To oUgyfel_DD
84163>>>        Set Constrain_File To Auto.File_Number
84164>>>    End_Object 
84165>>>
84165>>>    Set Main_DD To oAuto_DD
84166>>>
84166>>>
84166>>>
84166>>>
84166>>>    Object oPrintTo is a RadioGroup
84168>>>        Set Size to 38 118
84169>>>        Set Location to 10 12
84170>>>        Set Label to "Send Report to"
84171>>>
84171>>>        Object oRadio1 is a Radio
84173>>>            Set Label to "Report Viewer"
84174>>>            Set Size to 10 61
84175>>>            Set Location to 12 6
84176>>>            Set Status_Help to "Prints the report to screen"
84177>>>        End_Object 
84178>>>
84178>>>        Object oRadio2 is a Radio
84180>>>            Set Label to "Printer"
84181>>>            Set Size to 10 42
84182>>>            Set Location to 24 6
84183>>>            Set Status_Help to "Prints the report to printer"
84184>>>        End_Object 
84185>>>
84185>>>
84185>>>        Function IsToPrinter Returns Boolean
84188>>>            integer iRadio
84188>>>            Get Current_Radio to iRadio
84189>>>            Function_Return (iRadio=1)
84190>>>        End_Function 
84191>>>
84191>>>    End_Object 
84192>>>
84192>>>    Object oBtnPrint is a Button
84194>>>        Set Label to "Print"
84195>>>        Set Location to 5 140
84196>>>        Set Status_Help to "Print the selected report"
84197>>>        Set Default_State to TRUE
84198>>>        Procedure OnClick
84201>>>            Send StartReport
84202>>>        End_Procedure
84203>>>    End_Object 
84204>>>
84204>>>    Object oBtnPrinterSetup is a Button
84206>>>        Set Label to "Printer Setup"
84207>>>        Set Location to 22 140
84208>>>        Set Status_Help to "Set up printer for report"
84209>>>        Procedure OnClick
84212>>>            Send DFPrintSetup of oReport
84213>>>        End_Procedure
84214>>>    End_Object 
84215>>>
84215>>>    Object oBtnCancel is a Button
84217>>>        Set Label to "Cancel"
84218>>>        Set Location to 39 140
84219>>>        Set Status_Help to "Close this Panel"
84220>>>        Procedure OnClick
84223>>>            Send Close_Panel
84224>>>        End_Procedure
84225>>>    End_Object 
84226>>>
84226>>>
84226>>>
84226>>>    Object oReport is a cWinReport2
84228>>>
84228>>>        Set Report_Title to "Report"
84229>>>        Object oReport2 is a cWinReport2
84231>>>
84231>>>
84231>>>            // Set DDO, Index and breaks for the report
84231>>>            Set Server to oMunkalap_DD
84232>>>            Set Ordering to 0
84233>>>            Procedure Body 
84236>>>                string  sFont 
84236>>>                integer iFontSize iStyle
84236>>>
84236>>>                Move "Times New Roman" to sFont
84237>>>                Move 10 to iFontSize
84238>>>                Move (font_default) to iStyle
84239>>>
84239>>>                DFFont sFont
84240>>>                DFFontSize iFontSize
84241>>>
84241>>>                DFWritePos Munkalap.Rogzites              0.08 iStyle -1 2.13
84242>>>                DFWriteLn
84243>>>
84243>>>            End_Procedure 
84244>>>
84244>>>        End_Object 
84245>>>
84245>>>        // Set DDO, Index and breaks for the report
84245>>>        Set Server to oAuto_DD
84246>>>        Set Ordering to 1
84247>>>        Report_Breaks (SerializeRowId(GetRowId(Auto.File_Number)))
84261>>>
84261>>>        Function Starting_Main_Report Returns Integer
84264>>>            Boolean bErr
84264>>>            Send DFSetMetrics wpm_cm
84265>>>            Send DFSetmargins 1 1 1 1
84266>>>            //Send DFSetLandscape false // This can be used to force a page orientation
84266>>>            Forward Get Starting_Main_Report to bErr
84268>>>            Function_return bErr
84269>>>        End_Function 
84270>>>
84270>>>        // Page_Top is printed first at the top margin of each page
84270>>>        Procedure Page_Top 
84273>>>            string  sFont
84273>>>            integer iFontSize
84273>>>
84273>>>            Move "Times New Roman" to sFont
84274>>>            Move 10 to iFontSize
84275>>>
84275>>>            DFFont sFont
84276>>>            DFFontSize iFontSize
84277>>>            DFBeginHeader DFPageTop
84278>>>                DFHeaderFrame Hdr_NoFrame
84279>>>                DFHeaderPos   Hdr_Left
84280>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
84281>>>            DFEndHeader
84283>>>
84283>>>        End_Procedure 
84284>>>
84284>>>        // Report_Header is printed once in a report after Page_Top
84284>>>        //Procedure Report_Header
84284>>>        //    string  sFont
84284>>>        //    integer iFontSize
84284>>>        //    Move "Times New Roman" to sFont
84284>>>        //    Move 10 to iFontSize
84284>>>        //    DFFont sFont
84284>>>        //    DFFontSize iFontSize
84284>>>        //    DFBeginHeader  DFReportHeader
84284>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84284>>>        //        DFHeaderPos    Hdr_Left
84284>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84284>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
84284>>>        //    DFEndHeader
84284>>>        //End_Procedure
84284>>>
84284>>>        Procedure Page_Header 
84287>>>            integer iFill iBorder iStyle
84287>>>            string  sFont sReportTitle
84287>>>            integer iFontSize
84287>>>
84287>>>            Move "Times New Roman" to sFont
84288>>>            Move 16 to iFontSize
84289>>>            Move (Font_bold + rgb_White) to iStyle
84290>>>            Move (rgb_dGrey) to iFill
84291>>>            Move (rgb_dGrey) to iBorder
84292>>>            Get Report_Title to sReportTitle
84293>>>
84293>>>            DFFont sFont
84294>>>            DFFontSize iFontSize
84295>>>            DFBeginHeader DFPageHeader
84296>>>                DFHeaderPos   Hdr_Left
84297>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84298>>>                DFWritelnPos sReportTitle 0.1 iStyle
84299>>>                DFHeaderMargin HM_BottomOuter 0.08
84300>>>            DFEndHeader
84302>>>
84302>>>        End_Procedure 
84303>>>
84303>>>        // Page_Title appears on every page after Page_Header
84303>>>        //Procedure Page_Title
84303>>>        //    string  sFont
84303>>>        //    integer iFontSize
84303>>>        //    Move "Times New Roman" to sFont
84303>>>        //    Move 10 to iFontSize
84303>>>        //    DFFont sFont
84303>>>        //    DFFontSize iFontSize
84303>>>        //    DFBeginHeader  DFPageTitle
84303>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84303>>>        //        DFHeaderPos    Hdr_Left
84303>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84303>>>        //        DFWrite     "Page_Title" (Font_Bold+Font_Center)
84303>>>        //    DFEndHeader
84303>>>        //End_Procedure
84303>>>
84303>>>        Procedure SubHeader1 
84306>>>            string  sFont 
84306>>>            integer iFontSize iStyle
84306>>>            integer iFill iBorder iHeaderStyle
84306>>>
84306>>>
84306>>>            // If (Page_end_State(self)) Begin // Page_end_State must get set in subtotal 1
84306>>>            //    Send DFNew_Page // this will force a new page
84306>>>            // End
84306>>>
84306>>>            Move "Times New Roman" to sFont
84307>>>            Move 10 to iFontSize
84308>>>            Move (font_bold) to iStyle
84309>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
84310>>>            Move (rgb_dGrey) to iBorder
84311>>>            Get DFGetDFColor 242 242 242 to iFill
84312>>>
84312>>>            DFFont sFont
84313>>>            DFFontSize iFontSize
84314>>>            DFBeginHeader DFSubHeader 1
84315>>>                DFHeaderLineCheck 5
84316>>>                DFHeaderWrap   HDR_Wrap
84317>>>                DFHeaderPos    HDR_Left
84318>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
84319>>>                DFHeaderMargin hm_BottomOuter 0.08
84320>>>                DFHeaderMargin hm_TopInner    0.04
84321>>>                DFHeaderMargin hm_BottomInner 0.04
84322>>>
84322>>>                // display fields to be placed in this sub-header
84322>>>                DFWritePos "Mrka:"                      0.1 iHeaderStyle -1 4.9
84323>>>                DFWritePos Auto.Marka                     5 iStyle -1
84324>>>                DFWriteLn
84325>>>
84325>>>                // write the heading for the body section
84325>>>                DFFontSize 1 // create a very small space on top of and below the horizontal bar
84326>>>                DFWriteLn
84327>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
84328>>>                DFWriteLn
84329>>>                DFFontSize iFontSize
84330>>>                DFWritePos "Rgz."                        0.08 iHeaderStyle -1 2.13
84331>>>                DFWriteLn
84332>>>
84332>>>            DFEndHeader
84334>>>
84334>>>        End_Procedure 
84335>>>
84335>>>        Procedure SubTotal1 
84338>>>            // SubTotal section is not used
84338>>>
84338>>>            // Set Page_end_State to True // force a page-break when this section ends
84338>>>
84338>>>        End_Procedure 
84339>>>
84339>>>        // Totals appear at the end of the report before Report_Footer
84339>>>        //Procedure Total
84339>>>        //    string  sFont
84339>>>        //    integer iFontSize
84339>>>        //    Move "Times New Roman" to sFont
84339>>>        //    Move 10 to iFontSize
84339>>>        //    DFFont sFont
84339>>>        //    DFFontSize iFontSize
84339>>>        //    DFBeginHeader  DFTotal
84339>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84339>>>        //        DFHeaderPos    Hdr_Left
84339>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84339>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
84339>>>        //    DFEndHeader
84339>>>        //End_Procedure
84339>>>
84339>>>        // Report_Footer is printed once on the last page before Page_Footer
84339>>>        //Procedure Report_Footer
84339>>>        //    string  sFont
84339>>>        //    integer iFontSize
84339>>>        //    Move "Times New Roman" to sFont
84339>>>        //    Move 10 to iFontSize
84339>>>        //    DFFont sFont
84339>>>        //    DFFontSize iFontSize
84339>>>        //    DFBeginHeader DFReportFooter
84339>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84339>>>        //        DFHeaderPos    Hdr_Left
84339>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84339>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
84339>>>        //    DFEndHeader
84339>>>        //End_Procedure
84339>>>
84339>>>        // // Page_Footer is printed on each page before Page_Bottom
84339>>>        //Procedure Page_Footer
84339>>>        //    string  sFont
84339>>>        //    integer iFontSize
84339>>>        //    Move "Times New Roman" to sFont
84339>>>        //    Move 10 to iFontSize
84339>>>        //    DFFont sFont
84339>>>        //    DFFontSize iFontSize
84339>>>        //    DFBeginHeader DFPageFooter
84339>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84339>>>        //        DFHeaderPos    Hdr_Left
84339>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84339>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
84339>>>        //    DFEndHeader
84339>>>        //End_Procedure
84339>>>
84339>>>
84339>>>        // Page_Bottom is printed last at the bottom margin of each page
84339>>>        Procedure Page_Bottom 
84342>>>            string sFont
84342>>>            integer iFontSize iBorder iStyle
84342>>>            DateTime dtDT
84342>>>
84342>>>            Move (CurrentDateTime()) to dtDT
84343>>>
84343>>>            Move "Times New Roman" to sFont
84344>>>            Move 10 to iFontSize
84345>>>            Move (font_default) to iStyle
84346>>>            Move (rgb_dGrey) to iBorder
84347>>>
84347>>>            DFFont sFont
84348>>>            DFFontSize iFontSize
84349>>>            DFBeginHeader DFPageBottom
84350>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
84351>>>                DFHeaderPos Hdr_Left
84352>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
84353>>>            DFEndHeader
84355>>>
84355>>>        End_Procedure 
84356>>>
84356>>>        // Returns string with description of selection ranges
84356>>>        // Pass: Selection title, start value and end value. Return: description
84356>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
84359>>>            string sText
84359>>>            If (sStart=""  AND sStop="")  function_return ""
84362>>>            If (sStart="0" AND sStop="0") function_return ""
84365>>>            If (sStart<>"" AND sStop<>"") begin
84367>>>                Move ("between" * sStart * "and" * sStop) to sText
84368>>>            end
84368>>>>
84368>>>            Else if (sStart > "") Begin
84371>>>                Move ("starting at" * sStart) to sText
84372>>>            end
84372>>>>
84372>>>            Else if (sStop > "") begin
84375>>>                Move ("up to" * sStop) to sText
84376>>>            End
84376>>>>
84376>>>            function_return (sTitle * sText)
84377>>>        End_Function
84378>>>
84378>>>    End_Object 
84379>>>
84379>>>    Procedure StartReport 
84382>>>        Boolean bToPrinter
84382>>>
84382>>>        // determine if direct print
84382>>>        Get IsToPrinter of oPrintTo to bToPrinter
84383>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
84384>>>
84384>>>        // run the report
84384>>>        Send Run_Report of oReport
84385>>>
84385>>>    End_Procedure 
84386>>>
84386>>>End_Object 
84387>        Use MunkalapKeszites.vw
Including file: MunkalapKeszites.vw    (C:\Repos\DataFlexBeadando\AppSrc\MunkalapKeszites.vw)
84387>>>// C:\Repos\DataFlexBeadando\AppSrc\MunkalapKeszites.vw
84387>>>// MunkalapKeszites
84387>>>//
84387>>>
84387>>>Use DFClient.pkg
84387>>>Use DFEntry.pkg
84387>>>Use cDbCJGrid.pkg
84387>>>Use cDbCJGridColumn.pkg
84387>>>
84387>>>Use cUgyfelDataDictionary.dd
84387>>>Use cAutoDataDictionary.dd
84387>>>Use cMunkalapDataDictionary.dd
84387>>>Use cMunkaDataDictionary.dd
84387>>>Use cMunkaMunkalapDataDictionary.dd
84387>>>
84387>>>ACTIVATE_VIEW Activate_oMunkalapKeszites FOR oMunkalapKeszites
84397>>>>
84397>>>Object oMunkalapKeszites is a dbView
84399>>>    Set Location to 5 5
84400>>>    Set Size to 204 309
84401>>>    Set Label To "MunkalapKeszites"
84402>>>    Set Border_Style to Border_Thick
84403>>>
84403>>>
84403>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
84405>>>    End_Object 
84406>>>
84406>>>    Object oAuto_DD is a cAutoDataDictionary
84408>>>    End_Object 
84409>>>
84409>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84411>>>        Set DDO_Server To oAuto_DD
84412>>>        Set DDO_Server To oUgyfel_DD
84413>>>        // this lets you save a new parent DD from within child DD
84413>>>        Set Allow_Foreign_New_Save_State to True
84414>>>    End_Object 
84415>>>
84415>>>    Object oMunka_DD is a cMunkaDataDictionary
84417>>>    End_Object 
84418>>>
84418>>>    Object oMunkaMunkalap_DD is a cMunkaMunkalapDataDictionary
84420>>>        Set DDO_Server To oMunkalap_DD
84421>>>        Set DDO_Server To oMunka_DD
84422>>>        Set Constrain_File To Munkalap.File_Number
84423>>>    End_Object 
84424>>>
84424>>>    Set Main_DD To oMunkalap_DD
84425>>>    Set Server  To oMunkalap_DD
84426>>>
84426>>>
84426>>>
84426>>>    Object oMunkalapId is a dbForm
84428>>>        Entry_Item Munkalap.Id
84429>>>        Set Size to 13 42
84430>>>        Set Location to 5 68
84431>>>        Set peAnchors to anTopLeftRight
84432>>>        Set Label to "Munkalap azonost"
84433>>>        Set Label_Justification_mode to jMode_Left
84434>>>        Set Label_Col_Offset to 63
84435>>>        Set Label_row_Offset to 0
84436>>>    End_Object 
84437>>>
84437>>>    Object oUgyfelId is a dbForm
84439>>>        Entry_Item Ugyfel.Id
84440>>>        Set Size to 13 42
84441>>>        Set Location to 20 68
84442>>>        Set peAnchors to anTopLeftRight
84443>>>        Set Label to "gyfl azonost"
84444>>>        Set Label_Justification_mode to jMode_Left
84445>>>        Set Label_Col_Offset to 63
84446>>>        Set Label_row_Offset to 0
84447>>>    End_Object 
84448>>>
84448>>>    Object oAutoId is a dbForm
84450>>>        Entry_Item Auto.Id
84451>>>        Set Size to 13 42
84452>>>        Set Location to 35 68
84453>>>        Set peAnchors to anTopLeftRight
84454>>>        Set Label to "Azonost"
84455>>>        Set Label_Justification_mode to jMode_Left
84456>>>        Set Label_Col_Offset to 63
84457>>>        Set Label_row_Offset to 0
84458>>>    End_Object 
84459>>>
84459>>>    Object oMunkalapBehozatal is a dbForm
84461>>>        Entry_Item Munkalap.Behozatal
84462>>>        Set Size to 13 66
84463>>>        Set Location to 50 68
84464>>>        Set peAnchors to anTopLeftRight
84465>>>        Set Label to "Behozatal"
84466>>>        Set Label_Justification_mode to jMode_Left
84467>>>        Set Label_Col_Offset to 63
84468>>>        Set Label_row_Offset to 0
84469>>>    End_Object 
84470>>>
84470>>>    Object oMunkalapElvitel is a dbForm
84472>>>        Entry_Item Munkalap.Elvitel
84473>>>        Set Size to 13 66
84474>>>        Set Location to 65 68
84475>>>        Set peAnchors to anTopLeftRight
84476>>>        Set Label to "Elvitel"
84477>>>        Set Label_Justification_mode to jMode_Left
84478>>>        Set Label_Col_Offset to 63
84479>>>        Set Label_row_Offset to 0
84480>>>    End_Object 
84481>>>
84481>>>    Object oMunkalapAkm is a dbForm
84483>>>        Entry_Item Munkalap.Akm
84484>>>        Set Size to 13 66
84485>>>        Set Location to 80 68
84486>>>        Set peAnchors to anTopLeftRight
84487>>>        Set Label to "Kilmter eltte"
84488>>>        Set Label_Justification_mode to jMode_Left
84489>>>        Set Label_Col_Offset to 63
84490>>>        Set Label_row_Offset to 0
84491>>>    End_Object 
84492>>>
84492>>>    Object oMunkalapBkm is a dbForm
84494>>>        Entry_Item Munkalap.Bkm
84495>>>        Set Size to 13 66
84496>>>        Set Location to 95 68
84497>>>        Set peAnchors to anTopLeftRight
84498>>>        Set Label to "Kilmterlls utns"
84499>>>        Set Label_Justification_mode to jMode_Left
84500>>>        Set Label_Col_Offset to 63
84501>>>        Set Label_row_Offset to 0
84502>>>    End_Object 
84503>>>
84503>>>    Object oAutoMarka is a dbForm
84505>>>        Entry_Item Auto.Marka
84506>>>        Set Size to 13 126
84507>>>        Set Location to 110 68
84508>>>        Set peAnchors to anTopLeftRight
84509>>>        Set Label to "AutoMarka"
84510>>>        Set Label_Justification_mode to jMode_Left
84511>>>        Set Label_Col_Offset to 63
84512>>>        Set Label_row_Offset to 0
84513>>>    End_Object 
84514>>>
84514>>>    Object oDetailGrid is a cDbCJGrid
84516>>>        Set Size to 66 299
84517>>>        Set Location to 133 5
84518>>>        Set Server to oMunkaMunkalap_DD
84519>>>        Set Ordering to 1
84520>>>        Set peAnchors to anAll
84521>>>        Set psLayoutSection to "oMunkalapKeszites_oDetailGrid"
84522>>>        Set pbAllowInsertRow to False
84523>>>        Set pbHeaderPrompts to True
84524>>>
84524>>>        Object oMunka_Id is a cDbCJGridColumn
84526>>>            Entry_Item Munka.Id
84527>>>            Set piWidth to 85
84528>>>            Set psCaption to "Munka azon."
84529>>>        End_Object 
84530>>>
84530>>>        Object oMunka_Name is a cDbCJGridColumn
84532>>>            Entry_Item Munka.Name
84533>>>            Set piWidth to 210
84534>>>            Set psCaption to "Nv"
84535>>>        End_Object 
84536>>>
84536>>>        Object oMunka_Leiras is a cDbCJGridColumn
84538>>>            Entry_Item Munka.Leiras
84539>>>            Set piWidth to 105
84540>>>            Set psCaption to "Lers"
84541>>>        End_Object 
84542>>>
84542>>>        Object oMunka_Egysegar is a cDbCJGridColumn
84544>>>            Entry_Item Munka.Egysegar
84545>>>            Set piWidth to 105
84546>>>            Set psCaption to "Egysgr"
84547>>>        End_Object 
84548>>>
84548>>>    End_Object 
84549>>>
84549>>>    //-----------------------------------------------------------------------
84549>>>    // Create custom confirmation messages for save and delete
84549>>>    // We must create the new functions and assign verify messages
84549>>>    // to them.
84549>>>    //-----------------------------------------------------------------------
84549>>>
84549>>>    Function ConfirmDeleteHeader Returns Boolean
84552>>>        Boolean bFail
84552>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
84553>>>        Function_Return bFail
84554>>>    End_Function 
84555>>>
84555>>>    // Only confirm on the saving of new records
84555>>>    Function ConfirmSaveHeader Returns Boolean
84558>>>        Boolean bNoSave bHasRecord
84558>>>        Handle  hoSrvr
84558>>>        Get Server to hoSrvr
84559>>>        Get HasRecord of hoSrvr to bHasRecord
84560>>>        If not bHasRecord Begin
84562>>>            Get Confirm "Save this NEW header?" to bNoSave
84563>>>        End
84563>>>>
84563>>>        Function_Return bNoSave
84564>>>    End_Function 
84565>>>
84565>>>    // Define alternate confirmation Messages
84565>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
84566>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
84567>>>    // Saves in header should not clear the view
84567>>>    Set Auto_Clear_Deo_State to False
84568>>>
84568>>>
84568>>>End_Object 
84569>
84569>        Procedure Activate_About
84572>            Send DoAbout "" "" "" "" ""
84573>        End_Procedure
84574>
84574>    End_Object
84575>
84575>End_Object
84576>
84576>Start_UI
84577>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 47671
Total Resources: 0
Total Commands : 84576
Total Windows  : 1
Total Pages    : 1
Static Data    : 530751
Message area   : 586702
Total Blocks   : 30321
