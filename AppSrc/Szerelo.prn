Compiling Program: C:\Repos\DataFlexBeadando\AppSrc\Szerelo.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.0\Pkg\dfallent.pkd)
79228>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardCommandBarSystem.pkg)
79228>>>// these are all the packages used in a standard MDI menubar/toolbar system
79228>>>
79228>>>Use cCJCommandBarSystem.pkg
79228>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardMenuItemClasses.pkg)
79228>>>>>Use Dfpanel.pkg
79228>>>>>Use cCJCommandBarSystem.pkg
79228>>>>>Use LanguageText.pkg
79228>>>>>
79228>>>>>
79228>>>>>Class cCJUndoMenuItem is a cCJMenuItem
79229>>>>>    
79229>>>>>    Procedure Construct_Object
79231>>>>>        Forward Send Construct_Object
79233>>>>>        Set psCaption   to C_$CaptionUndo
79234>>>>>        Set psToolTip to C_$ToolTipUndo
79235>>>>>        Set psDescription to C_$DescUndo
79236>>>>>        Set psImage to "ActionUndo.ico"
79237>>>>>        Set pbActiveUpdate to True
79238>>>>>        Set psCategory to C_$CategoryEdit
79239>>>>>        Set psShortcut to C_$Key_Ctrl_Z
79240>>>>>    End_Procedure
79241>>>>>
79241>>>>>    Procedure OnExecute Variant vCommandBarControl
79243>>>>>        Send Undo of (focus(Self))
79244>>>>>    End_Procedure
79245>>>>>    
79245>>>>>    Function IsEnabled Returns Boolean
79247>>>>>        Boolean bEnabled
79247>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
79248>>>>>        Function_Return bEnabled
79249>>>>>    End_Function
79250>>>>>         
79250>>>>>End_Class
79251>>>>>
79251>>>>>
79251>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
79252>>>>>    
79252>>>>>    Procedure Construct_Object
79254>>>>>        Forward Send Construct_Object
79256>>>>>        Set psCaption   to C_$CaptionDelete
79257>>>>>        Set psToolTip to C_$ToolTipDelete
79258>>>>>        Set psDescription to C_$DescDelete
79259>>>>>        Set psImage to "actionDelete.ico"
79260>>>>>        Set psShortcut to C_$Key_Delete
79261>>>>>        Set pbActiveUpdate to True
79262>>>>>        Set psCategory to C_$CategoryEdit
79263>>>>>    End_Procedure
79264>>>>>
79264>>>>>
79264>>>>>    Procedure OnExecute Variant vCommandBarControl
79266>>>>>        Send Delete of (focus(Self))
79267>>>>>    End_Procedure
79268>>>>>    
79268>>>>>    Function IsEnabled Returns Boolean
79270>>>>>        Boolean bEnabled
79270>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
79271>>>>>        Function_Return bEnabled
79272>>>>>    End_Function
79273>>>>>         
79273>>>>>End_Class
79274>>>>>
79274>>>>>
79274>>>>>Class cCJCutMenuItem is a cCJMenuItem
79275>>>>>    
79275>>>>>    Procedure Construct_Object
79277>>>>>        Forward Send Construct_Object
79279>>>>>        Set psCaption   to C_$CaptionCut
79280>>>>>        Set psToolTip to C_$TooltipCut
79281>>>>>        Set psDescription to C_$DescCut
79282>>>>>        Set psImage to "actionCut.ico"
79283>>>>>        Set psShortcut to C_$Key_Ctrl_X
79284>>>>>        Set pbActiveUpdate to True
79285>>>>>        Set psCategory to C_$CategoryEdit
79286>>>>>    End_Procedure
79287>>>>>
79287>>>>>
79287>>>>>    Procedure OnExecute Variant vCommandBarControl
79289>>>>>        Send Cut of (focus(Self))
79290>>>>>    End_Procedure
79291>>>>>    
79291>>>>>    Function IsEnabled Returns Boolean
79293>>>>>        Boolean bEnabled
79293>>>>>        Get CanCut of (Focus(Self)) to bEnabled
79294>>>>>        Function_Return bEnabled
79295>>>>>    End_Function
79296>>>>>         
79296>>>>>End_Class
79297>>>>>
79297>>>>>
79297>>>>>Class cCJCopyMenuItem is a cCJMenuItem
79298>>>>>    
79298>>>>>    Procedure Construct_Object
79300>>>>>        Forward Send Construct_Object
79302>>>>>        Set psCaption   to C_$CaptionCopy
79303>>>>>        Set psToolTip to C_$ToolTipCopy
79304>>>>>        Set psDescription to C_$DescCopy
79305>>>>>        Set psImage to "actionCopy.ico"
79306>>>>>        Set psShortcut to C_$Key_Ctrl_C
79307>>>>>        Set pbActiveUpdate to True
79308>>>>>        Set psCategory to C_$CategoryEdit
79309>>>>>    End_Procedure
79310>>>>>
79310>>>>>
79310>>>>>    Procedure OnExecute Variant vCommandBarControl
79312>>>>>        Send Copy of (focus(Self))
79313>>>>>    End_Procedure
79314>>>>>    
79314>>>>>    Function IsEnabled Returns Boolean
79316>>>>>        Boolean bEnabled
79316>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
79317>>>>>        Function_Return bEnabled
79318>>>>>    End_Function
79319>>>>>         
79319>>>>>End_Class
79320>>>>>
79320>>>>>
79320>>>>>Class cCJPasteMenuItem is a cCJMenuItem
79321>>>>>    
79321>>>>>    Procedure Construct_Object
79323>>>>>        Forward Send Construct_Object
79325>>>>>        Set psCaption   to C_$CaptionPaste
79326>>>>>        Set psToolTip to C_$ToolTipPaste
79327>>>>>        Set psDescription to C_$DescPaste
79328>>>>>        Set psImage to "actionPaste.ico"
79329>>>>>        Set pbActiveUpdate to True
79330>>>>>        Set psShortcut to C_$Key_Ctrl_V
79331>>>>>        Set psCategory to C_$CategoryEdit
79332>>>>>    End_Procedure
79333>>>>>
79333>>>>>
79333>>>>>    Procedure OnExecute Variant vCommandBarControl
79335>>>>>        Send Paste of (focus(Self))
79336>>>>>    End_Procedure
79337>>>>>    
79337>>>>>    Function IsEnabled Returns Boolean
79339>>>>>        Boolean bEnabled
79339>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
79340>>>>>        Function_Return bEnabled
79341>>>>>    End_Function
79342>>>>>         
79342>>>>>End_Class
79343>>>>>
79343>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
79344>>>>>    
79344>>>>>    Procedure Construct_Object
79346>>>>>        Forward Send Construct_Object
79348>>>>>        Set psCaption   to C_$CaptionSelectAll
79349>>>>>        Set psToolTip to C_$ToolTipSelectAll
79350>>>>>        Set psDescription to C_$DescSelectAll
79351>>>>>        Set pbActiveUpdate to True
79352>>>>>        Set psShortcut to C_$Key_Ctrl_A
79353>>>>>        Set psCategory to C_$CategoryEdit
79354>>>>>    End_Procedure
79355>>>>>
79355>>>>>
79355>>>>>    Procedure OnExecute Variant vCommandBarControl
79357>>>>>        Send Select_All of (focus(Self))
79358>>>>>    End_Procedure
79359>>>>>    
79359>>>>>    Function IsEnabled Returns Boolean
79361>>>>>        Boolean bEnabled
79361>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
79362>>>>>        Function_Return bEnabled
79363>>>>>    End_Function
79364>>>>>         
79364>>>>>End_Class
79365>>>>>
79365>>>>> 
79365>>>>>Class cCJExitMenuItem is a cCJMenuItem
79366>>>>>
79366>>>>>    Procedure Construct_Object
79368>>>>>        Forward Send Construct_Object
79370>>>>>        Set psCaption to C_$CaptionExit
79371>>>>>        Set psToolTip to C_$ToolTipExit
79372>>>>>        Set psDescription to C_$ToolTipExit
79373>>>>>        Set psShortcut to C_$Key_Alt_F4
79374>>>>>        Set psCategory to C_$CategoryFile
79375>>>>>    End_Procedure
79376>>>>>
79376>>>>>    Procedure OnExecute Variant vCommandBarControl
79378>>>>>        Send Exit_Application of Desktop
79379>>>>>    End_Procedure
79380>>>>>
79380>>>>>End_Class           
79381>>>>>
79381>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
79382>>>>>
79382>>>>>    Procedure Construct_Object
79384>>>>>        Forward Send Construct_Object
79386>>>>>        Set psCaption to C_$CaptionHelp
79387>>>>>        Set psDescription to C_$ToolTipHelp
79388>>>>>        Set psToolTip to C_$DescHelp
79389>>>>>        Set psImage to "ActionHelp.ico"
79390>>>>>        Set psShortcut to "F1"
79391>>>>>        Set psCategory to C_$CategoryHelp
79392>>>>>    End_Procedure
79393>>>>>    
79393>>>>>    Procedure OnExecute Variant vCommandBarControl
79395>>>>>        Send Help of (Focus(Self))
79396>>>>>    End_Procedure
79397>>>>>
79397>>>>>End_Class
79398>>>>>
79398>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
79399>>>>>
79399>>>>>    Procedure Construct_Object
79401>>>>>        Forward Send Construct_Object
79403>>>>>        Set psCaption to C_$CaptionAddStatusbar
79404>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
79405>>>>>        Set psDescription to  C_$DescAddStatusbar
79406>>>>>        Set psCategory to C_$CategoryWindow
79407>>>>>    End_Procedure
79408>>>>>
79408>>>>>    Procedure OnExecute Variant vCommandBarControl
79410>>>>>        Handle hoCommandBars hoClientArea
79410>>>>>        Get CommandBarSystemObject to hoCommandBars
79411>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79412>>>>>        If hoClientArea Begin
79414>>>>>            // the clientarea's parent panel has message
79414>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
79415>>>>>        End
79415>>>>>>
79415>>>>>    End_Procedure
79416>>>>>
79416>>>>>     Function IsChecked Returns Boolean
79418>>>>>        Boolean bOn
79418>>>>>        Handle hoCommandBars hoClientArea
79418>>>>>        Get CommandBarSystemObject to hoCommandBars
79419>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79420>>>>>        If hoClientArea Begin
79422>>>>>            // the clientarea's parent panel has message
79422>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
79423>>>>>        End
79423>>>>>>
79423>>>>>        Function_Return bOn
79424>>>>>     End_Function
79425>>>>>End_Class
79426>>>>>
79426>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
79427>>>>>
79427>>>>>    Procedure Construct_Object
79429>>>>>        Forward Send Construct_Object
79431>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
79432>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
79433>>>>>        Set psDescription to C_$DescAutoArrangeIcons
79434>>>>>        Set psCategory to C_$CategoryWindow
79435>>>>>    End_Procedure
79436>>>>>
79436>>>>>    Procedure OnExecute Variant vCommandBarControl
79438>>>>>        Handle hoCommandBars hoClientArea
79438>>>>>        Get CommandBarSystemObject to hoCommandBars
79439>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79440>>>>>        If hoClientArea Begin
79442>>>>>            // the clientarea's parent panel has message
79442>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
79443>>>>>        End
79443>>>>>>
79443>>>>>    End_Procedure
79444>>>>>    
79444>>>>>     Function IsChecked Returns Boolean
79446>>>>>        Boolean bOn
79446>>>>>        Handle hoCommandBars hoClientArea
79446>>>>>        Get CommandBarSystemObject to hoCommandBars
79447>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79448>>>>>        If hoClientArea Begin
79450>>>>>            // the clientarea's parent panel has message
79450>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
79451>>>>>        End
79451>>>>>>
79451>>>>>        Function_Return bOn
79452>>>>>     End_Function
79453>>>>>End_Class
79454>>>>>
79454>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
79455>>>>>
79455>>>>>    Procedure Construct_Object
79457>>>>>        Forward Send Construct_Object
79459>>>>>        Set psCaption to C_$CaptionRestoreMenus
79460>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
79461>>>>>        Set psDescription to C_$DescRestoreMenus
79462>>>>>        Set psCategory to C_$CategoryWindow
79463>>>>>    End_Procedure
79464>>>>>
79464>>>>>    Procedure OnExecute Variant vCommandBarControl
79466>>>>>        Handle hoCommandBars
79466>>>>>        Get CommandBarSystemObject to hoCommandBars
79467>>>>>        Send RestoreLayout of hoCommandBars
79468>>>>>    End_Procedure
79469>>>>>    
79469>>>>>End_Class
79470>>>>>
79470>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
79471>>>>>
79471>>>>>    Procedure Construct_Object
79473>>>>>        Forward Send Construct_Object
79475>>>>>        Set psCaption to C_$CaptionCascade
79476>>>>>        Set psToolTip to C_$ToolTipCascade
79477>>>>>        Set psDescription to  C_$DescCascade
79478>>>>>        Set psImage to "ActionCascade.ico"
79479>>>>>        Set psCategory to C_$CategoryWindow
79480>>>>>    End_Procedure
79481>>>>>    
79481>>>>>    Procedure OnExecute Variant vCommandBarControl
79483>>>>>        Handle hoCommandBars hoClientArea
79483>>>>>        Get CommandBarSystemObject to hoCommandBars
79484>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79485>>>>>        If hoClientArea Begin
79487>>>>>            Send Cascade_Windows of hoClientArea
79488>>>>>        End
79488>>>>>>
79488>>>>>    End_Procedure
79489>>>>>End_Class
79490>>>>>
79490>>>>>Class cCJTileHorizontally is a cCJMenuItem
79491>>>>>
79491>>>>>    Procedure Construct_Object
79493>>>>>        Forward Send Construct_Object
79495>>>>>        Set psCaption to C_$CaptionTileHorizontally 
79496>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
79497>>>>>        Set psDescription to  C_$DescTileHorizontally
79498>>>>>        Set psImage to "ActionTileHorizontally.ico"
79499>>>>>        Set psCategory to C_$CategoryWindow
79500>>>>>    End_Procedure
79501>>>>>
79501>>>>>    Procedure OnExecute Variant vCommandBarControl
79503>>>>>        Handle hoCommandBars hoClientArea
79503>>>>>        Get CommandBarSystemObject to hoCommandBars
79504>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79505>>>>>        If hoClientArea Begin
79507>>>>>            Send Tile_Windows_Horizontal of hoClientArea
79508>>>>>        End
79508>>>>>>
79508>>>>>    End_Procedure
79509>>>>>End_Class
79510>>>>>
79510>>>>>Class cCJTileVertically is a cCJMenuItem
79511>>>>>
79511>>>>>    Procedure Construct_Object
79513>>>>>        Forward Send Construct_Object
79515>>>>>        Set psCaption to C_$CaptionTileVertically  
79516>>>>>        Set psToolTip to C_$ToolTipTileVertically
79517>>>>>        Set psDescription to  C_$DescTileVertically
79518>>>>>        Set psImage to "ActionTileVertically.ico"
79519>>>>>        Set psCategory to C_$CategoryWindow
79520>>>>>    End_Procedure
79521>>>>>
79521>>>>>    Procedure OnExecute Variant vCommandBarControl
79523>>>>>        Handle hoCommandBars hoClientArea
79523>>>>>        Get CommandBarSystemObject to hoCommandBars
79524>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79525>>>>>        If hoClientArea Begin
79527>>>>>            Send Tile_Windows_Vertical of hoClientArea
79528>>>>>        End
79528>>>>>>
79528>>>>>    End_Procedure
79529>>>>>End_Class
79530>>>>>
79530>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
79531>>>>>
79531>>>>>    Procedure Construct_Object
79533>>>>>        Forward Send Construct_Object
79535>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
79536>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
79537>>>>>        Set psDescription to  C_$DescMinimizeWindows
79538>>>>>        Set psCategory to C_$CategoryWindow
79539>>>>>    End_Procedure
79540>>>>>
79540>>>>>    Procedure OnExecute Variant vCommandBarControl
79542>>>>>        Handle hoCommandBars hoClientArea
79542>>>>>        Get CommandBarSystemObject to hoCommandBars
79543>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79544>>>>>        If hoClientArea Begin
79546>>>>>            // the clientarea's parent panel has message
79546>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
79547>>>>>        End
79547>>>>>>
79547>>>>>    End_Procedure
79548>>>>>End_Class
79549>>>>>
79549>>>>>
79549>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
79550>>>>>
79550>>>>>    Procedure Construct_Object
79552>>>>>        Forward Send Construct_Object
79554>>>>>        Set psCaption to C_$CaptionRestoreWindows
79555>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
79556>>>>>        Set psDescription to  C_$DescRestoreWindows
79557>>>>>        Set psCategory to C_$CategoryWindow
79558>>>>>    End_Procedure
79559>>>>>
79559>>>>>    Procedure OnExecute Variant vCommandBarControl
79561>>>>>        Handle hoCommandBars hoClientArea
79561>>>>>        Get CommandBarSystemObject to hoCommandBars
79562>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79563>>>>>        If hoClientArea Begin
79565>>>>>            // the clientarea's parent panel has message
79565>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
79566>>>>>        End
79566>>>>>>
79566>>>>>    End_Procedure
79567>>>>>End_Class
79568>>>>>
79568>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
79569>>>>>
79569>>>>>    Procedure Construct_Object
79571>>>>>        Forward Send Construct_Object
79573>>>>>        Set psCaption to C_$CaptionArrangeIcons  
79574>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
79575>>>>>        Set psDescription to  C_$DescArrangeIcons
79576>>>>>        Set psCategory to C_$CategoryWindow
79577>>>>>    End_Procedure
79578>>>>>
79578>>>>>    Procedure OnExecute Variant vCommandBarControl
79580>>>>>        Handle hoCommandBars hoClientArea
79580>>>>>        Get CommandBarSystemObject to hoCommandBars
79581>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79582>>>>>        If hoClientArea Begin
79584>>>>>            Send Arrange_Icons of hoClientArea
79585>>>>>        End
79585>>>>>>
79585>>>>>    End_Procedure
79586>>>>>
79586>>>>>End_Class
79587>>>>>    
79587>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJAboutMenuItem.pkg)
79587>>>>>Use cCJCommandBarSystem.pkg
79587>>>>>Use LanguageText.pkg
79587>>>>>
79587>>>>>// It is expected that if you use this class that you provide an about object that is
79587>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
79587>>>>>// because you may wish to create your own custom about package.
79587>>>>>
79587>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
79588>>>>>
79588>>>>>    Procedure Construct_Object
79590>>>>>        Forward Send Construct_Object
79592>>>>>        Set psCaption to C_$CaptionAbout
79593>>>>>        Set psDescription to C_$ToolTipAbout
79594>>>>>        Set psToolTip to C_$DescAbout
79595>>>>>        Set psImage to "ActionAbout.ico"
79596>>>>>        Set psCategory to C_$CategoryHelp
79597>>>>>    End_Procedure
79598>>>>>    
79598>>>>>    Procedure OnExecute Variant vCommandBarControl
79600>>>>>        Handle hoCommandBars hoClientArea
79600>>>>>        Get CommandBarSystemObject to hoCommandBars
79601>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79602>>>>>        If hoClientArea Begin
79604>>>>>            Send Activate_About of hoClientArea
79605>>>>>        End
79605>>>>>>
79605>>>>>    End_Procedure
79606>>>>>
79606>>>>>End_Class
79607>>>>>
79607>>>>>
79607>>>Use cCJDeoMenuItemClasses.pkg
79607>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJMDIWindowsMenuItem.pkg)
79607>>>>>Use cCJCommandBarSystem.pkg
79607>>>>>
79607>>>>>Register_Function Client_ID Returns Integer
79607>>>>>
79607>>>>>// only used by cCJMDIWIndowsMenuItem
79607>>>>>Class cCJMDIWindowItem is a cCJMenuItem
79608>>>>>
79608>>>>>    Procedure Construct_Object
79610>>>>>        Forward Send Construct_Object
79612>>>>>        Property Handle phWindow 0 // object id of view
79613>>>>>        Set pbControlFlagNoMovable to True
79614>>>>>        Set pbActiveUpdate to True
79615>>>>>    End_Procedure
79616>>>>>    
79616>>>>>    Procedure OnExecute Variant vCommandBarControl
79618>>>>>        Handle hWindow
79618>>>>>        Get phWindow to hWindow
79619>>>>>        Send Activate_View of hWindow
79620>>>>>    End_Procedure
79621>>>>>    
79621>>>>>End_Class                
79622>>>>>
79622>>>>>
79622>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
79623>>>>>    
79623>>>>>    Procedure Construct_Object
79625>>>>>        Forward Send Construct_Object
79627>>>>>        Property Handle[] phArrayOfWindows
79628>>>>>        Set peControlType to xtpControlPopup
79629>>>>>        Set psCategory to C_$CategoryWindow
79630>>>>>    End_Procedure
79631>>>>>    
79631>>>>>     // This adds MDI windows to the existing menu items.
79631>>>>>     // This removes any existing windows menus and always adds a new set to the end
79631>>>>>
79631>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
79633>>>>>        Handle  hClientArea hView
79633>>>>>        String  sLabel
79633>>>>>        Integer i iWindows
79633>>>>>        Handle[] hArrayOfWindows
79634>>>>>        Variant vItem
79634>>>>>        
79634>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
79634>>>>>        // also assume that destroying an action removes all menu instances of that action
79634>>>>>        Get phArrayOfWindows to hArrayOfWindows
79635>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
79636>>>>>        For i from 0 to (iWindows-1)
79642>>>>>>
79642>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
79643>>>>>        Loop
79644>>>>>>
79644>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
79645>>>>>
79645>>>>>        // Add all views to this menu. Create the action and add the item
79645>>>>>        Move 0 to i
79646>>>>>        Get Client_Id to hClientArea // object id of client area
79647>>>>>        If (hClientArea > 0) Begin
79649>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
79650>>>>>            While (hView <> 0)
79654>>>>>                If (Active_State(hView)) Begin
79656>>>>>                    // create the action
79656>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
79657>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
79658>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
79659>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
79660>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
79662>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
79663>>>>>                    End
79663>>>>>>
79663>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
79664>>>>>                    If (i=0) Begin
79666>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
79667>>>>>                    End
79667>>>>>>
79667>>>>>                    // Create a menu item for this action
79667>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
79668>>>>>                    Increment i
79669>>>>>                End
79669>>>>>>
79669>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
79670>>>>>            Loop
79671>>>>>>
79671>>>>>        End
79671>>>>>>
79671>>>>>
79671>>>>>        Set phArrayOfWindows to hArrayOfWindows
79672>>>>>
79672>>>>>     End_Procedure
79673>>>>>     
79673>>>>>End_Class
79674>>>>>
79674>
79674>Object oHtmlHelp is a cHtmlHelp
79676>End_Object
79677>
79677>Object oApplication is a cApplication
79679>    Set peHelpType to htHtmlHelp
79680>
79680>    Object oConnection is a cConnection
79682>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\LoginEncryption.pkg)
79682>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cLoginEncryption.pkg)
79682>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCryptographer.pkg)
79682>>>>>>>Use VdfBase.pkg
79682>>>>>>>
79682>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\CryptographerConstants.pkg)
79682>>>>>>>>>//                                      
79682>>>>>>>>>// File    : CryptographerConstants.pkg
79682>>>>>>>>>//
79682>>>>>>>>>//   Author  : Ulbe Stellema
79682>>>>>>>>>//             Data Access Worldwide
79682>>>>>>>>>//
79682>>>>>>>>>//   Date    : October 4, 2009
79682>>>>>>>>>//
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>// Algorithm classes
79682>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
79682>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
79682>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
79682>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
79682>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
79682>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
79682>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
79682>>>>>>>>>
79682>>>>>>>>>// Algorithm types
79682>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
79682>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
79682>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
79682>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
79682>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
79682>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
79682>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
79682>>>>>>>>>
79682>>>>>>>>>// Generic sub-ids
79682>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
79682>>>>>>>>>
79682>>>>>>>>>// RSA sub-ids
79682>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
79682>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
79682>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
79682>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
79682>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
79682>>>>>>>>>
79682>>>>>>>>>// DSS sub-ids
79682>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
79682>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
79682>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
79682>>>>>>>>>
79682>>>>>>>>>// DES sub_ids
79682>>>>>>>>>Define ALG_SID_DES                      for 1
79682>>>>>>>>>Define ALG_SID_3DES                     for 3
79682>>>>>>>>>Define ALG_SID_DESX                     for 4
79682>>>>>>>>>Define ALG_SID_IDEA                     for 5
79682>>>>>>>>>Define ALG_SID_CAST                     for 6
79682>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
79682>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
79682>>>>>>>>>Define ALG_SID_3DES_112                 for 9
79682>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
79682>>>>>>>>>Define ALG_SID_RC5                      for 13
79682>>>>>>>>>Define ALG_SID_AES_128                  for 14
79682>>>>>>>>>Define ALG_SID_AES_192                  for 15
79682>>>>>>>>>Define ALG_SID_AES_256                  for 16
79682>>>>>>>>>Define ALG_SID_AES                      for 17
79682>>>>>>>>>
79682>>>>>>>>>// Fortezza sub-ids
79682>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
79682>>>>>>>>>Define ALG_SID_TEK                      for 11
79682>>>>>>>>>
79682>>>>>>>>>// RC2 sub-ids
79682>>>>>>>>>Define ALG_SID_RC2                      for 2
79682>>>>>>>>>
79682>>>>>>>>>// Stream cipher sub-ids
79682>>>>>>>>>Define ALG_SID_RC4                      for 1
79682>>>>>>>>>Define ALG_SID_SEAL                     for 2
79682>>>>>>>>>
79682>>>>>>>>>// Diffie-Hellman sub-ids
79682>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
79682>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
79682>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
79682>>>>>>>>>Define ALG_SID_KEA                      for 4
79682>>>>>>>>>
79682>>>>>>>>>// Hash sub ids
79682>>>>>>>>>Define ALG_SID_MD2                      for 1
79682>>>>>>>>>Define ALG_SID_MD4                      for 2
79682>>>>>>>>>Define ALG_SID_MD5                      for 3
79682>>>>>>>>>Define ALG_SID_SHA                      for 4
79682>>>>>>>>>Define ALG_SID_SHA1                     for 4
79682>>>>>>>>>Define ALG_SID_MAC                      for 5
79682>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
79682>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
79682>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
79682>>>>>>>>>Define ALG_SID_HMAC                     for 9
79682>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
79682>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
79682>>>>>>>>>Define ALG_SID_SHA_256                  for 12
79682>>>>>>>>>Define ALG_SID_SHA_384                  for 13
79682>>>>>>>>>Define ALG_SID_SHA_512                  for 14
79682>>>>>>>>>
79682>>>>>>>>>// secure channel sub ids
79682>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
79682>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
79682>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
79682>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
79682>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
79682>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
79682>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
79682>>>>>>>>>
79682>>>>>>>>>// algorithm identifier definitions
79682>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
79682>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
79682>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
79682>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
79682>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
79682>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
79682>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
79682>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
79682>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
79682>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
79682>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
79682>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
79682>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
79682>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
79682>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
79682>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
79682>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
79682>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
79682>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
79682>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
79682>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
79682>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
79682>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
79682>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
79682>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
79682>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
79682>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
79682>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
79682>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
79682>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
79682>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
79682>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
79682>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
79682>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
79682>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
79682>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
79682>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
79682>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
79682>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
79682>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
79682>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
79682>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
79682>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
79682>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
79682>>>>>>>>>
79682>>>>>>>>>// Providers
79682>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
79682>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
79682>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
79682>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
79682>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
79682>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
79682>>>>>>>>>
79682>>>>>>>>>// dwFlags definitions for CryptAcquireContext
79682>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
79682>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
79682>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
79682>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
79682>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
79682>>>>>>>>>
79682>>>>>>>>>// dwFlag definitions for CryptGenKey
79682>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
79682>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
79682>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
79682>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
79682>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
79682>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
79682>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
79682>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
79682>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
79682>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
79682>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
79682>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
79682>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
79682>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
79682>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
79682>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
79682>>>>>>>>>
79682>>>>>>>>>// Provider types
79682>>>>>>>>>Define PROV_RSA_FULL                    for 1
79682>>>>>>>>>Define PROV_RSA_SIG                     for 2
79682>>>>>>>>>Define PROV_DSS                         for 3
79682>>>>>>>>>Define PROV_FORTEZZA                    for 4
79682>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
79682>>>>>>>>>Define PROV_SSL                         for 6
79682>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
79682>>>>>>>>>Define PROV_DSS_DH                      for 13
79682>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
79682>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
79682>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
79682>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
79682>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
79682>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
79682>>>>>>>>>Define PROV_RNG                         for 21
79682>>>>>>>>>Define PROV_INTEL_SEC                   for 22
79682>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
79682>>>>>>>>>Define PROV_RSA_AES                     for 24
79682>>>>>>>>>
79682>>>>>>>>>// KP_MODE
79682>>>>>>>>>// KP_MODE
79682>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
79682>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
79682>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
79682>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
79682>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
79682>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
79682>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
79682>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
79682>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
79682>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
79682>>>>>>>>>
79682>>>>>>>>>// dwParam definitions for CryptGetKeyParam
79682>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
79682>>>>>>>>>Define KP_SALT                          for 2       // Salt value
79682>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
79682>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
79682>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
79682>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
79682>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
79682>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
79682>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
79682>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
79682>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
79682>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
79682>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
79682>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
79682>>>>>>>>>Define KP_Y                             for 15      // Y value
79682>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
79682>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
79682>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
79682>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
79682>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
79682>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
79682>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
79682>>>>>>>>>Define KP_RP                            for 23
79682>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
79682>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
79682>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
79682>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
79682>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
79682>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
79682>>>>>>>>>Define KP_KEYVAL                        for 30
79682>>>>>>>>>Define KP_ADMIN_PIN                     for 31
79682>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
79682>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
79682>>>>>>>>>Define KP_PREHASH                       for 34
79682>>>>>>>>>Define KP_ROUNDS                        for 35
79682>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
79682>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
79682>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
79682>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
79682>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
79682>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
79682>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
79682>>>>>>>>>
79682>>>>>>>>>// dwParam definitions for CryptGetHashParam
79682>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
79682>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
79682>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
79682>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
79682>>>>>>>>>
79682>>>>>>>>>// key BLOB types
79682>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
79682>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
79682>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
79682>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
79682>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
79682>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
79682>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
79682>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
79682>>>>>>>>>
79682>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
79682>>>>>>>>>
79682>>>>>>>>>//  Structure cryptimportkey
79682>>>>>>>>>Struct PUBLICKEYSTRUC
79682>>>>>>>>>    UChar    bType
79682>>>>>>>>>    UChar    bVersion
79682>>>>>>>>>    UShort   reserved
79682>>>>>>>>>    UInteger aiKeyAlg
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>Struct tPLAINTEXTKEYBLOB
79682>>>>>>>>>    PUBLICKEYSTRUC hdr
79682>>>>>>>>>    PUBLICKEYSTRUC hdr
79682>>>>>>>>>    UInteger       dwKeySize
79682>>>>>>>>>//    UChar[]        rgbKeyData
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
79682>>>>>>>>>Struct HMAC_INFO
79682>>>>>>>>>    UInteger HashAlgid
79682>>>>>>>>>    Pointer pbInnerString
79682>>>>>>>>>    DWord cbInnerString
79682>>>>>>>>>    Pointer pbOuterString
79682>>>>>>>>>    DWord cbOuterString
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
79683>>>>>>>>>
79683>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
79684>>>>>>>>>
79684>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
79685>>>>>>>>>
79685>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
79686>>>>>>>>>
79686>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
79687>>>>>>>>>
79687>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
79688>>>>>>>>>
79688>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
79689>>>>>>>>>
79689>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
79690>>>>>>>>>
79690>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
79691>>>>>>>>>
79691>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
79692>>>>>>>>>    
79692>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
79693>>>>>>>>>
79693>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
79694>>>>>>>>>
79694>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
79695>>>>>>>>>
79695>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
79696>>>>>>>>>    
79696>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
79697>>>>>>>>>    
79697>>>>>>>
79697>>>>>>>Class cCryptographer is a cObject
79698>>>>>>>    
79698>>>>>>>    // Procedure : Construct_Object
79698>>>>>>>    // Purpose   : Object constructor
79698>>>>>>>    Procedure Construct_Object
79700>>>>>>>        Forward Send Construct_Object
79702>>>>>>>
79702>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
79703>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
79704>>>>>>>        Property Integer    piCipher    CALG_RC4
79705>>>>>>>        Property Integer    piHash      CALG_MD5
79706>>>>>>>        
79706>>>>>>>        // Private properties
79706>>>>>>>        Property Handle     Private_phProv
79707>>>>>>>    End_Procedure
79708>>>>>>>    
79708>>>>>>>    
79708>>>>>>>    // Function : AcquireContext
79708>>>>>>>    // Purpose  : Acquire key container handle
79708>>>>>>>    Function AcquireContext Returns Handle
79710>>>>>>>        Integer iProvider
79710>>>>>>>        String sProvider
79710>>>>>>>        Handle hProv
79710>>>>>>>        Boolean bOk
79710>>>>>>>        Address addrProv
79710>>>>>>>        
79710>>>>>>>        Move 0 to hProv
79711>>>>>>>        Get piProvider to iProvider
79712>>>>>>>        Get psProvider to sProvider
79713>>>>>>>        
79713>>>>>>>        //  Determine address to be passed as provider
79713>>>>>>>        If (Trim(sProvider) <> "") Begin
79715>>>>>>>            Move (AddressOf(sProvider)) to addrProv
79716>>>>>>>        End
79716>>>>>>>>
79716>>>>>>>        Else Begin
79717>>>>>>>            Move 0 to addrProv
79718>>>>>>>        End
79718>>>>>>>>
79718>>>>>>>        
79718>>>>>>>        //  Acquire Crypto Context
79718>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
79719>>>>>>>        If (not(bOk) or hProv = 0) Begin
79721>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
79722>>>>>>>        End
79722>>>>>>>>
79722>>>>>>>        
79722>>>>>>>        If (not(bOk) or hProv = 0) Begin
79724>>>>>>>            // Fallback to original
79724>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
79725>>>>>>>            
79725>>>>>>>            If (not(bOk) or hProv = 0) Begin
79727>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
79728>>>>>>>            End
79728>>>>>>>>
79728>>>>>>>        End
79728>>>>>>>>
79728>>>>>>>        Set Private_phProv to hProv
79729>>>>>>>        
79729>>>>>>>        Function_Return hProv
79730>>>>>>>    End_Function
79731>>>>>>>    
79731>>>>>>>    // Function : ReleaseContext
79731>>>>>>>    // Purpose  : Releases key container handle
79731>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
79733>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
79734>>>>>>>    End_Function
79735>>>>>>>    
79735>>>>>>>    // Function : CreateHash
79735>>>>>>>    // Purpose  : Creates hash object
79735>>>>>>>    Function CreateHash Handle hProv Returns Handle
79737>>>>>>>        Integer iAlgorithm
79737>>>>>>>        Handle hHash
79737>>>>>>>        Boolean bOk
79737>>>>>>>        
79737>>>>>>>        Move 0 to hHash
79738>>>>>>>        Get piHash to iAlgorithm
79739>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
79740>>>>>>>        
79740>>>>>>>        Function_Return hHash
79741>>>>>>>    End_Function
79742>>>>>>>    
79742>>>>>>>    // Function : DestroyHash
79742>>>>>>>    // Purpose  : Destroys the hash object
79742>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
79744>>>>>>>        Function_Return (CryptDestroyHash(hHash))
79745>>>>>>>    End_Function
79746>>>>>>>    
79746>>>>>>>    // Function : HashData
79746>>>>>>>    // Purpose  : Adds data to hash object
79746>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
79748>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
79749>>>>>>>    End_Function
79750>>>>>>>    
79750>>>>>>>    // Function : DeriveKey
79750>>>>>>>    // Purpose  : Generates session key
79750>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
79752>>>>>>>        Integer iAlgorithm
79752>>>>>>>        Handle hKey
79752>>>>>>>        Boolean bOk
79752>>>>>>>        
79752>>>>>>>        Move 0 to hKey
79753>>>>>>>        Get piCipher to iAlgorithm
79754>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
79755>>>>>>>        
79755>>>>>>>        Function_Return hKey
79756>>>>>>>    End_Function
79757>>>>>>>    
79757>>>>>>>    // Function : ImportPlainTextKey
79757>>>>>>>    // Purpose  : Imports a plain text key
79757>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
79759>>>>>>>        tPLAINTEXTKEYBLOB blobhead
79759>>>>>>>        tPLAINTEXTKEYBLOB blobhead
79759>>>>>>>        Boolean   bSuccess
79759>>>>>>>        Handle    hKey
79759>>>>>>>        Integer   iHeadSize iKeySize
79759>>>>>>>        UChar[]   ucaKeyblob
79760>>>>>>>        Integer iVoid
79760>>>>>>>    
79760>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
79761>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
79762>>>>>>>    
79762>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
79763>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
79764>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
79765>>>>>>>        Move iKeySize           to blobhead.dwKeySize
79766>>>>>>>    
79766>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
79767>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
79768>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
79769>>>>>>>    
79769>>>>>>>        Move 0 to hKey
79770>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
79771>>>>>>>        If (not(bSuccess)) Begin 
79773>>>>>>>            Move (ShowLastError()) to iVoid
79774>>>>>>>        End
79774>>>>>>>>
79774>>>>>>>    
79774>>>>>>>        Function_Return hKey
79775>>>>>>>    End_Function
79776>>>>>>>
79776>>>>>>>    // Function : DestroyKey
79776>>>>>>>    // Purpose  : Destroys the key
79776>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
79778>>>>>>>        Function_Return (CryptDestroyKey(hKey))
79779>>>>>>>    End_Function
79780>>>>>>>    
79780>>>>>>>    // Function : KeyParameter
79780>>>>>>>    // Purpose  : Retrieves key data
79780>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
79782>>>>>>>        Integer iBuffer iLen
79782>>>>>>>        Boolean bOk
79782>>>>>>>        
79782>>>>>>>        Move (SizeOfType(Integer)) to iLen
79783>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
79784>>>>>>>        Function_Return iBuffer
79785>>>>>>>    End_Function
79786>>>>>>>    
79786>>>>>>>    // Function : HashValue
79786>>>>>>>    // Purpose  : Retrieves a hash value
79786>>>>>>>    Function HashValue Handle lhHash Returns String
79788>>>>>>>        Pointer lpSize
79788>>>>>>>        Pointer lpHash
79788>>>>>>>        String  lsSize
79788>>>>>>>        String  lsHash
79788>>>>>>>        Integer liResult
79788>>>>>>>
79788>>>>>>>        Move (Repeat(Character(0),4)) to lsSize
79789>>>>>>>        GetAddress of lsSize to lpSize
79790>>>>>>>
79790>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,lpSize,0)) to liResult
79791>>>>>>>        If (liResult = 0) Function_Return ""
79794>>>>>>>
79794>>>>>>>        Move (Repeat(Character(0),BytesTodWord(lsSize,1))) to lsHash
79795>>>>>>>        GetAddress of lsHash to lpHash
79796>>>>>>>
79796>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,lpHash,lpSize,0)) to liResult
79797>>>>>>>        If (liResult = 0) Function_Return ""
79800>>>>>>>
79800>>>>>>>        Function_Return lsHash
79801>>>>>>>    End_Function  // HashValue
79802>>>>>>>    
79802>>>>>>>            
79802>>>>>>>    // Function : Encrypt
79802>>>>>>>    // Purpose  : Encrypts data
79802>>>>>>>    Function Encrypt String sPassword String sData Returns String
79804>>>>>>>        Handle hProv hHash hKey
79804>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
79804>>>>>>>        Boolean bOk
79804>>>>>>>        
79804>>>>>>>        Get AcquireContext to hProv
79805>>>>>>>        If (hProv) Begin
79807>>>>>>>            Get CreateHash hProv to hHash
79808>>>>>>>            If (hHash) Begin
79810>>>>>>>                Get HashData hHash sPassword to bOk
79811>>>>>>>                If (bOk) Begin
79813>>>>>>>                    Get piCipher to iAlgorithm
79814>>>>>>>                    Get DeriveKey hProv hHash to hKey
79815>>>>>>>                End // If (bOk) Begin            
79815>>>>>>>>
79815>>>>>>>                Get DestroyHash hHash to bOk
79816>>>>>>>            End // If (hHash) Begin
79816>>>>>>>>
79816>>>>>>>            
79816>>>>>>>            If (hKey) Begin
79818>>>>>>>                //  First call to determine resulting data size
79818>>>>>>>                Move (Length(sData)) to iDataLen
79819>>>>>>>                Move (Length(sData)) to iCipherLen
79820>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
79821>>>>>>>                
79821>>>>>>>                //  Reserve space in string
79821>>>>>>>                If (iDataLen < iCipherLen) Begin
79823>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
79824>>>>>>>                End
79824>>>>>>>>
79824>>>>>>>                
79824>>>>>>>                //  Call to really decrypt
79824>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
79825>>>>>>>                //If (not(bOk)) Begin
79825>>>>>>>                    //Move "" to sData
79825>>>>>>>                    //Move (GetLastError()) to iErr
79825>>>>>>>                //End
79825>>>>>>>                
79825>>>>>>>                Get DestroyKey hKey to bOk
79826>>>>>>>            End // If (hKey) Begin
79826>>>>>>>>
79826>>>>>>>            Get ReleaseContext hProv to bOk
79827>>>>>>>        End // If (hProv) Begin
79827>>>>>>>>
79827>>>>>>>        Function_Return sData
79828>>>>>>>    End_Function
79829>>>>>>>    
79829>>>>>>>    // Function : Decrypt
79829>>>>>>>    // Purpose  : Decrypts data
79829>>>>>>>    Function Decrypt String sPassword String sData Returns String
79831>>>>>>>        Handle hProv hHash hKey
79831>>>>>>>        Integer iAlgorithm iDataLen
79831>>>>>>>        Boolean bOk
79831>>>>>>>        
79831>>>>>>>        Get AcquireContext to hProv
79832>>>>>>>        If (hProv) Begin
79834>>>>>>>            Get CreateHash hProv to hHash
79835>>>>>>>            If (hHash) Begin
79837>>>>>>>                Get HashData hHash sPassword to bOk
79838>>>>>>>                If (bOk) Begin
79840>>>>>>>                    Get piCipher to iAlgorithm
79841>>>>>>>                    Get DeriveKey hProv hHash to hKey
79842>>>>>>>                End // If (bOk) Begin            
79842>>>>>>>>
79842>>>>>>>                Get DestroyHash hHash to bOk
79843>>>>>>>            End // If (hHash) Begin
79843>>>>>>>>
79843>>>>>>>            
79843>>>>>>>            If (hKey) Begin
79845>>>>>>>                Move (Length(sData)) to iDataLen
79846>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
79847>>>>>>>                //If (bOk = False) Move "" to sData
79847>>>>>>>                
79847>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
79847>>>>>>>                If (Length(sData) > iDataLen) Begin
79849>>>>>>>                    Move (Left(sData, iDataLen)) to sData
79850>>>>>>>                End
79850>>>>>>>>
79850>>>>>>>                
79850>>>>>>>                Get DestroyKey hKey to bOk
79851>>>>>>>            End // If (hKey) Begin
79851>>>>>>>>
79851>>>>>>>            Get ReleaseContext hProv to bOk
79852>>>>>>>        End // If (hProv) Begin
79852>>>>>>>>
79852>>>>>>>        Function_Return sData
79853>>>>>>>    End_Function
79854>>>>>>>    
79854>>>>>>>    //  Function : GenerateRandom
79854>>>>>>>    //  Purpose  : Generates random data.
79854>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
79856>>>>>>>        Handle hProv
79856>>>>>>>        UChar[] uaResult
79857>>>>>>>        Boolean bRes
79857>>>>>>>        
79857>>>>>>>        Get AcquireContext to hProv
79858>>>>>>>        
79858>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
79859>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
79860>>>>>>>        
79860>>>>>>>        Get ReleaseContext hProv to bRes
79861>>>>>>>        
79861>>>>>>>        Function_Return uaResult
79862>>>>>>>    End_Function
79863>>>>>>>    
79863>>>>>>>    //  Function : GenerateRandomString
79863>>>>>>>    //  Purpose  : Generates random data and does a base64 encoding to properly present it as a string.
79863>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
79865>>>>>>>        String sResult
79865>>>>>>>        UChar[] aData
79866>>>>>>>        Address pBase64
79866>>>>>>>        Integer iVoid
79866>>>>>>>
79866>>>>>>>        Get GenerateRandom iLenght to aData
79867>>>>>>>        
79867>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
79868>>>>>>>        Move pBase64 to sResult
79869>>>>>>>        Move (Free(pBase64)) to iVoid    
79870>>>>>>>        
79870>>>>>>>        Function_Return (Left(sResult, iLenght))
79871>>>>>>>    End_Function
79872>>>>>>>
79872>>>>>>>End_Class
79873>>>>>
79873>>>>>Class cLoginEncryption is a cObject
79874>>>>>    
79874>>>>>    Procedure Construct_Object
79876>>>>>        Forward Send Construct_Object
79878>>>>>        // this must be set to a multi (40ish) character random key
79878>>>>>        Property String psEncryptPassword ""
79879>>>>>    
79879>>>>>        Object oDataCrypter is a cCryptographer
79881>>>>>            Set piHash to CALG_SHA_256
79882>>>>>            Set piCipher to CALG_AES_256
79883>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
79884>>>>>            Set piProvider to PROV_RSA_AES
79885>>>>>        End_Object
79886>>>>>    End_Procedure
79887>>>>>        
79887>>>>>    // This can be augmented to return a password encryption key using any
79887>>>>>    // hidden mechanism desired.    
79887>>>>>    Function GetEncryptionPassword Returns String
79889>>>>>        String sPassword
79889>>>>>        Get psEncryptPassword to sPassword    
79890>>>>>        Function_Return sPassword
79891>>>>>    End_Function
79892>>>>>    
79892>>>>>    // EncryptPassword:
79892>>>>>    
79892>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
79892>>>>>    //
79892>>>>>    // Params:
79892>>>>>    //   sPlainText     String to encrypt.
79892>>>>>    // Returns:
79892>>>>>    //   Base64 encoded hash.
79892>>>>>    Function EncryptPassword String sPlainText Returns String
79894>>>>>        String sEncryptPassword sBinary sBase64
79894>>>>>        Address pBase64
79894>>>>>        Integer iVoid
79894>>>>>        
79894>>>>>        //  Encrypt Key
79894>>>>>        Get GetEncryptionPassword to sEncryptPassword
79895>>>>>        If (sEncryptPassword = "") Begin
79897>>>>>            Error DFERR_PROGRAM "No encryption password set" 
79898>>>>>>
79898>>>>>        End
79898>>>>>>
79898>>>>>        
79898>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
79899>>>>>        
79899>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
79901>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
79902>>>>>>
79902>>>>>            Function_Return ""
79903>>>>>        End
79903>>>>>>
79903>>>>>        
79903>>>>>        //  Encode binary hash to Base64
79903>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
79904>>>>>        Move pBase64 to sBase64
79905>>>>>        Move (Free(pBase64)) to iVoid
79906>>>>>        
79906>>>>>        Function_Return sBase64
79907>>>>>    End_Function
79908>>>>>    
79908>>>>>    
79908>>>>>    // DecryptPassword:
79908>>>>>    
79908>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
79908>>>>>    //
79908>>>>>    // Params:
79908>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
79908>>>>>    // Returns:
79908>>>>>    //   Readable plain text password
79908>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
79910>>>>>        String sEncryptPassword sPlainText sBinary
79910>>>>>        Boolean bIsHex
79910>>>>>        Integer iLen iVoid
79910>>>>>        Address pBinary
79910>>>>>        
79910>>>>>        If (sBase64EncryptedPassword <> "") Begin
79912>>>>>            //  Decode from Base64
79912>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
79913>>>>>            
79913>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
79914>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
79915>>>>>            
79915>>>>>            Move (Free(pBinary)) to iVoid
79916>>>>>    
79916>>>>>            //  Encrypted binary hash to string
79916>>>>>            Get GetEncryptionPassword to sEncryptPassword
79917>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
79918>>>>>        End
79918>>>>>>
79918>>>>>        
79918>>>>>        Function_Return sPlainText
79919>>>>>    End_Function
79920>>>>>End_Class
79921>>>>>    
79921>>>
79921>>>Object oLoginEncryption is a cLoginEncryption
79923>>>
79923>>>    // this must be created in your appsrc directory and must contain an encryption
79923>>>    // key that is set to psEncryptPassword. It will look something like this
79923>>>    //
79923>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
79923>>>    //  
Including file: LoginEncryptionKey.inc    (C:\Repos\DataFlexBeadando\AppSrc\LoginEncryptionKey.inc)
79923>>>>// Studio generated login encryption key
79923>>>>Set psEncryptPassword to "8eH5|`Xs0c>fum6W8E6^}#@XhoWPuDN)Usf_t<]("
79924>>>>
79924>>>    
79924>>>    // use this to register this object to your cConnection Object. This object
79924>>>    // must be created after the cConnection object
79924>>>    Move Self to ghoLoginEncryption
79925>>>End_Object
79926>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DatabaseLoginDialog.dg)
79926>>>
79926>>>Use Windows.pkg
79926>>>Use cConnection.pkg
79926>>>Use dfLine.pkg
79926>>>
79926>>>Object oDatabaseLoginDialog is a ModalPanel
79928>>>    Set Label to "Database Login"
79929>>>    Set Location to 2 2
79930>>>    Set Size to 110 211
79931>>>
79931>>>    Property String psId
79933>>>    Property Boolean pbOk False
79935>>>    Property Boolean pbChanged False
79937>>>    Property Boolean pbAllowRemember True
79939>>>
79939>>>    // this registers this object with the cConnection object.
79939>>>    Move Self to ghoLoginConnectDialog
79940>>>
79940>>>    Object oUserIDForm is a Form
79942>>>        Set Label to "User Name"
79943>>>        Set Size to 13 85
79944>>>        Set Location to 34 79
79945>>>        Set Label_Col_Offset to 64
79946>>>                Set peAnchors to anTopLeftRight
79947>>>    End_Object
79948>>>
79948>>>    Object oPwdForm is a Form
79950>>>        Set Size to 13 85
79951>>>        Set Location to 49 79
79952>>>        Set Label_Col_Offset to 64
79953>>>        Set Password_State to True
79954>>>                Set peAnchors to anTopLeftRight
79955>>>        Set Label to "Password"
79956>>>    End_Object
79957>>>
79957>>>    Object oTrustedConnection is a CheckBox
79959>>>        Set Size to 10 50
79960>>>        Set Location to 65 79
79961>>>        Set Label to "Trusted Connection"
79962>>>    End_Object
79963>>>
79963>>>    Object oRemember is a CheckBox
79965>>>        Set Size to 10 50
79966>>>        Set Location to 79 14
79967>>>        Set Label to "Remember and don't ask again"
79968>>>        Set Checked_State to True
79969>>>    End_Object
79970>>>
79970>>>    Object oLogin_btn is a Button
79972>>>        Set Label to "&Login"
79973>>>        Set Location to 92 102
79974>>>        Set peAnchors to anBottomRight
79975>>>        Set Default_State to True
79976>>>
79976>>>        Procedure OnClick
79979>>>            Boolean bTrust
79979>>>            String sUser sPwd sConn sErr sId
79979>>>            Integer iError
79979>>>            Get psId to sId
79980>>>            Get Value of oUserIDForm to sUser
79981>>>            Get Value of oPwdForm to sPwd
79982>>>            Get Checked_State of oTrustedConnection to bTrust
79983>>>            
79983>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
79984>>>            If (iError=0) Begin
79986>>>                Set pbOk to True
79987>>>                Set pbChanged to True
79988>>>                // using Stop_UI instead of close_panel keeps it running when the dialog
79988>>>                // is the only dialog and it closes
79988>>>                Send Stop_UI
79989>>>//                Send Close_Panel
79989>>>            End
79989>>>>
79989>>>            Else Begin
79990>>>                Get psErrorText of ghoConnection to sErr
79991>>>                Send UserError sErr "Login Error"
79992>>>            End
79992>>>>
79992>>>        End_Procedure
79993>>>    End_Object
79994>>>
79994>>>    Object oCancel_btn is a Button
79996>>>        Set Label to "&Cancel"
79997>>>        Set Location to 92 157
79998>>>        Set peAnchors to anBottomRight
79999>>>
79999>>>        Procedure OnClick
80002>>>            Send Stop_UI
80003>>>//            Send Close_Panel
80003>>>        End_Procedure
80004>>>    End_Object
80005>>>
80005>>>    Object oConnectionIdInfo is a TextBox
80007>>>        Set Size to 10 50
80008>>>        Set Location to 4 14
80009>>>        Set Label to 'Connection Id='
80010>>>    End_Object
80011>>>
80011>>>    Object oConnectionServerInfo is a TextBox
80013>>>        Set Size to 10 50
80014>>>        Set Location to 16 14
80015>>>        Set Label to 'Server'
80016>>>    End_Object
80017>>>
80017>>>    Object oLineControl1 is a LineControl
80019>>>        Set Size to 2 202
80020>>>        Set Location to 29 5
80021>>>    End_Object
80022>>>
80022>>>    Function LoginConnectIdDialog String sId Returns Boolean
80025>>>         Boolean bOk bChanged bTrusted bAllowRemember bRemember
80025>>>         String sUser sPwd sDescription
80025>>>         tConnection Connect
80025>>>         tConnection Connect
80025>>>         
80025>>>         Get pbAllowRemember to bAllowRemember
80026>>>         
80026>>>
80026>>>         If not bAllowRemember Begin
80028>>>            Set Enabled_State of oRemember to bRemember
80029>>>            Set Visible_State of oRemember to bRemember
80030>>>         End
80030>>>>
80030>>>         
80030>>>         Get ConnectionIdInfo of ghoConnection sId to Connect
80031>>>         Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
80032>>>         Set Value of oConnectionServerInfo to Connect.sString
80033>>>
80033>>>         Set psId to sId
80034>>>         Set pbOk to False
80035>>>         Set pbChanged to False
80036>>>         Set Value of oUserIDForm to Connect.sUID
80037>>>         Set Value of oPwdForm to ""
80038>>>         
80038>>>         Send Popup
80039>>>         
80039>>>         Get pbOk to bOk
80040>>>         Get pbChanged to bChanged
80041>>>         If (bChanged and bOk) Begin
80043>>>            If bAllowRemember Begin
80045>>>                Get Checked_State of oRemember to bRemember
80046>>>                If bRemember Begin
80048>>>                    Get Checked_State of oTrustedConnection to bTrusted
80049>>>                    If not (bTrusted) Begin
80051>>>                        Get Value of oUserIDForm to sUser
80052>>>                        Get Value of oPwdForm to sPwd
80053>>>                    End
80053>>>>
80053>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
80054>>>                 End
80054>>>>
80054>>>             End
80054>>>>
80054>>>         End
80054>>>>
80054>>>         Function_Return bOk
80055>>>    End_Function
80056>>>    
80056>>>    
80056>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
80057>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
80058>>>End_Object
80059>>>
80059>    End_Object
80060>
80060>End_Object
80061>
80061>Object oToolTipController is a cToolTipController
80063>    Move Self to ghoToolTipController
80064>End_Object
80065>
80065>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oEditContextMenu.pkg)
80065>>>Use cCJStandardMenuItemClasses.pkg
80065>>>
80065>>>Object oEditContextMenu is a cCJContextMenu
80067>>>    
80067>>>    Move Self to Default_Form_Floating_Menu_ID
80068>>>    
80068>>>    Object oUndoMenuItem is a cCJUndoMenuItem
80070>>>    End_Object
80071>>>    
80071>>>    Object oCutMenuItem is a cCJCutMenuItem
80073>>>        Set pbControlBeginGroup to True
80074>>>    End_Object
80075>>>    
80075>>>    Object oCopyMenuItem is a cCJCopyMenuItem
80077>>>    End_Object
80078>>>
80078>>>    Object oPasteMenuItem is a cCJPasteMenuItem
80080>>>    End_Object
80081>>>
80081>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
80083>>>    End_Object
80084>>>
80084>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
80086>>>        Set pbControlBeginGroup to True
80087>>>    End_Object
80088>>>
80088>>>End_Object
80089>>>
80089>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oDEOEditContextMenu17.pkg)
80089>>>Use Windows.pkg
80089>>>Use cCJStandardMenuItemClasses.pkg
80089>>>Use cCJDeoMenuItemClasses.pkg
80089>>>
80089>>>
80089>>>Object oDEOEditContextMenu17 is a cCJContextMenu
80091>>>    
80091>>>    Move Self to Default_dbFloating_Menu_ID
80092>>>    
80092>>>    Object oUndoMenuItem is a cCJUndoMenuItem
80094>>>    End_Object
80095>>>    
80095>>>    Object oCutMenuItem is a cCJCutMenuItem
80097>>>        Set pbControlBeginGroup to True
80098>>>    End_Object
80099>>>    
80099>>>    Object oCopyMenuItem is a cCJCopyMenuItem
80101>>>    End_Object
80102>>>
80102>>>    Object oPasteMenuItem is a cCJPasteMenuItem
80104>>>    End_Object
80105>>>
80105>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
80107>>>    End_Object
80108>>>
80108>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
80110>>>        Set pbControlBeginGroup to True
80111>>>    End_Object
80112>>>
80112>>>    Object oPromptMenuItem is a cCJPromptMenuItem
80114>>>        Set pbControlBeginGroup to True
80115>>>    End_Object
80116>>>
80116>>>    Object oFindNextMenu is a cCJFindNextMenuItem
80118>>>        Set pbControlBeginGroup to True
80119>>>    End_Object
80120>>>
80120>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
80122>>>    End_Object
80123>>>
80123>>>    Object oClearMenuItem is a cCJClearMenuItem
80125>>>        Set pbControlBeginGroup to True
80126>>>    End_Object
80127>>>
80127>>>    Object oClearAllMenu is a cCJClearAllMenuItem
80129>>>    End_Object
80130>>>
80130>>>    Object oSaveMenu is a cCJSaveMenuItem
80132>>>    End_Object
80133>>>    
80133>>>    Object oDeleteMenu is a cCJDeleteMenuItem
80135>>>    End_Object
80136>>>
80136>>>    Object oRememberitem is a cCJRememberFieldMenuItem
80138>>>        Set pbControlBeginGroup to True
80139>>>    End_Object
80140>>>
80140>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
80142>>>    End_Object
80143>>>
80143>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
80145>>>    End_Object
80146>>>
80146>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
80148>>>    End_Object
80149>>>
80149>>>End_Object
80150>
80150>Object oMain is a Panel
80152>    Set Label To "My Project"
80153>    Set Location to 4 3
80154>    Set Size to 300 450
80155>
80155>    Object oCommandBarSystem is a cCJCommandBarSystem
80157>        Set pbTimerUpdate to True
80158>        Set peVisualTheme to xtpThemeOffice2013Outlook
80159>        Set pbAutoResizeIcons to True
80160>
80160>        Procedure OnCreateCommandBars
80163>            Handle hoOptions
80163>            Get OptionsObject to hoOptions
80164>            Forward Send OnCreateCommandBars
80166>        End_Procedure
80167>
80167>        Object oMenuBar is a cCJMenuBar
80169>
80169>            Object oFileMenu is a cCJMenuItem
80171>                Set peControlType to xtpControlPopup          
80172>                Set psCaption   to "&File"
80173>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
80174>                Set psCategory to "Menus"
80175>
80175>                Object oClearMenuItem is a cCJClearMenuItem
80177>                    Set pbAddToDesignerMenu to True
80178>                End_Object
80179>
80179>                Object oClearAllMenu is a cCJClearAllMenuItem
80181>                    Set pbAddToDesignerMenu to True
80182>                End_Object
80183>
80183>                Object oPromptMenuItem is a cCJPromptMenuItem
80185>                    Set pbAddToDesignerMenu to True
80186>                    Set pbControlBeginGroup to True
80187>                End_Object
80188>
80188>                Object oFindMenuItem is a cCJFindMenuItem
80190>                    Set pbAddToDesignerMenu to True
80191>                    Set pbControlBeginGroup to True
80192>                End_Object
80193>
80193>                Object oFindNextMenu is a cCJFindNextMenuItem
80195>                    Set pbAddToDesignerMenu to True
80196>                End_Object
80197>
80197>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
80199>                    Set pbAddToDesignerMenu to True
80200>                End_Object
80201>
80201>                Object oFindFirstMenu is a cCJFindFirstMenuItem
80203>                    Set pbAddToDesignerMenu to True
80204>                End_Object
80205>
80205>                Object oFindLastMenu is a cCJFindLastMenuItem
80207>                    Set pbAddToDesignerMenu to True
80208>                End_Object
80209>
80209>                Object oSaveMenuItem is a cCJSaveMenuItem
80211>                    Set pbAddToDesignerMenu to True
80212>                    Set pbControlBeginGroup to True
80213>                End_Object
80214>
80214>                Object oDeleteMenuItem is a cCJDeleteMenuItem
80216>                    Set pbAddToDesignerMenu to True
80217>                End_Object
80218>
80218>                Object oExitMenu is a cCJExitMenuItem
80220>                    Set pbControlBeginGroup to True
80221>                End_Object
80222>
80222>            End_Object
80223>
80223>            Object oViewMenu is a cCJMenuItem
80225>                Set peControlType to xtpControlPopup
80226>                Set psCaption to "&View"
80227>                Set psToolTip to "View"
80228>                Set psDescription to "Available Views"
80229>
80229>                Object oAutoMenuItem is a cCJMenuItem
80231>                    Set psCaption to "Auto"
80232>                    Set psTooltip to "Auto"
80233>                
80233>                    Procedure OnExecute Variant vCommandBarControl
80236>                        Handle hoClient
80236>                        Get Client_Id to hoClient
80237>                        Send Activate_oAuto of hoClient
80238>                    End_Procedure
80239>                End_Object
80240>
80240>                Object oMunkaMenuItem is a cCJMenuItem
80242>                    Set psCaption to "Munka"
80243>                    Set psTooltip to "Munka"
80244>                
80244>                    Procedure OnExecute Variant vCommandBarControl
80247>                        Handle hoClient
80247>                        Get Client_Id to hoClient
80248>                        Send Activate_oMunka of hoClient
80249>                    End_Procedure
80250>                End_Object
80251>
80251>                Object oUgyfelMenuItem is a cCJMenuItem
80253>                    Set psCaption to "Ugyfel"
80254>                    Set psTooltip to "Ugyfel"
80255>                
80255>                    Procedure OnExecute Variant vCommandBarControl
80258>                        Handle hoClient
80258>                        Get Client_Id to hoClient
80259>                        Send Activate_oUgyfel of hoClient
80260>                    End_Procedure
80261>                End_Object
80262>
80262>                Object oMunkalapMenuItem is a cCJMenuItem
80264>                    Set psCaption to "Munkalap"
80265>                    Set psTooltip to "Munkalap"
80266>                
80266>                    Procedure OnExecute Variant vCommandBarControl
80269>                        Handle hoClient
80269>                        Get Client_Id to hoClient
80270>                        Send Activate_oMunkalap of hoClient
80271>                    End_Procedure
80272>                End_Object
80273>            End_Object
80274>            
80274>            Object oReportMenu is a cCJMenuItem
80276>                Set peControlType to xtpControlPopup          
80277>                Set psCaption to "&Report"
80278>                Set psToolTip to "Report"
80279>                Set psDescription to "Available Reports"
80280>            End_Object
80281>
80281>            Object oNavigateMenu is a cCJMenuItem
80283>                Set peControlType to xtpControlPopup      
80284>                Set psCaption to "&Navigate"    
80285>                Set psTooltip to "Navigate"    
80286>                Set psDescription to "Move to different areas of the application"
80287>
80287>                Object oNextAreaMenu is a cCJNextAreaMenu
80289>                End_Object
80290>
80290>                Object oPriorAreaMenu is a cCJPriorAreaMenu
80292>                End_Object
80293>
80293>                Object oNextViewMenu is a cCJNextViewMenu
80295>                End_Object
80296>
80296>                Object oPriorViewMenu is a cCJPriorViewMenu
80298>                End_Object
80299>
80299>                Object oPromptMenu is a cCJPromptMenuItem
80301>                    Set pbControlBeginGroup to True
80302>                End_Object
80303>
80303>                Object oZoomMenu is a cCJZoomMenuItem
80305>                End_Object
80306>
80306>            End_Object
80307>
80307>            Object oWindowMenu is a cCJMDIWindowsMenuItem
80309>                Set peControlType to xtpControlPopup
80310>                Set psCaption to "&Window"
80311>                Set psToolTip to "Window"
80312>                Set psDescription to "Display Current Views and set other display options."    
80313>
80313>                // These are the static windows items. More will be created in onInitPopup 
80313>                Object oDisplayOptionsMenu is a cCJMenuItem
80315>                    Set peControlType to xtpControlPopup          
80316>                    Set psCaption to "&Display Options"
80317>                    Set psToolTip to "Display Options"
80318>                    Set psDescription to "Set display options"
80319>
80319>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
80321>                    End_Object
80322>
80322>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
80324>                    End_Object
80325>
80325>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
80327>                        Set pbControlBeginGroup to True
80328>                    End_Object
80329>
80329>                End_Object
80330>
80330>                Object oCascadeMenu is a cCJCascadeMenuItem
80332>                    Set pbControlBeginGroup to True
80333>                End_Object
80334>
80334>                Object oHorizTile is a cCJTileHorizontally
80336>                End_Object
80337>
80337>                Object oVertTile is a cCJTileVertically
80339>                End_Object
80340>
80340>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
80342>                    Set pbControlBeginGroup to True
80343>                End_Object
80344>
80344>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
80346>                End_Object
80347>
80347>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
80349>                    Set pbControlBeginGroup to True
80350>                End_Object
80351>
80351>            End_Object
80352>
80352>            Object oHelpMenu is a cCJMenuItem
80354>                Set peControlType to xtpControlPopup    
80355>                Set psCaption to "&Help"
80356>                Set psDescription to "Access Information for learning and using this DataFlex application."
80357>                Set psToolTip to "Help"
80358>
80358>                Object oHelpMenuItem is a cCJHelpMenuItem 
80360>                End_Object
80361>
80361>                Object oAboutMenuItem is a cCJAboutMenuItem
80363>                End_Object
80364>
80364>            End_Object
80365>
80365>        End_Object
80366>
80366>        Object oFindToolBar is a cCJToolbar
80368>            Set psTitle to "Finding Toolbar"
80369>
80369>            Object oFindFirstTool is a cCJFindFirstMenuItem
80371>            End_Object
80372>
80372>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
80374>            End_Object
80375>
80375>            Object oFindMenuTool is a cCJFindMenuItem
80377>            End_Object
80378>
80378>            Object oFindNextTool is a cCJFindNextMenuItem
80380>            End_Object
80381>
80381>            Object oFindLastTool is a cCJFindLastMenuItem
80383>            End_Object
80384>
80384>            Object oPromptToolItem is a cCJPromptMenuItem
80386>                Set pbControlBeginGroup to True
80387>            End_Object
80388>
80388>        End_Object
80389>
80389>        Object oFileToolBar is a cCJToolbar
80391>            Set psTitle to "Data Entry Toolbar"
80392>
80392>            Object oClearToolItem is a cCJClearMenuItem
80394>                Set peControlStyle to xtpButtonIconAndCaption
80395>            End_Object
80396>
80396>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
80398>                Set peControlStyle to xtpButtonIconAndCaption
80399>            End_Object
80400>
80400>            Object oSaveToolItem is a cCJSaveMenuItem
80402>                Set peControlStyle to xtpButtonIconAndCaption
80403>                Set pbControlBeginGroup to True
80404>            End_Object
80405>
80405>            Object oDeleteToolItem is a cCJDeleteMenuItem
80407>                Set peControlStyle to xtpButtonIconAndCaption
80408>            End_Object
80409>
80409>        End_Object
80410>
80410>        Object oEditToolBar is a cCJToolbar
80412>            Set psTitle to "Edit Toolbar"
80413>
80413>            Object oCutToolbarItem is a cCJCutMenuItem
80415>            End_Object
80416>
80416>            Object oCopyToolbarItem is a cCJCopyMenuItem
80418>            End_Object
80419>
80419>            Object oPasteToolbarItem is a cCJPasteMenuItem
80421>            End_Object
80422>
80422>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
80424>                Set pbControlBeginGroup to True
80425>            End_Object
80426>
80426>        End_Object
80427>
80427>        Object oRememberToolbar is a cCJToolbar
80429>            Set psTitle to C_$Remember
80430>
80430>            Object oRememberItems is a cCJMenuItem
80432>
80432>                Set peControlType to xtpControlPopup
80433>                Set peControlStyle to xtpButtonCaption
80434>                Set psCaption to C_$Remember
80435>                
80435>                Object oMenuItem is a cCJRememberFieldMenuItem
80437>                    Set peControlStyle to xtpButtonIconAndCaption
80438>                End_Object
80439>                
80439>                Object oMenuItem is a cCJRememberLastFieldMenuItem
80441>                    Set peControlStyle to xtpButtonIconAndCaption
80442>                End_Object
80443>                
80443>                Object oMenuItem is a cCJUnRememberFieldMenuItem
80445>                    Set peControlStyle to xtpButtonIconAndCaption
80446>                End_Object
80447>                
80447>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
80449>                    Set peControlStyle to xtpButtonIconAndCaption
80450>                End_Object
80451>
80451>            End_Object
80452>            
80452>        End_Object
80453>        
80453>        Object oStatusBar is a cCJStatusBar
80455>
80455>            Object oStatusPane1 is a cCJStatusBarPane
80457>                Set piID to sbpIDIdlePane
80458>                Set pbStyleStretch to True
80459>            End_Object
80460>
80460>            Object oStatusPane2 is a cCJStatusBarPane
80462>                Set phoViewPane to Self
80463>                Set pbStyleStretch to True
80464>            End_Object
80465>
80465>        End_Object
80466>
80466>    End_Object
80467>
80467>    Object oClientArea is a ClientArea
80469>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\StdAbout.pkg)
80469>>>//************************************************************************
80469>>>// Confidential Trade Secret.
80469>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
80469>>>// as an unpublished work.  All rights reserved.
80469>>>// DataFlex is a registered trademark of Data Access Corporation.
80469>>>//
80469>>>//************************************************************************
80469>>>//************************************************************************
80469>>>//
80469>>>// $File name  : StdAbout.pkg
80469>>>// $File title : Standard about object package for VDF
80469>>>// Notice      :
80469>>>// $Author(s)  : John Tuohy
80469>>>//
80469>>>// $Rev History
80469>>>//
80469>>>// JT 06/27/97   File created
80469>>>//************************************************************************
80469>>>
80469>>>// This provides a quick and simple way to create an about package for a program.
80469>>>// You need to create a message inside you client area called Activate_About.
80469>>>// Within this message you should send the message DoAbout passing needed
80469>>>// string information.
80469>>>//
80469>>>//       Procedure Activate_About
80469>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
80469>>>//       End_Procedure
80469>>>//    where: sTitle =     Name of application. If none provided, uses caption
80469>>>//                        bar title
80469>>>//           sVersion   = Version Line. If none provided, will be blank
80469>>>//           sCopyRight = Copyright Line. If none provided, will be blank
80469>>>//           sAuthor    = Author name, blank if none provided
80469>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
80469>>>//                        is used.
80469>>>// It is expected that you will place this in your own object package. For
80469>>>// example an order about package may look like this:
80469>>>//
80469>>>//   // OrderAbout.pkg
80469>>>//   Use StdAbout.pkg
80469>>>//   Procedure Activate_About
80469>>>//      String sTitle sCopyright sVersion sAuthor
80469>>>//      Move "My Order Entry System" to sTitle
80469>>>//      Move "Version 2.1" to sVersion
80469>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
80469>>>//      Move "John Smith"  to sAuthor
80469>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
80469>>>//   end_procedure
80469>>>//   // end of file.
80469>>>
80469>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfabout.pkg)
80469>>>>>//************************************************************************
80469>>>>>// Confidential Trade Secret.
80469>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
80469>>>>>// as an unpublished work.  All rights reserved.
80469>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
80469>>>>>//
80469>>>>>//************************************************************************
80469>>>>>//************************************************************************
80469>>>>>//
80469>>>>>// $File name  : DfAbout.pkg
80469>>>>>// $File title : About class support
80469>>>>>// Notice      :
80469>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
80469>>>>>//
80469>>>>>// $Rev History
80469>>>>>//
80469>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
80469>>>>>//                Windows for the size first. 
80469>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
80469>>>>>//                with anchor technique. Removed unnessary property in the
80469>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
80469>>>>>//                object To better look in Windows XP. Repositioned the close
80469>>>>>//                button in the sysinfo dialog To line up with the display area
80469>>>>>//                Replaced obsolete code and techniques. Removed dead code.
80469>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
80469>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
80469>>>>>//                the global Workspace object, if it is present
80469>>>>>// JJT 11/05/98   Added version information
80469>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
80469>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
80469>>>>>//                workspace package.
80469>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
80469>>>>>//                class can create this object.
80469>>>>>//                Cleaned up the interface (used correct classes and messages)
80469>>>>>//                Added workspace reporting support To sys-info.
80469>>>>>//                Turned off wrapping in the sys-info editor.
80469>>>>>// KR  ??/??/96   File created
80469>>>>>//************************************************************************
80469>>>>>Use LanguageText.pkg
80469>>>>>Use Windows.pkg
80469>>>>>Use DFbitmap.pkg
80469>>>>>Use GlobalFunctionsProcedures.pkg
80469>>>>>Use cTextEdit.pkg
80469>>>>>
80469>>>>>Use cli.pkg
80469>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DFBTRDRV.PKG)
80469>>>>>>>//****************************************************************************
80469>>>>>>>//
80469>>>>>>>// $File name  : DFBTRDRV.PKG
80469>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
80469>>>>>>>// Notice      : This package contains constants and commands, used to call
80469>>>>>>>//               specific functions in the DFBTRDRV.
80469>>>>>>>// $Author(s)  : Eddy Kleinjan
80469>>>>>>>//
80469>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
80469>>>>>>>// Created     : 01-07-97 @ 12:00:00
80469>>>>>>>//
80469>>>>>>>// Changed     : 04-04-2001.
80469>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
80469>>>>>>>//
80469>>>>>>>// Changed     : June 6, 2001
80469>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
80469>>>>>>>//
80469>>>>>>>//               Added DFBTR_DDF_OWNER command.
80469>>>>>>>//
80469>>>>>>>// Changed     : June 12, 2001
80469>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
80469>>>>>>>//
80469>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
80469>>>>>>>//
80469>>>>>>>// Changed     : August 4, 2004
80469>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
80469>>>>>>>//
80469>>>>>>>//               Added cDfbtrdrvHandler class.
80469>>>>>>>//               New functions in this class:
80469>>>>>>>//                  Function CKRevision Returns String
80469>>>>>>>//                  Function CkUsesUri Returns Integer
80469>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
80469>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
80469>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
80469>>>>>>>//
80469>>>>>>>// Changed     : September 30, 2005
80469>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
80469>>>>>>>//
80469>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
80469>>>>>>>//****************************************************************************
80469>>>>>>>Use Ui
80469>>>>>>>//
80469>>>>>>>// Driver Indentification
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//*** Driver attributes
80469>>>>>>>//
80469>>>>>>>// Call_Driver functions ID's
80469>>>>>>>//
80469>>>>>>>//
80469>>>>>>>// DFBTRFN_CONVERT_FILE options
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// DFBTRFN_SET_OWNER options
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to create all vars which may be needed
80469>>>>>>>// in other commands.
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to set the owner of a Btrieve file.
80469>>>>>>>// File must have been opened.
80469>>>>>>>// Filenumber needs to be passed.
80469>>>>>>>// To clear set the owner to "".
80469>>>>>>>// Examples:
80469>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
80469>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
80469>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
80469>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
80469>>>>>>>// To clear:
80469>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to parse DFBTR_SET_OWNVER
80469>>>>>>>// options.
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to parse for Callback
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to clear the owner of a Btrieve file.
80469>>>>>>>// File must have been opened.
80469>>>>>>>// Filenumber needs to be passed.
80469>>>>>>>// Examples:
80469>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to add a owner name to the internal list of ownernames
80469>>>>>>>// which will be tries when opening files.
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to remove all owners from the internal list of ownernames
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to set the owner name to be used when opening the DDF files.
80469>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
80469>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
80469>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to change the transaction type.
80469>>>>>>>// Valid types are:
80469>>>>>>>//     DFBTRTT_NONE
80469>>>>>>>//     DFBTRTT_EXCLUSIVE
80469>>>>>>>//     DFBTRTT_CONCURRENT
80469>>>>>>>//
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to get the current transaction type.
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to set explicit_locking
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to get explicit locking
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//
80469>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
80469>>>>>>>//
80469>>>>>>>
80469>>>>>>>//*****************************************************************************
80469>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
80469>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
80469>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
80469>>>>>>>//*****************************************************************************
80469>>>>>>>
80469>>>>>>>Class cDFBtrDrvHandler Is An Array
80470>>>>>>>
80470>>>>>>>    Procedure Construct_Object Integer iImage
80472>>>>>>>        Forward Send Construct_object iImage
80474>>>>>>>
80474>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
80475>>>>>>>    End_Procedure // Construct_Object
80476>>>>>>>
80476>>>>>>>
80476>>>>>>>
80476>>>>>>>    //***
80476>>>>>>>    //*** Function: CKRevsion
80476>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
80476>>>>>>>    //***
80476>>>>>>>
80476>>>>>>>    Function CKRevision Returns String
80478>>>>>>>        Local String  sDriverID
80478>>>>>>>        Local String  sRevision
80478>>>>>>>        Local String  sVoid
80478>>>>>>>        Local Integer iRetval
80478>>>>>>>
80478>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80478>>>>>>>        // This error would otherwise be raised when we have an older
80478>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80478>>>>>>>        Send Ignore_error To Error_object_Id 20491
80479>>>>>>>        Get psDriverID To sDriverID
80480>>>>>>>        Move (Repeat(" ", 255)) To sRevision
80481>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
80486>>>>>>>        Send Trap_Error To Error_object_Id 20491
80487>>>>>>>        If (Trim(sRevision) = "") Begin
80489>>>>>>>            // Unable to get the revision. return all zeroes.
80489>>>>>>>            Move "0.0.0.0" To sRevision
80490>>>>>>>        End
80490>>>>>>>>
80490>>>>>>>        Function_Return sRevision
80491>>>>>>>    End_Function // CKRevision
80492>>>>>>>
80492>>>>>>>    Function CkUsesUri Returns Integer
80494>>>>>>>        Local String  sDriverID
80494>>>>>>>        Local String  sVoid1
80494>>>>>>>        Local String  sVoid2
80494>>>>>>>        Local Integer iRetval
80494>>>>>>>
80494>>>>>>>        Get psDriverID To sDriverID
80495>>>>>>>
80495>>>>>>>        Move 0 To iRetval
80496>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80496>>>>>>>        // This error would otherwise be raised when we have an older
80496>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
80496>>>>>>>        Send Ignore_error To Error_object_Id 20491
80497>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
80502>>>>>>>        Send Trap_Error To Error_object_Id 20491
80503>>>>>>>
80503>>>>>>>        Function_Return iRetval
80504>>>>>>>    End_Function // CKUsesUri
80505>>>>>>>
80505>>>>>>>
80505>>>>>>>
80505>>>>>>>    //***
80505>>>>>>>    //*** Function: ExtractPartFromRevsion
80505>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
80505>>>>>>>    //***
80505>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
80505>>>>>>>    //***
80505>>>>>>>
80505>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
80507>>>>>>>        Local Integer iPartRev
80507>>>>>>>        Local Integer iCurrentPart
80507>>>>>>>        Local Integer iSeparatorPos
80507>>>>>>>
80507>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
80510>>>>>>>
80510>>>>>>>        Move 0 To iCurrentPart
80511>>>>>>>        Repeat
80511>>>>>>>>
80511>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
80512>>>>>>>            If (iSeparatorPos > 0) Begin
80514>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
80515>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
80516>>>>>>>                Increment iCurrentPart
80517>>>>>>>            End
80517>>>>>>>>
80517>>>>>>>            Else If (sRevision <> "") Begin
80520>>>>>>>                Move sRevision To iPartRev
80521>>>>>>>                Move "" To sRevision
80522>>>>>>>                Increment iCurrentPart
80523>>>>>>>            End
80523>>>>>>>>
80523>>>>>>>            Else ;                Move -1 To iPartRev
80525>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
80527>>>>>>>
80527>>>>>>>        Function_Return iPartRev
80528>>>>>>>    End_Function // EcxtractPartFromRevision
80529>>>>>>>
80529>>>>>>>
80529>>>>>>>
80529>>>>>>>    //***
80529>>>>>>>    //*** Function: CKMajorRevision
80529>>>>>>>    //*** Purpose : Returns the major revision of the CK
80529>>>>>>>    //***
80529>>>>>>>
80529>>>>>>>    Function CKMajorRevision Returns Integer
80531>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
80532>>>>>>>    End_Function // CKMajorRevision
80533>>>>>>>
80533>>>>>>>
80533>>>>>>>
80533>>>>>>>    //***
80533>>>>>>>    //*** Function: CKMinorRevision
80533>>>>>>>    //*** Purpose : Returns the minor revision of the CK
80533>>>>>>>    //***
80533>>>>>>>
80533>>>>>>>    Function CKMinorRevision Returns Integer
80535>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
80536>>>>>>>    End_Function // CKMinorRevision
80537>>>>>>>
80537>>>>>>>
80537>>>>>>>
80537>>>>>>>    //***
80537>>>>>>>    //*** Function: CKReleaseRevision
80537>>>>>>>    //*** Purpose : Returns the release revision of the CK
80537>>>>>>>    //***
80537>>>>>>>
80537>>>>>>>    Function CKReleaseRevision Returns Integer
80539>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
80540>>>>>>>    End_Function // CKReleaseRevision
80541>>>>>>>
80541>>>>>>>
80541>>>>>>>
80541>>>>>>>    //***
80541>>>>>>>    //*** Function: CKBuildRevision
80541>>>>>>>    //*** Purpose : Returns the major revision of the CK
80541>>>>>>>    //***
80541>>>>>>>
80541>>>>>>>    Function CKBuildRevision Returns Integer
80543>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
80544>>>>>>>    End_Function // CKBuildRevision
80545>>>>>>>
80545>>>>>>>
80545>>>>>>>
80545>>>>>>>    //***
80545>>>>>>>    //*** Function: IsMinimalRevision
80545>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
80545>>>>>>>    //***
80545>>>>>>>
80545>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
80547>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
80550>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
80553>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
80556>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
80559>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
80562>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
80566>>>>>>>            End
80566>>>>>>>>
80566>>>>>>>        End
80566>>>>>>>>
80566>>>>>>>
80566>>>>>>>        Function_Return (FALSE)
80567>>>>>>>    End_Function // IsMinimalRevision
80568>>>>>>>
80568>>>>>>>    //   Functions to query the Pervasive.SQL version:
80568>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
80568>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
80568>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
80568>>>>>>>    //
80568>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
80568>>>>>>>    //   in the following format:
80568>>>>>>>    //       <version>.<revision>.<type>
80568>>>>>>>    //   possible values for <type>:
80568>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
80568>>>>>>>    //         server using Workgroup authentication mode
80568>>>>>>>    //       C for client cache engine
80568>>>>>>>    //       D for DOS workstation
80568>>>>>>>    //       N for client Requester
80568>>>>>>>    //       S for NetWare server
80568>>>>>>>    //       T for 32-bit Windows server engine
80568>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
80568>>>>>>>    //
80568>>>>>>>    //   example:
80568>>>>>>>    //       8.50.T
80568>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
80568>>>>>>>    //   32-bits Windows server.
80568>>>>>>>    //
80568>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
80568>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
80568>>>>>>>    //
80568>>>>>>>    //   If the version information is not available or can not be obtained
80568>>>>>>>    //   the functions will return "0.0.0"
80568>>>>>>>
80568>>>>>>>
80568>>>>>>>    //***
80568>>>>>>>    //*** Function: PSQLRequesterVersionInfo
80568>>>>>>>    //*** Purpose : Returns the version information of the
80568>>>>>>>    //***           Pervasive.SQL Client requester.
80568>>>>>>>
80568>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
80570>>>>>>>
80570>>>>>>>        Local String  sDriverID
80570>>>>>>>        Local String  sVersion
80570>>>>>>>        Local String  sVoid
80570>>>>>>>        Local Integer iRetval
80570>>>>>>>
80570>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80570>>>>>>>        // This error would otherwise be raised when we have an older
80570>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80570>>>>>>>        Send Ignore_error To Error_object_Id 20491
80571>>>>>>>        Get psDriverID To sDriverID
80572>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80573>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80578>>>>>>>        Send Trap_Error To Error_object_Id 20491
80579>>>>>>>        If (Trim(sVersion) = "") Begin
80581>>>>>>>            // Unable to get the revision. return all zeroes.
80581>>>>>>>            Move "0.0.0" To sVersion
80582>>>>>>>        End
80582>>>>>>>>
80582>>>>>>>        Function_Return sVersion
80583>>>>>>>    End_Function //  PSQLRequesterVersion
80584>>>>>>>
80584>>>>>>>    //***
80584>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
80584>>>>>>>    //*** Purpose : Returns the version information of the
80584>>>>>>>    //***           Pervasive.SQL Local Engine
80584>>>>>>>
80584>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
80586>>>>>>>
80586>>>>>>>        Local String  sDriverID
80586>>>>>>>        Local String  sVersion
80586>>>>>>>        Local String  sVoid
80586>>>>>>>        Local Integer iRetval
80586>>>>>>>
80586>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80586>>>>>>>        // This error would otherwise be raised when we have an older
80586>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80586>>>>>>>        Send Ignore_error To Error_object_Id 20491
80587>>>>>>>        Get psDriverID To sDriverID
80588>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80589>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80594>>>>>>>        Send Trap_Error To Error_object_Id 20491
80595>>>>>>>        If (Trim(sVersion) = "") Begin
80597>>>>>>>            // Unable to get the revision. return all zeroes.
80597>>>>>>>            Move "0.0.0" To sVersion
80598>>>>>>>        End
80598>>>>>>>>
80598>>>>>>>        Function_Return sVersion
80599>>>>>>>    End_Function //  PSQLLocalEngineVersion
80600>>>>>>>
80600>>>>>>>    //***
80600>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
80600>>>>>>>    //*** Purpose : Returns the version information of the
80600>>>>>>>    //***           Pervasive.SQL Server Engine
80600>>>>>>>
80600>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
80602>>>>>>>
80602>>>>>>>        Local String  sDriverID
80602>>>>>>>        Local String  sVersion
80602>>>>>>>        Local String  sVoid
80602>>>>>>>        Local Integer iRetval
80602>>>>>>>
80602>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80602>>>>>>>        // This error would otherwise be raised when we have an older
80602>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80602>>>>>>>        Send Ignore_error To Error_object_Id 20491
80603>>>>>>>        Get psDriverID To sDriverID
80604>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80605>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80610>>>>>>>        Send Trap_Error To Error_object_Id 20491
80611>>>>>>>        If (Trim(sVersion) = "") Begin
80613>>>>>>>            // Unable to get the revision. return all zeroes.
80613>>>>>>>            Move "0.0.0" To sVersion
80614>>>>>>>        End
80614>>>>>>>>
80614>>>>>>>        Function_Return sVersion
80615>>>>>>>    End_Function //  PSQLServerEngineVersion
80616>>>>>>>
80616>>>>>>>End_Class // cDfbtrdrvHandler
80617>>>>>>>
80617>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\MSSqldrv.pkg)
80617>>>>>>>//*****************************************************************************
80617>>>>>>>//*** MSSQLDRV.PKG                                                          ***
80617>>>>>>>//***                                                                       ***
80617>>>>>>>//*** Author: Ben Weijers                                                   ***
80617>>>>>>>//***         Data Access Nederland                                         ***
80617>>>>>>>//***         29 June 1998                                                  ***
80617>>>>>>>//***                                                                       ***
80617>>>>>>>//***                                                                       ***
80617>>>>>>>//*** Purpose:                                                              ***
80617>>>>>>>//***   Package that declares MS SQL driver constants and functions.        ***
80617>>>>>>>//****                                                                      ***
80617>>>>>>>//***   This package can be used by developers who want to add Data Access  ***
80617>>>>>>>//***   MS SQL Client specific code to a DataFlex application.              ***
80617>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
80617>>>>>>>//***             Changed EnumerateServers function to use the highest      ***
80617>>>>>>>//***             available SQL Server client driver.                       ***
80617>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
80617>>>>>>>//***             mssqldrv.pkg                                              ***
80617>>>>>>>//***   Updated:  November 6th 2013 (Current CK build: 6.0.0.19)            ***
80617>>>>>>>//***             Added constants for SQL Server specific native types      ***
80617>>>>>>>//***             ( var...(max) types, money types, datetime types)         ***
80617>>>>>>>//*****************************************************************************
80617>>>>>>>
80617>>>>>>>Use Cli.pkg
80617>>>>>>>Use SQL.pkg
80617>>>>>>>
80617>>>>>>>//*** Driver Indentification
80617>>>>>>>
80617>>>>>>>//*** Error number constants
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>// SQL Server spcific types. 
80617>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
80617>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
80617>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
80617>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
80617>>>>>>>
80617>>>>>>>// SQL Server spcific types. 
80617>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
80617>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
80617>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
80617>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
80617>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
80617>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
80617>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>//*****************************************************************************
80617>>>>>>>//*** MSSQL_SetConstraint <FileNum> <ConstraintText>                        ***
80617>>>>>>>//***                                                                       ***
80617>>>>>>>//***   Setup a constraint for a file.                                      ***
80617>>>>>>>//*****************************************************************************
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>Class cMSSQLHandler Is A cCLIHandler
80618>>>>>>>
80618>>>>>>>    Procedure Construct_Object
80620>>>>>>>        Forward Send Construct_Object
80622>>>>>>>
80622>>>>>>>        Set psDriverID To MSSQLDRV_ID
80623>>>>>>>    End_Procedure // Construct_Object
80624>>>>>>>
80624>>>>>>>
80624>>>>>>>
80624>>>>>>>    //***
80624>>>>>>>    //*** Function: ExtractList
80624>>>>>>>    //*** Purpose : Extract the list from the out connect string.
80624>>>>>>>    //***
80624>>>>>>>
80624>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
80626>>>>>>>        Local String  sItem
80626>>>>>>>        Local Integer iStart
80626>>>>>>>        Local Integer iEnd
80626>>>>>>>
80626>>>>>>>        If (hoStore = 0) ;            Move Current_object To hoStore
80629>>>>>>>
80629>>>>>>>        Send Delete_Data To hoStore
80630>>>>>>>        Move (Pos("{", sOutConnStr)) To iStart
80631>>>>>>>        While (iStart > 0)
80635>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) To sOutConnStr
80636>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 To iStart
80639>>>>>>>            Else Begin
80640>>>>>>>                Move (Pos(",", sOutConnStr)) To iStart
80641>>>>>>>                Move (Pos("}", sOutConnStr)) To iEnd
80642>>>>>>>                If ((iStart = 0) Or (iEnd < iStart)) ;                    Move iEnd To iStart
80645>>>>>>>
80645>>>>>>>                If (iStart > 0) ;                    Set Value Of hoStore Item (Item_Count(Current_Object)) To (Left(sOutConnStr, iStart - 1))
80648>>>>>>>
80648>>>>>>>                If (iStart = iEnd) ;                    Move 0 To iStart
80651>>>>>>>            End
80651>>>>>>>>
80651>>>>>>>        Loop
80652>>>>>>>>
80652>>>>>>>
80652>>>>>>>        Function_Return (Item_Count(hoStore))
80653>>>>>>>    End_Procedure // ExtractList
80654>>>>>>>
80654>>>>>>>
80654>>>>>>>
80654>>>>>>>    //***
80654>>>>>>>    //*** Function: BrowseConnect
80654>>>>>>>    //*** Purpose : Call the driver's browse connect function
80654>>>>>>>    //***
80654>>>>>>>
80654>>>>>>>    Function BrowseConnect String sInConnStr Returns String
80656>>>>>>>        Local String  sDriver
80656>>>>>>>        Local String  sOutConnStr
80656>>>>>>>        Local Integer iArg
80656>>>>>>>        Local Integer iRetval
80656>>>>>>>
80656>>>>>>>        Get psDriverID To sDriver
80657>>>>>>>        If (sDriver <> "") Begin
80659>>>>>>>            Move (Repeat(" ", 8192)) To sOutConnStr
80660>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
80665>>>>>>>        End
80665>>>>>>>>
80665>>>>>>>
80665>>>>>>>        Function_Return sOutConnStr
80666>>>>>>>    End_Function// BrowseConnect
80667>>>>>>>
80667>>>>>>>
80667>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
80669>>>>>>>        Local String  sDriver
80669>>>>>>>        Local String  sOutConnStr
80669>>>>>>>        Local Integer iArg
80669>>>>>>>        Local Integer iRetval
80669>>>>>>>        
80669>>>>>>>        Move 1 to iArg // Browses only local
80670>>>>>>>
80670>>>>>>>        Get psDriverID to sDriver
80671>>>>>>>        If (sDriver <> "") Begin
80673>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
80674>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
80679>>>>>>>        End
80679>>>>>>>>
80679>>>>>>>
80679>>>>>>>        Function_Return sOutConnStr
80680>>>>>>>    End_Function// BrowseConnect
80681>>>>>>>
80681>>>>>>>
80681>>>>>>>    Function DriverIndex String sDriver Returns Integer
80683>>>>>>>    
80683>>>>>>>        Local String  sCurrentDriver
80683>>>>>>>        Local Integer iNumberOfDrivers iDriver iCount
80683>>>>>>>    
80683>>>>>>>        Move 0 to iDriver
80684>>>>>>>    
80684>>>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
80687>>>>>>>        For iCount from 1 to iNumberOfDrivers
80693>>>>>>>>
80693>>>>>>>    
80693>>>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
80696>>>>>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriver) ) Begin
80698>>>>>>>                Move iCount to iDriver
80699>>>>>>>            End
80699>>>>>>>>
80699>>>>>>>        Loop
80700>>>>>>>>
80700>>>>>>>    
80700>>>>>>>        Function_Return iDriver
80701>>>>>>>    
80701>>>>>>>    End_Function 
80702>>>>>>>
80702>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
80704>>>>>>>        
80704>>>>>>>        Local String  sServerList
80704>>>>>>>        Local Integer iNumServers
80704>>>>>>>        Local Integer iDriver
80704>>>>>>>        Local Integer iClientVersion
80704>>>>>>>        Local String  sDriver
80704>>>>>>>        
80704>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
80705>>>>>>>
80705>>>>>>>        If (iDriver) Begin
80707>>>>>>>                
80707>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
80710>>>>>>>            
80710>>>>>>>            Case Begin
80710>>>>>>>    
80710>>>>>>>                Case (iClientVersion = SQLSERVER2016CLIENT)
80712>>>>>>>                    Move SQLSERVER2016DRVRSTR to sDriver
80713>>>>>>>                    Case Break
80714>>>>>>>    
80714>>>>>>>                Case (iClientVersion = SQLSERVER2014CLIENT)
80717>>>>>>>                    Move SQLSERVER2014DRVRSTR to sDriver
80718>>>>>>>                    Case Break
80719>>>>>>>            
80719>>>>>>>                Case (iClientVersion = SQLSERVER2012CLIENT)
80722>>>>>>>                    Move SQLSERVER2012DRVRSTR to sDriver
80723>>>>>>>                    Case Break
80724>>>>>>>    
80724>>>>>>>                Case (iClientVersion = SQLSERVER2008CLIENT)
80727>>>>>>>                    Move SQLSERVER2008DRVRSTR to sDriver
80728>>>>>>>                    Case Break
80729>>>>>>>    
80729>>>>>>>                Case (iClientVersion = SQLSERVER2005CLIENT)
80732>>>>>>>                    Move SQLSERVER2005DRVRSTR to sDriver
80733>>>>>>>                    Case Break
80734>>>>>>>            
80734>>>>>>>                Case (iClientVersion = SQLSERVER2000CLIENT)
80737>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
80738>>>>>>>                    Case Break
80739>>>>>>>            
80739>>>>>>>                Case Else
80739>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
80740>>>>>>>            
80740>>>>>>>            Case End
80740>>>>>>>    
80740>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
80741>>>>>>>            If (iNetworkLocal = 0) Begin
80743>>>>>>>                Get BrowseConnect sDriver to sServerList
80744>>>>>>>            End
80744>>>>>>>>
80744>>>>>>>            Else Begin
80745>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
80746>>>>>>>            End
80746>>>>>>>>
80746>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
80747>>>>>>>        End
80747>>>>>>>>
80747>>>>>>>        
80747>>>>>>>        Function_Return iNumServers
80748>>>>>>>        
80748>>>>>>>    End_Function
80749>>>>>>>
80749>>>>>>>    //***
80749>>>>>>>    //*** Procedure: EnumerateServers
80749>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
80749>>>>>>>    //***            This function will return all SQL Server instances on the network. 
80749>>>>>>>    //***            This may take a long time. 
80749>>>>>>>    //***            To enumerate only local SQL Server instances use EnumerateServersLocal 
80749>>>>>>>    Function EnumerateServers Returns Integer
80751>>>>>>>
80751>>>>>>>        Local Integer iNumServers
80751>>>>>>>        Local Integer iNetworkLocal
80751>>>>>>>        
80751>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
80752>>>>>>>        
80752>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
80753>>>>>>>        
80753>>>>>>>        Function_Return iNumServers
80754>>>>>>>        
80754>>>>>>>    End_Function
80755>>>>>>>
80755>>>>>>>
80755>>>>>>>    //***
80755>>>>>>>    //*** Procedure: EnumerateServersLocal
80755>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
80755>>>>>>>    //***            This function will return only return SQL Server instance on the local machine
80755>>>>>>>    //***            To enumerate all SQL Server instances in a network use EnumerateServers
80755>>>>>>>    Function EnumerateServersLocal Returns Integer
80757>>>>>>>
80757>>>>>>>        Local Integer iNumServers
80757>>>>>>>        Local Integer iNetworkLocal
80757>>>>>>>        
80757>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
80758>>>>>>>        
80758>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
80759>>>>>>>        
80759>>>>>>>        Function_Return iNumServers
80760>>>>>>>        
80760>>>>>>>    End_Function
80761>>>>>>>
80761>>>>>>>    
80761>>>>>>>
80761>>>>>>>    //***
80761>>>>>>>    //*** Function: EnumerateDatabases
80761>>>>>>>    //*** Purpose : Enumerate database in a given server.
80761>>>>>>>    //***
80761>>>>>>>
80761>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
80763>>>>>>>        Local Integer hoSQL
80763>>>>>>>        Local String  sConnect
80763>>>>>>>        Local String  sDatabase
80763>>>>>>>        Local Integer hdbc
80763>>>>>>>        Local Integer hstmt
80763>>>>>>>        Local Integer iFetchResult
80763>>>>>>>
80763>>>>>>>        If (Num_Arguments < 3) ;            Move "" To sPassWord
80766>>>>>>>        If (Num_Arguments < 2) ;            Move "" To sUser
80769>>>>>>>
80769>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") To sConnect
80772>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") To sConnect
80774>>>>>>>
80774>>>>>>>        Object oEnumDBSQLmanager Is A cSQLHandleManager
80776>>>>>>>            Move Current_Object To hoSQL
80777>>>>>>>        End_Object // oEnumDBSQLManager
80778>>>>>>>
80778>>>>>>>        If (hoSQL <> 0) Begin
80780>>>>>>>            Get SQLConnect Of hoSQL "MSSQLDRV" sConnect To hdbc
80781>>>>>>>            If (hdbc <> 0) Begin
80783>>>>>>>                Get SQLOpen Of hdbc To hstmt
80784>>>>>>>                If (hstmt <> 0) Begin
80786>>>>>>>                    //*** We could do a direct select on the sysdatabases table but we use
80786>>>>>>>                    //*** the stored procedure sp_database instead. SQL Server recommends this
80786>>>>>>>                    //*** approach in case meta data might change, the stored procedure will
80786>>>>>>>                    //*** stay the same.
80786>>>>>>>                    Send SQLSetProcedureName To hstmt "sp_databases"
80787>>>>>>>                    Send SQLCall To hstmt
80788>>>>>>>                    Repeat
80788>>>>>>>>
80788>>>>>>>                        Get SQLFetch Of hstmt To iFetchResult
80789>>>>>>>                        If (iFetchResult <> 0) Begin
80791>>>>>>>                            Get SQLColumnValue Of hstmt 1 To sDatabase
80792>>>>>>>                            Set Value Item (Item_Count(Current_Object)) To sDatabase
80793>>>>>>>                        End
80793>>>>>>>>
80793>>>>>>>                    Until (iFetchResult = 0)
80795>>>>>>>
80795>>>>>>>                    Send SQLClose To hstmt
80796>>>>>>>                End
80796>>>>>>>>
80796>>>>>>>                Send SQLDisconnect To hdbc
80797>>>>>>>            End
80797>>>>>>>>
80797>>>>>>>        End
80797>>>>>>>>
80797>>>>>>>        Send Destroy_Object To hoSQL
80798>>>>>>>
80798>>>>>>>        Function_return (Item_Count(Current_Object))
80799>>>>>>>    End_Function // EnumerateDatabases
80800>>>>>>>
80800>>>>>>>
80800>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
80802>>>>>>>        
80802>>>>>>>        Local String  sSqlServerClientVersionName
80802>>>>>>>        
80802>>>>>>>            
80802>>>>>>>        Case Begin
80802>>>>>>>
80802>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
80804>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
80805>>>>>>>                Case Break
80806>>>>>>>
80806>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
80809>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
80810>>>>>>>                Case Break
80811>>>>>>>        
80811>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
80814>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
80815>>>>>>>                Case Break
80816>>>>>>>
80816>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
80819>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
80820>>>>>>>                Case Break
80821>>>>>>>
80821>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
80824>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
80825>>>>>>>                Case Break
80826>>>>>>>        
80826>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
80829>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
80830>>>>>>>                Case Break
80831>>>>>>>        
80831>>>>>>>            Case Else
80831>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
80832>>>>>>>        
80832>>>>>>>        Case End
80832>>>>>>>    
80832>>>>>>>        
80832>>>>>>>        Function_Return sSqlServerClientVersionName
80833>>>>>>>        
80833>>>>>>>    End_Function
80834>>>>>>>
80834>>>>>>>
80834>>>>>>>End_Class // cMSSQLHandler
80835>>>>>>>
80835>>>>>
80835>>>>>
80835>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
80836>>>>>
80836>>>>>Register_Function phoWorkspace Returns Handle
80836>>>>>Register_Function Help_filename Returns String
80836>>>>>Register_Function GetHelpFile Returns String
80836>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
80836>>>>>
80836>>>>>//****************************************************************************
80836>>>>>// $Module type: FUNCTION
80836>>>>>// $Module name: Network_User_Name
80836>>>>>// $Author     : AK/VOO/KCR
80836>>>>>// Created     : 09-24-96 @ 19:17
80836>>>>>//
80836>>>>>// Description
80836>>>>>//    This function reads the current username Of windows and returns that
80836>>>>>//    name or an text unknown user
80836>>>>>//
80836>>>>>// $Rev History
80836>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
80836>>>>>//  07/25/2003  Replaced obsolete code
80836>>>>>//  09/24/1996  Module header created
80836>>>>>//****************************************************************************
80836>>>>>Function Network_User_Name for cDesktop Returns String
80838>>>>>    String sName
80838>>>>>    Integer iRetval iLength
80838>>>>>
80838>>>>>    Move 0 to iLength
80839>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
80840>>>>>    ZeroString iLength to sName
80841>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
80842>>>>>
80842>>>>>    If (iRetval = NO_ERROR) Begin
80844>>>>>        Function_Return (CString (sName))
80845>>>>>    End
80845>>>>>>
80845>>>>>    
80845>>>>>    Function_Return "User Unknown"
80846>>>>>End_Function
80847>>>>>
80847>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
80847>>>>>Type MEMORYSTATUS
80847>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
80847>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
80847>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
80847>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
80847>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
80847>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
80847>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
80847>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
80847>>>>>End_Type // MEMORYSTATUS
80847>>>>>
80847>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
80848>>>>>
80848>>>>>Struct tWinMemoryStatusEx
80848>>>>>    UInteger dwLength                
80848>>>>>    UInteger dwMemoryLoad          
80848>>>>>    UBigInt ullTotalPhys           
80848>>>>>    UBigInt ullAvailPhys           
80848>>>>>    UBigInt ullTotalPageFile       
80848>>>>>    UBigInt ullAvailPageFile       
80848>>>>>    UBigInt ullTotalVirtual        
80848>>>>>    UBigInt ullAvailVirtual        
80848>>>>>    UBigInt ullAvailExtendedVirtual
80848>>>>>End_Struct
80848>>>>>
80848>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
80849>>>>>
80849>>>>>Class SysinfoDisplay is a cTextEdit
80850>>>>>    Procedure Construct_Object
80852>>>>>        Forward Send Construct_Object
80854>>>>>
80854>>>>>        Set Location To 6 6
80855>>>>>        Set Size To 110 255
80856>>>>>        Set Read_Only_State To True
80857>>>>>        Set pbWrap to False
80858>>>>>    End_Procedure
80859>>>>>
80859>>>>>    //****************************************************************************
80859>>>>>    // $Module type: PROCEDURE
80859>>>>>    // $Module name: Show_Current_Directory
80859>>>>>    // $Author     : VOO
80859>>>>>    // Created     : 06-10-96 @ 15:24
80859>>>>>    //
80859>>>>>    // Description
80859>>>>>    //    This method will show the name Of the current directory in the system
80859>>>>>    //    information box
80859>>>>>    //
80859>>>>>    // $Rev History
80859>>>>>    //    06-10-96  Module header created
80859>>>>>    //****************************************************************************
80859>>>>>    Procedure Show_Current_Directory
80861>>>>>        String sDir
80861>>>>>
80861>>>>>        Get_Current_Directory To sDir
80862>>>>>
80862>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
80863>>>>>    End_Procedure
80864>>>>>
80864>>>>>    Procedure Show_Windows_Directory
80866>>>>>        String sWindir
80866>>>>>
80866>>>>>        Get_Windows_Directory To sWindir
80867>>>>>
80867>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
80868>>>>>    End_Procedure
80869>>>>>
80869>>>>>    Procedure Show_Current_User
80871>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
80872>>>>>    End_Procedure
80873>>>>>
80873>>>>>    Procedure Show_Number_Format
80875>>>>>        Integer iFormat
80875>>>>>        String sFormatText
80875>>>>>
80875>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
80878>>>>>        Move (Character (iFormat)) To sFormatText
80879>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
80880>>>>>
80880>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
80883>>>>>        Move (Character (iFormat)) to sFormatText
80884>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
80885>>>>>    End_Procedure
80886>>>>>
80886>>>>>    Procedure Show_Filelist_Name
80888>>>>>        String sFilename
80888>>>>>
80888>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
80891>>>>>
80891>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
80892>>>>>        Send AppendTextLn ""
80893>>>>>    End_Procedure
80894>>>>>
80894>>>>>    Procedure Show_Lock_Delay
80896>>>>>        Integer iLockdelay
80896>>>>>
80896>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
80899>>>>>
80899>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
80900>>>>>    End_Procedure
80901>>>>>
80901>>>>>    Procedure Show_Lock_Timeout
80903>>>>>        Integer iLockTimeout
80903>>>>>
80903>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
80906>>>>>
80906>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
80907>>>>>    End_Procedure
80908>>>>>
80908>>>>>    Procedure Show_Screen_Size
80910>>>>>        Integer iYscreensize iXscreensize
80910>>>>>
80910>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
80911>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
80912>>>>>
80912>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
80913>>>>>    End_Procedure
80914>>>>>
80914>>>>>    Procedure Show_Page_Size
80916>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
80917>>>>>    End_procedure
80918>>>>>
80918>>>>>    Procedure Show_Date
80920>>>>>        Date dToday
80920>>>>>
80920>>>>>        Sysdate dToday
80921>>>>>
80921>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
80922>>>>>    End_procedure
80923>>>>>
80923>>>>>    Procedure Show_Date_Format
80925>>>>>        Integer iDateFormat
80925>>>>>        String sDateFormat
80925>>>>>
80925>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
80928>>>>>        Case Begin
80928>>>>>            Case (iDateFormat = DF_DATE_USA)
80930>>>>>                Move C_$USA To sDateFormat
80931>>>>>                Case Break
80932>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
80935>>>>>                Move C_$European To sDateFormat
80936>>>>>                Case Break
80937>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
80940>>>>>                Move C_$Military To sDateFormat
80941>>>>>                Case Break
80942>>>>>            Case Else
80942>>>>>                Move C_$UnknownDateType To sDateFormat
80943>>>>>                Case Break
80944>>>>>        Case End
80944>>>>>
80944>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
80945>>>>>    End_Procedure
80946>>>>>
80946>>>>>    Procedure Show_Systemresources
80948>>>>>        tWinMemoryStatusEx MemoryStatusInfo
80948>>>>>        tWinMemoryStatusEx MemoryStatusInfo
80948>>>>>        Integer iRetval
80948>>>>>
80948>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
80949>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
80950>>>>>        If (iRetval = 0) Begin
80952>>>>>            Move (ShowLastError ()) to iRetval
80953>>>>>        End
80953>>>>>>
80953>>>>>
80953>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
80954>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
80955>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
80956>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
80957>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
80958>>>>>    End_Procedure
80959>>>>>
80959>>>>>    Procedure Show_Registration
80961>>>>>        String sRegName
80961>>>>>        Integer iSN iMaxUsers
80961>>>>>
80961>>>>>        Registration sRegName iSN
80962>>>>>>
80962>>>>>        
80962>>>>>        Get_Licensed_Max_Users to iMaxUsers
80963>>>>>
80963>>>>>        Send AppendTextLn ""
80964>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
80965>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
80966>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
80967>>>>>    End_Procedure
80968>>>>>
80968>>>>>    //****************************************************************************
80968>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
80968>>>>>    // To the workspace object passing the an object and message To send back
80968>>>>>    // To this object. It is expected that the workspace object will send this
80968>>>>>    // message for every line Of information it wants displayed (passing the
80968>>>>>    // information To be displayed
80968>>>>>    //****************************************************************************
80968>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
80968>>>>>
80968>>>>>    Procedure Show_ServicePack
80970>>>>>        String sKey sVersionDescription sVersion 
80970>>>>>        Handle hoRegistry
80970>>>>>        Boolean bExists bOpened
80970>>>>>        
80970>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
80971>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
80972>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
80973>>>>>
80973>>>>>        Move C_DFVersionRegistryRoot to sKey
80974>>>>>        Get KeyExists of hoRegistry sKey to bExists
80975>>>>>        If (bExists) Begin
80977>>>>>            Get OpenKey of hoRegistry sKey to bOpened
80978>>>>>            If (bOpened) Begin
80980>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
80981>>>>>                If (bExists) Begin
80983>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
80984>>>>>                End
80984>>>>>>
80984>>>>>                
80984>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
80985>>>>>                If (bExists) Begin
80987>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
80988>>>>>                End                
80988>>>>>>
80988>>>>>                Send CloseKey of hoRegistry
80989>>>>>            End
80989>>>>>>
80989>>>>>        End
80989>>>>>>
80989>>>>>        Send Destroy of hoRegistry
80990>>>>>
80990>>>>>        If (sVersionDescription <> "") Begin
80992>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
80993>>>>>           Send AppendTextLn ""
80994>>>>>        End
80994>>>>>>
80994>>>>>    End_Procedure
80995>>>>>    
80995>>>>>
80995>>>>>    Procedure Show_WorkspaceInformation
80997>>>>>        Integer hoWorkspace
80997>>>>>
80997>>>>>        If (ghoApplication <> 0) Begin
80999>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
81000>>>>>            If (hoWorkspace <> 0) Begin
81002>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
81003>>>>>                Send AppendTextLn ""
81004>>>>>            End
81004>>>>>>
81004>>>>>        End
81004>>>>>>
81004>>>>>    End_Procedure
81005>>>>>
81005>>>>>    //****************************************************************************
81005>>>>>    // If connection ids are used, we will send the message EnumerateConnections
81005>>>>>    // to the connection manager object passing the an object and message to send 
81005>>>>>    // back to this object. It is expected that the connection manager object will 
81005>>>>>    // send this message for every line Of information it wants displayed (passing 
81005>>>>>    // the information To be displayed
81005>>>>>    //****************************************************************************
81005>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
81005>>>>>
81005>>>>>    Procedure Show_ConnectionIdInformation
81007>>>>>        If (ghoConnection > 0) Begin
81009>>>>>            Send AppendTextLn ""
81010>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
81011>>>>>        End
81011>>>>>>
81011>>>>>    End_Procedure
81012>>>>>
81012>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
81014>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
81015>>>>>    End_Function
81016>>>>>
81016>>>>>    Procedure Show_Versions
81018>>>>>        Integer iVersion iRevision iBuild
81018>>>>>
81018>>>>>        Version_Information iVersion iRevision iBuild
81020>>>>>
81020>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
81021>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
81022>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
81023>>>>>    End_Procedure
81024>>>>>    
81024>>>>>    Function CKRevisionNumber String sDriverID Returns String
81026>>>>>        Handle hoCLIHandler
81026>>>>>        Handle hoDFBtrDrvHandler
81026>>>>>        String sCKRevision
81026>>>>>
81026>>>>>
81026>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
81028>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
81029>>>>>            Set psDriverID of hoCLIHandler to sDriverID
81030>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
81031>>>>>            Send Destroy of hoCLIHandler
81032>>>>>        End
81032>>>>>>
81032>>>>>        Else Begin
81033>>>>>            If (sDriverID = "DFBTRDRV") Begin
81035>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
81036>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
81037>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
81038>>>>>                Send Destroy of hoDFBtrDrvHandler
81039>>>>>            End
81039>>>>>>
81039>>>>>        End
81039>>>>>>
81039>>>>>        
81039>>>>>        Function_Return sCKRevision
81040>>>>>    End_Function
81041>>>>>    
81041>>>>>    
81041>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
81043>>>>>        
81043>>>>>        If (sDriverID = "DATAFLEX") Begin
81045>>>>>            Function_Return False
81046>>>>>        End
81046>>>>>>
81046>>>>>    
81046>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
81047>>>>>    End_Function    
81048>>>>>
81048>>>>>
81048>>>>>    //***
81048>>>>>    //*** BW
81048>>>>>    //*** Procedure: Show_Drivers
81048>>>>>    //*** Purpose  : Show loaded database drivers
81048>>>>>    //***
81048>>>>>
81048>>>>>    Procedure Show_Drivers
81050>>>>>        String sCurrentDriver sRevNumber
81050>>>>>        String sLoadedDrivers sClientDriver
81050>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
81050>>>>>        Boolean bOK 
81050>>>>>        Handle hoMsqlDrv
81050>>>>>
81050>>>>>        Move "" To sLoadedDrivers
81051>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
81054>>>>>        For iCount from 1 to iNumberOfDrivers
81060>>>>>>
81060>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
81063>>>>>            If (sLoadedDrivers <> "") Begin
81065>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
81066>>>>>            End
81066>>>>>>
81066>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
81067>>>>>            If (bOK) Begin
81069>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
81071>>>>>                    Move iCount to iMSSQLIndex
81072>>>>>                End
81072>>>>>>
81072>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
81073>>>>>                // if mssqldrv, show the client number
81073>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
81074>>>>>            End
81074>>>>>>
81074>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
81075>>>>>        Loop
81076>>>>>>
81076>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
81077>>>>>        If (iMSSQLIndex>0) Begin
81079>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
81082>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
81083>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
81084>>>>>            Send Destroy of hoMsqlDrv
81085>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
81086>>>>>        End
81086>>>>>>
81086>>>>>    End_Procedure
81087>>>>>
81087>>>>>    Procedure Show_HelpFile
81089>>>>>        String sHelpFile
81089>>>>>        Integer eHelpType
81089>>>>>
81089>>>>>        If (ghoApplication <> 0) Begin
81091>>>>>            Get peHelpType Of ghoApplication To eHelpType
81092>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
81094>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
81095>>>>>            End
81095>>>>>>
81095>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
81098>>>>>                Get Help_filename Of Help_object_id To sHelpFile
81099>>>>>            End
81099>>>>>>
81099>>>>>            Else Begin
81100>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
81101>>>>>            End
81101>>>>>>
81101>>>>>
81101>>>>>            Send AppendTextLn ""
81102>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
81103>>>>>        End
81103>>>>>>
81103>>>>>    End_Procedure
81104>>>>>
81104>>>>>    Procedure Show_EnterAsTab
81106>>>>>        Boolean bEnterKeyAsTabKey
81106>>>>>        String sText
81106>>>>>
81106>>>>>        If (ghoApplication <> 0) Begin
81108>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
81109>>>>>            If (bEnterKeyAsTabKey) Begin
81111>>>>>                Move "True" To sText
81112>>>>>            End
81112>>>>>>
81112>>>>>            Else Begin
81113>>>>>                Move "False" To sText
81114>>>>>            End
81114>>>>>>
81114>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
81115>>>>>        End
81115>>>>>>
81115>>>>>    End_Procedure
81116>>>>>
81116>>>>>    //****************************************************************************
81116>>>>>    // $Module type: PROCEDURE
81116>>>>>    // $Module name: Add_Focus
81116>>>>>    // $Author     : VOO
81116>>>>>    // Created     : 24-09-96 @ 19:43
81116>>>>>    //
81116>>>>>    // Description
81116>>>>>    //    During activation we will remove the old information and add the newly
81116>>>>>    //    found systeminformation
81116>>>>>    //
81116>>>>>    // $Rev History
81116>>>>>    //    24-09-96  Module header created
81116>>>>>    //****************************************************************************
81116>>>>>    Procedure Add_Focus Integer hoRoot
81118>>>>>        Forward Send Add_Focus hoRoot
81120>>>>>
81120>>>>>        Send Delete_Data
81121>>>>>
81121>>>>>        Set Changed_State To False
81122>>>>>        Set Read_Only_State To True
81123>>>>>
81123>>>>>        Send Show_ServicePack
81124>>>>>        Send Show_Versions   
81125>>>>>        Send Show_Drivers         
81126>>>>>        If (ghoConnection <> 0) Begin
81128>>>>>            Send Show_ConnectionIdInformation
81129>>>>>        End
81129>>>>>>
81129>>>>>        Send Show_HelpFile
81130>>>>>        Send Show_Current_Directory
81131>>>>>        Send Show_Filelist_Name          
81132>>>>>        If (ghoApplication <> 0) Begin
81134>>>>>            Send Show_WorkSpaceInformation // added To show WS info
81135>>>>>        End
81135>>>>>>
81135>>>>>        Send Show_Current_User 
81136>>>>>        Send Show_Windows_Directory 
81137>>>>>        Send Show_Screen_Size
81138>>>>>        Send Show_Page_Size
81139>>>>>        Send Show_EnterAsTab        
81140>>>>>        Send Show_Number_Format
81141>>>>>        Send Show_Date_Format
81142>>>>>        Send Show_Lock_Delay
81143>>>>>        Send Show_Lock_Timeout
81144>>>>>        Send Show_Date
81145>>>>>        Send Show_Systemresources
81146>>>>>        Send Show_Registration
81147>>>>>        Send Beginning_of_Data
81148>>>>>
81148>>>>>        Set Icon to 'default.ico'
81149>>>>>    End_Procedure
81150>>>>>End_Class
81151>>>>>
81151>>>>>//****************************************************************************
81151>>>>>// $Module type: OBJECT
81151>>>>>// $Module name: Sysinfo_Dialog
81151>>>>>// $Author     : VOO
81151>>>>>// Created     : 24-09-96 @ 18:47
81151>>>>>//
81151>>>>>// Description
81151>>>>>//    This object shows the systeminformation on the screen
81151>>>>>//
81151>>>>>// $Rev History
81151>>>>>//    24-09-96  Module header created
81151>>>>>//****************************************************************************
81151>>>>>Class SysInfoDialog Is A ModalPanel
81152>>>>>    Procedure Construct_Object
81154>>>>>        Forward Send Construct_Object
81156>>>>>
81156>>>>>        Set Label to C_$SystemInformation
81157>>>>>        Set Size to 140 267
81158>>>>>        Set piMinSize to 140 267
81159>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
81160>>>>>        Set Border_Style to Border_Thick
81161>>>>>
81161>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
81163>>>>>            Set peAnchors to anAll
81164>>>>>        End_Object
81165>>>>>
81165>>>>>        Object oCloseButton Is A Button
81167>>>>>            Set Label To C_$Close
81168>>>>>            Set Location To 120 210
81169>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
81170>>>>>            Set Default_State To True
81171>>>>>            Set peAnchors to anBottomRight
81172>>>>>        End_Object
81173>>>>>
81173>>>>>        On_Key kCancel Send Close_Panel
81174>>>>>    End_Procedure
81175>>>>>End_Class
81176>>>>>
81176>>>>>// Purpose:
81176>>>>>//
81176>>>>>// Ken Ross 12/17/96 5:16PM
81176>>>>>//
81176>>>>>Class AboutDialog Is A ModalPanel
81177>>>>>    Procedure Construct_Object
81179>>>>>        String sVdfRootDir
81179>>>>>
81179>>>>>        Forward Send Construct_Object
81181>>>>>
81181>>>>>        Set Label To C_$About
81182>>>>>        Set Size to 89 212
81183>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
81184>>>>>
81184>>>>>        Object oSysInfoDialog Is A SysInfoDialog
81186>>>>>        End_Object
81187>>>>>
81187>>>>>        Object oBox Is A Container3d
81189>>>>>            Set Border_Style To Border_StaticEdge
81190>>>>>            Set Size to 63 202
81191>>>>>            Set Location To 4 5
81192>>>>>
81192>>>>>            Object oAboutGraphic Is A BitmapContainer
81194>>>>>                Set Border_Style To Border_None
81195>>>>>                Set Bitmap_Style To Bitmap_Center
81196>>>>>                Set Size To 48 48
81197>>>>>                Set Location To 7 2
81198>>>>>            End_Object
81199>>>>>
81199>>>>>            Object oProductName Is A TextBox
81201>>>>>                Set Label To C_$ProductName
81202>>>>>                Set Size To 10 45
81203>>>>>                Set Location To 8 53
81204>>>>>            End_Object
81205>>>>>
81205>>>>>            Object oVersion Is A TextBox
81207>>>>>                Set Label To C_$Version
81208>>>>>                Set Size To 10 25
81209>>>>>                Set Location To 21 53
81210>>>>>            End_Object
81211>>>>>
81211>>>>>            Object oCopyright Is A TextBox
81213>>>>>                Set Label To C_$Copyright
81214>>>>>                Set Size To 10 31
81215>>>>>                Set Location To 34 53
81216>>>>>            End_Object
81217>>>>>
81217>>>>>            Object oAuthor Is A TextBox
81219>>>>>                Set Label To C_$Author
81220>>>>>                Set Size To 10 22
81221>>>>>                Set Location To 46 53
81222>>>>>            End_Object
81223>>>>>        End_Object
81224>>>>>
81224>>>>>        Object oOKButton Is A Button
81226>>>>>            On_Item C_$OK Send Close_Panel
81227>>>>>            Set Size To 14 50
81228>>>>>            Set Location To 71 157
81229>>>>>        End_Object
81230>>>>>
81230>>>>>        Object oSysInfoButton Is A Button
81232>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
81233>>>>>            Set Size To 14 50
81234>>>>>            Set Location To 71 101
81235>>>>>        End_Object
81236>>>>>
81236>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
81237>>>>>
81237>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
81238>>>>>    End_Procedure
81239>>>>>
81239>>>>>    Procedure Set ProductName String sProductName
81241>>>>>        Set Label Of oProductName To sProductName
81242>>>>>    End_Procedure
81243>>>>>
81243>>>>>    Procedure Set Version String sVersion
81245>>>>>        Set Label Of oVersion To sVersion
81246>>>>>    End_Procedure
81247>>>>>
81247>>>>>    Procedure Set Copyright string sCopyright
81249>>>>>        Set Label Of oCopyright To sCopyright
81250>>>>>    End_Procedure
81251>>>>>
81251>>>>>    Procedure Set Author String sAuthor
81253>>>>>        Set Label Of oAuthor To sAuthor
81254>>>>>    End_Procedure
81255>>>>>
81255>>>>>    Procedure Set Logo string sLogo
81257>>>>>        // square bitmaps Of 42x42 work best
81257>>>>>        Set Bitmap Of oAboutGraphic To sLogo
81258>>>>>    End_Procedure
81259>>>>>
81259>>>>>    Procedure Show_Sysinfo
81261>>>>>        Send Popup_Modal Of oSysinfoDialog
81262>>>>>    End_Procedure
81263>>>>>
81263>>>>>    Procedure End_Construct_Object
81265>>>>>        Handle hoVersionInfo
81265>>>>>        Boolean bIncluded
81265>>>>>        Integer iMajor iMinor iRelease iBuild
81265>>>>>        String sLabel
81265>>>>>
81265>>>>>        Get Label Of oVersion To sLabel
81266>>>>>        If (sLabel = C_$VERSION) Begin
81268>>>>>            // set it To the version info Of the program, if available
81268>>>>>            If (ghoApplication <> 0) Begin
81270>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
81271>>>>>                If (hoVersionInfo <> 0) Begin
81273>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
81274>>>>>                    If (bIncluded) Begin
81276>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
81277>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
81278>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
81279>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
81280>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
81281>>>>>                        Set Version to sLabel
81282>>>>>                    End
81282>>>>>>
81282>>>>>                End
81282>>>>>>
81282>>>>>            End
81282>>>>>>
81282>>>>>        End
81282>>>>>>
81282>>>>>
81282>>>>>        Forward Send End_Construct_Object
81284>>>>>    End_Procedure
81285>>>>>End_Class
81286>>>
81286>>>// *************************************************************************
81286>>>//  Public message. This is the default message. It is expected that you will
81286>>>//   create your own message to override this
81286>>>// *************************************************************************
81286>>>
81286>>>Procedure Activate_About
81289>>>   Send DoAbout "" "" "" "" ""
81290>>>End_Procedure
81291>>>
81291>>>// *************************************************************************
81291>>>//  Public message. It is expected that you will send this message (most
81291>>>//  likely from Activate_About. This creates an about object, activates it
81291>>>//  and destroys it when done. It is not exepected that you will augment this.
81291>>>// *************************************************************************
81291>>>
81291>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
81294>>>        integer hoObj hoMain
81294>>>
81294>>>        // create object
81294>>>        Object About is an AboutDialog
81296>>>            // if no title passed use the label of the main panel
81296>>>            // (if a main panel exists).
81296>>>            if sTitle     eq '' Begin
81298>>>                Get Main_Window of desktop to hoMain
81299>>>                if hoMain Get Label of hoMain to sTitle
81302>>>            end
81302>>>>
81302>>>            set productname to sTitle
81303>>>            set version     to sVersion
81304>>>            set copyright   to sCopyRight
81305>>>            set author      to sAuthor
81306>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
81309>>>            Move self to hoObj // object Id
81310>>>        End_Object
81311>>>        Send Popup   of hoObj    // popup the about object
81312>>>        Send Destroy of hoObj // when done, it will be destroyed
81313>>>End_procedure
81314>        Use Auto.vw
Including file: Auto.vw    (C:\Repos\DataFlexBeadando\AppSrc\Auto.vw)
81314>>>// C:\Repos\DataFlexBeadando\AppSrc\Auto.vw
81314>>>// Auto
81314>>>//
81314>>>
81314>>>Use DFClient.pkg
81314>>>Use DFEntry.pkg
81314>>>
81314>>>Use cAutoDataDictionary.dd
Including file: cAutoDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cAutoDataDictionary.dd)
81314>>>>>Use DataDict.pkg
81314>>>>>
81314>>>>>Open Auto
Including file: Auto.fd    (C:\Repos\DataFlexBeadando\DDSrc\Auto.fd)
81316>>>>>Open Munkalap
Including file: Munkalap.fd    (C:\Repos\DataFlexBeadando\DDSrc\Munkalap.fd)
81318>>>>>
81318>>>>>Register_Object Auto_sl
81318>>>>>
81318>>>>>Class cAutoDataDictionary is a DataDictionary
81319>>>>>    
81319>>>>>    Procedure Construct_Object
81321>>>>>        Forward Send Construct_Object
81323>>>>>        Set Main_File to Auto.File_Number
81324>>>>>
81324>>>>>        Set Add_Client_File to Munkalap.File_Number
81325>>>>>
81325>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81326>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81327>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81328>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81329>>>>>
81329>>>>>        Set Field_Label_Long Field Auto.Id to "Azonost"
81330>>>>>        Set Field_Label_Short Field Auto.Id to "Azon."
81331>>>>>        Set Field_Prompt_Object Field Auto.Id to Auto_sl
81332>>>>>
81332>>>>>        Set Field_Label_Long Field Auto.Alvazszam to "Alvzszm"
81333>>>>>        Set Field_Label_Short Field Auto.Alvazszam to "Alv."
81334>>>>>        Set Field_Prompt_Object Field Auto.Alvazszam to Auto_sl
81335>>>>>
81335>>>>>        Set Field_Label_Long Field Auto.Motorszam to "Motorszm"
81336>>>>>        Set Field_Label_Short Field Auto.Motorszam to "Motorsz."
81337>>>>>        Set Field_Prompt_Object Field Auto.Motorszam to Auto_sl
81338>>>>>
81338>>>>>        Set Field_Label_Long Field Auto.Marka to "Mrka"
81339>>>>>        Set Field_Label_Short Field Auto.Marka to "Mrka"
81340>>>>>
81340>>>>>        Set Field_Label_Long Field Auto.Tipus to "Tipus"
81341>>>>>        Set Field_Label_Short Field Auto.Tipus to "Tipus"
81342>>>>>
81342>>>>>        Set Field_Label_Long Field Auto.Evjarat to "Evjarat"
81343>>>>>        Set Field_Label_Short Field Auto.Evjarat to "Evj,"
81344>>>>>
81344>>>>>        Set Field_Label_Long Field Auto.UtolsoSzerviz to "Utols szervz"
81345>>>>>        Set Field_Label_Short Field Auto.UtolsoSzerviz to "Utol. szv."
81346>>>>>
81346>>>>>        Set Field_Label_Long Field Auto.KmAllas to "Kilmter lls"
81347>>>>>        Set Field_Label_Short Field Auto.KmAllas to "Km ll."
81348>>>>>
81348>>>>>    End_Procedure
81349>>>>>
81349>>>>>End_Class
81350>>>>>
81350>>>>>Use Auto.sl
Including file: Auto.sl    (C:\Repos\DataFlexBeadando\AppSrc\Auto.sl)
81350>>>>>>>// Auto.sl
81350>>>>>>>// Auto Lookup List
81350>>>>>>>
81350>>>>>>>Use DFClient.pkg
81350>>>>>>>Use cDbCJGridPromptList.pkg
81350>>>>>>>Use cDbCJGridColumn.pkg
81350>>>>>>>Use Windows.pkg
81350>>>>>>>
81350>>>>>>>Use cAutoDataDictionary.dd
81350>>>>>>>
81350>>>>>>>CD_Popup_Object Auto_sl is a dbModalPanel
81368>>>>>>>>
81368>>>>>>>    Set Location to 5 5
81369>>>>>>>    Set Size to 134 610
81370>>>>>>>    Set Label To "Auto Lookup List"
81371>>>>>>>    Set Border_Style to Border_Thick
81372>>>>>>>    Set Minimize_Icon to False
81373>>>>>>>
81373>>>>>>>
81373>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
81375>>>>>>>    End_Object 
81376>>>>>>>
81376>>>>>>>    Set Main_DD To oAuto_DD
81377>>>>>>>    Set Server  To oAuto_DD
81378>>>>>>>
81378>>>>>>>
81378>>>>>>>
81378>>>>>>>    Object oSelList is a cDbCJGridPromptList
81380>>>>>>>        Set Size to 105 600
81381>>>>>>>        Set Location to 5 5
81382>>>>>>>        Set peAnchors to anAll
81383>>>>>>>        Set psLayoutSection to "Auto_sl_oSelList"
81384>>>>>>>        Set Ordering to 1
81385>>>>>>>        Set pbAutoServer to True
81386>>>>>>>
81386>>>>>>>        Object oAuto_Id is a cDbCJGridColumn
81388>>>>>>>            Entry_Item Auto.Id
81389>>>>>>>            Set piWidth to 63
81390>>>>>>>            Set psCaption to "Azon."
81391>>>>>>>        End_Object 
81392>>>>>>>
81392>>>>>>>        Object oAuto_Alvazszam is a cDbCJGridColumn
81394>>>>>>>            Entry_Item Auto.Alvazszam
81395>>>>>>>            Set piWidth to 210
81396>>>>>>>            Set psCaption to "Alv."
81397>>>>>>>        End_Object 
81398>>>>>>>
81398>>>>>>>        Object oAuto_Motorszam is a cDbCJGridColumn
81400>>>>>>>            Entry_Item Auto.Motorszam
81401>>>>>>>            Set piWidth to 210
81402>>>>>>>            Set psCaption to "Motorsz."
81403>>>>>>>        End_Object 
81404>>>>>>>
81404>>>>>>>        Object oAuto_Marka is a cDbCJGridColumn
81406>>>>>>>            Entry_Item Auto.Marka
81407>>>>>>>            Set piWidth to 210
81408>>>>>>>            Set psCaption to "Mrka"
81409>>>>>>>        End_Object 
81410>>>>>>>
81410>>>>>>>        Object oAuto_Tipus is a cDbCJGridColumn
81412>>>>>>>            Entry_Item Auto.Tipus
81413>>>>>>>            Set piWidth to 210
81414>>>>>>>            Set psCaption to "Tipus"
81415>>>>>>>        End_Object 
81416>>>>>>>
81416>>>>>>>        Object oAuto_Evjarat is a cDbCJGridColumn
81418>>>>>>>            Entry_Item Auto.Evjarat
81419>>>>>>>            Set piWidth to 49
81420>>>>>>>            Set psCaption to "Evj,"
81421>>>>>>>        End_Object 
81422>>>>>>>
81422>>>>>>>        Object oAuto_UtolsoSzerviz is a cDbCJGridColumn
81424>>>>>>>            Entry_Item Auto.UtolsoSzerviz
81425>>>>>>>            Set piWidth to 105
81426>>>>>>>            Set psCaption to "Utol. szv."
81427>>>>>>>        End_Object 
81428>>>>>>>
81428>>>>>>>        Object oAuto_KmAllas is a cDbCJGridColumn
81430>>>>>>>            Entry_Item Auto.KmAllas
81431>>>>>>>            Set piWidth to 105
81432>>>>>>>            Set psCaption to "Km ll."
81433>>>>>>>        End_Object 
81434>>>>>>>
81434>>>>>>>
81434>>>>>>>    End_Object 
81435>>>>>>>
81435>>>>>>>    Object oOk_bn is a Button
81437>>>>>>>        Set Label to "&Ok"
81438>>>>>>>        Set Location to 115 447
81439>>>>>>>        Set peAnchors to anBottomRight
81440>>>>>>>
81440>>>>>>>        Procedure OnClick
81443>>>>>>>            Send OK of oSelList
81444>>>>>>>        End_Procedure
81445>>>>>>>
81445>>>>>>>    End_Object 
81446>>>>>>>
81446>>>>>>>    Object oCancel_bn is a Button
81448>>>>>>>        Set Label to "&Cancel"
81449>>>>>>>        Set Location to 115 501
81450>>>>>>>        Set peAnchors to anBottomRight
81451>>>>>>>
81451>>>>>>>        Procedure OnClick
81454>>>>>>>            Send Cancel of oSelList
81455>>>>>>>        End_Procedure
81456>>>>>>>
81456>>>>>>>    End_Object 
81457>>>>>>>
81457>>>>>>>    Object oSearch_bn is a Button
81459>>>>>>>        Set Label to "&Search..."
81460>>>>>>>        Set Location to 115 555
81461>>>>>>>        Set peAnchors to anBottomRight
81462>>>>>>>
81462>>>>>>>        Procedure OnClick
81465>>>>>>>            Send Search of oSelList
81466>>>>>>>        End_Procedure
81467>>>>>>>
81467>>>>>>>    End_Object 
81468>>>>>>>
81468>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81469>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81470>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81471>>>>>>>
81471>>>>>>>
81471>>>>>>>CD_End_Object // Auto_sl
81473>>>>>>>>
81473>>>
81473>>>ACTIVATE_VIEW Activate_oAuto FOR oAuto
81483>>>>
81483>>>Object oAuto is a dbView
81485>>>    Set Location to 5 5
81486>>>    Set Size to 98 349
81487>>>    Set Label To "Auto"
81488>>>    Set Border_Style to Border_Thick
81489>>>
81489>>>
81489>>>    Object oAuto_DD is a cAutoDataDictionary
81491>>>    End_Object 
81492>>>
81492>>>    Set Main_DD To oAuto_DD
81493>>>    Set Server  To oAuto_DD
81494>>>
81494>>>
81494>>>
81494>>>    Object oAutoId is a dbForm
81496>>>        Entry_Item Auto.Id
81497>>>        Set Size to 13 42
81498>>>        Set Location to 5 51
81499>>>        Set peAnchors to anTopLeftRight
81500>>>        Set Label to "Azonost"
81501>>>        Set Label_Justification_mode to jMode_Left
81502>>>        Set Label_Col_Offset to 46
81503>>>        Set Label_row_Offset to 0
81504>>>    End_Object 
81505>>>
81505>>>    Object oAutoAlvazszam is a dbForm
81507>>>        Entry_Item Auto.Alvazszam
81508>>>        Set Size to 13 126
81509>>>        Set Location to 20 51
81510>>>        Set peAnchors to anTopLeftRight
81511>>>        Set Label to "Alvzszm"
81512>>>        Set Label_Justification_mode to jMode_Left
81513>>>        Set Label_Col_Offset to 46
81514>>>        Set Label_row_Offset to 0
81515>>>    End_Object 
81516>>>
81516>>>    Object oAutoMotorszam is a dbForm
81518>>>        Entry_Item Auto.Motorszam
81519>>>        Set Size to 13 126
81520>>>        Set Location to 20 218
81521>>>        Set peAnchors to anTopRight
81522>>>        Set Label to "Motorszm"
81523>>>        Set Label_Justification_mode to jMode_Left
81524>>>        Set Label_Col_Offset to 36
81525>>>        Set Label_row_Offset to 0
81526>>>    End_Object 
81527>>>
81527>>>    Object oAutoMarka is a dbForm
81529>>>        Entry_Item Auto.Marka
81530>>>        Set Size to 13 126
81531>>>        Set Location to 35 51
81532>>>        Set peAnchors to anTopLeftRight
81533>>>        Set Label to "Mrka"
81534>>>        Set Label_Justification_mode to jMode_Left
81535>>>        Set Label_Col_Offset to 46
81536>>>        Set Label_row_Offset to 0
81537>>>    End_Object 
81538>>>
81538>>>    Object oAutoTipus is a dbForm
81540>>>        Entry_Item Auto.Tipus
81541>>>        Set Size to 13 126
81542>>>        Set Location to 35 201
81543>>>        Set peAnchors to anTopRight
81544>>>        Set Label to "Tipus"
81545>>>        Set Label_Justification_mode to jMode_Left
81546>>>        Set Label_Col_Offset to 19
81547>>>        Set Label_row_Offset to 0
81548>>>    End_Object 
81549>>>
81549>>>    Object oAutoEvjarat is a dbForm
81551>>>        Entry_Item Auto.Evjarat
81552>>>        Set Size to 13 34
81553>>>        Set Location to 50 51
81554>>>        Set peAnchors to anTopLeftRight
81555>>>        Set Label to "Evjarat"
81556>>>        Set Label_Justification_mode to jMode_Left
81557>>>        Set Label_Col_Offset to 46
81558>>>        Set Label_row_Offset to 0
81559>>>    End_Object 
81560>>>
81560>>>    Object oAutoUtolsoSzerviz is a dbForm
81562>>>        Entry_Item Auto.UtolsoSzerviz
81563>>>        Set Size to 13 66
81564>>>        Set Location to 65 51
81565>>>        Set peAnchors to anTopLeftRight
81566>>>        Set Label to "Utols szervz"
81567>>>        Set Label_Justification_mode to jMode_Left
81568>>>        Set Label_Col_Offset to 46
81569>>>        Set Label_row_Offset to 0
81570>>>    End_Object 
81571>>>
81571>>>    Object oAutoKmAllas is a dbForm
81573>>>        Entry_Item Auto.KmAllas
81574>>>        Set Size to 13 66
81575>>>        Set Location to 80 51
81576>>>        Set peAnchors to anTopLeftRight
81577>>>        Set Label to "Kilmter lls"
81578>>>        Set Label_Justification_mode to jMode_Left
81579>>>        Set Label_Col_Offset to 46
81580>>>        Set Label_row_Offset to 0
81581>>>    End_Object 
81582>>>
81582>>>
81582>>>End_Object 
81583>        Use Munka.vw
Including file: Munka.vw    (C:\Repos\DataFlexBeadando\AppSrc\Munka.vw)
81583>>>// C:\Repos\DataFlexBeadando\AppSrc\Munka.vw
81583>>>// Munka
81583>>>//
81583>>>
81583>>>Use DFClient.pkg
81583>>>Use DFEntry.pkg
81583>>>
81583>>>Use cMunkaDataDictionary.dd
Including file: cMunkaDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkaDataDictionary.dd)
81583>>>>>Use DataDict.pkg
81583>>>>>
81583>>>>>Open Munka
Including file: Munka.fd    (C:\Repos\DataFlexBeadando\DDSrc\Munka.fd)
81585>>>>>Open MunkaMunkalap
Including file: MunkaMunkalap.fd    (C:\Repos\DataFlexBeadando\DDSrc\MunkaMunkalap.fd)
81587>>>>>
81587>>>>>Register_Object Munka_sl
81587>>>>>
81587>>>>>Class cMunkaDataDictionary is a DataDictionary
81588>>>>>    
81588>>>>>    Procedure Construct_Object
81590>>>>>        Forward Send Construct_Object
81592>>>>>        Set Main_File to Munka.File_Number
81593>>>>>
81593>>>>>        Set Add_Client_File to MunkaMunkalap.File_Number
81594>>>>>
81594>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81595>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81596>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81597>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81598>>>>>
81598>>>>>        Set Field_Label_Long Field Munka.Id to "Munka azonost"
81599>>>>>        Set Field_Label_Short Field Munka.Id to "Munka azon."
81600>>>>>        Set Field_Prompt_Object Field Munka.Id to Munka_sl
81601>>>>>
81601>>>>>        Set Field_Label_Long Field Munka.Name to "Nv"
81602>>>>>        Set Field_Label_Short Field Munka.Name to "Nv"
81603>>>>>        Set Field_Prompt_Object Field Munka.Name to Munka_sl
81604>>>>>
81604>>>>>        Set Field_Label_Long Field Munka.Leiras to "Lers"
81605>>>>>        Set Field_Label_Short Field Munka.Leiras to "Lers"
81606>>>>>
81606>>>>>        Set Field_Label_Long Field Munka.Egysegar to "Egysgr"
81607>>>>>        Set Field_Label_Short Field Munka.Egysegar to "Egysgr"
81608>>>>>
81608>>>>>    End_Procedure
81609>>>>>
81609>>>>>End_Class
81610>>>>>
81610>>>>>Use Munka.sl
Including file: Munka.sl    (C:\Repos\DataFlexBeadando\AppSrc\Munka.sl)
81610>>>>>>>// Munka.sl
81610>>>>>>>// Munka Lookup List
81610>>>>>>>
81610>>>>>>>Use DFClient.pkg
81610>>>>>>>Use cDbCJGridPromptList.pkg
81610>>>>>>>Use cDbCJGridColumn.pkg
81610>>>>>>>Use Windows.pkg
81610>>>>>>>
81610>>>>>>>Use cMunkaDataDictionary.dd
81610>>>>>>>
81610>>>>>>>CD_Popup_Object Munka_sl is a dbModalPanel
81628>>>>>>>>
81628>>>>>>>    Set Location to 5 5
81629>>>>>>>    Set Size to 134 309
81630>>>>>>>    Set Label To "Munka Lookup List"
81631>>>>>>>    Set Border_Style to Border_Thick
81632>>>>>>>    Set Minimize_Icon to False
81633>>>>>>>
81633>>>>>>>
81633>>>>>>>    Object oMunka_DD is a cMunkaDataDictionary
81635>>>>>>>    End_Object 
81636>>>>>>>
81636>>>>>>>    Set Main_DD To oMunka_DD
81637>>>>>>>    Set Server  To oMunka_DD
81638>>>>>>>
81638>>>>>>>
81638>>>>>>>
81638>>>>>>>    Object oSelList is a cDbCJGridPromptList
81640>>>>>>>        Set Size to 105 299
81641>>>>>>>        Set Location to 5 5
81642>>>>>>>        Set peAnchors to anAll
81643>>>>>>>        Set psLayoutSection to "Munka_sl_oSelList"
81644>>>>>>>        Set Ordering to 1
81645>>>>>>>        Set pbAutoServer to True
81646>>>>>>>
81646>>>>>>>        Object oMunka_Id is a cDbCJGridColumn
81648>>>>>>>            Entry_Item Munka.Id
81649>>>>>>>            Set piWidth to 85
81650>>>>>>>            Set psCaption to "Munka azon."
81651>>>>>>>        End_Object 
81652>>>>>>>
81652>>>>>>>        Object oMunka_Name is a cDbCJGridColumn
81654>>>>>>>            Entry_Item Munka.Name
81655>>>>>>>            Set piWidth to 210
81656>>>>>>>            Set psCaption to "Nv"
81657>>>>>>>        End_Object 
81658>>>>>>>
81658>>>>>>>        Object oMunka_Leiras is a cDbCJGridColumn
81660>>>>>>>            Entry_Item Munka.Leiras
81661>>>>>>>            Set piWidth to 105
81662>>>>>>>            Set psCaption to "Lers"
81663>>>>>>>        End_Object 
81664>>>>>>>
81664>>>>>>>        Object oMunka_Egysegar is a cDbCJGridColumn
81666>>>>>>>            Entry_Item Munka.Egysegar
81667>>>>>>>            Set piWidth to 105
81668>>>>>>>            Set psCaption to "Egysgr"
81669>>>>>>>        End_Object 
81670>>>>>>>
81670>>>>>>>
81670>>>>>>>    End_Object 
81671>>>>>>>
81671>>>>>>>    Object oOk_bn is a Button
81673>>>>>>>        Set Label to "&Ok"
81674>>>>>>>        Set Location to 115 146
81675>>>>>>>        Set peAnchors to anBottomRight
81676>>>>>>>
81676>>>>>>>        Procedure OnClick
81679>>>>>>>            Send OK of oSelList
81680>>>>>>>        End_Procedure
81681>>>>>>>
81681>>>>>>>    End_Object 
81682>>>>>>>
81682>>>>>>>    Object oCancel_bn is a Button
81684>>>>>>>        Set Label to "&Cancel"
81685>>>>>>>        Set Location to 115 200
81686>>>>>>>        Set peAnchors to anBottomRight
81687>>>>>>>
81687>>>>>>>        Procedure OnClick
81690>>>>>>>            Send Cancel of oSelList
81691>>>>>>>        End_Procedure
81692>>>>>>>
81692>>>>>>>    End_Object 
81693>>>>>>>
81693>>>>>>>    Object oSearch_bn is a Button
81695>>>>>>>        Set Label to "&Search..."
81696>>>>>>>        Set Location to 115 254
81697>>>>>>>        Set peAnchors to anBottomRight
81698>>>>>>>
81698>>>>>>>        Procedure OnClick
81701>>>>>>>            Send Search of oSelList
81702>>>>>>>        End_Procedure
81703>>>>>>>
81703>>>>>>>    End_Object 
81704>>>>>>>
81704>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81705>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81706>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81707>>>>>>>
81707>>>>>>>
81707>>>>>>>CD_End_Object // Munka_sl
81709>>>>>>>>
81709>>>
81709>>>ACTIVATE_VIEW Activate_oMunka FOR oMunka
81719>>>>
81719>>>Object oMunka is a dbView
81721>>>    Set Location to 5 5
81722>>>    Set Size to 38 251
81723>>>    Set Label To "Munka"
81724>>>    Set Border_Style to Border_Thick
81725>>>
81725>>>
81725>>>    Object oMunka_DD is a cMunkaDataDictionary
81727>>>    End_Object 
81728>>>
81728>>>    Set Main_DD To oMunka_DD
81729>>>    Set Server  To oMunka_DD
81730>>>
81730>>>
81730>>>
81730>>>    Object oMunkaId is a dbForm
81732>>>        Entry_Item Munka.Id
81733>>>        Set Size to 13 42
81734>>>        Set Location to 5 59
81735>>>        Set peAnchors to anTopLeftRight
81736>>>        Set Label to "Munka azonost"
81737>>>        Set Label_Justification_mode to jMode_Left
81738>>>        Set Label_Col_Offset to 54
81739>>>        Set Label_row_Offset to 0
81740>>>    End_Object 
81741>>>
81741>>>    Object oMunkaName is a dbForm
81743>>>        Entry_Item Munka.Name
81744>>>        Set Size to 13 126
81745>>>        Set Location to 5 120
81746>>>        Set peAnchors to anTopRight
81747>>>        Set Label to "Nv"
81748>>>        Set Label_Justification_mode to jMode_Left
81749>>>        Set Label_Col_Offset to 14
81750>>>        Set Label_row_Offset to 0
81751>>>    End_Object 
81752>>>
81752>>>    Object oMunkaLeiras is a dbForm
81754>>>        Entry_Item Munka.Leiras
81755>>>        Set Size to 13 66
81756>>>        Set Location to 20 59
81757>>>        Set peAnchors to anTopLeftRight
81758>>>        Set Label to "Lers"
81759>>>        Set Label_Justification_mode to jMode_Left
81760>>>        Set Label_Col_Offset to 54
81761>>>        Set Label_row_Offset to 0
81762>>>    End_Object 
81763>>>
81763>>>    Object oMunkaEgysegar is a dbForm
81765>>>        Entry_Item Munka.Egysegar
81766>>>        Set Size to 13 66
81767>>>        Set Location to 20 159
81768>>>        Set peAnchors to anTopRight
81769>>>        Set Label to "Egysgr"
81770>>>        Set Label_Justification_mode to jMode_Left
81771>>>        Set Label_Col_Offset to 29
81772>>>        Set Label_row_Offset to 0
81773>>>    End_Object 
81774>>>
81774>>>
81774>>>End_Object 
81775>        Use Ugyfel.vw
Including file: Ugyfel.vw    (C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.vw)
81775>>>// C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.vw
81775>>>// Ugyfel
81775>>>//
81775>>>
81775>>>Use DFClient.pkg
81775>>>Use DFEntry.pkg
81775>>>
81775>>>Use cUgyfelDataDictionary.dd
Including file: cUgyfelDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cUgyfelDataDictionary.dd)
81775>>>>>Use DataDict.pkg
81775>>>>>
81775>>>>>Open Ugyfel
Including file: Ugyfel.fd    (C:\Repos\DataFlexBeadando\DDSrc\Ugyfel.fd)
81777>>>>>Open Munkalap
81779>>>>>
81779>>>>>Register_Object Ugyfel_sl
81779>>>>>
81779>>>>>Class cUgyfelDataDictionary is a DataDictionary
81780>>>>>    
81780>>>>>    Procedure Construct_Object
81782>>>>>        Forward Send Construct_Object
81784>>>>>        Set Main_File to Ugyfel.File_Number
81785>>>>>
81785>>>>>        Set Add_Client_File to Munkalap.File_Number
81786>>>>>
81786>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81787>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81788>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81789>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81790>>>>>
81790>>>>>        Set Field_Label_Long Field Ugyfel.Id to "gyfl azonost"
81791>>>>>        Set Field_Label_Short Field Ugyfel.Id to "gyf. azon."
81792>>>>>        Set Field_Prompt_Object Field Ugyfel.Id to Ugyfel_sl
81793>>>>>
81793>>>>>        Set Field_Label_Long Field Ugyfel.Nev to "Nv"
81794>>>>>        Set Field_Label_Short Field Ugyfel.Nev to "Nv"
81795>>>>>        Set Field_Prompt_Object Field Ugyfel.Nev to Ugyfel_sl
81796>>>>>
81796>>>>>        Set Field_Mask Field Ugyfel.Adoszam to "########-#-##"
81797>>>>>        Set Field_Label_Long Field Ugyfel.Adoszam to "Adszm"
81798>>>>>        Set Field_Label_Short Field Ugyfel.Adoszam to "A.sz."
81799>>>>>
81799>>>>>        Set Field_Label_Long Field Ugyfel.Cim to "Cm"
81800>>>>>        Set Field_Label_Short Field Ugyfel.Cim to "Cm"
81801>>>>>
81801>>>>>        Set Field_Label_Long Field Ugyfel.Telefon to "Telefon"
81802>>>>>        Set Field_Label_Short Field Ugyfel.Telefon to "tel."
81803>>>>>        Set Field_Mask Field Ugyfel.Telefon to "+##-##-###-####"
81804>>>>>
81804>>>>>        Set Field_Label_Long Field Ugyfel.Bankszamla to "Bankszmla"
81805>>>>>        Set Field_Label_Short Field Ugyfel.Bankszamla to "Bszla."
81806>>>>>        Set Field_Mask Field Ugyfel.Bankszamla to "#######-########-########"
81807>>>>>
81807>>>>>    End_Procedure
81808>>>>>
81808>>>>>End_Class
81809>>>>>
81809>>>>>Use Ugyfel.sl
Including file: Ugyfel.sl    (C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.sl)
81809>>>>>>>// Ugyfel.sl
81809>>>>>>>// Ugyfel Lookup List
81809>>>>>>>
81809>>>>>>>Use DFClient.pkg
81809>>>>>>>Use cDbCJGridPromptList.pkg
81809>>>>>>>Use cDbCJGridColumn.pkg
81809>>>>>>>Use Windows.pkg
81809>>>>>>>
81809>>>>>>>Use cUgyfelDataDictionary.dd
81809>>>>>>>
81809>>>>>>>CD_Popup_Object Ugyfel_sl is a dbModalPanel
81827>>>>>>>>
81827>>>>>>>    Set Location to 5 5
81828>>>>>>>    Set Size to 134 610
81829>>>>>>>    Set Label To "Ugyfel Lookup List"
81830>>>>>>>    Set Border_Style to Border_Thick
81831>>>>>>>    Set Minimize_Icon to False
81832>>>>>>>
81832>>>>>>>
81832>>>>>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
81834>>>>>>>    End_Object 
81835>>>>>>>
81835>>>>>>>    Set Main_DD To oUgyfel_DD
81836>>>>>>>    Set Server  To oUgyfel_DD
81837>>>>>>>
81837>>>>>>>
81837>>>>>>>
81837>>>>>>>    Object oSelList is a cDbCJGridPromptList
81839>>>>>>>        Set Size to 105 600
81840>>>>>>>        Set Location to 5 5
81841>>>>>>>        Set peAnchors to anAll
81842>>>>>>>        Set psLayoutSection to "Ugyfel_sl_oSelList"
81843>>>>>>>        Set Ordering to 1
81844>>>>>>>        Set pbAutoServer to True
81845>>>>>>>
81845>>>>>>>        Object oUgyfel_Id is a cDbCJGridColumn
81847>>>>>>>            Entry_Item Ugyfel.Id
81848>>>>>>>            Set piWidth to 77
81849>>>>>>>            Set psCaption to "gyf. azon."
81850>>>>>>>        End_Object 
81851>>>>>>>
81851>>>>>>>        Object oUgyfel_Nev is a cDbCJGridColumn
81853>>>>>>>            Entry_Item Ugyfel.Nev
81854>>>>>>>            Set piWidth to 262
81855>>>>>>>            Set psCaption to "Nv"
81856>>>>>>>        End_Object 
81857>>>>>>>
81857>>>>>>>        Object oUgyfel_Adoszam is a cDbCJGridColumn
81859>>>>>>>            Entry_Item Ugyfel.Adoszam
81860>>>>>>>            Set piWidth to 136
81861>>>>>>>            Set psCaption to "A.sz."
81862>>>>>>>        End_Object 
81863>>>>>>>
81863>>>>>>>        Object oUgyfel_Cim is a cDbCJGridColumn
81865>>>>>>>            Entry_Item Ugyfel.Cim
81866>>>>>>>            Set piWidth to 262
81867>>>>>>>            Set psCaption to "Cm"
81868>>>>>>>        End_Object 
81869>>>>>>>
81869>>>>>>>        Object oUgyfel_Telefon is a cDbCJGridColumn
81871>>>>>>>            Entry_Item Ugyfel.Telefon
81872>>>>>>>            Set piWidth to 126
81873>>>>>>>            Set psCaption to "tel."
81874>>>>>>>        End_Object 
81875>>>>>>>
81875>>>>>>>        Object oUgyfel_Bankszamla is a cDbCJGridColumn
81877>>>>>>>            Entry_Item Ugyfel.Bankszamla
81878>>>>>>>            Set piWidth to 262
81879>>>>>>>            Set psCaption to "Bszla."
81880>>>>>>>        End_Object 
81881>>>>>>>
81881>>>>>>>
81881>>>>>>>    End_Object 
81882>>>>>>>
81882>>>>>>>    Object oOk_bn is a Button
81884>>>>>>>        Set Label to "&Ok"
81885>>>>>>>        Set Location to 115 447
81886>>>>>>>        Set peAnchors to anBottomRight
81887>>>>>>>
81887>>>>>>>        Procedure OnClick
81890>>>>>>>            Send OK of oSelList
81891>>>>>>>        End_Procedure
81892>>>>>>>
81892>>>>>>>    End_Object 
81893>>>>>>>
81893>>>>>>>    Object oCancel_bn is a Button
81895>>>>>>>        Set Label to "&Cancel"
81896>>>>>>>        Set Location to 115 501
81897>>>>>>>        Set peAnchors to anBottomRight
81898>>>>>>>
81898>>>>>>>        Procedure OnClick
81901>>>>>>>            Send Cancel of oSelList
81902>>>>>>>        End_Procedure
81903>>>>>>>
81903>>>>>>>    End_Object 
81904>>>>>>>
81904>>>>>>>    Object oSearch_bn is a Button
81906>>>>>>>        Set Label to "&Search..."
81907>>>>>>>        Set Location to 115 555
81908>>>>>>>        Set peAnchors to anBottomRight
81909>>>>>>>
81909>>>>>>>        Procedure OnClick
81912>>>>>>>            Send Search of oSelList
81913>>>>>>>        End_Procedure
81914>>>>>>>
81914>>>>>>>    End_Object 
81915>>>>>>>
81915>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81916>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81917>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81918>>>>>>>
81918>>>>>>>
81918>>>>>>>CD_End_Object // Ugyfel_sl
81920>>>>>>>>
81920>>>
81920>>>ACTIVATE_VIEW Activate_oUgyfel FOR oUgyfel
81930>>>>
81930>>>Object oUgyfel is a dbView
81932>>>    Set Location to 5 5
81933>>>    Set Size to 83 350
81934>>>    Set Label To "Ugyfel"
81935>>>    Set Border_Style to Border_Thick
81936>>>
81936>>>
81936>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
81938>>>    End_Object 
81939>>>
81939>>>    Set Main_DD To oUgyfel_DD
81940>>>    Set Server  To oUgyfel_DD
81941>>>
81941>>>
81941>>>
81941>>>    Object oUgyfelId is a dbForm
81943>>>        Entry_Item Ugyfel.Id
81944>>>        Set Size to 13 42
81945>>>        Set Location to 5 57
81946>>>        Set peAnchors to anTopLeftRight
81947>>>        Set Label to "gyfl azonost"
81948>>>        Set Label_Justification_mode to jMode_Left
81949>>>        Set Label_Col_Offset to 52
81950>>>        Set Label_row_Offset to 0
81951>>>    End_Object 
81952>>>
81952>>>    Object oUgyfelNev is a dbForm
81954>>>        Entry_Item Ugyfel.Nev
81955>>>        Set Size to 13 250
81956>>>        Set Location to 20 57
81957>>>        Set peAnchors to anTopLeftRight
81958>>>        Set Label to "Nv"
81959>>>        Set Label_Justification_mode to jMode_Left
81960>>>        Set Label_Col_Offset to 52
81961>>>        Set Label_row_Offset to 0
81962>>>    End_Object 
81963>>>
81963>>>    Object oUgyfelAdoszam is a dbForm
81965>>>        Entry_Item Ugyfel.Adoszam
81966>>>        Set Size to 13 84
81967>>>        Set Location to 35 57
81968>>>        Set peAnchors to anTopLeftRight
81969>>>        Set Label to "Adszm"
81970>>>        Set Label_Justification_mode to jMode_Left
81971>>>        Set Label_Col_Offset to 52
81972>>>        Set Label_row_Offset to 0
81973>>>    End_Object 
81974>>>
81974>>>    Object oUgyfelCim is a dbForm
81976>>>        Entry_Item Ugyfel.Cim
81977>>>        Set Size to 13 250
81978>>>        Set Location to 50 57
81979>>>        Set peAnchors to anTopLeftRight
81980>>>        Set Label to "Cm"
81981>>>        Set Label_Justification_mode to jMode_Left
81982>>>        Set Label_Col_Offset to 52
81983>>>        Set Label_row_Offset to 0
81984>>>    End_Object 
81985>>>
81985>>>    Object oUgyfelTelefon is a dbForm
81987>>>        Entry_Item Ugyfel.Telefon
81988>>>        Set Size to 13 78
81989>>>        Set Location to 65 57
81990>>>        Set peAnchors to anTopLeftRight
81991>>>        Set Label to "Telefon"
81992>>>        Set Label_Justification_mode to jMode_Left
81993>>>        Set Label_Col_Offset to 52
81994>>>        Set Label_row_Offset to 0
81995>>>    End_Object 
81996>>>
81996>>>    Object oUgyfelBankszamla is a dbForm
81998>>>        Entry_Item Ugyfel.Bankszamla
81999>>>        Set Size to 13 168
82000>>>        Set Location to 65 177
82001>>>        Set peAnchors to anTopRight
82002>>>        Set Label to "Bankszmla"
82003>>>        Set Label_Justification_mode to jMode_Left
82004>>>        Set Label_Col_Offset to 37
82005>>>        Set Label_row_Offset to 0
82006>>>    End_Object 
82007>>>
82007>>>
82007>>>End_Object 
82008>        Use Munkalap.vw
Including file: Munkalap.vw    (C:\Repos\DataFlexBeadando\AppSrc\Munkalap.vw)
82008>>>// C:\Repos\DataFlexBeadando\AppSrc\Munkalap.vw
82008>>>// Munkalap
82008>>>//
82008>>>
82008>>>Use DFClient.pkg
82008>>>Use DFEntry.pkg
82008>>>Use cDbCJGrid.pkg
82008>>>Use cDbCJGridColumn.pkg
82008>>>
82008>>>Use cUgyfelDataDictionary.dd
82008>>>Use cAutoDataDictionary.dd
82008>>>Use cMunkalapDataDictionary.dd
Including file: cMunkalapDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkalapDataDictionary.dd)
82008>>>>>Use DataDict.pkg
82008>>>>>
82008>>>>>Open Munkalap
82010>>>>>Open Auto
82012>>>>>Open Ugyfel
82014>>>>>Open MunkaMunkalap
82016>>>>>
82016>>>>>Register_Object Munkalap_sl
82016>>>>>
82016>>>>>Class cMunkalapDataDictionary is a DataDictionary
82017>>>>>    
82017>>>>>    Procedure Construct_Object
82019>>>>>        Forward Send Construct_Object
82021>>>>>        Set Main_File to Munkalap.File_Number
82022>>>>>
82022>>>>>        Set Add_Client_File to MunkaMunkalap.File_Number
82023>>>>>
82023>>>>>        Set Add_Server_File to Auto.File_Number
82024>>>>>        Set Add_Server_File to Ugyfel.File_Number
82025>>>>>
82025>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
82026>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
82027>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
82028>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
82029>>>>>
82029>>>>>        Set Field_Label_Long Field Munkalap.Id to "Munkalap azonost"
82030>>>>>        Set Field_Label_Short Field Munkalap.Id to "Munkalap azon."
82031>>>>>        Set Field_Prompt_Object Field Munkalap.Id to Munkalap_sl
82032>>>>>
82032>>>>>        Set Field_Label_Long Field Munkalap.Rogzites to "Rgzts"
82033>>>>>        Set Field_Label_Short Field Munkalap.Rogzites to "Rgz."
82034>>>>>
82034>>>>>        Set Field_Prompt_Object Field Munkalap.UgyfelId to Munkalap_sl
82035>>>>>
82035>>>>>        Set Field_Prompt_Object Field Munkalap.AutoId to Munkalap_sl
82036>>>>>
82036>>>>>        Set Field_Label_Long Field Munkalap.Behozatal to "Behozatal"
82037>>>>>        Set Field_Label_Short Field Munkalap.Behozatal to "Behoz."
82038>>>>>
82038>>>>>        Set Field_Label_Long Field Munkalap.Elvitel to "Elvitel"
82039>>>>>        Set Field_Label_Short Field Munkalap.Elvitel to "Elvitel"
82040>>>>>
82040>>>>>        Set Field_Label_Long Field Munkalap.Akm to "Kilmter eltte"
82041>>>>>        Set Field_Label_Short Field Munkalap.Akm to "Km eltte"
82042>>>>>
82042>>>>>        Set Field_Label_Long Field Munkalap.Bkm to "Kilmterlls utns"
82043>>>>>        Set Field_Label_Short Field Munkalap.Bkm to "Km utna"
82044>>>>>
82044>>>>>    End_Procedure
82045>>>>>
82045>>>>>End_Class
82046>>>>>
82046>>>>>Use Munkalap.sl
Including file: Munkalap.sl    (C:\Repos\DataFlexBeadando\AppSrc\Munkalap.sl)
82046>>>>>>>// Munkalap.sl
82046>>>>>>>// Munkalap Lookup List
82046>>>>>>>
82046>>>>>>>Use DFClient.pkg
82046>>>>>>>Use cDbCJGridPromptList.pkg
82046>>>>>>>Use cDbCJGridColumn.pkg
82046>>>>>>>Use Windows.pkg
82046>>>>>>>
82046>>>>>>>Use cUgyfelDataDictionary.dd
82046>>>>>>>Use cAutoDataDictionary.dd
82046>>>>>>>Use cMunkalapDataDictionary.dd
82046>>>>>>>
82046>>>>>>>CD_Popup_Object Munkalap_sl is a dbModalPanel
82064>>>>>>>>
82064>>>>>>>    Set Location to 5 5
82065>>>>>>>    Set Size to 134 450
82066>>>>>>>    Set Label To "Munkalap Lookup List"
82067>>>>>>>    Set Border_Style to Border_Thick
82068>>>>>>>    Set Minimize_Icon to False
82069>>>>>>>
82069>>>>>>>
82069>>>>>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82071>>>>>>>    End_Object 
82072>>>>>>>
82072>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
82074>>>>>>>    End_Object 
82075>>>>>>>
82075>>>>>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
82077>>>>>>>        Set DDO_Server To oAuto_DD
82078>>>>>>>        Set DDO_Server To oUgyfel_DD
82079>>>>>>>    End_Object 
82080>>>>>>>
82080>>>>>>>    Set Main_DD To oMunkalap_DD
82081>>>>>>>    Set Server  To oMunkalap_DD
82082>>>>>>>
82082>>>>>>>
82082>>>>>>>
82082>>>>>>>    Object oSelList is a cDbCJGridPromptList
82084>>>>>>>        Set Size to 105 440
82085>>>>>>>        Set Location to 5 5
82086>>>>>>>        Set peAnchors to anAll
82087>>>>>>>        Set psLayoutSection to "Munkalap_sl_oSelList"
82088>>>>>>>        Set Ordering to 1
82089>>>>>>>        Set pbAutoServer to True
82090>>>>>>>
82090>>>>>>>        Object oMunkalap_Id is a cDbCJGridColumn
82092>>>>>>>            Entry_Item Munkalap.Id
82093>>>>>>>            Set piWidth to 101
82094>>>>>>>            Set psCaption to "Munkalap azon."
82095>>>>>>>        End_Object 
82096>>>>>>>
82096>>>>>>>        Object oMunkalap_Rogzites is a cDbCJGridColumn
82098>>>>>>>            Entry_Item Munkalap.Rogzites
82099>>>>>>>            Set piWidth to 105
82100>>>>>>>            Set psCaption to "Rgz."
82101>>>>>>>        End_Object 
82102>>>>>>>
82102>>>>>>>        Object oUgyfel_Id is a cDbCJGridColumn
82104>>>>>>>            Entry_Item Ugyfel.Id
82105>>>>>>>            Set piWidth to 63
82106>>>>>>>            Set psCaption to "UgyfelId"
82107>>>>>>>        End_Object 
82108>>>>>>>
82108>>>>>>>        Object oAuto_Id is a cDbCJGridColumn
82110>>>>>>>            Entry_Item Auto.Id
82111>>>>>>>            Set piWidth to 63
82112>>>>>>>            Set psCaption to "AutoId"
82113>>>>>>>        End_Object 
82114>>>>>>>
82114>>>>>>>        Object oMunkalap_Behozatal is a cDbCJGridColumn
82116>>>>>>>            Entry_Item Munkalap.Behozatal
82117>>>>>>>            Set piWidth to 105
82118>>>>>>>            Set psCaption to "Behoz."
82119>>>>>>>        End_Object 
82120>>>>>>>
82120>>>>>>>        Object oMunkalap_Elvitel is a cDbCJGridColumn
82122>>>>>>>            Entry_Item Munkalap.Elvitel
82123>>>>>>>            Set piWidth to 105
82124>>>>>>>            Set psCaption to "Elvitel"
82125>>>>>>>        End_Object 
82126>>>>>>>
82126>>>>>>>        Object oMunkalap_Akm is a cDbCJGridColumn
82128>>>>>>>            Entry_Item Munkalap.Akm
82129>>>>>>>            Set piWidth to 105
82130>>>>>>>            Set psCaption to "Km eltte"
82131>>>>>>>        End_Object 
82132>>>>>>>
82132>>>>>>>        Object oMunkalap_Bkm is a cDbCJGridColumn
82134>>>>>>>            Entry_Item Munkalap.Bkm
82135>>>>>>>            Set piWidth to 105
82136>>>>>>>            Set psCaption to "Km utna"
82137>>>>>>>        End_Object 
82138>>>>>>>
82138>>>>>>>
82138>>>>>>>    End_Object 
82139>>>>>>>
82139>>>>>>>    Object oOk_bn is a Button
82141>>>>>>>        Set Label to "&Ok"
82142>>>>>>>        Set Location to 115 287
82143>>>>>>>        Set peAnchors to anBottomRight
82144>>>>>>>
82144>>>>>>>        Procedure OnClick
82147>>>>>>>            Send OK of oSelList
82148>>>>>>>        End_Procedure
82149>>>>>>>
82149>>>>>>>    End_Object 
82150>>>>>>>
82150>>>>>>>    Object oCancel_bn is a Button
82152>>>>>>>        Set Label to "&Cancel"
82153>>>>>>>        Set Location to 115 341
82154>>>>>>>        Set peAnchors to anBottomRight
82155>>>>>>>
82155>>>>>>>        Procedure OnClick
82158>>>>>>>            Send Cancel of oSelList
82159>>>>>>>        End_Procedure
82160>>>>>>>
82160>>>>>>>    End_Object 
82161>>>>>>>
82161>>>>>>>    Object oSearch_bn is a Button
82163>>>>>>>        Set Label to "&Search..."
82164>>>>>>>        Set Location to 115 395
82165>>>>>>>        Set peAnchors to anBottomRight
82166>>>>>>>
82166>>>>>>>        Procedure OnClick
82169>>>>>>>            Send Search of oSelList
82170>>>>>>>        End_Procedure
82171>>>>>>>
82171>>>>>>>    End_Object 
82172>>>>>>>
82172>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
82173>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
82174>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
82175>>>>>>>
82175>>>>>>>
82175>>>>>>>CD_End_Object // Munkalap_sl
82177>>>>>>>>
82177>>>Use cMunkaDataDictionary.dd
82177>>>Use cMunkaMunkalapDataDictionary.dd
Including file: cMunkaMunkalapDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkaMunkalapDataDictionary.dd)
82177>>>>>Use DataDict.pkg
82177>>>>>
82177>>>>>Open MunkaMunkalap
82179>>>>>Open Munka
82181>>>>>Open Munkalap
82183>>>>>
82183>>>>>Class cMunkaMunkalapDataDictionary is a DataDictionary
82184>>>>>    
82184>>>>>    Procedure Construct_Object
82186>>>>>        Forward Send Construct_Object
82188>>>>>        Set Main_File to MunkaMunkalap.File_Number
82189>>>>>
82189>>>>>        Set Add_Server_File to Munka.File_Number
82190>>>>>        Set Add_Server_File to Munkalap.File_Number
82191>>>>>
82191>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
82192>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
82193>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
82194>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
82195>>>>>
82195>>>>>    End_Procedure
82196>>>>>
82196>>>>>End_Class
82197>>>
82197>>>ACTIVATE_VIEW Activate_oMunkalap FOR oMunkalap
82207>>>>
82207>>>Object oMunkalap is a dbView
82209>>>    Set Location to 5 5
82210>>>    Set Size to 159 446
82211>>>    Set Label To "Munkalap"
82212>>>    Set Border_Style to Border_Thick
82213>>>
82213>>>
82213>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82215>>>    End_Object 
82216>>>
82216>>>    Object oAuto_DD is a cAutoDataDictionary
82218>>>    End_Object 
82219>>>
82219>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
82221>>>        Set DDO_Server To oAuto_DD
82222>>>        Set DDO_Server To oUgyfel_DD
82223>>>        // this lets you save a new parent DD from within child DD
82223>>>        Set Allow_Foreign_New_Save_State to True
82224>>>    End_Object 
82225>>>
82225>>>    Object oMunka_DD is a cMunkaDataDictionary
82227>>>    End_Object 
82228>>>
82228>>>    Object oMunkaMunkalap_DD is a cMunkaMunkalapDataDictionary
82230>>>        Set DDO_Server To oMunka_DD
82231>>>        Set DDO_Server To oMunkalap_DD
82232>>>        Set Constrain_File To Munkalap.File_Number
82233>>>    End_Object 
82234>>>
82234>>>    Set Main_DD To oMunkalap_DD
82235>>>    Set Server  To oMunkalap_DD
82236>>>
82236>>>
82236>>>
82236>>>    Object oMunkalapId is a dbForm
82238>>>        Entry_Item Munkalap.Id
82239>>>        Set Size to 13 42
82240>>>        Set Location to 5 68
82241>>>        Set peAnchors to anTopLeftRight
82242>>>        Set Label to "Munkalap azonost"
82243>>>        Set Label_Justification_mode to jMode_Left
82244>>>        Set Label_Col_Offset to 63
82245>>>        Set Label_row_Offset to 0
82246>>>    End_Object 
82247>>>
82247>>>    Object oUgyfelId is a dbForm
82249>>>        Entry_Item Ugyfel.Id
82250>>>        Set Size to 13 42
82251>>>        Set Location to 20 68
82252>>>        Set peAnchors to anTopLeftRight
82253>>>        Set Label to "gyfl azonost"
82254>>>        Set Label_Justification_mode to jMode_Left
82255>>>        Set Label_Col_Offset to 63
82256>>>        Set Label_row_Offset to 0
82257>>>    End_Object 
82258>>>
82258>>>    Object oUgyfelNev is a dbForm
82260>>>        Entry_Item Ugyfel.Nev
82261>>>        Set Size to 13 250
82262>>>        Set Location to 20 129
82263>>>        Set peAnchors to anTopRight
82264>>>        Set Label to "Nv"
82265>>>        Set Label_Justification_mode to jMode_Left
82266>>>        Set Label_Col_Offset to 14
82267>>>        Set Label_row_Offset to 0
82268>>>    End_Object 
82269>>>
82269>>>    Object oAutoId is a dbForm
82271>>>        Entry_Item Auto.Id
82272>>>        Set Size to 13 42
82273>>>        Set Location to 35 68
82274>>>        Set peAnchors to anTopLeftRight
82275>>>        Set Label to "Azonost"
82276>>>        Set Label_Justification_mode to jMode_Left
82277>>>        Set Label_Col_Offset to 63
82278>>>        Set Label_row_Offset to 0
82279>>>    End_Object 
82280>>>
82280>>>    Object oAutoAlvazszam is a dbForm
82282>>>        Entry_Item Auto.Alvazszam
82283>>>        Set Size to 13 126
82284>>>        Set Location to 35 148
82285>>>        Set peAnchors to anTopRight
82286>>>        Set Label to "Alvzszm"
82287>>>        Set Label_Justification_mode to jMode_Left
82288>>>        Set Label_Col_Offset to 33
82289>>>        Set Label_row_Offset to 0
82290>>>    End_Object 
82291>>>
82291>>>    Object oAutoMotorszam is a dbForm
82293>>>        Entry_Item Auto.Motorszam
82294>>>        Set Size to 13 126
82295>>>        Set Location to 35 315
82296>>>        Set peAnchors to anTopRight
82297>>>        Set Label to "Motorszm"
82298>>>        Set Label_Justification_mode to jMode_Left
82299>>>        Set Label_Col_Offset to 36
82300>>>        Set Label_row_Offset to 0
82301>>>    End_Object 
82302>>>
82302>>>    Object oMunkalapRogzites is a dbForm
82304>>>        Entry_Item Munkalap.Rogzites
82305>>>        Set Size to 13 66
82306>>>        Set Location to 50 68
82307>>>        Set peAnchors to anTopLeftRight
82308>>>        Set Label to "Rgzts"
82309>>>        Set Label_Justification_mode to jMode_Left
82310>>>        Set Label_Col_Offset to 63
82311>>>        Set Label_row_Offset to 0
82312>>>    End_Object 
82313>>>
82313>>>    Object oMunkalapBehozatal is a dbForm
82315>>>        Entry_Item Munkalap.Behozatal
82316>>>        Set Size to 13 66
82317>>>        Set Location to 50 170
82318>>>        Set peAnchors to anTopRight
82319>>>        Set Label to "Behozatal"
82320>>>        Set Label_Justification_mode to jMode_Left
82321>>>        Set Label_Col_Offset to 31
82322>>>        Set Label_row_Offset to 0
82323>>>    End_Object 
82324>>>
82324>>>    Object oMunkalapElvitel is a dbForm
82326>>>        Entry_Item Munkalap.Elvitel
82327>>>        Set Size to 13 66
82328>>>        Set Location to 50 261
82329>>>        Set peAnchors to anTopRight
82330>>>        Set Label to "Elvitel"
82331>>>        Set Label_Justification_mode to jMode_Left
82332>>>        Set Label_Col_Offset to 20
82333>>>        Set Label_row_Offset to 0
82334>>>    End_Object 
82335>>>
82335>>>    Object oMunkalapAkm is a dbForm
82337>>>        Entry_Item Munkalap.Akm
82338>>>        Set Size to 13 66
82339>>>        Set Location to 65 68
82340>>>        Set peAnchors to anTopLeftRight
82341>>>        Set Label to "Kilmter eltte"
82342>>>        Set Label_Justification_mode to jMode_Left
82343>>>        Set Label_Col_Offset to 63
82344>>>        Set Label_row_Offset to 0
82345>>>    End_Object 
82346>>>
82346>>>    Object oMunkalapBkm is a dbForm
82348>>>        Entry_Item Munkalap.Bkm
82349>>>        Set Size to 13 66
82350>>>        Set Location to 65 202
82351>>>        Set peAnchors to anTopRight
82352>>>        Set Label to "Kilmterlls utns"
82353>>>        Set Label_Justification_mode to jMode_Left
82354>>>        Set Label_Col_Offset to 63
82355>>>        Set Label_row_Offset to 0
82356>>>    End_Object 
82357>>>
82357>>>    Object oDetailGrid is a cDbCJGrid
82359>>>        Set Size to 66 359
82360>>>        Set Location to 88 5
82361>>>        Set Server to oMunkaMunkalap_DD
82362>>>        Set Ordering to 3
82363>>>        Set peAnchors to anAll
82364>>>        Set psLayoutSection to "oMunkalap_oDetailGrid"
82365>>>        Set pbAllowInsertRow to False
82366>>>        Set pbHeaderPrompts to True
82367>>>
82367>>>        Object oMunka_Id is a cDbCJGridColumn
82369>>>            Entry_Item Munka.Id
82370>>>            Set piWidth to 85
82371>>>            Set psCaption to "Munka azon."
82372>>>        End_Object 
82373>>>
82373>>>        Object oMunka_Name is a cDbCJGridColumn
82375>>>            Entry_Item Munka.Name
82376>>>            Set piWidth to 210
82377>>>            Set psCaption to "Nv"
82378>>>        End_Object 
82379>>>
82379>>>        Object oMunka_Leiras is a cDbCJGridColumn
82381>>>            Entry_Item Munka.Leiras
82382>>>            Set piWidth to 105
82383>>>            Set psCaption to "Lers"
82384>>>        End_Object 
82385>>>
82385>>>        Object oMunka_Egysegar is a cDbCJGridColumn
82387>>>            Entry_Item Munka.Egysegar
82388>>>            Set piWidth to 105
82389>>>            Set psCaption to "Egysgr"
82390>>>        End_Object 
82391>>>
82391>>>        Object oMunkaMunkalap_Darab is a cDbCJGridColumn
82393>>>            Entry_Item MunkaMunkalap.Darab
82394>>>            Set piWidth to 105
82395>>>            Set psCaption to "Darab"
82396>>>        End_Object 
82397>>>
82397>>>    End_Object 
82398>>>
82398>>>    //-----------------------------------------------------------------------
82398>>>    // Create custom confirmation messages for save and delete
82398>>>    // We must create the new functions and assign verify messages
82398>>>    // to them.
82398>>>    //-----------------------------------------------------------------------
82398>>>
82398>>>    Function ConfirmDeleteHeader Returns Boolean
82401>>>        Boolean bFail
82401>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
82402>>>        Function_Return bFail
82403>>>    End_Function 
82404>>>
82404>>>    // Only confirm on the saving of new records
82404>>>    Function ConfirmSaveHeader Returns Boolean
82407>>>        Boolean bNoSave bHasRecord
82407>>>        Handle  hoSrvr
82407>>>        Get Server to hoSrvr
82408>>>        Get HasRecord of hoSrvr to bHasRecord
82409>>>        If not bHasRecord Begin
82411>>>            Get Confirm "Save this NEW header?" to bNoSave
82412>>>        End
82412>>>>
82412>>>        Function_Return bNoSave
82413>>>    End_Function 
82414>>>
82414>>>    // Define alternate confirmation Messages
82414>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
82415>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
82416>>>    // Saves in header should not clear the view
82416>>>    Set Auto_Clear_Deo_State to False
82417>>>
82417>>>
82417>>>End_Object 
82418>
82418>        Procedure Activate_About
82421>            Send DoAbout "" "" "" "" ""
82422>        End_Procedure
82423>
82423>    End_Object
82424>
82424>End_Object
82425>
82425>Start_UI
82426>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 46821
Total Resources: 0
Total Commands : 82425
Total Windows  : 1
Total Pages    : 1
Static Data    : 509459
Message area   : 570335
Total Blocks   : 29572
