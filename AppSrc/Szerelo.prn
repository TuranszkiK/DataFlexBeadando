Compiling Program: C:\Repos\DataFlexBeadando\AppSrc\Szerelo.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.0\Pkg\dfallent.pkd)
79228>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardCommandBarSystem.pkg)
79228>>>// these are all the packages used in a standard MDI menubar/toolbar system
79228>>>
79228>>>Use cCJCommandBarSystem.pkg
79228>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardMenuItemClasses.pkg)
79228>>>>>Use Dfpanel.pkg
79228>>>>>Use cCJCommandBarSystem.pkg
79228>>>>>Use LanguageText.pkg
79228>>>>>
79228>>>>>
79228>>>>>Class cCJUndoMenuItem is a cCJMenuItem
79229>>>>>    
79229>>>>>    Procedure Construct_Object
79231>>>>>        Forward Send Construct_Object
79233>>>>>        Set psCaption   to C_$CaptionUndo
79234>>>>>        Set psToolTip to C_$ToolTipUndo
79235>>>>>        Set psDescription to C_$DescUndo
79236>>>>>        Set psImage to "ActionUndo.ico"
79237>>>>>        Set pbActiveUpdate to True
79238>>>>>        Set psCategory to C_$CategoryEdit
79239>>>>>        Set psShortcut to C_$Key_Ctrl_Z
79240>>>>>    End_Procedure
79241>>>>>
79241>>>>>    Procedure OnExecute Variant vCommandBarControl
79243>>>>>        Send Undo of (focus(Self))
79244>>>>>    End_Procedure
79245>>>>>    
79245>>>>>    Function IsEnabled Returns Boolean
79247>>>>>        Boolean bEnabled
79247>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
79248>>>>>        Function_Return bEnabled
79249>>>>>    End_Function
79250>>>>>         
79250>>>>>End_Class
79251>>>>>
79251>>>>>
79251>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
79252>>>>>    
79252>>>>>    Procedure Construct_Object
79254>>>>>        Forward Send Construct_Object
79256>>>>>        Set psCaption   to C_$CaptionDelete
79257>>>>>        Set psToolTip to C_$ToolTipDelete
79258>>>>>        Set psDescription to C_$DescDelete
79259>>>>>        Set psImage to "actionDelete.ico"
79260>>>>>        Set psShortcut to C_$Key_Delete
79261>>>>>        Set pbActiveUpdate to True
79262>>>>>        Set psCategory to C_$CategoryEdit
79263>>>>>    End_Procedure
79264>>>>>
79264>>>>>
79264>>>>>    Procedure OnExecute Variant vCommandBarControl
79266>>>>>        Send Delete of (focus(Self))
79267>>>>>    End_Procedure
79268>>>>>    
79268>>>>>    Function IsEnabled Returns Boolean
79270>>>>>        Boolean bEnabled
79270>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
79271>>>>>        Function_Return bEnabled
79272>>>>>    End_Function
79273>>>>>         
79273>>>>>End_Class
79274>>>>>
79274>>>>>
79274>>>>>Class cCJCutMenuItem is a cCJMenuItem
79275>>>>>    
79275>>>>>    Procedure Construct_Object
79277>>>>>        Forward Send Construct_Object
79279>>>>>        Set psCaption   to C_$CaptionCut
79280>>>>>        Set psToolTip to C_$TooltipCut
79281>>>>>        Set psDescription to C_$DescCut
79282>>>>>        Set psImage to "actionCut.ico"
79283>>>>>        Set psShortcut to C_$Key_Ctrl_X
79284>>>>>        Set pbActiveUpdate to True
79285>>>>>        Set psCategory to C_$CategoryEdit
79286>>>>>    End_Procedure
79287>>>>>
79287>>>>>
79287>>>>>    Procedure OnExecute Variant vCommandBarControl
79289>>>>>        Send Cut of (focus(Self))
79290>>>>>    End_Procedure
79291>>>>>    
79291>>>>>    Function IsEnabled Returns Boolean
79293>>>>>        Boolean bEnabled
79293>>>>>        Get CanCut of (Focus(Self)) to bEnabled
79294>>>>>        Function_Return bEnabled
79295>>>>>    End_Function
79296>>>>>         
79296>>>>>End_Class
79297>>>>>
79297>>>>>
79297>>>>>Class cCJCopyMenuItem is a cCJMenuItem
79298>>>>>    
79298>>>>>    Procedure Construct_Object
79300>>>>>        Forward Send Construct_Object
79302>>>>>        Set psCaption   to C_$CaptionCopy
79303>>>>>        Set psToolTip to C_$ToolTipCopy
79304>>>>>        Set psDescription to C_$DescCopy
79305>>>>>        Set psImage to "actionCopy.ico"
79306>>>>>        Set psShortcut to C_$Key_Ctrl_C
79307>>>>>        Set pbActiveUpdate to True
79308>>>>>        Set psCategory to C_$CategoryEdit
79309>>>>>    End_Procedure
79310>>>>>
79310>>>>>
79310>>>>>    Procedure OnExecute Variant vCommandBarControl
79312>>>>>        Send Copy of (focus(Self))
79313>>>>>    End_Procedure
79314>>>>>    
79314>>>>>    Function IsEnabled Returns Boolean
79316>>>>>        Boolean bEnabled
79316>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
79317>>>>>        Function_Return bEnabled
79318>>>>>    End_Function
79319>>>>>         
79319>>>>>End_Class
79320>>>>>
79320>>>>>
79320>>>>>Class cCJPasteMenuItem is a cCJMenuItem
79321>>>>>    
79321>>>>>    Procedure Construct_Object
79323>>>>>        Forward Send Construct_Object
79325>>>>>        Set psCaption   to C_$CaptionPaste
79326>>>>>        Set psToolTip to C_$ToolTipPaste
79327>>>>>        Set psDescription to C_$DescPaste
79328>>>>>        Set psImage to "actionPaste.ico"
79329>>>>>        Set pbActiveUpdate to True
79330>>>>>        Set psShortcut to C_$Key_Ctrl_V
79331>>>>>        Set psCategory to C_$CategoryEdit
79332>>>>>    End_Procedure
79333>>>>>
79333>>>>>
79333>>>>>    Procedure OnExecute Variant vCommandBarControl
79335>>>>>        Send Paste of (focus(Self))
79336>>>>>    End_Procedure
79337>>>>>    
79337>>>>>    Function IsEnabled Returns Boolean
79339>>>>>        Boolean bEnabled
79339>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
79340>>>>>        Function_Return bEnabled
79341>>>>>    End_Function
79342>>>>>         
79342>>>>>End_Class
79343>>>>>
79343>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
79344>>>>>    
79344>>>>>    Procedure Construct_Object
79346>>>>>        Forward Send Construct_Object
79348>>>>>        Set psCaption   to C_$CaptionSelectAll
79349>>>>>        Set psToolTip to C_$ToolTipSelectAll
79350>>>>>        Set psDescription to C_$DescSelectAll
79351>>>>>        Set pbActiveUpdate to True
79352>>>>>        Set psShortcut to C_$Key_Ctrl_A
79353>>>>>        Set psCategory to C_$CategoryEdit
79354>>>>>    End_Procedure
79355>>>>>
79355>>>>>
79355>>>>>    Procedure OnExecute Variant vCommandBarControl
79357>>>>>        Send Select_All of (focus(Self))
79358>>>>>    End_Procedure
79359>>>>>    
79359>>>>>    Function IsEnabled Returns Boolean
79361>>>>>        Boolean bEnabled
79361>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
79362>>>>>        Function_Return bEnabled
79363>>>>>    End_Function
79364>>>>>         
79364>>>>>End_Class
79365>>>>>
79365>>>>> 
79365>>>>>Class cCJExitMenuItem is a cCJMenuItem
79366>>>>>
79366>>>>>    Procedure Construct_Object
79368>>>>>        Forward Send Construct_Object
79370>>>>>        Set psCaption to C_$CaptionExit
79371>>>>>        Set psToolTip to C_$ToolTipExit
79372>>>>>        Set psDescription to C_$ToolTipExit
79373>>>>>        Set psShortcut to C_$Key_Alt_F4
79374>>>>>        Set psCategory to C_$CategoryFile
79375>>>>>    End_Procedure
79376>>>>>
79376>>>>>    Procedure OnExecute Variant vCommandBarControl
79378>>>>>        Send Exit_Application of Desktop
79379>>>>>    End_Procedure
79380>>>>>
79380>>>>>End_Class           
79381>>>>>
79381>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
79382>>>>>
79382>>>>>    Procedure Construct_Object
79384>>>>>        Forward Send Construct_Object
79386>>>>>        Set psCaption to C_$CaptionHelp
79387>>>>>        Set psDescription to C_$ToolTipHelp
79388>>>>>        Set psToolTip to C_$DescHelp
79389>>>>>        Set psImage to "ActionHelp.ico"
79390>>>>>        Set psShortcut to "F1"
79391>>>>>        Set psCategory to C_$CategoryHelp
79392>>>>>    End_Procedure
79393>>>>>    
79393>>>>>    Procedure OnExecute Variant vCommandBarControl
79395>>>>>        Send Help of (Focus(Self))
79396>>>>>    End_Procedure
79397>>>>>
79397>>>>>End_Class
79398>>>>>
79398>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
79399>>>>>
79399>>>>>    Procedure Construct_Object
79401>>>>>        Forward Send Construct_Object
79403>>>>>        Set psCaption to C_$CaptionAddStatusbar
79404>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
79405>>>>>        Set psDescription to  C_$DescAddStatusbar
79406>>>>>        Set psCategory to C_$CategoryWindow
79407>>>>>    End_Procedure
79408>>>>>
79408>>>>>    Procedure OnExecute Variant vCommandBarControl
79410>>>>>        Handle hoCommandBars hoClientArea
79410>>>>>        Get CommandBarSystemObject to hoCommandBars
79411>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79412>>>>>        If hoClientArea Begin
79414>>>>>            // the clientarea's parent panel has message
79414>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
79415>>>>>        End
79415>>>>>>
79415>>>>>    End_Procedure
79416>>>>>
79416>>>>>     Function IsChecked Returns Boolean
79418>>>>>        Boolean bOn
79418>>>>>        Handle hoCommandBars hoClientArea
79418>>>>>        Get CommandBarSystemObject to hoCommandBars
79419>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79420>>>>>        If hoClientArea Begin
79422>>>>>            // the clientarea's parent panel has message
79422>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
79423>>>>>        End
79423>>>>>>
79423>>>>>        Function_Return bOn
79424>>>>>     End_Function
79425>>>>>End_Class
79426>>>>>
79426>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
79427>>>>>
79427>>>>>    Procedure Construct_Object
79429>>>>>        Forward Send Construct_Object
79431>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
79432>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
79433>>>>>        Set psDescription to C_$DescAutoArrangeIcons
79434>>>>>        Set psCategory to C_$CategoryWindow
79435>>>>>    End_Procedure
79436>>>>>
79436>>>>>    Procedure OnExecute Variant vCommandBarControl
79438>>>>>        Handle hoCommandBars hoClientArea
79438>>>>>        Get CommandBarSystemObject to hoCommandBars
79439>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79440>>>>>        If hoClientArea Begin
79442>>>>>            // the clientarea's parent panel has message
79442>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
79443>>>>>        End
79443>>>>>>
79443>>>>>    End_Procedure
79444>>>>>    
79444>>>>>     Function IsChecked Returns Boolean
79446>>>>>        Boolean bOn
79446>>>>>        Handle hoCommandBars hoClientArea
79446>>>>>        Get CommandBarSystemObject to hoCommandBars
79447>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79448>>>>>        If hoClientArea Begin
79450>>>>>            // the clientarea's parent panel has message
79450>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
79451>>>>>        End
79451>>>>>>
79451>>>>>        Function_Return bOn
79452>>>>>     End_Function
79453>>>>>End_Class
79454>>>>>
79454>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
79455>>>>>
79455>>>>>    Procedure Construct_Object
79457>>>>>        Forward Send Construct_Object
79459>>>>>        Set psCaption to C_$CaptionRestoreMenus
79460>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
79461>>>>>        Set psDescription to C_$DescRestoreMenus
79462>>>>>        Set psCategory to C_$CategoryWindow
79463>>>>>    End_Procedure
79464>>>>>
79464>>>>>    Procedure OnExecute Variant vCommandBarControl
79466>>>>>        Handle hoCommandBars
79466>>>>>        Get CommandBarSystemObject to hoCommandBars
79467>>>>>        Send RestoreLayout of hoCommandBars
79468>>>>>    End_Procedure
79469>>>>>    
79469>>>>>End_Class
79470>>>>>
79470>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
79471>>>>>
79471>>>>>    Procedure Construct_Object
79473>>>>>        Forward Send Construct_Object
79475>>>>>        Set psCaption to C_$CaptionCascade
79476>>>>>        Set psToolTip to C_$ToolTipCascade
79477>>>>>        Set psDescription to  C_$DescCascade
79478>>>>>        Set psImage to "ActionCascade.ico"
79479>>>>>        Set psCategory to C_$CategoryWindow
79480>>>>>    End_Procedure
79481>>>>>    
79481>>>>>    Procedure OnExecute Variant vCommandBarControl
79483>>>>>        Handle hoCommandBars hoClientArea
79483>>>>>        Get CommandBarSystemObject to hoCommandBars
79484>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79485>>>>>        If hoClientArea Begin
79487>>>>>            Send Cascade_Windows of hoClientArea
79488>>>>>        End
79488>>>>>>
79488>>>>>    End_Procedure
79489>>>>>End_Class
79490>>>>>
79490>>>>>Class cCJTileHorizontally is a cCJMenuItem
79491>>>>>
79491>>>>>    Procedure Construct_Object
79493>>>>>        Forward Send Construct_Object
79495>>>>>        Set psCaption to C_$CaptionTileHorizontally 
79496>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
79497>>>>>        Set psDescription to  C_$DescTileHorizontally
79498>>>>>        Set psImage to "ActionTileHorizontally.ico"
79499>>>>>        Set psCategory to C_$CategoryWindow
79500>>>>>    End_Procedure
79501>>>>>
79501>>>>>    Procedure OnExecute Variant vCommandBarControl
79503>>>>>        Handle hoCommandBars hoClientArea
79503>>>>>        Get CommandBarSystemObject to hoCommandBars
79504>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79505>>>>>        If hoClientArea Begin
79507>>>>>            Send Tile_Windows_Horizontal of hoClientArea
79508>>>>>        End
79508>>>>>>
79508>>>>>    End_Procedure
79509>>>>>End_Class
79510>>>>>
79510>>>>>Class cCJTileVertically is a cCJMenuItem
79511>>>>>
79511>>>>>    Procedure Construct_Object
79513>>>>>        Forward Send Construct_Object
79515>>>>>        Set psCaption to C_$CaptionTileVertically  
79516>>>>>        Set psToolTip to C_$ToolTipTileVertically
79517>>>>>        Set psDescription to  C_$DescTileVertically
79518>>>>>        Set psImage to "ActionTileVertically.ico"
79519>>>>>        Set psCategory to C_$CategoryWindow
79520>>>>>    End_Procedure
79521>>>>>
79521>>>>>    Procedure OnExecute Variant vCommandBarControl
79523>>>>>        Handle hoCommandBars hoClientArea
79523>>>>>        Get CommandBarSystemObject to hoCommandBars
79524>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79525>>>>>        If hoClientArea Begin
79527>>>>>            Send Tile_Windows_Vertical of hoClientArea
79528>>>>>        End
79528>>>>>>
79528>>>>>    End_Procedure
79529>>>>>End_Class
79530>>>>>
79530>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
79531>>>>>
79531>>>>>    Procedure Construct_Object
79533>>>>>        Forward Send Construct_Object
79535>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
79536>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
79537>>>>>        Set psDescription to  C_$DescMinimizeWindows
79538>>>>>        Set psCategory to C_$CategoryWindow
79539>>>>>    End_Procedure
79540>>>>>
79540>>>>>    Procedure OnExecute Variant vCommandBarControl
79542>>>>>        Handle hoCommandBars hoClientArea
79542>>>>>        Get CommandBarSystemObject to hoCommandBars
79543>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79544>>>>>        If hoClientArea Begin
79546>>>>>            // the clientarea's parent panel has message
79546>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
79547>>>>>        End
79547>>>>>>
79547>>>>>    End_Procedure
79548>>>>>End_Class
79549>>>>>
79549>>>>>
79549>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
79550>>>>>
79550>>>>>    Procedure Construct_Object
79552>>>>>        Forward Send Construct_Object
79554>>>>>        Set psCaption to C_$CaptionRestoreWindows
79555>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
79556>>>>>        Set psDescription to  C_$DescRestoreWindows
79557>>>>>        Set psCategory to C_$CategoryWindow
79558>>>>>    End_Procedure
79559>>>>>
79559>>>>>    Procedure OnExecute Variant vCommandBarControl
79561>>>>>        Handle hoCommandBars hoClientArea
79561>>>>>        Get CommandBarSystemObject to hoCommandBars
79562>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79563>>>>>        If hoClientArea Begin
79565>>>>>            // the clientarea's parent panel has message
79565>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
79566>>>>>        End
79566>>>>>>
79566>>>>>    End_Procedure
79567>>>>>End_Class
79568>>>>>
79568>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
79569>>>>>
79569>>>>>    Procedure Construct_Object
79571>>>>>        Forward Send Construct_Object
79573>>>>>        Set psCaption to C_$CaptionArrangeIcons  
79574>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
79575>>>>>        Set psDescription to  C_$DescArrangeIcons
79576>>>>>        Set psCategory to C_$CategoryWindow
79577>>>>>    End_Procedure
79578>>>>>
79578>>>>>    Procedure OnExecute Variant vCommandBarControl
79580>>>>>        Handle hoCommandBars hoClientArea
79580>>>>>        Get CommandBarSystemObject to hoCommandBars
79581>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79582>>>>>        If hoClientArea Begin
79584>>>>>            Send Arrange_Icons of hoClientArea
79585>>>>>        End
79585>>>>>>
79585>>>>>    End_Procedure
79586>>>>>
79586>>>>>End_Class
79587>>>>>    
79587>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJAboutMenuItem.pkg)
79587>>>>>Use cCJCommandBarSystem.pkg
79587>>>>>Use LanguageText.pkg
79587>>>>>
79587>>>>>// It is expected that if you use this class that you provide an about object that is
79587>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
79587>>>>>// because you may wish to create your own custom about package.
79587>>>>>
79587>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
79588>>>>>
79588>>>>>    Procedure Construct_Object
79590>>>>>        Forward Send Construct_Object
79592>>>>>        Set psCaption to C_$CaptionAbout
79593>>>>>        Set psDescription to C_$ToolTipAbout
79594>>>>>        Set psToolTip to C_$DescAbout
79595>>>>>        Set psImage to "ActionAbout.ico"
79596>>>>>        Set psCategory to C_$CategoryHelp
79597>>>>>    End_Procedure
79598>>>>>    
79598>>>>>    Procedure OnExecute Variant vCommandBarControl
79600>>>>>        Handle hoCommandBars hoClientArea
79600>>>>>        Get CommandBarSystemObject to hoCommandBars
79601>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79602>>>>>        If hoClientArea Begin
79604>>>>>            Send Activate_About of hoClientArea
79605>>>>>        End
79605>>>>>>
79605>>>>>    End_Procedure
79606>>>>>
79606>>>>>End_Class
79607>>>>>
79607>>>>>
79607>>>Use cCJDeoMenuItemClasses.pkg
79607>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJMDIWindowsMenuItem.pkg)
79607>>>>>Use cCJCommandBarSystem.pkg
79607>>>>>
79607>>>>>Register_Function Client_ID Returns Integer
79607>>>>>
79607>>>>>// only used by cCJMDIWIndowsMenuItem
79607>>>>>Class cCJMDIWindowItem is a cCJMenuItem
79608>>>>>
79608>>>>>    Procedure Construct_Object
79610>>>>>        Forward Send Construct_Object
79612>>>>>        Property Handle phWindow 0 // object id of view
79613>>>>>        Set pbControlFlagNoMovable to True
79614>>>>>        Set pbActiveUpdate to True
79615>>>>>    End_Procedure
79616>>>>>    
79616>>>>>    Procedure OnExecute Variant vCommandBarControl
79618>>>>>        Handle hWindow
79618>>>>>        Get phWindow to hWindow
79619>>>>>        Send Activate_View of hWindow
79620>>>>>    End_Procedure
79621>>>>>    
79621>>>>>End_Class                
79622>>>>>
79622>>>>>
79622>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
79623>>>>>    
79623>>>>>    Procedure Construct_Object
79625>>>>>        Forward Send Construct_Object
79627>>>>>        Property Handle[] phArrayOfWindows
79628>>>>>        Set peControlType to xtpControlPopup
79629>>>>>        Set psCategory to C_$CategoryWindow
79630>>>>>    End_Procedure
79631>>>>>    
79631>>>>>     // This adds MDI windows to the existing menu items.
79631>>>>>     // This removes any existing windows menus and always adds a new set to the end
79631>>>>>
79631>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
79633>>>>>        Handle  hClientArea hView
79633>>>>>        String  sLabel
79633>>>>>        Integer i iWindows
79633>>>>>        Handle[] hArrayOfWindows
79634>>>>>        Variant vItem
79634>>>>>        
79634>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
79634>>>>>        // also assume that destroying an action removes all menu instances of that action
79634>>>>>        Get phArrayOfWindows to hArrayOfWindows
79635>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
79636>>>>>        For i from 0 to (iWindows-1)
79642>>>>>>
79642>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
79643>>>>>        Loop
79644>>>>>>
79644>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
79645>>>>>
79645>>>>>        // Add all views to this menu. Create the action and add the item
79645>>>>>        Move 0 to i
79646>>>>>        Get Client_Id to hClientArea // object id of client area
79647>>>>>        If (hClientArea > 0) Begin
79649>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
79650>>>>>            While (hView <> 0)
79654>>>>>                If (Active_State(hView)) Begin
79656>>>>>                    // create the action
79656>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
79657>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
79658>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
79659>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
79660>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
79662>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
79663>>>>>                    End
79663>>>>>>
79663>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
79664>>>>>                    If (i=0) Begin
79666>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
79667>>>>>                    End
79667>>>>>>
79667>>>>>                    // Create a menu item for this action
79667>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
79668>>>>>                    Increment i
79669>>>>>                End
79669>>>>>>
79669>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
79670>>>>>            Loop
79671>>>>>>
79671>>>>>        End
79671>>>>>>
79671>>>>>
79671>>>>>        Set phArrayOfWindows to hArrayOfWindows
79672>>>>>
79672>>>>>     End_Procedure
79673>>>>>     
79673>>>>>End_Class
79674>>>>>
79674>
79674>Object oHtmlHelp is a cHtmlHelp
79676>End_Object
79677>
79677>Object oApplication is a cApplication
79679>    Set peHelpType to htHtmlHelp
79680>
79680>    Object oConnection is a cConnection
79682>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\LoginEncryption.pkg)
79682>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cLoginEncryption.pkg)
79682>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCryptographer.pkg)
79682>>>>>>>Use VdfBase.pkg
79682>>>>>>>
79682>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\CryptographerConstants.pkg)
79682>>>>>>>>>//                                      
79682>>>>>>>>>// File    : CryptographerConstants.pkg
79682>>>>>>>>>//
79682>>>>>>>>>//   Author  : Ulbe Stellema
79682>>>>>>>>>//             Data Access Worldwide
79682>>>>>>>>>//
79682>>>>>>>>>//   Date    : October 4, 2009
79682>>>>>>>>>//
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>// Algorithm classes
79682>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
79682>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
79682>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
79682>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
79682>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
79682>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
79682>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
79682>>>>>>>>>
79682>>>>>>>>>// Algorithm types
79682>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
79682>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
79682>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
79682>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
79682>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
79682>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
79682>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
79682>>>>>>>>>
79682>>>>>>>>>// Generic sub-ids
79682>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
79682>>>>>>>>>
79682>>>>>>>>>// RSA sub-ids
79682>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
79682>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
79682>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
79682>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
79682>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
79682>>>>>>>>>
79682>>>>>>>>>// DSS sub-ids
79682>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
79682>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
79682>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
79682>>>>>>>>>
79682>>>>>>>>>// DES sub_ids
79682>>>>>>>>>Define ALG_SID_DES                      for 1
79682>>>>>>>>>Define ALG_SID_3DES                     for 3
79682>>>>>>>>>Define ALG_SID_DESX                     for 4
79682>>>>>>>>>Define ALG_SID_IDEA                     for 5
79682>>>>>>>>>Define ALG_SID_CAST                     for 6
79682>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
79682>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
79682>>>>>>>>>Define ALG_SID_3DES_112                 for 9
79682>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
79682>>>>>>>>>Define ALG_SID_RC5                      for 13
79682>>>>>>>>>Define ALG_SID_AES_128                  for 14
79682>>>>>>>>>Define ALG_SID_AES_192                  for 15
79682>>>>>>>>>Define ALG_SID_AES_256                  for 16
79682>>>>>>>>>Define ALG_SID_AES                      for 17
79682>>>>>>>>>
79682>>>>>>>>>// Fortezza sub-ids
79682>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
79682>>>>>>>>>Define ALG_SID_TEK                      for 11
79682>>>>>>>>>
79682>>>>>>>>>// RC2 sub-ids
79682>>>>>>>>>Define ALG_SID_RC2                      for 2
79682>>>>>>>>>
79682>>>>>>>>>// Stream cipher sub-ids
79682>>>>>>>>>Define ALG_SID_RC4                      for 1
79682>>>>>>>>>Define ALG_SID_SEAL                     for 2
79682>>>>>>>>>
79682>>>>>>>>>// Diffie-Hellman sub-ids
79682>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
79682>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
79682>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
79682>>>>>>>>>Define ALG_SID_KEA                      for 4
79682>>>>>>>>>
79682>>>>>>>>>// Hash sub ids
79682>>>>>>>>>Define ALG_SID_MD2                      for 1
79682>>>>>>>>>Define ALG_SID_MD4                      for 2
79682>>>>>>>>>Define ALG_SID_MD5                      for 3
79682>>>>>>>>>Define ALG_SID_SHA                      for 4
79682>>>>>>>>>Define ALG_SID_SHA1                     for 4
79682>>>>>>>>>Define ALG_SID_MAC                      for 5
79682>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
79682>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
79682>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
79682>>>>>>>>>Define ALG_SID_HMAC                     for 9
79682>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
79682>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
79682>>>>>>>>>Define ALG_SID_SHA_256                  for 12
79682>>>>>>>>>Define ALG_SID_SHA_384                  for 13
79682>>>>>>>>>Define ALG_SID_SHA_512                  for 14
79682>>>>>>>>>
79682>>>>>>>>>// secure channel sub ids
79682>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
79682>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
79682>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
79682>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
79682>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
79682>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
79682>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
79682>>>>>>>>>
79682>>>>>>>>>// algorithm identifier definitions
79682>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
79682>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
79682>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
79682>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
79682>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
79682>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
79682>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
79682>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
79682>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
79682>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
79682>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
79682>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
79682>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
79682>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
79682>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
79682>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
79682>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
79682>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
79682>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
79682>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
79682>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
79682>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
79682>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
79682>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
79682>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
79682>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
79682>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
79682>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
79682>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
79682>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
79682>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
79682>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
79682>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
79682>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
79682>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
79682>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
79682>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
79682>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
79682>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
79682>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
79682>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
79682>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
79682>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
79682>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
79682>>>>>>>>>
79682>>>>>>>>>// Providers
79682>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
79682>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
79682>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
79682>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
79682>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
79682>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
79682>>>>>>>>>
79682>>>>>>>>>// dwFlags definitions for CryptAcquireContext
79682>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
79682>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
79682>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
79682>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
79682>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
79682>>>>>>>>>
79682>>>>>>>>>// dwFlag definitions for CryptGenKey
79682>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
79682>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
79682>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
79682>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
79682>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
79682>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
79682>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
79682>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
79682>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
79682>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
79682>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
79682>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
79682>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
79682>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
79682>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
79682>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
79682>>>>>>>>>
79682>>>>>>>>>// Provider types
79682>>>>>>>>>Define PROV_RSA_FULL                    for 1
79682>>>>>>>>>Define PROV_RSA_SIG                     for 2
79682>>>>>>>>>Define PROV_DSS                         for 3
79682>>>>>>>>>Define PROV_FORTEZZA                    for 4
79682>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
79682>>>>>>>>>Define PROV_SSL                         for 6
79682>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
79682>>>>>>>>>Define PROV_DSS_DH                      for 13
79682>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
79682>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
79682>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
79682>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
79682>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
79682>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
79682>>>>>>>>>Define PROV_RNG                         for 21
79682>>>>>>>>>Define PROV_INTEL_SEC                   for 22
79682>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
79682>>>>>>>>>Define PROV_RSA_AES                     for 24
79682>>>>>>>>>
79682>>>>>>>>>// KP_MODE
79682>>>>>>>>>// KP_MODE
79682>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
79682>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
79682>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
79682>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
79682>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
79682>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
79682>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
79682>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
79682>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
79682>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
79682>>>>>>>>>
79682>>>>>>>>>// dwParam definitions for CryptGetKeyParam
79682>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
79682>>>>>>>>>Define KP_SALT                          for 2       // Salt value
79682>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
79682>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
79682>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
79682>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
79682>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
79682>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
79682>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
79682>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
79682>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
79682>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
79682>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
79682>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
79682>>>>>>>>>Define KP_Y                             for 15      // Y value
79682>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
79682>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
79682>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
79682>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
79682>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
79682>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
79682>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
79682>>>>>>>>>Define KP_RP                            for 23
79682>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
79682>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
79682>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
79682>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
79682>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
79682>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
79682>>>>>>>>>Define KP_KEYVAL                        for 30
79682>>>>>>>>>Define KP_ADMIN_PIN                     for 31
79682>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
79682>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
79682>>>>>>>>>Define KP_PREHASH                       for 34
79682>>>>>>>>>Define KP_ROUNDS                        for 35
79682>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
79682>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
79682>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
79682>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
79682>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
79682>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
79682>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
79682>>>>>>>>>
79682>>>>>>>>>// dwParam definitions for CryptGetHashParam
79682>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
79682>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
79682>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
79682>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
79682>>>>>>>>>
79682>>>>>>>>>// key BLOB types
79682>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
79682>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
79682>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
79682>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
79682>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
79682>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
79682>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
79682>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
79682>>>>>>>>>
79682>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
79682>>>>>>>>>
79682>>>>>>>>>//  Structure cryptimportkey
79682>>>>>>>>>Struct PUBLICKEYSTRUC
79682>>>>>>>>>    UChar    bType
79682>>>>>>>>>    UChar    bVersion
79682>>>>>>>>>    UShort   reserved
79682>>>>>>>>>    UInteger aiKeyAlg
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>Struct tPLAINTEXTKEYBLOB
79682>>>>>>>>>    PUBLICKEYSTRUC hdr
79682>>>>>>>>>    PUBLICKEYSTRUC hdr
79682>>>>>>>>>    UInteger       dwKeySize
79682>>>>>>>>>//    UChar[]        rgbKeyData
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
79682>>>>>>>>>Struct HMAC_INFO
79682>>>>>>>>>    UInteger HashAlgid
79682>>>>>>>>>    Pointer pbInnerString
79682>>>>>>>>>    DWord cbInnerString
79682>>>>>>>>>    Pointer pbOuterString
79682>>>>>>>>>    DWord cbOuterString
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
79683>>>>>>>>>
79683>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
79684>>>>>>>>>
79684>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
79685>>>>>>>>>
79685>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
79686>>>>>>>>>
79686>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
79687>>>>>>>>>
79687>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
79688>>>>>>>>>
79688>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
79689>>>>>>>>>
79689>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
79690>>>>>>>>>
79690>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
79691>>>>>>>>>
79691>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
79692>>>>>>>>>    
79692>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
79693>>>>>>>>>
79693>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
79694>>>>>>>>>
79694>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
79695>>>>>>>>>
79695>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
79696>>>>>>>>>    
79696>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
79697>>>>>>>>>    
79697>>>>>>>
79697>>>>>>>Class cCryptographer is a cObject
79698>>>>>>>    
79698>>>>>>>    // Procedure : Construct_Object
79698>>>>>>>    // Purpose   : Object constructor
79698>>>>>>>    Procedure Construct_Object
79700>>>>>>>        Forward Send Construct_Object
79702>>>>>>>
79702>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
79703>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
79704>>>>>>>        Property Integer    piCipher    CALG_RC4
79705>>>>>>>        Property Integer    piHash      CALG_MD5
79706>>>>>>>        
79706>>>>>>>        // Private properties
79706>>>>>>>        Property Handle     Private_phProv
79707>>>>>>>    End_Procedure
79708>>>>>>>    
79708>>>>>>>    
79708>>>>>>>    // Function : AcquireContext
79708>>>>>>>    // Purpose  : Acquire key container handle
79708>>>>>>>    Function AcquireContext Returns Handle
79710>>>>>>>        Integer iProvider
79710>>>>>>>        String sProvider
79710>>>>>>>        Handle hProv
79710>>>>>>>        Boolean bOk
79710>>>>>>>        Address addrProv
79710>>>>>>>        
79710>>>>>>>        Move 0 to hProv
79711>>>>>>>        Get piProvider to iProvider
79712>>>>>>>        Get psProvider to sProvider
79713>>>>>>>        
79713>>>>>>>        //  Determine address to be passed as provider
79713>>>>>>>        If (Trim(sProvider) <> "") Begin
79715>>>>>>>            Move (AddressOf(sProvider)) to addrProv
79716>>>>>>>        End
79716>>>>>>>>
79716>>>>>>>        Else Begin
79717>>>>>>>            Move 0 to addrProv
79718>>>>>>>        End
79718>>>>>>>>
79718>>>>>>>        
79718>>>>>>>        //  Acquire Crypto Context
79718>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
79719>>>>>>>        If (not(bOk) or hProv = 0) Begin
79721>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
79722>>>>>>>        End
79722>>>>>>>>
79722>>>>>>>        
79722>>>>>>>        If (not(bOk) or hProv = 0) Begin
79724>>>>>>>            // Fallback to original
79724>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
79725>>>>>>>            
79725>>>>>>>            If (not(bOk) or hProv = 0) Begin
79727>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
79728>>>>>>>            End
79728>>>>>>>>
79728>>>>>>>        End
79728>>>>>>>>
79728>>>>>>>        Set Private_phProv to hProv
79729>>>>>>>        
79729>>>>>>>        Function_Return hProv
79730>>>>>>>    End_Function
79731>>>>>>>    
79731>>>>>>>    // Function : ReleaseContext
79731>>>>>>>    // Purpose  : Releases key container handle
79731>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
79733>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
79734>>>>>>>    End_Function
79735>>>>>>>    
79735>>>>>>>    // Function : CreateHash
79735>>>>>>>    // Purpose  : Creates hash object
79735>>>>>>>    Function CreateHash Handle hProv Returns Handle
79737>>>>>>>        Integer iAlgorithm
79737>>>>>>>        Handle hHash
79737>>>>>>>        Boolean bOk
79737>>>>>>>        
79737>>>>>>>        Move 0 to hHash
79738>>>>>>>        Get piHash to iAlgorithm
79739>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
79740>>>>>>>        
79740>>>>>>>        Function_Return hHash
79741>>>>>>>    End_Function
79742>>>>>>>    
79742>>>>>>>    // Function : DestroyHash
79742>>>>>>>    // Purpose  : Destroys the hash object
79742>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
79744>>>>>>>        Function_Return (CryptDestroyHash(hHash))
79745>>>>>>>    End_Function
79746>>>>>>>    
79746>>>>>>>    // Function : HashData
79746>>>>>>>    // Purpose  : Adds data to hash object
79746>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
79748>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
79749>>>>>>>    End_Function
79750>>>>>>>    
79750>>>>>>>    // Function : DeriveKey
79750>>>>>>>    // Purpose  : Generates session key
79750>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
79752>>>>>>>        Integer iAlgorithm
79752>>>>>>>        Handle hKey
79752>>>>>>>        Boolean bOk
79752>>>>>>>        
79752>>>>>>>        Move 0 to hKey
79753>>>>>>>        Get piCipher to iAlgorithm
79754>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
79755>>>>>>>        
79755>>>>>>>        Function_Return hKey
79756>>>>>>>    End_Function
79757>>>>>>>    
79757>>>>>>>    // Function : ImportPlainTextKey
79757>>>>>>>    // Purpose  : Imports a plain text key
79757>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
79759>>>>>>>        tPLAINTEXTKEYBLOB blobhead
79759>>>>>>>        tPLAINTEXTKEYBLOB blobhead
79759>>>>>>>        Boolean   bSuccess
79759>>>>>>>        Handle    hKey
79759>>>>>>>        Integer   iHeadSize iKeySize
79759>>>>>>>        UChar[]   ucaKeyblob
79760>>>>>>>        Integer iVoid
79760>>>>>>>    
79760>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
79761>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
79762>>>>>>>    
79762>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
79763>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
79764>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
79765>>>>>>>        Move iKeySize           to blobhead.dwKeySize
79766>>>>>>>    
79766>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
79767>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
79768>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
79769>>>>>>>    
79769>>>>>>>        Move 0 to hKey
79770>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
79771>>>>>>>        If (not(bSuccess)) Begin 
79773>>>>>>>            Move (ShowLastError()) to iVoid
79774>>>>>>>        End
79774>>>>>>>>
79774>>>>>>>    
79774>>>>>>>        Function_Return hKey
79775>>>>>>>    End_Function
79776>>>>>>>
79776>>>>>>>    // Function : DestroyKey
79776>>>>>>>    // Purpose  : Destroys the key
79776>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
79778>>>>>>>        Function_Return (CryptDestroyKey(hKey))
79779>>>>>>>    End_Function
79780>>>>>>>    
79780>>>>>>>    // Function : KeyParameter
79780>>>>>>>    // Purpose  : Retrieves key data
79780>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
79782>>>>>>>        Integer iBuffer iLen
79782>>>>>>>        Boolean bOk
79782>>>>>>>        
79782>>>>>>>        Move (SizeOfType(Integer)) to iLen
79783>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
79784>>>>>>>        Function_Return iBuffer
79785>>>>>>>    End_Function
79786>>>>>>>    
79786>>>>>>>    // Function : HashValue
79786>>>>>>>    // Purpose  : Retrieves a hash value
79786>>>>>>>    Function HashValue Handle lhHash Returns String
79788>>>>>>>        Pointer lpSize
79788>>>>>>>        Pointer lpHash
79788>>>>>>>        String  lsSize
79788>>>>>>>        String  lsHash
79788>>>>>>>        Integer liResult
79788>>>>>>>
79788>>>>>>>        Move (Repeat(Character(0),4)) to lsSize
79789>>>>>>>        GetAddress of lsSize to lpSize
79790>>>>>>>
79790>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,lpSize,0)) to liResult
79791>>>>>>>        If (liResult = 0) Function_Return ""
79794>>>>>>>
79794>>>>>>>        Move (Repeat(Character(0),BytesTodWord(lsSize,1))) to lsHash
79795>>>>>>>        GetAddress of lsHash to lpHash
79796>>>>>>>
79796>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,lpHash,lpSize,0)) to liResult
79797>>>>>>>        If (liResult = 0) Function_Return ""
79800>>>>>>>
79800>>>>>>>        Function_Return lsHash
79801>>>>>>>    End_Function  // HashValue
79802>>>>>>>    
79802>>>>>>>            
79802>>>>>>>    // Function : Encrypt
79802>>>>>>>    // Purpose  : Encrypts data
79802>>>>>>>    Function Encrypt String sPassword String sData Returns String
79804>>>>>>>        Handle hProv hHash hKey
79804>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
79804>>>>>>>        Boolean bOk
79804>>>>>>>        
79804>>>>>>>        Get AcquireContext to hProv
79805>>>>>>>        If (hProv) Begin
79807>>>>>>>            Get CreateHash hProv to hHash
79808>>>>>>>            If (hHash) Begin
79810>>>>>>>                Get HashData hHash sPassword to bOk
79811>>>>>>>                If (bOk) Begin
79813>>>>>>>                    Get piCipher to iAlgorithm
79814>>>>>>>                    Get DeriveKey hProv hHash to hKey
79815>>>>>>>                End // If (bOk) Begin            
79815>>>>>>>>
79815>>>>>>>                Get DestroyHash hHash to bOk
79816>>>>>>>            End // If (hHash) Begin
79816>>>>>>>>
79816>>>>>>>            
79816>>>>>>>            If (hKey) Begin
79818>>>>>>>                //  First call to determine resulting data size
79818>>>>>>>                Move (Length(sData)) to iDataLen
79819>>>>>>>                Move (Length(sData)) to iCipherLen
79820>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
79821>>>>>>>                
79821>>>>>>>                //  Reserve space in string
79821>>>>>>>                If (iDataLen < iCipherLen) Begin
79823>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
79824>>>>>>>                End
79824>>>>>>>>
79824>>>>>>>                
79824>>>>>>>                //  Call to really decrypt
79824>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
79825>>>>>>>                //If (not(bOk)) Begin
79825>>>>>>>                    //Move "" to sData
79825>>>>>>>                    //Move (GetLastError()) to iErr
79825>>>>>>>                //End
79825>>>>>>>                
79825>>>>>>>                Get DestroyKey hKey to bOk
79826>>>>>>>            End // If (hKey) Begin
79826>>>>>>>>
79826>>>>>>>            Get ReleaseContext hProv to bOk
79827>>>>>>>        End // If (hProv) Begin
79827>>>>>>>>
79827>>>>>>>        Function_Return sData
79828>>>>>>>    End_Function
79829>>>>>>>    
79829>>>>>>>    // Function : Decrypt
79829>>>>>>>    // Purpose  : Decrypts data
79829>>>>>>>    Function Decrypt String sPassword String sData Returns String
79831>>>>>>>        Handle hProv hHash hKey
79831>>>>>>>        Integer iAlgorithm iDataLen
79831>>>>>>>        Boolean bOk
79831>>>>>>>        
79831>>>>>>>        Get AcquireContext to hProv
79832>>>>>>>        If (hProv) Begin
79834>>>>>>>            Get CreateHash hProv to hHash
79835>>>>>>>            If (hHash) Begin
79837>>>>>>>                Get HashData hHash sPassword to bOk
79838>>>>>>>                If (bOk) Begin
79840>>>>>>>                    Get piCipher to iAlgorithm
79841>>>>>>>                    Get DeriveKey hProv hHash to hKey
79842>>>>>>>                End // If (bOk) Begin            
79842>>>>>>>>
79842>>>>>>>                Get DestroyHash hHash to bOk
79843>>>>>>>            End // If (hHash) Begin
79843>>>>>>>>
79843>>>>>>>            
79843>>>>>>>            If (hKey) Begin
79845>>>>>>>                Move (Length(sData)) to iDataLen
79846>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
79847>>>>>>>                //If (bOk = False) Move "" to sData
79847>>>>>>>                
79847>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
79847>>>>>>>                If (Length(sData) > iDataLen) Begin
79849>>>>>>>                    Move (Left(sData, iDataLen)) to sData
79850>>>>>>>                End
79850>>>>>>>>
79850>>>>>>>                
79850>>>>>>>                Get DestroyKey hKey to bOk
79851>>>>>>>            End // If (hKey) Begin
79851>>>>>>>>
79851>>>>>>>            Get ReleaseContext hProv to bOk
79852>>>>>>>        End // If (hProv) Begin
79852>>>>>>>>
79852>>>>>>>        Function_Return sData
79853>>>>>>>    End_Function
79854>>>>>>>    
79854>>>>>>>    //  Function : GenerateRandom
79854>>>>>>>    //  Purpose  : Generates random data.
79854>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
79856>>>>>>>        Handle hProv
79856>>>>>>>        UChar[] uaResult
79857>>>>>>>        Boolean bRes
79857>>>>>>>        
79857>>>>>>>        Get AcquireContext to hProv
79858>>>>>>>        
79858>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
79859>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
79860>>>>>>>        
79860>>>>>>>        Get ReleaseContext hProv to bRes
79861>>>>>>>        
79861>>>>>>>        Function_Return uaResult
79862>>>>>>>    End_Function
79863>>>>>>>    
79863>>>>>>>    //  Function : GenerateRandomString
79863>>>>>>>    //  Purpose  : Generates random data and does a base64 encoding to properly present it as a string.
79863>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
79865>>>>>>>        String sResult
79865>>>>>>>        UChar[] aData
79866>>>>>>>        Address pBase64
79866>>>>>>>        Integer iVoid
79866>>>>>>>
79866>>>>>>>        Get GenerateRandom iLenght to aData
79867>>>>>>>        
79867>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
79868>>>>>>>        Move pBase64 to sResult
79869>>>>>>>        Move (Free(pBase64)) to iVoid    
79870>>>>>>>        
79870>>>>>>>        Function_Return (Left(sResult, iLenght))
79871>>>>>>>    End_Function
79872>>>>>>>
79872>>>>>>>End_Class
79873>>>>>
79873>>>>>Class cLoginEncryption is a cObject
79874>>>>>    
79874>>>>>    Procedure Construct_Object
79876>>>>>        Forward Send Construct_Object
79878>>>>>        // this must be set to a multi (40ish) character random key
79878>>>>>        Property String psEncryptPassword ""
79879>>>>>    
79879>>>>>        Object oDataCrypter is a cCryptographer
79881>>>>>            Set piHash to CALG_SHA_256
79882>>>>>            Set piCipher to CALG_AES_256
79883>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
79884>>>>>            Set piProvider to PROV_RSA_AES
79885>>>>>        End_Object
79886>>>>>    End_Procedure
79887>>>>>        
79887>>>>>    // This can be augmented to return a password encryption key using any
79887>>>>>    // hidden mechanism desired.    
79887>>>>>    Function GetEncryptionPassword Returns String
79889>>>>>        String sPassword
79889>>>>>        Get psEncryptPassword to sPassword    
79890>>>>>        Function_Return sPassword
79891>>>>>    End_Function
79892>>>>>    
79892>>>>>    // EncryptPassword:
79892>>>>>    
79892>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
79892>>>>>    //
79892>>>>>    // Params:
79892>>>>>    //   sPlainText     String to encrypt.
79892>>>>>    // Returns:
79892>>>>>    //   Base64 encoded hash.
79892>>>>>    Function EncryptPassword String sPlainText Returns String
79894>>>>>        String sEncryptPassword sBinary sBase64
79894>>>>>        Address pBase64
79894>>>>>        Integer iVoid
79894>>>>>        
79894>>>>>        //  Encrypt Key
79894>>>>>        Get GetEncryptionPassword to sEncryptPassword
79895>>>>>        If (sEncryptPassword = "") Begin
79897>>>>>            Error DFERR_PROGRAM "No encryption password set" 
79898>>>>>>
79898>>>>>        End
79898>>>>>>
79898>>>>>        
79898>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
79899>>>>>        
79899>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
79901>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
79902>>>>>>
79902>>>>>            Function_Return ""
79903>>>>>        End
79903>>>>>>
79903>>>>>        
79903>>>>>        //  Encode binary hash to Base64
79903>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
79904>>>>>        Move pBase64 to sBase64
79905>>>>>        Move (Free(pBase64)) to iVoid
79906>>>>>        
79906>>>>>        Function_Return sBase64
79907>>>>>    End_Function
79908>>>>>    
79908>>>>>    
79908>>>>>    // DecryptPassword:
79908>>>>>    
79908>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
79908>>>>>    //
79908>>>>>    // Params:
79908>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
79908>>>>>    // Returns:
79908>>>>>    //   Readable plain text password
79908>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
79910>>>>>        String sEncryptPassword sPlainText sBinary
79910>>>>>        Boolean bIsHex
79910>>>>>        Integer iLen iVoid
79910>>>>>        Address pBinary
79910>>>>>        
79910>>>>>        If (sBase64EncryptedPassword <> "") Begin
79912>>>>>            //  Decode from Base64
79912>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
79913>>>>>            
79913>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
79914>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
79915>>>>>            
79915>>>>>            Move (Free(pBinary)) to iVoid
79916>>>>>    
79916>>>>>            //  Encrypted binary hash to string
79916>>>>>            Get GetEncryptionPassword to sEncryptPassword
79917>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
79918>>>>>        End
79918>>>>>>
79918>>>>>        
79918>>>>>        Function_Return sPlainText
79919>>>>>    End_Function
79920>>>>>End_Class
79921>>>>>    
79921>>>
79921>>>Object oLoginEncryption is a cLoginEncryption
79923>>>
79923>>>    // this must be created in your appsrc directory and must contain an encryption
79923>>>    // key that is set to psEncryptPassword. It will look something like this
79923>>>    //
79923>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
79923>>>    //  
Including file: LoginEncryptionKey.inc    (C:\Repos\DataFlexBeadando\AppSrc\LoginEncryptionKey.inc)
79923>>>>// Studio generated login encryption key
79923>>>>Set psEncryptPassword to "8eH5|`Xs0c>fum6W8E6^}#@XhoWPuDN)Usf_t<]("
79924>>>>
79924>>>    
79924>>>    // use this to register this object to your cConnection Object. This object
79924>>>    // must be created after the cConnection object
79924>>>    Move Self to ghoLoginEncryption
79925>>>End_Object
79926>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DatabaseLoginDialog.dg)
79926>>>
79926>>>Use Windows.pkg
79926>>>Use cConnection.pkg
79926>>>Use dfLine.pkg
79926>>>
79926>>>Object oDatabaseLoginDialog is a ModalPanel
79928>>>    Set Label to "Database Login"
79929>>>    Set Location to 2 2
79930>>>    Set Size to 110 211
79931>>>
79931>>>    Property String psId
79933>>>    Property Boolean pbOk False
79935>>>    Property Boolean pbChanged False
79937>>>    Property Boolean pbAllowRemember True
79939>>>
79939>>>    // this registers this object with the cConnection object.
79939>>>    Move Self to ghoLoginConnectDialog
79940>>>
79940>>>    Object oUserIDForm is a Form
79942>>>        Set Label to "User Name"
79943>>>        Set Size to 13 85
79944>>>        Set Location to 34 79
79945>>>        Set Label_Col_Offset to 64
79946>>>                Set peAnchors to anTopLeftRight
79947>>>    End_Object
79948>>>
79948>>>    Object oPwdForm is a Form
79950>>>        Set Size to 13 85
79951>>>        Set Location to 49 79
79952>>>        Set Label_Col_Offset to 64
79953>>>        Set Password_State to True
79954>>>                Set peAnchors to anTopLeftRight
79955>>>        Set Label to "Password"
79956>>>    End_Object
79957>>>
79957>>>    Object oTrustedConnection is a CheckBox
79959>>>        Set Size to 10 50
79960>>>        Set Location to 65 79
79961>>>        Set Label to "Trusted Connection"
79962>>>    End_Object
79963>>>
79963>>>    Object oRemember is a CheckBox
79965>>>        Set Size to 10 50
79966>>>        Set Location to 79 14
79967>>>        Set Label to "Remember and don't ask again"
79968>>>        Set Checked_State to True
79969>>>    End_Object
79970>>>
79970>>>    Object oLogin_btn is a Button
79972>>>        Set Label to "&Login"
79973>>>        Set Location to 92 102
79974>>>        Set peAnchors to anBottomRight
79975>>>        Set Default_State to True
79976>>>
79976>>>        Procedure OnClick
79979>>>            Boolean bTrust
79979>>>            String sUser sPwd sConn sErr sId
79979>>>            Integer iError
79979>>>            Get psId to sId
79980>>>            Get Value of oUserIDForm to sUser
79981>>>            Get Value of oPwdForm to sPwd
79982>>>            Get Checked_State of oTrustedConnection to bTrust
79983>>>            
79983>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
79984>>>            If (iError=0) Begin
79986>>>                Set pbOk to True
79987>>>                Set pbChanged to True
79988>>>                // using Stop_UI instead of close_panel keeps it running when the dialog
79988>>>                // is the only dialog and it closes
79988>>>                Send Stop_UI
79989>>>//                Send Close_Panel
79989>>>            End
79989>>>>
79989>>>            Else Begin
79990>>>                Get psErrorText of ghoConnection to sErr
79991>>>                Send UserError sErr "Login Error"
79992>>>            End
79992>>>>
79992>>>        End_Procedure
79993>>>    End_Object
79994>>>
79994>>>    Object oCancel_btn is a Button
79996>>>        Set Label to "&Cancel"
79997>>>        Set Location to 92 157
79998>>>        Set peAnchors to anBottomRight
79999>>>
79999>>>        Procedure OnClick
80002>>>            Send Stop_UI
80003>>>//            Send Close_Panel
80003>>>        End_Procedure
80004>>>    End_Object
80005>>>
80005>>>    Object oConnectionIdInfo is a TextBox
80007>>>        Set Size to 10 50
80008>>>        Set Location to 4 14
80009>>>        Set Label to 'Connection Id='
80010>>>    End_Object
80011>>>
80011>>>    Object oConnectionServerInfo is a TextBox
80013>>>        Set Size to 10 50
80014>>>        Set Location to 16 14
80015>>>        Set Label to 'Server'
80016>>>    End_Object
80017>>>
80017>>>    Object oLineControl1 is a LineControl
80019>>>        Set Size to 2 202
80020>>>        Set Location to 29 5
80021>>>    End_Object
80022>>>
80022>>>    Function LoginConnectIdDialog String sId Returns Boolean
80025>>>         Boolean bOk bChanged bTrusted bAllowRemember bRemember
80025>>>         String sUser sPwd sDescription
80025>>>         tConnection Connect
80025>>>         tConnection Connect
80025>>>         
80025>>>         Get pbAllowRemember to bAllowRemember
80026>>>         
80026>>>
80026>>>         If not bAllowRemember Begin
80028>>>            Set Enabled_State of oRemember to bRemember
80029>>>            Set Visible_State of oRemember to bRemember
80030>>>         End
80030>>>>
80030>>>         
80030>>>         Get ConnectionIdInfo of ghoConnection sId to Connect
80031>>>         Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
80032>>>         Set Value of oConnectionServerInfo to Connect.sString
80033>>>
80033>>>         Set psId to sId
80034>>>         Set pbOk to False
80035>>>         Set pbChanged to False
80036>>>         Set Value of oUserIDForm to Connect.sUID
80037>>>         Set Value of oPwdForm to ""
80038>>>         
80038>>>         Send Popup
80039>>>         
80039>>>         Get pbOk to bOk
80040>>>         Get pbChanged to bChanged
80041>>>         If (bChanged and bOk) Begin
80043>>>            If bAllowRemember Begin
80045>>>                Get Checked_State of oRemember to bRemember
80046>>>                If bRemember Begin
80048>>>                    Get Checked_State of oTrustedConnection to bTrusted
80049>>>                    If not (bTrusted) Begin
80051>>>                        Get Value of oUserIDForm to sUser
80052>>>                        Get Value of oPwdForm to sPwd
80053>>>                    End
80053>>>>
80053>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
80054>>>                 End
80054>>>>
80054>>>             End
80054>>>>
80054>>>         End
80054>>>>
80054>>>         Function_Return bOk
80055>>>    End_Function
80056>>>    
80056>>>    
80056>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
80057>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
80058>>>End_Object
80059>>>
80059>    End_Object
80060>
80060>End_Object
80061>
80061>Object oToolTipController is a cToolTipController
80063>    Move Self to ghoToolTipController
80064>End_Object
80065>
80065>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oEditContextMenu.pkg)
80065>>>Use cCJStandardMenuItemClasses.pkg
80065>>>
80065>>>Object oEditContextMenu is a cCJContextMenu
80067>>>    
80067>>>    Move Self to Default_Form_Floating_Menu_ID
80068>>>    
80068>>>    Object oUndoMenuItem is a cCJUndoMenuItem
80070>>>    End_Object
80071>>>    
80071>>>    Object oCutMenuItem is a cCJCutMenuItem
80073>>>        Set pbControlBeginGroup to True
80074>>>    End_Object
80075>>>    
80075>>>    Object oCopyMenuItem is a cCJCopyMenuItem
80077>>>    End_Object
80078>>>
80078>>>    Object oPasteMenuItem is a cCJPasteMenuItem
80080>>>    End_Object
80081>>>
80081>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
80083>>>    End_Object
80084>>>
80084>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
80086>>>        Set pbControlBeginGroup to True
80087>>>    End_Object
80088>>>
80088>>>End_Object
80089>>>
80089>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oDEOEditContextMenu17.pkg)
80089>>>Use Windows.pkg
80089>>>Use cCJStandardMenuItemClasses.pkg
80089>>>Use cCJDeoMenuItemClasses.pkg
80089>>>
80089>>>
80089>>>Object oDEOEditContextMenu17 is a cCJContextMenu
80091>>>    
80091>>>    Move Self to Default_dbFloating_Menu_ID
80092>>>    
80092>>>    Object oUndoMenuItem is a cCJUndoMenuItem
80094>>>    End_Object
80095>>>    
80095>>>    Object oCutMenuItem is a cCJCutMenuItem
80097>>>        Set pbControlBeginGroup to True
80098>>>    End_Object
80099>>>    
80099>>>    Object oCopyMenuItem is a cCJCopyMenuItem
80101>>>    End_Object
80102>>>
80102>>>    Object oPasteMenuItem is a cCJPasteMenuItem
80104>>>    End_Object
80105>>>
80105>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
80107>>>    End_Object
80108>>>
80108>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
80110>>>        Set pbControlBeginGroup to True
80111>>>    End_Object
80112>>>
80112>>>    Object oPromptMenuItem is a cCJPromptMenuItem
80114>>>        Set pbControlBeginGroup to True
80115>>>    End_Object
80116>>>
80116>>>    Object oFindNextMenu is a cCJFindNextMenuItem
80118>>>        Set pbControlBeginGroup to True
80119>>>    End_Object
80120>>>
80120>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
80122>>>    End_Object
80123>>>
80123>>>    Object oClearMenuItem is a cCJClearMenuItem
80125>>>        Set pbControlBeginGroup to True
80126>>>    End_Object
80127>>>
80127>>>    Object oClearAllMenu is a cCJClearAllMenuItem
80129>>>    End_Object
80130>>>
80130>>>    Object oSaveMenu is a cCJSaveMenuItem
80132>>>    End_Object
80133>>>    
80133>>>    Object oDeleteMenu is a cCJDeleteMenuItem
80135>>>    End_Object
80136>>>
80136>>>    Object oRememberitem is a cCJRememberFieldMenuItem
80138>>>        Set pbControlBeginGroup to True
80139>>>    End_Object
80140>>>
80140>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
80142>>>    End_Object
80143>>>
80143>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
80145>>>    End_Object
80146>>>
80146>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
80148>>>    End_Object
80149>>>
80149>>>End_Object
80150>
80150>Object oMain is a Panel
80152>    Set Label To "My Project"
80153>    Set Location to 4 3
80154>    Set Size to 300 450
80155>
80155>    Object oCommandBarSystem is a cCJCommandBarSystem
80157>        Set pbTimerUpdate to True
80158>        Set peVisualTheme to xtpThemeOffice2013Outlook
80159>        Set pbAutoResizeIcons to True
80160>
80160>        Procedure OnCreateCommandBars
80163>            Handle hoOptions
80163>            Get OptionsObject to hoOptions
80164>            Forward Send OnCreateCommandBars
80166>        End_Procedure
80167>
80167>        Object oMenuBar is a cCJMenuBar
80169>
80169>            Object oFileMenu is a cCJMenuItem
80171>                Set peControlType to xtpControlPopup          
80172>                Set psCaption   to "&File"
80173>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
80174>                Set psCategory to "Menus"
80175>
80175>                Object oClearMenuItem is a cCJClearMenuItem
80177>                    Set pbAddToDesignerMenu to True
80178>                End_Object
80179>
80179>                Object oClearAllMenu is a cCJClearAllMenuItem
80181>                    Set pbAddToDesignerMenu to True
80182>                End_Object
80183>
80183>                Object oPromptMenuItem is a cCJPromptMenuItem
80185>                    Set pbAddToDesignerMenu to True
80186>                    Set pbControlBeginGroup to True
80187>                End_Object
80188>
80188>                Object oFindMenuItem is a cCJFindMenuItem
80190>                    Set pbAddToDesignerMenu to True
80191>                    Set pbControlBeginGroup to True
80192>                End_Object
80193>
80193>                Object oFindNextMenu is a cCJFindNextMenuItem
80195>                    Set pbAddToDesignerMenu to True
80196>                End_Object
80197>
80197>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
80199>                    Set pbAddToDesignerMenu to True
80200>                End_Object
80201>
80201>                Object oFindFirstMenu is a cCJFindFirstMenuItem
80203>                    Set pbAddToDesignerMenu to True
80204>                End_Object
80205>
80205>                Object oFindLastMenu is a cCJFindLastMenuItem
80207>                    Set pbAddToDesignerMenu to True
80208>                End_Object
80209>
80209>                Object oSaveMenuItem is a cCJSaveMenuItem
80211>                    Set pbAddToDesignerMenu to True
80212>                    Set pbControlBeginGroup to True
80213>                End_Object
80214>
80214>                Object oDeleteMenuItem is a cCJDeleteMenuItem
80216>                    Set pbAddToDesignerMenu to True
80217>                End_Object
80218>
80218>                Object oExitMenu is a cCJExitMenuItem
80220>                    Set pbControlBeginGroup to True
80221>                End_Object
80222>
80222>            End_Object
80223>
80223>            Object oViewMenu is a cCJMenuItem
80225>                Set peControlType to xtpControlPopup
80226>                Set psCaption to "&View"
80227>                Set psToolTip to "View"
80228>                Set psDescription to "Available Views"
80229>
80229>                Object oAutoMenuItem is a cCJMenuItem
80231>                    Set psCaption to "Auto"
80232>                    Set psTooltip to "Auto"
80233>                
80233>                    Procedure OnExecute Variant vCommandBarControl
80236>                        Handle hoClient
80236>                        Get Client_Id to hoClient
80237>                        Send Activate_oAuto of hoClient
80238>                    End_Procedure
80239>                End_Object
80240>
80240>                Object oMunkaMenuItem is a cCJMenuItem
80242>                    Set psCaption to "Munka"
80243>                    Set psTooltip to "Munka"
80244>                
80244>                    Procedure OnExecute Variant vCommandBarControl
80247>                        Handle hoClient
80247>                        Get Client_Id to hoClient
80248>                        Send Activate_oMunka of hoClient
80249>                    End_Procedure
80250>                End_Object
80251>
80251>                Object oUgyfelMenuItem is a cCJMenuItem
80253>                    Set psCaption to "Ugyfel"
80254>                    Set psTooltip to "Ugyfel"
80255>                
80255>                    Procedure OnExecute Variant vCommandBarControl
80258>                        Handle hoClient
80258>                        Get Client_Id to hoClient
80259>                        Send Activate_oUgyfel of hoClient
80260>                    End_Procedure
80261>                End_Object
80262>
80262>                Object oMunkalapMenuItem is a cCJMenuItem
80264>                    Set psCaption to "Munkalap"
80265>                    Set psTooltip to "Munkalap"
80266>                
80266>                    Procedure OnExecute Variant vCommandBarControl
80269>                        Handle hoClient
80269>                        Get Client_Id to hoClient
80270>                        Send Activate_oMunkalap of hoClient
80271>                    End_Procedure
80272>                End_Object
80273>
80273>                Object oMunkalapKeszitesMenuItem is a cCJMenuItem
80275>                    Set psCaption to "MunkalapKeszites"
80276>                    Set psTooltip to "MunkalapKeszites"
80277>                
80277>                    Procedure OnExecute Variant vCommandBarControl
80280>                        Handle hoClient
80280>                        Get Client_Id to hoClient
80281>                        Send Activate_oMunkalapKeszites of hoClient
80282>                    End_Procedure
80283>                End_Object
80284>            End_Object
80285>            
80285>            Object oReportMenu is a cCJMenuItem
80287>                Set peControlType to xtpControlPopup
80288>                Set psCaption to "&Report"
80289>                Set psToolTip to "Report"
80290>                Set psDescription to "Available Reports"
80291>
80291>                Object oGyakorisagRiportMenuItem is a cCJMenuItem
80293>                    Set psCaption to "GyakorisagRiport"
80294>                    Set psTooltip to "GyakorisagRiport"
80295>                
80295>                    Procedure OnExecute Variant vCommandBarControl
80298>                        Handle hoClient
80298>                        Get Client_Id to hoClient
80299>                        Send Activate_oGyakorisagRiport of hoClient
80300>                    End_Procedure
80301>                End_Object
80302>
80302>                Object oReportMenuItem is a cCJMenuItem
80304>                    Set psCaption to "Report"
80305>                    Set psTooltip to "Report"
80306>                
80306>                    Procedure OnExecute Variant vCommandBarControl
80309>                        Handle hoClient
80309>                        Get Client_Id to hoClient
80310>                        Send Activate_oReport of hoClient
80311>                    End_Procedure
80312>                End_Object
80313>
80313>                Object oReport2MenuItem is a cCJMenuItem
80315>                    Set psCaption to "Report2"
80316>                    Set psTooltip to "Report2"
80317>                
80317>                    Procedure OnExecute Variant vCommandBarControl
80320>                        Handle hoClient
80320>                        Get Client_Id to hoClient
80321>                        Send Activate_oReport2 of hoClient
80322>                    End_Procedure
80323>                End_Object
80324>
80324>                Object oReport3MenuItem is a cCJMenuItem
80326>                    Set psCaption to "Report3"
80327>                    Set psTooltip to "Report3"
80328>                
80328>                    Procedure OnExecute Variant vCommandBarControl
80331>                        Handle hoClient
80331>                        Get Client_Id to hoClient
80332>                        Send Activate_oReport3 of hoClient
80333>                    End_Procedure
80334>                End_Object
80335>
80335>                Object oReport4MenuItem is a cCJMenuItem
80337>                    Set psCaption to "Report4"
80338>                    Set psTooltip to "Report4"
80339>                
80339>                    Procedure OnExecute Variant vCommandBarControl
80342>                        Handle hoClient
80342>                        Get Client_Id to hoClient
80343>                        Send Activate_oReport4 of hoClient
80344>                    End_Procedure
80345>                End_Object
80346>
80346>                Object oVeglegesReportMenuItem is a cCJMenuItem
80348>                    Set psCaption to "VeglegesReport"
80349>                    Set psTooltip to "VeglegesReport"
80350>                
80350>                    Procedure OnExecute Variant vCommandBarControl
80353>                        Handle hoClient
80353>                        Get Client_Id to hoClient
80354>                        Send Activate_oVeglegesReport of hoClient
80355>                    End_Procedure
80356>                End_Object
80357>            End_Object
80358>
80358>            Object oNavigateMenu is a cCJMenuItem
80360>                Set peControlType to xtpControlPopup      
80361>                Set psCaption to "&Navigate"    
80362>                Set psTooltip to "Navigate"    
80363>                Set psDescription to "Move to different areas of the application"
80364>
80364>                Object oNextAreaMenu is a cCJNextAreaMenu
80366>                End_Object
80367>
80367>                Object oPriorAreaMenu is a cCJPriorAreaMenu
80369>                End_Object
80370>
80370>                Object oNextViewMenu is a cCJNextViewMenu
80372>                End_Object
80373>
80373>                Object oPriorViewMenu is a cCJPriorViewMenu
80375>                End_Object
80376>
80376>                Object oPromptMenu is a cCJPromptMenuItem
80378>                    Set pbControlBeginGroup to True
80379>                End_Object
80380>
80380>                Object oZoomMenu is a cCJZoomMenuItem
80382>                End_Object
80383>
80383>            End_Object
80384>
80384>            Object oWindowMenu is a cCJMDIWindowsMenuItem
80386>                Set peControlType to xtpControlPopup
80387>                Set psCaption to "&Window"
80388>                Set psToolTip to "Window"
80389>                Set psDescription to "Display Current Views and set other display options."    
80390>
80390>                // These are the static windows items. More will be created in onInitPopup 
80390>                Object oDisplayOptionsMenu is a cCJMenuItem
80392>                    Set peControlType to xtpControlPopup          
80393>                    Set psCaption to "&Display Options"
80394>                    Set psToolTip to "Display Options"
80395>                    Set psDescription to "Set display options"
80396>
80396>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
80398>                    End_Object
80399>
80399>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
80401>                    End_Object
80402>
80402>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
80404>                        Set pbControlBeginGroup to True
80405>                    End_Object
80406>
80406>                End_Object
80407>
80407>                Object oCascadeMenu is a cCJCascadeMenuItem
80409>                    Set pbControlBeginGroup to True
80410>                End_Object
80411>
80411>                Object oHorizTile is a cCJTileHorizontally
80413>                End_Object
80414>
80414>                Object oVertTile is a cCJTileVertically
80416>                End_Object
80417>
80417>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
80419>                    Set pbControlBeginGroup to True
80420>                End_Object
80421>
80421>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
80423>                End_Object
80424>
80424>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
80426>                    Set pbControlBeginGroup to True
80427>                End_Object
80428>
80428>            End_Object
80429>
80429>            Object oHelpMenu is a cCJMenuItem
80431>                Set peControlType to xtpControlPopup    
80432>                Set psCaption to "&Help"
80433>                Set psDescription to "Access Information for learning and using this DataFlex application."
80434>                Set psToolTip to "Help"
80435>
80435>                Object oHelpMenuItem is a cCJHelpMenuItem 
80437>                End_Object
80438>
80438>                Object oAboutMenuItem is a cCJAboutMenuItem
80440>                End_Object
80441>
80441>            End_Object
80442>
80442>        End_Object
80443>
80443>        Object oFindToolBar is a cCJToolbar
80445>            Set psTitle to "Finding Toolbar"
80446>
80446>            Object oFindFirstTool is a cCJFindFirstMenuItem
80448>            End_Object
80449>
80449>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
80451>            End_Object
80452>
80452>            Object oFindMenuTool is a cCJFindMenuItem
80454>            End_Object
80455>
80455>            Object oFindNextTool is a cCJFindNextMenuItem
80457>            End_Object
80458>
80458>            Object oFindLastTool is a cCJFindLastMenuItem
80460>            End_Object
80461>
80461>            Object oPromptToolItem is a cCJPromptMenuItem
80463>                Set pbControlBeginGroup to True
80464>            End_Object
80465>
80465>        End_Object
80466>
80466>        Object oFileToolBar is a cCJToolbar
80468>            Set psTitle to "Data Entry Toolbar"
80469>
80469>            Object oClearToolItem is a cCJClearMenuItem
80471>                Set peControlStyle to xtpButtonIconAndCaption
80472>            End_Object
80473>
80473>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
80475>                Set peControlStyle to xtpButtonIconAndCaption
80476>            End_Object
80477>
80477>            Object oSaveToolItem is a cCJSaveMenuItem
80479>                Set peControlStyle to xtpButtonIconAndCaption
80480>                Set pbControlBeginGroup to True
80481>            End_Object
80482>
80482>            Object oDeleteToolItem is a cCJDeleteMenuItem
80484>                Set peControlStyle to xtpButtonIconAndCaption
80485>            End_Object
80486>
80486>        End_Object
80487>
80487>        Object oEditToolBar is a cCJToolbar
80489>            Set psTitle to "Edit Toolbar"
80490>
80490>            Object oCutToolbarItem is a cCJCutMenuItem
80492>            End_Object
80493>
80493>            Object oCopyToolbarItem is a cCJCopyMenuItem
80495>            End_Object
80496>
80496>            Object oPasteToolbarItem is a cCJPasteMenuItem
80498>            End_Object
80499>
80499>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
80501>                Set pbControlBeginGroup to True
80502>            End_Object
80503>
80503>        End_Object
80504>
80504>        Object oRememberToolbar is a cCJToolbar
80506>            Set psTitle to C_$Remember
80507>
80507>            Object oRememberItems is a cCJMenuItem
80509>
80509>                Set peControlType to xtpControlPopup
80510>                Set peControlStyle to xtpButtonCaption
80511>                Set psCaption to C_$Remember
80512>                
80512>                Object oMenuItem is a cCJRememberFieldMenuItem
80514>                    Set peControlStyle to xtpButtonIconAndCaption
80515>                End_Object
80516>                
80516>                Object oMenuItem is a cCJRememberLastFieldMenuItem
80518>                    Set peControlStyle to xtpButtonIconAndCaption
80519>                End_Object
80520>                
80520>                Object oMenuItem is a cCJUnRememberFieldMenuItem
80522>                    Set peControlStyle to xtpButtonIconAndCaption
80523>                End_Object
80524>                
80524>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
80526>                    Set peControlStyle to xtpButtonIconAndCaption
80527>                End_Object
80528>
80528>            End_Object
80529>            
80529>        End_Object
80530>        
80530>        Object oStatusBar is a cCJStatusBar
80532>
80532>            Object oStatusPane1 is a cCJStatusBarPane
80534>                Set piID to sbpIDIdlePane
80535>                Set pbStyleStretch to True
80536>            End_Object
80537>
80537>            Object oStatusPane2 is a cCJStatusBarPane
80539>                Set phoViewPane to Self
80540>                Set pbStyleStretch to True
80541>            End_Object
80542>
80542>        End_Object
80543>
80543>    End_Object
80544>
80544>    Object oClientArea is a ClientArea
80546>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\StdAbout.pkg)
80546>>>//************************************************************************
80546>>>// Confidential Trade Secret.
80546>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
80546>>>// as an unpublished work.  All rights reserved.
80546>>>// DataFlex is a registered trademark of Data Access Corporation.
80546>>>//
80546>>>//************************************************************************
80546>>>//************************************************************************
80546>>>//
80546>>>// $File name  : StdAbout.pkg
80546>>>// $File title : Standard about object package for VDF
80546>>>// Notice      :
80546>>>// $Author(s)  : John Tuohy
80546>>>//
80546>>>// $Rev History
80546>>>//
80546>>>// JT 06/27/97   File created
80546>>>//************************************************************************
80546>>>
80546>>>// This provides a quick and simple way to create an about package for a program.
80546>>>// You need to create a message inside you client area called Activate_About.
80546>>>// Within this message you should send the message DoAbout passing needed
80546>>>// string information.
80546>>>//
80546>>>//       Procedure Activate_About
80546>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
80546>>>//       End_Procedure
80546>>>//    where: sTitle =     Name of application. If none provided, uses caption
80546>>>//                        bar title
80546>>>//           sVersion   = Version Line. If none provided, will be blank
80546>>>//           sCopyRight = Copyright Line. If none provided, will be blank
80546>>>//           sAuthor    = Author name, blank if none provided
80546>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
80546>>>//                        is used.
80546>>>// It is expected that you will place this in your own object package. For
80546>>>// example an order about package may look like this:
80546>>>//
80546>>>//   // OrderAbout.pkg
80546>>>//   Use StdAbout.pkg
80546>>>//   Procedure Activate_About
80546>>>//      String sTitle sCopyright sVersion sAuthor
80546>>>//      Move "My Order Entry System" to sTitle
80546>>>//      Move "Version 2.1" to sVersion
80546>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
80546>>>//      Move "John Smith"  to sAuthor
80546>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
80546>>>//   end_procedure
80546>>>//   // end of file.
80546>>>
80546>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfabout.pkg)
80546>>>>>//************************************************************************
80546>>>>>// Confidential Trade Secret.
80546>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
80546>>>>>// as an unpublished work.  All rights reserved.
80546>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
80546>>>>>//
80546>>>>>//************************************************************************
80546>>>>>//************************************************************************
80546>>>>>//
80546>>>>>// $File name  : DfAbout.pkg
80546>>>>>// $File title : About class support
80546>>>>>// Notice      :
80546>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
80546>>>>>//
80546>>>>>// $Rev History
80546>>>>>//
80546>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
80546>>>>>//                Windows for the size first. 
80546>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
80546>>>>>//                with anchor technique. Removed unnessary property in the
80546>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
80546>>>>>//                object To better look in Windows XP. Repositioned the close
80546>>>>>//                button in the sysinfo dialog To line up with the display area
80546>>>>>//                Replaced obsolete code and techniques. Removed dead code.
80546>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
80546>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
80546>>>>>//                the global Workspace object, if it is present
80546>>>>>// JJT 11/05/98   Added version information
80546>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
80546>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
80546>>>>>//                workspace package.
80546>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
80546>>>>>//                class can create this object.
80546>>>>>//                Cleaned up the interface (used correct classes and messages)
80546>>>>>//                Added workspace reporting support To sys-info.
80546>>>>>//                Turned off wrapping in the sys-info editor.
80546>>>>>// KR  ??/??/96   File created
80546>>>>>//************************************************************************
80546>>>>>Use LanguageText.pkg
80546>>>>>Use Windows.pkg
80546>>>>>Use DFbitmap.pkg
80546>>>>>Use GlobalFunctionsProcedures.pkg
80546>>>>>Use cTextEdit.pkg
80546>>>>>
80546>>>>>Use cli.pkg
80546>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DFBTRDRV.PKG)
80546>>>>>>>//****************************************************************************
80546>>>>>>>//
80546>>>>>>>// $File name  : DFBTRDRV.PKG
80546>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
80546>>>>>>>// Notice      : This package contains constants and commands, used to call
80546>>>>>>>//               specific functions in the DFBTRDRV.
80546>>>>>>>// $Author(s)  : Eddy Kleinjan
80546>>>>>>>//
80546>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
80546>>>>>>>// Created     : 01-07-97 @ 12:00:00
80546>>>>>>>//
80546>>>>>>>// Changed     : 04-04-2001.
80546>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
80546>>>>>>>//
80546>>>>>>>// Changed     : June 6, 2001
80546>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
80546>>>>>>>//
80546>>>>>>>//               Added DFBTR_DDF_OWNER command.
80546>>>>>>>//
80546>>>>>>>// Changed     : June 12, 2001
80546>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
80546>>>>>>>//
80546>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
80546>>>>>>>//
80546>>>>>>>// Changed     : August 4, 2004
80546>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
80546>>>>>>>//
80546>>>>>>>//               Added cDfbtrdrvHandler class.
80546>>>>>>>//               New functions in this class:
80546>>>>>>>//                  Function CKRevision Returns String
80546>>>>>>>//                  Function CkUsesUri Returns Integer
80546>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
80546>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
80546>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
80546>>>>>>>//
80546>>>>>>>// Changed     : September 30, 2005
80546>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
80546>>>>>>>//
80546>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
80546>>>>>>>//****************************************************************************
80546>>>>>>>Use Ui
80546>>>>>>>//
80546>>>>>>>// Driver Indentification
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//*** Driver attributes
80546>>>>>>>//
80546>>>>>>>// Call_Driver functions ID's
80546>>>>>>>//
80546>>>>>>>//
80546>>>>>>>// DFBTRFN_CONVERT_FILE options
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// DFBTRFN_SET_OWNER options
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to create all vars which may be needed
80546>>>>>>>// in other commands.
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to set the owner of a Btrieve file.
80546>>>>>>>// File must have been opened.
80546>>>>>>>// Filenumber needs to be passed.
80546>>>>>>>// To clear set the owner to "".
80546>>>>>>>// Examples:
80546>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
80546>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
80546>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
80546>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
80546>>>>>>>// To clear:
80546>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to parse DFBTR_SET_OWNVER
80546>>>>>>>// options.
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to parse for Callback
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to clear the owner of a Btrieve file.
80546>>>>>>>// File must have been opened.
80546>>>>>>>// Filenumber needs to be passed.
80546>>>>>>>// Examples:
80546>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to add a owner name to the internal list of ownernames
80546>>>>>>>// which will be tries when opening files.
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to remove all owners from the internal list of ownernames
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to set the owner name to be used when opening the DDF files.
80546>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
80546>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
80546>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to change the transaction type.
80546>>>>>>>// Valid types are:
80546>>>>>>>//     DFBTRTT_NONE
80546>>>>>>>//     DFBTRTT_EXCLUSIVE
80546>>>>>>>//     DFBTRTT_CONCURRENT
80546>>>>>>>//
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to get the current transaction type.
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to set explicit_locking
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to get explicit locking
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//
80546>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
80546>>>>>>>//
80546>>>>>>>
80546>>>>>>>//*****************************************************************************
80546>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
80546>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
80546>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
80546>>>>>>>//*****************************************************************************
80546>>>>>>>
80546>>>>>>>Class cDFBtrDrvHandler Is An Array
80547>>>>>>>
80547>>>>>>>    Procedure Construct_Object Integer iImage
80549>>>>>>>        Forward Send Construct_object iImage
80551>>>>>>>
80551>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
80552>>>>>>>    End_Procedure // Construct_Object
80553>>>>>>>
80553>>>>>>>
80553>>>>>>>
80553>>>>>>>    //***
80553>>>>>>>    //*** Function: CKRevsion
80553>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
80553>>>>>>>    //***
80553>>>>>>>
80553>>>>>>>    Function CKRevision Returns String
80555>>>>>>>        Local String  sDriverID
80555>>>>>>>        Local String  sRevision
80555>>>>>>>        Local String  sVoid
80555>>>>>>>        Local Integer iRetval
80555>>>>>>>
80555>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80555>>>>>>>        // This error would otherwise be raised when we have an older
80555>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80555>>>>>>>        Send Ignore_error To Error_object_Id 20491
80556>>>>>>>        Get psDriverID To sDriverID
80557>>>>>>>        Move (Repeat(" ", 255)) To sRevision
80558>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
80563>>>>>>>        Send Trap_Error To Error_object_Id 20491
80564>>>>>>>        If (Trim(sRevision) = "") Begin
80566>>>>>>>            // Unable to get the revision. return all zeroes.
80566>>>>>>>            Move "0.0.0.0" To sRevision
80567>>>>>>>        End
80567>>>>>>>>
80567>>>>>>>        Function_Return sRevision
80568>>>>>>>    End_Function // CKRevision
80569>>>>>>>
80569>>>>>>>    Function CkUsesUri Returns Integer
80571>>>>>>>        Local String  sDriverID
80571>>>>>>>        Local String  sVoid1
80571>>>>>>>        Local String  sVoid2
80571>>>>>>>        Local Integer iRetval
80571>>>>>>>
80571>>>>>>>        Get psDriverID To sDriverID
80572>>>>>>>
80572>>>>>>>        Move 0 To iRetval
80573>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80573>>>>>>>        // This error would otherwise be raised when we have an older
80573>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
80573>>>>>>>        Send Ignore_error To Error_object_Id 20491
80574>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
80579>>>>>>>        Send Trap_Error To Error_object_Id 20491
80580>>>>>>>
80580>>>>>>>        Function_Return iRetval
80581>>>>>>>    End_Function // CKUsesUri
80582>>>>>>>
80582>>>>>>>
80582>>>>>>>
80582>>>>>>>    //***
80582>>>>>>>    //*** Function: ExtractPartFromRevsion
80582>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
80582>>>>>>>    //***
80582>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
80582>>>>>>>    //***
80582>>>>>>>
80582>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
80584>>>>>>>        Local Integer iPartRev
80584>>>>>>>        Local Integer iCurrentPart
80584>>>>>>>        Local Integer iSeparatorPos
80584>>>>>>>
80584>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
80587>>>>>>>
80587>>>>>>>        Move 0 To iCurrentPart
80588>>>>>>>        Repeat
80588>>>>>>>>
80588>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
80589>>>>>>>            If (iSeparatorPos > 0) Begin
80591>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
80592>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
80593>>>>>>>                Increment iCurrentPart
80594>>>>>>>            End
80594>>>>>>>>
80594>>>>>>>            Else If (sRevision <> "") Begin
80597>>>>>>>                Move sRevision To iPartRev
80598>>>>>>>                Move "" To sRevision
80599>>>>>>>                Increment iCurrentPart
80600>>>>>>>            End
80600>>>>>>>>
80600>>>>>>>            Else ;                Move -1 To iPartRev
80602>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
80604>>>>>>>
80604>>>>>>>        Function_Return iPartRev
80605>>>>>>>    End_Function // EcxtractPartFromRevision
80606>>>>>>>
80606>>>>>>>
80606>>>>>>>
80606>>>>>>>    //***
80606>>>>>>>    //*** Function: CKMajorRevision
80606>>>>>>>    //*** Purpose : Returns the major revision of the CK
80606>>>>>>>    //***
80606>>>>>>>
80606>>>>>>>    Function CKMajorRevision Returns Integer
80608>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
80609>>>>>>>    End_Function // CKMajorRevision
80610>>>>>>>
80610>>>>>>>
80610>>>>>>>
80610>>>>>>>    //***
80610>>>>>>>    //*** Function: CKMinorRevision
80610>>>>>>>    //*** Purpose : Returns the minor revision of the CK
80610>>>>>>>    //***
80610>>>>>>>
80610>>>>>>>    Function CKMinorRevision Returns Integer
80612>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
80613>>>>>>>    End_Function // CKMinorRevision
80614>>>>>>>
80614>>>>>>>
80614>>>>>>>
80614>>>>>>>    //***
80614>>>>>>>    //*** Function: CKReleaseRevision
80614>>>>>>>    //*** Purpose : Returns the release revision of the CK
80614>>>>>>>    //***
80614>>>>>>>
80614>>>>>>>    Function CKReleaseRevision Returns Integer
80616>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
80617>>>>>>>    End_Function // CKReleaseRevision
80618>>>>>>>
80618>>>>>>>
80618>>>>>>>
80618>>>>>>>    //***
80618>>>>>>>    //*** Function: CKBuildRevision
80618>>>>>>>    //*** Purpose : Returns the major revision of the CK
80618>>>>>>>    //***
80618>>>>>>>
80618>>>>>>>    Function CKBuildRevision Returns Integer
80620>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
80621>>>>>>>    End_Function // CKBuildRevision
80622>>>>>>>
80622>>>>>>>
80622>>>>>>>
80622>>>>>>>    //***
80622>>>>>>>    //*** Function: IsMinimalRevision
80622>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
80622>>>>>>>    //***
80622>>>>>>>
80622>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
80624>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
80627>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
80630>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
80633>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
80636>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
80639>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
80643>>>>>>>            End
80643>>>>>>>>
80643>>>>>>>        End
80643>>>>>>>>
80643>>>>>>>
80643>>>>>>>        Function_Return (FALSE)
80644>>>>>>>    End_Function // IsMinimalRevision
80645>>>>>>>
80645>>>>>>>    //   Functions to query the Pervasive.SQL version:
80645>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
80645>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
80645>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
80645>>>>>>>    //
80645>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
80645>>>>>>>    //   in the following format:
80645>>>>>>>    //       <version>.<revision>.<type>
80645>>>>>>>    //   possible values for <type>:
80645>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
80645>>>>>>>    //         server using Workgroup authentication mode
80645>>>>>>>    //       C for client cache engine
80645>>>>>>>    //       D for DOS workstation
80645>>>>>>>    //       N for client Requester
80645>>>>>>>    //       S for NetWare server
80645>>>>>>>    //       T for 32-bit Windows server engine
80645>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
80645>>>>>>>    //
80645>>>>>>>    //   example:
80645>>>>>>>    //       8.50.T
80645>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
80645>>>>>>>    //   32-bits Windows server.
80645>>>>>>>    //
80645>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
80645>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
80645>>>>>>>    //
80645>>>>>>>    //   If the version information is not available or can not be obtained
80645>>>>>>>    //   the functions will return "0.0.0"
80645>>>>>>>
80645>>>>>>>
80645>>>>>>>    //***
80645>>>>>>>    //*** Function: PSQLRequesterVersionInfo
80645>>>>>>>    //*** Purpose : Returns the version information of the
80645>>>>>>>    //***           Pervasive.SQL Client requester.
80645>>>>>>>
80645>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
80647>>>>>>>
80647>>>>>>>        Local String  sDriverID
80647>>>>>>>        Local String  sVersion
80647>>>>>>>        Local String  sVoid
80647>>>>>>>        Local Integer iRetval
80647>>>>>>>
80647>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80647>>>>>>>        // This error would otherwise be raised when we have an older
80647>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80647>>>>>>>        Send Ignore_error To Error_object_Id 20491
80648>>>>>>>        Get psDriverID To sDriverID
80649>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80650>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80655>>>>>>>        Send Trap_Error To Error_object_Id 20491
80656>>>>>>>        If (Trim(sVersion) = "") Begin
80658>>>>>>>            // Unable to get the revision. return all zeroes.
80658>>>>>>>            Move "0.0.0" To sVersion
80659>>>>>>>        End
80659>>>>>>>>
80659>>>>>>>        Function_Return sVersion
80660>>>>>>>    End_Function //  PSQLRequesterVersion
80661>>>>>>>
80661>>>>>>>    //***
80661>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
80661>>>>>>>    //*** Purpose : Returns the version information of the
80661>>>>>>>    //***           Pervasive.SQL Local Engine
80661>>>>>>>
80661>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
80663>>>>>>>
80663>>>>>>>        Local String  sDriverID
80663>>>>>>>        Local String  sVersion
80663>>>>>>>        Local String  sVoid
80663>>>>>>>        Local Integer iRetval
80663>>>>>>>
80663>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80663>>>>>>>        // This error would otherwise be raised when we have an older
80663>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80663>>>>>>>        Send Ignore_error To Error_object_Id 20491
80664>>>>>>>        Get psDriverID To sDriverID
80665>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80666>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80671>>>>>>>        Send Trap_Error To Error_object_Id 20491
80672>>>>>>>        If (Trim(sVersion) = "") Begin
80674>>>>>>>            // Unable to get the revision. return all zeroes.
80674>>>>>>>            Move "0.0.0" To sVersion
80675>>>>>>>        End
80675>>>>>>>>
80675>>>>>>>        Function_Return sVersion
80676>>>>>>>    End_Function //  PSQLLocalEngineVersion
80677>>>>>>>
80677>>>>>>>    //***
80677>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
80677>>>>>>>    //*** Purpose : Returns the version information of the
80677>>>>>>>    //***           Pervasive.SQL Server Engine
80677>>>>>>>
80677>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
80679>>>>>>>
80679>>>>>>>        Local String  sDriverID
80679>>>>>>>        Local String  sVersion
80679>>>>>>>        Local String  sVoid
80679>>>>>>>        Local Integer iRetval
80679>>>>>>>
80679>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80679>>>>>>>        // This error would otherwise be raised when we have an older
80679>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80679>>>>>>>        Send Ignore_error To Error_object_Id 20491
80680>>>>>>>        Get psDriverID To sDriverID
80681>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80682>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80687>>>>>>>        Send Trap_Error To Error_object_Id 20491
80688>>>>>>>        If (Trim(sVersion) = "") Begin
80690>>>>>>>            // Unable to get the revision. return all zeroes.
80690>>>>>>>            Move "0.0.0" To sVersion
80691>>>>>>>        End
80691>>>>>>>>
80691>>>>>>>        Function_Return sVersion
80692>>>>>>>    End_Function //  PSQLServerEngineVersion
80693>>>>>>>
80693>>>>>>>End_Class // cDfbtrdrvHandler
80694>>>>>>>
80694>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\MSSqldrv.pkg)
80694>>>>>>>//*****************************************************************************
80694>>>>>>>//*** MSSQLDRV.PKG                                                          ***
80694>>>>>>>//***                                                                       ***
80694>>>>>>>//*** Author: Ben Weijers                                                   ***
80694>>>>>>>//***         Data Access Nederland                                         ***
80694>>>>>>>//***         29 June 1998                                                  ***
80694>>>>>>>//***                                                                       ***
80694>>>>>>>//***                                                                       ***
80694>>>>>>>//*** Purpose:                                                              ***
80694>>>>>>>//***   Package that declares MS SQL driver constants and functions.        ***
80694>>>>>>>//****                                                                      ***
80694>>>>>>>//***   This package can be used by developers who want to add Data Access  ***
80694>>>>>>>//***   MS SQL Client specific code to a DataFlex application.              ***
80694>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
80694>>>>>>>//***             Changed EnumerateServers function to use the highest      ***
80694>>>>>>>//***             available SQL Server client driver.                       ***
80694>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
80694>>>>>>>//***             mssqldrv.pkg                                              ***
80694>>>>>>>//***   Updated:  November 6th 2013 (Current CK build: 6.0.0.19)            ***
80694>>>>>>>//***             Added constants for SQL Server specific native types      ***
80694>>>>>>>//***             ( var...(max) types, money types, datetime types)         ***
80694>>>>>>>//*****************************************************************************
80694>>>>>>>
80694>>>>>>>Use Cli.pkg
80694>>>>>>>Use SQL.pkg
80694>>>>>>>
80694>>>>>>>//*** Driver Indentification
80694>>>>>>>
80694>>>>>>>//*** Error number constants
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>// SQL Server spcific types. 
80694>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
80694>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
80694>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
80694>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
80694>>>>>>>
80694>>>>>>>// SQL Server spcific types. 
80694>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
80694>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
80694>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
80694>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
80694>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
80694>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
80694>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>//*****************************************************************************
80694>>>>>>>//*** MSSQL_SetConstraint <FileNum> <ConstraintText>                        ***
80694>>>>>>>//***                                                                       ***
80694>>>>>>>//***   Setup a constraint for a file.                                      ***
80694>>>>>>>//*****************************************************************************
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>
80694>>>>>>>Class cMSSQLHandler Is A cCLIHandler
80695>>>>>>>
80695>>>>>>>    Procedure Construct_Object
80697>>>>>>>        Forward Send Construct_Object
80699>>>>>>>
80699>>>>>>>        Set psDriverID To MSSQLDRV_ID
80700>>>>>>>    End_Procedure // Construct_Object
80701>>>>>>>
80701>>>>>>>
80701>>>>>>>
80701>>>>>>>    //***
80701>>>>>>>    //*** Function: ExtractList
80701>>>>>>>    //*** Purpose : Extract the list from the out connect string.
80701>>>>>>>    //***
80701>>>>>>>
80701>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
80703>>>>>>>        Local String  sItem
80703>>>>>>>        Local Integer iStart
80703>>>>>>>        Local Integer iEnd
80703>>>>>>>
80703>>>>>>>        If (hoStore = 0) ;            Move Current_object To hoStore
80706>>>>>>>
80706>>>>>>>        Send Delete_Data To hoStore
80707>>>>>>>        Move (Pos("{", sOutConnStr)) To iStart
80708>>>>>>>        While (iStart > 0)
80712>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) To sOutConnStr
80713>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 To iStart
80716>>>>>>>            Else Begin
80717>>>>>>>                Move (Pos(",", sOutConnStr)) To iStart
80718>>>>>>>                Move (Pos("}", sOutConnStr)) To iEnd
80719>>>>>>>                If ((iStart = 0) Or (iEnd < iStart)) ;                    Move iEnd To iStart
80722>>>>>>>
80722>>>>>>>                If (iStart > 0) ;                    Set Value Of hoStore Item (Item_Count(Current_Object)) To (Left(sOutConnStr, iStart - 1))
80725>>>>>>>
80725>>>>>>>                If (iStart = iEnd) ;                    Move 0 To iStart
80728>>>>>>>            End
80728>>>>>>>>
80728>>>>>>>        Loop
80729>>>>>>>>
80729>>>>>>>
80729>>>>>>>        Function_Return (Item_Count(hoStore))
80730>>>>>>>    End_Procedure // ExtractList
80731>>>>>>>
80731>>>>>>>
80731>>>>>>>
80731>>>>>>>    //***
80731>>>>>>>    //*** Function: BrowseConnect
80731>>>>>>>    //*** Purpose : Call the driver's browse connect function
80731>>>>>>>    //***
80731>>>>>>>
80731>>>>>>>    Function BrowseConnect String sInConnStr Returns String
80733>>>>>>>        Local String  sDriver
80733>>>>>>>        Local String  sOutConnStr
80733>>>>>>>        Local Integer iArg
80733>>>>>>>        Local Integer iRetval
80733>>>>>>>
80733>>>>>>>        Get psDriverID To sDriver
80734>>>>>>>        If (sDriver <> "") Begin
80736>>>>>>>            Move (Repeat(" ", 8192)) To sOutConnStr
80737>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
80742>>>>>>>        End
80742>>>>>>>>
80742>>>>>>>
80742>>>>>>>        Function_Return sOutConnStr
80743>>>>>>>    End_Function// BrowseConnect
80744>>>>>>>
80744>>>>>>>
80744>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
80746>>>>>>>        Local String  sDriver
80746>>>>>>>        Local String  sOutConnStr
80746>>>>>>>        Local Integer iArg
80746>>>>>>>        Local Integer iRetval
80746>>>>>>>        
80746>>>>>>>        Move 1 to iArg // Browses only local
80747>>>>>>>
80747>>>>>>>        Get psDriverID to sDriver
80748>>>>>>>        If (sDriver <> "") Begin
80750>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
80751>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
80756>>>>>>>        End
80756>>>>>>>>
80756>>>>>>>
80756>>>>>>>        Function_Return sOutConnStr
80757>>>>>>>    End_Function// BrowseConnect
80758>>>>>>>
80758>>>>>>>
80758>>>>>>>    Function DriverIndex String sDriver Returns Integer
80760>>>>>>>    
80760>>>>>>>        Local String  sCurrentDriver
80760>>>>>>>        Local Integer iNumberOfDrivers iDriver iCount
80760>>>>>>>    
80760>>>>>>>        Move 0 to iDriver
80761>>>>>>>    
80761>>>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
80764>>>>>>>        For iCount from 1 to iNumberOfDrivers
80770>>>>>>>>
80770>>>>>>>    
80770>>>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
80773>>>>>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriver) ) Begin
80775>>>>>>>                Move iCount to iDriver
80776>>>>>>>            End
80776>>>>>>>>
80776>>>>>>>        Loop
80777>>>>>>>>
80777>>>>>>>    
80777>>>>>>>        Function_Return iDriver
80778>>>>>>>    
80778>>>>>>>    End_Function 
80779>>>>>>>
80779>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
80781>>>>>>>        
80781>>>>>>>        Local String  sServerList
80781>>>>>>>        Local Integer iNumServers
80781>>>>>>>        Local Integer iDriver
80781>>>>>>>        Local Integer iClientVersion
80781>>>>>>>        Local String  sDriver
80781>>>>>>>        
80781>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
80782>>>>>>>
80782>>>>>>>        If (iDriver) Begin
80784>>>>>>>                
80784>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
80787>>>>>>>            
80787>>>>>>>            Case Begin
80787>>>>>>>    
80787>>>>>>>                Case (iClientVersion = SQLSERVER2016CLIENT)
80789>>>>>>>                    Move SQLSERVER2016DRVRSTR to sDriver
80790>>>>>>>                    Case Break
80791>>>>>>>    
80791>>>>>>>                Case (iClientVersion = SQLSERVER2014CLIENT)
80794>>>>>>>                    Move SQLSERVER2014DRVRSTR to sDriver
80795>>>>>>>                    Case Break
80796>>>>>>>            
80796>>>>>>>                Case (iClientVersion = SQLSERVER2012CLIENT)
80799>>>>>>>                    Move SQLSERVER2012DRVRSTR to sDriver
80800>>>>>>>                    Case Break
80801>>>>>>>    
80801>>>>>>>                Case (iClientVersion = SQLSERVER2008CLIENT)
80804>>>>>>>                    Move SQLSERVER2008DRVRSTR to sDriver
80805>>>>>>>                    Case Break
80806>>>>>>>    
80806>>>>>>>                Case (iClientVersion = SQLSERVER2005CLIENT)
80809>>>>>>>                    Move SQLSERVER2005DRVRSTR to sDriver
80810>>>>>>>                    Case Break
80811>>>>>>>            
80811>>>>>>>                Case (iClientVersion = SQLSERVER2000CLIENT)
80814>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
80815>>>>>>>                    Case Break
80816>>>>>>>            
80816>>>>>>>                Case Else
80816>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
80817>>>>>>>            
80817>>>>>>>            Case End
80817>>>>>>>    
80817>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
80818>>>>>>>            If (iNetworkLocal = 0) Begin
80820>>>>>>>                Get BrowseConnect sDriver to sServerList
80821>>>>>>>            End
80821>>>>>>>>
80821>>>>>>>            Else Begin
80822>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
80823>>>>>>>            End
80823>>>>>>>>
80823>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
80824>>>>>>>        End
80824>>>>>>>>
80824>>>>>>>        
80824>>>>>>>        Function_Return iNumServers
80825>>>>>>>        
80825>>>>>>>    End_Function
80826>>>>>>>
80826>>>>>>>    //***
80826>>>>>>>    //*** Procedure: EnumerateServers
80826>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
80826>>>>>>>    //***            This function will return all SQL Server instances on the network. 
80826>>>>>>>    //***            This may take a long time. 
80826>>>>>>>    //***            To enumerate only local SQL Server instances use EnumerateServersLocal 
80826>>>>>>>    Function EnumerateServers Returns Integer
80828>>>>>>>
80828>>>>>>>        Local Integer iNumServers
80828>>>>>>>        Local Integer iNetworkLocal
80828>>>>>>>        
80828>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
80829>>>>>>>        
80829>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
80830>>>>>>>        
80830>>>>>>>        Function_Return iNumServers
80831>>>>>>>        
80831>>>>>>>    End_Function
80832>>>>>>>
80832>>>>>>>
80832>>>>>>>    //***
80832>>>>>>>    //*** Procedure: EnumerateServersLocal
80832>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
80832>>>>>>>    //***            This function will return only return SQL Server instance on the local machine
80832>>>>>>>    //***            To enumerate all SQL Server instances in a network use EnumerateServers
80832>>>>>>>    Function EnumerateServersLocal Returns Integer
80834>>>>>>>
80834>>>>>>>        Local Integer iNumServers
80834>>>>>>>        Local Integer iNetworkLocal
80834>>>>>>>        
80834>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
80835>>>>>>>        
80835>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
80836>>>>>>>        
80836>>>>>>>        Function_Return iNumServers
80837>>>>>>>        
80837>>>>>>>    End_Function
80838>>>>>>>
80838>>>>>>>    
80838>>>>>>>
80838>>>>>>>    //***
80838>>>>>>>    //*** Function: EnumerateDatabases
80838>>>>>>>    //*** Purpose : Enumerate database in a given server.
80838>>>>>>>    //***
80838>>>>>>>
80838>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
80840>>>>>>>        Local Integer hoSQL
80840>>>>>>>        Local String  sConnect
80840>>>>>>>        Local String  sDatabase
80840>>>>>>>        Local Integer hdbc
80840>>>>>>>        Local Integer hstmt
80840>>>>>>>        Local Integer iFetchResult
80840>>>>>>>
80840>>>>>>>        If (Num_Arguments < 3) ;            Move "" To sPassWord
80843>>>>>>>        If (Num_Arguments < 2) ;            Move "" To sUser
80846>>>>>>>
80846>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") To sConnect
80849>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") To sConnect
80851>>>>>>>
80851>>>>>>>        Object oEnumDBSQLmanager Is A cSQLHandleManager
80853>>>>>>>            Move Current_Object To hoSQL
80854>>>>>>>        End_Object // oEnumDBSQLManager
80855>>>>>>>
80855>>>>>>>        If (hoSQL <> 0) Begin
80857>>>>>>>            Get SQLConnect Of hoSQL "MSSQLDRV" sConnect To hdbc
80858>>>>>>>            If (hdbc <> 0) Begin
80860>>>>>>>                Get SQLOpen Of hdbc To hstmt
80861>>>>>>>                If (hstmt <> 0) Begin
80863>>>>>>>                    //*** We could do a direct select on the sysdatabases table but we use
80863>>>>>>>                    //*** the stored procedure sp_database instead. SQL Server recommends this
80863>>>>>>>                    //*** approach in case meta data might change, the stored procedure will
80863>>>>>>>                    //*** stay the same.
80863>>>>>>>                    Send SQLSetProcedureName To hstmt "sp_databases"
80864>>>>>>>                    Send SQLCall To hstmt
80865>>>>>>>                    Repeat
80865>>>>>>>>
80865>>>>>>>                        Get SQLFetch Of hstmt To iFetchResult
80866>>>>>>>                        If (iFetchResult <> 0) Begin
80868>>>>>>>                            Get SQLColumnValue Of hstmt 1 To sDatabase
80869>>>>>>>                            Set Value Item (Item_Count(Current_Object)) To sDatabase
80870>>>>>>>                        End
80870>>>>>>>>
80870>>>>>>>                    Until (iFetchResult = 0)
80872>>>>>>>
80872>>>>>>>                    Send SQLClose To hstmt
80873>>>>>>>                End
80873>>>>>>>>
80873>>>>>>>                Send SQLDisconnect To hdbc
80874>>>>>>>            End
80874>>>>>>>>
80874>>>>>>>        End
80874>>>>>>>>
80874>>>>>>>        Send Destroy_Object To hoSQL
80875>>>>>>>
80875>>>>>>>        Function_return (Item_Count(Current_Object))
80876>>>>>>>    End_Function // EnumerateDatabases
80877>>>>>>>
80877>>>>>>>
80877>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
80879>>>>>>>        
80879>>>>>>>        Local String  sSqlServerClientVersionName
80879>>>>>>>        
80879>>>>>>>            
80879>>>>>>>        Case Begin
80879>>>>>>>
80879>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
80881>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
80882>>>>>>>                Case Break
80883>>>>>>>
80883>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
80886>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
80887>>>>>>>                Case Break
80888>>>>>>>        
80888>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
80891>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
80892>>>>>>>                Case Break
80893>>>>>>>
80893>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
80896>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
80897>>>>>>>                Case Break
80898>>>>>>>
80898>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
80901>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
80902>>>>>>>                Case Break
80903>>>>>>>        
80903>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
80906>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
80907>>>>>>>                Case Break
80908>>>>>>>        
80908>>>>>>>            Case Else
80908>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
80909>>>>>>>        
80909>>>>>>>        Case End
80909>>>>>>>    
80909>>>>>>>        
80909>>>>>>>        Function_Return sSqlServerClientVersionName
80910>>>>>>>        
80910>>>>>>>    End_Function
80911>>>>>>>
80911>>>>>>>
80911>>>>>>>End_Class // cMSSQLHandler
80912>>>>>>>
80912>>>>>
80912>>>>>
80912>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
80913>>>>>
80913>>>>>Register_Function phoWorkspace Returns Handle
80913>>>>>Register_Function Help_filename Returns String
80913>>>>>Register_Function GetHelpFile Returns String
80913>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
80913>>>>>
80913>>>>>//****************************************************************************
80913>>>>>// $Module type: FUNCTION
80913>>>>>// $Module name: Network_User_Name
80913>>>>>// $Author     : AK/VOO/KCR
80913>>>>>// Created     : 09-24-96 @ 19:17
80913>>>>>//
80913>>>>>// Description
80913>>>>>//    This function reads the current username Of windows and returns that
80913>>>>>//    name or an text unknown user
80913>>>>>//
80913>>>>>// $Rev History
80913>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
80913>>>>>//  07/25/2003  Replaced obsolete code
80913>>>>>//  09/24/1996  Module header created
80913>>>>>//****************************************************************************
80913>>>>>Function Network_User_Name for cDesktop Returns String
80915>>>>>    String sName
80915>>>>>    Integer iRetval iLength
80915>>>>>
80915>>>>>    Move 0 to iLength
80916>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
80917>>>>>    ZeroString iLength to sName
80918>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
80919>>>>>
80919>>>>>    If (iRetval = NO_ERROR) Begin
80921>>>>>        Function_Return (CString (sName))
80922>>>>>    End
80922>>>>>>
80922>>>>>    
80922>>>>>    Function_Return "User Unknown"
80923>>>>>End_Function
80924>>>>>
80924>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
80924>>>>>Type MEMORYSTATUS
80924>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
80924>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
80924>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
80924>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
80924>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
80924>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
80924>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
80924>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
80924>>>>>End_Type // MEMORYSTATUS
80924>>>>>
80924>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
80925>>>>>
80925>>>>>Struct tWinMemoryStatusEx
80925>>>>>    UInteger dwLength                
80925>>>>>    UInteger dwMemoryLoad          
80925>>>>>    UBigInt ullTotalPhys           
80925>>>>>    UBigInt ullAvailPhys           
80925>>>>>    UBigInt ullTotalPageFile       
80925>>>>>    UBigInt ullAvailPageFile       
80925>>>>>    UBigInt ullTotalVirtual        
80925>>>>>    UBigInt ullAvailVirtual        
80925>>>>>    UBigInt ullAvailExtendedVirtual
80925>>>>>End_Struct
80925>>>>>
80925>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
80926>>>>>
80926>>>>>Class SysinfoDisplay is a cTextEdit
80927>>>>>    Procedure Construct_Object
80929>>>>>        Forward Send Construct_Object
80931>>>>>
80931>>>>>        Set Location To 6 6
80932>>>>>        Set Size To 110 255
80933>>>>>        Set Read_Only_State To True
80934>>>>>        Set pbWrap to False
80935>>>>>    End_Procedure
80936>>>>>
80936>>>>>    //****************************************************************************
80936>>>>>    // $Module type: PROCEDURE
80936>>>>>    // $Module name: Show_Current_Directory
80936>>>>>    // $Author     : VOO
80936>>>>>    // Created     : 06-10-96 @ 15:24
80936>>>>>    //
80936>>>>>    // Description
80936>>>>>    //    This method will show the name Of the current directory in the system
80936>>>>>    //    information box
80936>>>>>    //
80936>>>>>    // $Rev History
80936>>>>>    //    06-10-96  Module header created
80936>>>>>    //****************************************************************************
80936>>>>>    Procedure Show_Current_Directory
80938>>>>>        String sDir
80938>>>>>
80938>>>>>        Get_Current_Directory To sDir
80939>>>>>
80939>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
80940>>>>>    End_Procedure
80941>>>>>
80941>>>>>    Procedure Show_Windows_Directory
80943>>>>>        String sWindir
80943>>>>>
80943>>>>>        Get_Windows_Directory To sWindir
80944>>>>>
80944>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
80945>>>>>    End_Procedure
80946>>>>>
80946>>>>>    Procedure Show_Current_User
80948>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
80949>>>>>    End_Procedure
80950>>>>>
80950>>>>>    Procedure Show_Number_Format
80952>>>>>        Integer iFormat
80952>>>>>        String sFormatText
80952>>>>>
80952>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
80955>>>>>        Move (Character (iFormat)) To sFormatText
80956>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
80957>>>>>
80957>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
80960>>>>>        Move (Character (iFormat)) to sFormatText
80961>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
80962>>>>>    End_Procedure
80963>>>>>
80963>>>>>    Procedure Show_Filelist_Name
80965>>>>>        String sFilename
80965>>>>>
80965>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
80968>>>>>
80968>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
80969>>>>>        Send AppendTextLn ""
80970>>>>>    End_Procedure
80971>>>>>
80971>>>>>    Procedure Show_Lock_Delay
80973>>>>>        Integer iLockdelay
80973>>>>>
80973>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
80976>>>>>
80976>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
80977>>>>>    End_Procedure
80978>>>>>
80978>>>>>    Procedure Show_Lock_Timeout
80980>>>>>        Integer iLockTimeout
80980>>>>>
80980>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
80983>>>>>
80983>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
80984>>>>>    End_Procedure
80985>>>>>
80985>>>>>    Procedure Show_Screen_Size
80987>>>>>        Integer iYscreensize iXscreensize
80987>>>>>
80987>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
80988>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
80989>>>>>
80989>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
80990>>>>>    End_Procedure
80991>>>>>
80991>>>>>    Procedure Show_Page_Size
80993>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
80994>>>>>    End_procedure
80995>>>>>
80995>>>>>    Procedure Show_Date
80997>>>>>        Date dToday
80997>>>>>
80997>>>>>        Sysdate dToday
80998>>>>>
80998>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
80999>>>>>    End_procedure
81000>>>>>
81000>>>>>    Procedure Show_Date_Format
81002>>>>>        Integer iDateFormat
81002>>>>>        String sDateFormat
81002>>>>>
81002>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
81005>>>>>        Case Begin
81005>>>>>            Case (iDateFormat = DF_DATE_USA)
81007>>>>>                Move C_$USA To sDateFormat
81008>>>>>                Case Break
81009>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
81012>>>>>                Move C_$European To sDateFormat
81013>>>>>                Case Break
81014>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
81017>>>>>                Move C_$Military To sDateFormat
81018>>>>>                Case Break
81019>>>>>            Case Else
81019>>>>>                Move C_$UnknownDateType To sDateFormat
81020>>>>>                Case Break
81021>>>>>        Case End
81021>>>>>
81021>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
81022>>>>>    End_Procedure
81023>>>>>
81023>>>>>    Procedure Show_Systemresources
81025>>>>>        tWinMemoryStatusEx MemoryStatusInfo
81025>>>>>        tWinMemoryStatusEx MemoryStatusInfo
81025>>>>>        Integer iRetval
81025>>>>>
81025>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
81026>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
81027>>>>>        If (iRetval = 0) Begin
81029>>>>>            Move (ShowLastError ()) to iRetval
81030>>>>>        End
81030>>>>>>
81030>>>>>
81030>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
81031>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
81032>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
81033>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
81034>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
81035>>>>>    End_Procedure
81036>>>>>
81036>>>>>    Procedure Show_Registration
81038>>>>>        String sRegName
81038>>>>>        Integer iSN iMaxUsers
81038>>>>>
81038>>>>>        Registration sRegName iSN
81039>>>>>>
81039>>>>>        
81039>>>>>        Get_Licensed_Max_Users to iMaxUsers
81040>>>>>
81040>>>>>        Send AppendTextLn ""
81041>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
81042>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
81043>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
81044>>>>>    End_Procedure
81045>>>>>
81045>>>>>    //****************************************************************************
81045>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
81045>>>>>    // To the workspace object passing the an object and message To send back
81045>>>>>    // To this object. It is expected that the workspace object will send this
81045>>>>>    // message for every line Of information it wants displayed (passing the
81045>>>>>    // information To be displayed
81045>>>>>    //****************************************************************************
81045>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
81045>>>>>
81045>>>>>    Procedure Show_ServicePack
81047>>>>>        String sKey sVersionDescription sVersion 
81047>>>>>        Handle hoRegistry
81047>>>>>        Boolean bExists bOpened
81047>>>>>        
81047>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
81048>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
81049>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
81050>>>>>
81050>>>>>        Move C_DFVersionRegistryRoot to sKey
81051>>>>>        Get KeyExists of hoRegistry sKey to bExists
81052>>>>>        If (bExists) Begin
81054>>>>>            Get OpenKey of hoRegistry sKey to bOpened
81055>>>>>            If (bOpened) Begin
81057>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
81058>>>>>                If (bExists) Begin
81060>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
81061>>>>>                End
81061>>>>>>
81061>>>>>                
81061>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
81062>>>>>                If (bExists) Begin
81064>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
81065>>>>>                End                
81065>>>>>>
81065>>>>>                Send CloseKey of hoRegistry
81066>>>>>            End
81066>>>>>>
81066>>>>>        End
81066>>>>>>
81066>>>>>        Send Destroy of hoRegistry
81067>>>>>
81067>>>>>        If (sVersionDescription <> "") Begin
81069>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
81070>>>>>           Send AppendTextLn ""
81071>>>>>        End
81071>>>>>>
81071>>>>>    End_Procedure
81072>>>>>    
81072>>>>>
81072>>>>>    Procedure Show_WorkspaceInformation
81074>>>>>        Integer hoWorkspace
81074>>>>>
81074>>>>>        If (ghoApplication <> 0) Begin
81076>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
81077>>>>>            If (hoWorkspace <> 0) Begin
81079>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
81080>>>>>                Send AppendTextLn ""
81081>>>>>            End
81081>>>>>>
81081>>>>>        End
81081>>>>>>
81081>>>>>    End_Procedure
81082>>>>>
81082>>>>>    //****************************************************************************
81082>>>>>    // If connection ids are used, we will send the message EnumerateConnections
81082>>>>>    // to the connection manager object passing the an object and message to send 
81082>>>>>    // back to this object. It is expected that the connection manager object will 
81082>>>>>    // send this message for every line Of information it wants displayed (passing 
81082>>>>>    // the information To be displayed
81082>>>>>    //****************************************************************************
81082>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
81082>>>>>
81082>>>>>    Procedure Show_ConnectionIdInformation
81084>>>>>        If (ghoConnection > 0) Begin
81086>>>>>            Send AppendTextLn ""
81087>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
81088>>>>>        End
81088>>>>>>
81088>>>>>    End_Procedure
81089>>>>>
81089>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
81091>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
81092>>>>>    End_Function
81093>>>>>
81093>>>>>    Procedure Show_Versions
81095>>>>>        Integer iVersion iRevision iBuild
81095>>>>>
81095>>>>>        Version_Information iVersion iRevision iBuild
81097>>>>>
81097>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
81098>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
81099>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
81100>>>>>    End_Procedure
81101>>>>>    
81101>>>>>    Function CKRevisionNumber String sDriverID Returns String
81103>>>>>        Handle hoCLIHandler
81103>>>>>        Handle hoDFBtrDrvHandler
81103>>>>>        String sCKRevision
81103>>>>>
81103>>>>>
81103>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
81105>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
81106>>>>>            Set psDriverID of hoCLIHandler to sDriverID
81107>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
81108>>>>>            Send Destroy of hoCLIHandler
81109>>>>>        End
81109>>>>>>
81109>>>>>        Else Begin
81110>>>>>            If (sDriverID = "DFBTRDRV") Begin
81112>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
81113>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
81114>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
81115>>>>>                Send Destroy of hoDFBtrDrvHandler
81116>>>>>            End
81116>>>>>>
81116>>>>>        End
81116>>>>>>
81116>>>>>        
81116>>>>>        Function_Return sCKRevision
81117>>>>>    End_Function
81118>>>>>    
81118>>>>>    
81118>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
81120>>>>>        
81120>>>>>        If (sDriverID = "DATAFLEX") Begin
81122>>>>>            Function_Return False
81123>>>>>        End
81123>>>>>>
81123>>>>>    
81123>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
81124>>>>>    End_Function    
81125>>>>>
81125>>>>>
81125>>>>>    //***
81125>>>>>    //*** BW
81125>>>>>    //*** Procedure: Show_Drivers
81125>>>>>    //*** Purpose  : Show loaded database drivers
81125>>>>>    //***
81125>>>>>
81125>>>>>    Procedure Show_Drivers
81127>>>>>        String sCurrentDriver sRevNumber
81127>>>>>        String sLoadedDrivers sClientDriver
81127>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
81127>>>>>        Boolean bOK 
81127>>>>>        Handle hoMsqlDrv
81127>>>>>
81127>>>>>        Move "" To sLoadedDrivers
81128>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
81131>>>>>        For iCount from 1 to iNumberOfDrivers
81137>>>>>>
81137>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
81140>>>>>            If (sLoadedDrivers <> "") Begin
81142>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
81143>>>>>            End
81143>>>>>>
81143>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
81144>>>>>            If (bOK) Begin
81146>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
81148>>>>>                    Move iCount to iMSSQLIndex
81149>>>>>                End
81149>>>>>>
81149>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
81150>>>>>                // if mssqldrv, show the client number
81150>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
81151>>>>>            End
81151>>>>>>
81151>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
81152>>>>>        Loop
81153>>>>>>
81153>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
81154>>>>>        If (iMSSQLIndex>0) Begin
81156>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
81159>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
81160>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
81161>>>>>            Send Destroy of hoMsqlDrv
81162>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
81163>>>>>        End
81163>>>>>>
81163>>>>>    End_Procedure
81164>>>>>
81164>>>>>    Procedure Show_HelpFile
81166>>>>>        String sHelpFile
81166>>>>>        Integer eHelpType
81166>>>>>
81166>>>>>        If (ghoApplication <> 0) Begin
81168>>>>>            Get peHelpType Of ghoApplication To eHelpType
81169>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
81171>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
81172>>>>>            End
81172>>>>>>
81172>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
81175>>>>>                Get Help_filename Of Help_object_id To sHelpFile
81176>>>>>            End
81176>>>>>>
81176>>>>>            Else Begin
81177>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
81178>>>>>            End
81178>>>>>>
81178>>>>>
81178>>>>>            Send AppendTextLn ""
81179>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
81180>>>>>        End
81180>>>>>>
81180>>>>>    End_Procedure
81181>>>>>
81181>>>>>    Procedure Show_EnterAsTab
81183>>>>>        Boolean bEnterKeyAsTabKey
81183>>>>>        String sText
81183>>>>>
81183>>>>>        If (ghoApplication <> 0) Begin
81185>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
81186>>>>>            If (bEnterKeyAsTabKey) Begin
81188>>>>>                Move "True" To sText
81189>>>>>            End
81189>>>>>>
81189>>>>>            Else Begin
81190>>>>>                Move "False" To sText
81191>>>>>            End
81191>>>>>>
81191>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
81192>>>>>        End
81192>>>>>>
81192>>>>>    End_Procedure
81193>>>>>
81193>>>>>    //****************************************************************************
81193>>>>>    // $Module type: PROCEDURE
81193>>>>>    // $Module name: Add_Focus
81193>>>>>    // $Author     : VOO
81193>>>>>    // Created     : 24-09-96 @ 19:43
81193>>>>>    //
81193>>>>>    // Description
81193>>>>>    //    During activation we will remove the old information and add the newly
81193>>>>>    //    found systeminformation
81193>>>>>    //
81193>>>>>    // $Rev History
81193>>>>>    //    24-09-96  Module header created
81193>>>>>    //****************************************************************************
81193>>>>>    Procedure Add_Focus Integer hoRoot
81195>>>>>        Forward Send Add_Focus hoRoot
81197>>>>>
81197>>>>>        Send Delete_Data
81198>>>>>
81198>>>>>        Set Changed_State To False
81199>>>>>        Set Read_Only_State To True
81200>>>>>
81200>>>>>        Send Show_ServicePack
81201>>>>>        Send Show_Versions   
81202>>>>>        Send Show_Drivers         
81203>>>>>        If (ghoConnection <> 0) Begin
81205>>>>>            Send Show_ConnectionIdInformation
81206>>>>>        End
81206>>>>>>
81206>>>>>        Send Show_HelpFile
81207>>>>>        Send Show_Current_Directory
81208>>>>>        Send Show_Filelist_Name          
81209>>>>>        If (ghoApplication <> 0) Begin
81211>>>>>            Send Show_WorkSpaceInformation // added To show WS info
81212>>>>>        End
81212>>>>>>
81212>>>>>        Send Show_Current_User 
81213>>>>>        Send Show_Windows_Directory 
81214>>>>>        Send Show_Screen_Size
81215>>>>>        Send Show_Page_Size
81216>>>>>        Send Show_EnterAsTab        
81217>>>>>        Send Show_Number_Format
81218>>>>>        Send Show_Date_Format
81219>>>>>        Send Show_Lock_Delay
81220>>>>>        Send Show_Lock_Timeout
81221>>>>>        Send Show_Date
81222>>>>>        Send Show_Systemresources
81223>>>>>        Send Show_Registration
81224>>>>>        Send Beginning_of_Data
81225>>>>>
81225>>>>>        Set Icon to 'default.ico'
81226>>>>>    End_Procedure
81227>>>>>End_Class
81228>>>>>
81228>>>>>//****************************************************************************
81228>>>>>// $Module type: OBJECT
81228>>>>>// $Module name: Sysinfo_Dialog
81228>>>>>// $Author     : VOO
81228>>>>>// Created     : 24-09-96 @ 18:47
81228>>>>>//
81228>>>>>// Description
81228>>>>>//    This object shows the systeminformation on the screen
81228>>>>>//
81228>>>>>// $Rev History
81228>>>>>//    24-09-96  Module header created
81228>>>>>//****************************************************************************
81228>>>>>Class SysInfoDialog Is A ModalPanel
81229>>>>>    Procedure Construct_Object
81231>>>>>        Forward Send Construct_Object
81233>>>>>
81233>>>>>        Set Label to C_$SystemInformation
81234>>>>>        Set Size to 140 267
81235>>>>>        Set piMinSize to 140 267
81236>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
81237>>>>>        Set Border_Style to Border_Thick
81238>>>>>
81238>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
81240>>>>>            Set peAnchors to anAll
81241>>>>>        End_Object
81242>>>>>
81242>>>>>        Object oCloseButton Is A Button
81244>>>>>            Set Label To C_$Close
81245>>>>>            Set Location To 120 210
81246>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
81247>>>>>            Set Default_State To True
81248>>>>>            Set peAnchors to anBottomRight
81249>>>>>        End_Object
81250>>>>>
81250>>>>>        On_Key kCancel Send Close_Panel
81251>>>>>    End_Procedure
81252>>>>>End_Class
81253>>>>>
81253>>>>>// Purpose:
81253>>>>>//
81253>>>>>// Ken Ross 12/17/96 5:16PM
81253>>>>>//
81253>>>>>Class AboutDialog Is A ModalPanel
81254>>>>>    Procedure Construct_Object
81256>>>>>        String sVdfRootDir
81256>>>>>
81256>>>>>        Forward Send Construct_Object
81258>>>>>
81258>>>>>        Set Label To C_$About
81259>>>>>        Set Size to 89 212
81260>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
81261>>>>>
81261>>>>>        Object oSysInfoDialog Is A SysInfoDialog
81263>>>>>        End_Object
81264>>>>>
81264>>>>>        Object oBox Is A Container3d
81266>>>>>            Set Border_Style To Border_StaticEdge
81267>>>>>            Set Size to 63 202
81268>>>>>            Set Location To 4 5
81269>>>>>
81269>>>>>            Object oAboutGraphic Is A BitmapContainer
81271>>>>>                Set Border_Style To Border_None
81272>>>>>                Set Bitmap_Style To Bitmap_Center
81273>>>>>                Set Size To 48 48
81274>>>>>                Set Location To 7 2
81275>>>>>            End_Object
81276>>>>>
81276>>>>>            Object oProductName Is A TextBox
81278>>>>>                Set Label To C_$ProductName
81279>>>>>                Set Size To 10 45
81280>>>>>                Set Location To 8 53
81281>>>>>            End_Object
81282>>>>>
81282>>>>>            Object oVersion Is A TextBox
81284>>>>>                Set Label To C_$Version
81285>>>>>                Set Size To 10 25
81286>>>>>                Set Location To 21 53
81287>>>>>            End_Object
81288>>>>>
81288>>>>>            Object oCopyright Is A TextBox
81290>>>>>                Set Label To C_$Copyright
81291>>>>>                Set Size To 10 31
81292>>>>>                Set Location To 34 53
81293>>>>>            End_Object
81294>>>>>
81294>>>>>            Object oAuthor Is A TextBox
81296>>>>>                Set Label To C_$Author
81297>>>>>                Set Size To 10 22
81298>>>>>                Set Location To 46 53
81299>>>>>            End_Object
81300>>>>>        End_Object
81301>>>>>
81301>>>>>        Object oOKButton Is A Button
81303>>>>>            On_Item C_$OK Send Close_Panel
81304>>>>>            Set Size To 14 50
81305>>>>>            Set Location To 71 157
81306>>>>>        End_Object
81307>>>>>
81307>>>>>        Object oSysInfoButton Is A Button
81309>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
81310>>>>>            Set Size To 14 50
81311>>>>>            Set Location To 71 101
81312>>>>>        End_Object
81313>>>>>
81313>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
81314>>>>>
81314>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
81315>>>>>    End_Procedure
81316>>>>>
81316>>>>>    Procedure Set ProductName String sProductName
81318>>>>>        Set Label Of oProductName To sProductName
81319>>>>>    End_Procedure
81320>>>>>
81320>>>>>    Procedure Set Version String sVersion
81322>>>>>        Set Label Of oVersion To sVersion
81323>>>>>    End_Procedure
81324>>>>>
81324>>>>>    Procedure Set Copyright string sCopyright
81326>>>>>        Set Label Of oCopyright To sCopyright
81327>>>>>    End_Procedure
81328>>>>>
81328>>>>>    Procedure Set Author String sAuthor
81330>>>>>        Set Label Of oAuthor To sAuthor
81331>>>>>    End_Procedure
81332>>>>>
81332>>>>>    Procedure Set Logo string sLogo
81334>>>>>        // square bitmaps Of 42x42 work best
81334>>>>>        Set Bitmap Of oAboutGraphic To sLogo
81335>>>>>    End_Procedure
81336>>>>>
81336>>>>>    Procedure Show_Sysinfo
81338>>>>>        Send Popup_Modal Of oSysinfoDialog
81339>>>>>    End_Procedure
81340>>>>>
81340>>>>>    Procedure End_Construct_Object
81342>>>>>        Handle hoVersionInfo
81342>>>>>        Boolean bIncluded
81342>>>>>        Integer iMajor iMinor iRelease iBuild
81342>>>>>        String sLabel
81342>>>>>
81342>>>>>        Get Label Of oVersion To sLabel
81343>>>>>        If (sLabel = C_$VERSION) Begin
81345>>>>>            // set it To the version info Of the program, if available
81345>>>>>            If (ghoApplication <> 0) Begin
81347>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
81348>>>>>                If (hoVersionInfo <> 0) Begin
81350>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
81351>>>>>                    If (bIncluded) Begin
81353>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
81354>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
81355>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
81356>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
81357>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
81358>>>>>                        Set Version to sLabel
81359>>>>>                    End
81359>>>>>>
81359>>>>>                End
81359>>>>>>
81359>>>>>            End
81359>>>>>>
81359>>>>>        End
81359>>>>>>
81359>>>>>
81359>>>>>        Forward Send End_Construct_Object
81361>>>>>    End_Procedure
81362>>>>>End_Class
81363>>>
81363>>>// *************************************************************************
81363>>>//  Public message. This is the default message. It is expected that you will
81363>>>//   create your own message to override this
81363>>>// *************************************************************************
81363>>>
81363>>>Procedure Activate_About
81366>>>   Send DoAbout "" "" "" "" ""
81367>>>End_Procedure
81368>>>
81368>>>// *************************************************************************
81368>>>//  Public message. It is expected that you will send this message (most
81368>>>//  likely from Activate_About. This creates an about object, activates it
81368>>>//  and destroys it when done. It is not exepected that you will augment this.
81368>>>// *************************************************************************
81368>>>
81368>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
81371>>>        integer hoObj hoMain
81371>>>
81371>>>        // create object
81371>>>        Object About is an AboutDialog
81373>>>            // if no title passed use the label of the main panel
81373>>>            // (if a main panel exists).
81373>>>            if sTitle     eq '' Begin
81375>>>                Get Main_Window of desktop to hoMain
81376>>>                if hoMain Get Label of hoMain to sTitle
81379>>>            end
81379>>>>
81379>>>            set productname to sTitle
81380>>>            set version     to sVersion
81381>>>            set copyright   to sCopyRight
81382>>>            set author      to sAuthor
81383>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
81386>>>            Move self to hoObj // object Id
81387>>>        End_Object
81388>>>        Send Popup   of hoObj    // popup the about object
81389>>>        Send Destroy of hoObj // when done, it will be destroyed
81390>>>End_procedure
81391>        Use Auto.vw
Including file: Auto.vw    (C:\Repos\DataFlexBeadando\AppSrc\Auto.vw)
81391>>>// C:\Repos\DataFlexBeadando\AppSrc\Auto.vw
81391>>>// Auto
81391>>>//
81391>>>
81391>>>Use DFClient.pkg
81391>>>Use DFEntry.pkg
81391>>>
81391>>>Use cAutoDataDictionary.dd
Including file: cAutoDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cAutoDataDictionary.dd)
81391>>>>>Use DataDict.pkg
81391>>>>>
81391>>>>>Open Auto
Including file: Auto.fd    (C:\Repos\DataFlexBeadando\DDSrc\Auto.fd)
81393>>>>>Open Munkalap
Including file: Munkalap.fd    (C:\Repos\DataFlexBeadando\DDSrc\Munkalap.fd)
81395>>>>>
81395>>>>>Register_Object Auto_sl
81395>>>>>
81395>>>>>Class cAutoDataDictionary is a DataDictionary
81396>>>>>    
81396>>>>>    Procedure Construct_Object
81398>>>>>        Forward Send Construct_Object
81400>>>>>        Set Main_File to Auto.File_Number
81401>>>>>
81401>>>>>        Set Add_Client_File to Munkalap.File_Number
81402>>>>>
81402>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81403>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81404>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81405>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81406>>>>>
81406>>>>>        Set Field_Label_Long Field Auto.Id to "Azonost"
81407>>>>>        Set Field_Label_Short Field Auto.Id to "Azon."
81408>>>>>        Set Field_Prompt_Object Field Auto.Id to Auto_sl
81409>>>>>
81409>>>>>        Set Field_Label_Long Field Auto.Alvazszam to "Alvzszm"
81410>>>>>        Set Field_Label_Short Field Auto.Alvazszam to "Alv."
81411>>>>>        Set Field_Prompt_Object Field Auto.Alvazszam to Auto_sl
81412>>>>>
81412>>>>>        Set Field_Label_Long Field Auto.Motorszam to "Motorszm"
81413>>>>>        Set Field_Label_Short Field Auto.Motorszam to "Motorsz."
81414>>>>>        Set Field_Prompt_Object Field Auto.Motorszam to Auto_sl
81415>>>>>
81415>>>>>        Set Field_Label_Long Field Auto.Marka to "Mrka"
81416>>>>>        Set Field_Label_Short Field Auto.Marka to "Mrka"
81417>>>>>
81417>>>>>        Set Field_Label_Long Field Auto.Tipus to "Tipus"
81418>>>>>        Set Field_Label_Short Field Auto.Tipus to "Tipus"
81419>>>>>
81419>>>>>        Set Field_Label_Long Field Auto.Evjarat to "Evjarat"
81420>>>>>        Set Field_Label_Short Field Auto.Evjarat to "Evj,"
81421>>>>>
81421>>>>>        Set Field_Label_Long Field Auto.UtolsoSzerviz to "Utols szervz"
81422>>>>>        Set Field_Label_Short Field Auto.UtolsoSzerviz to "Utol. szv."
81423>>>>>
81423>>>>>        Set Field_Label_Long Field Auto.KmAllas to "Kilmter lls"
81424>>>>>        Set Field_Label_Short Field Auto.KmAllas to "Km ll."
81425>>>>>
81425>>>>>    End_Procedure
81426>>>>>
81426>>>>>End_Class
81427>>>>>
81427>>>>>Use Auto.sl
Including file: Auto.sl    (C:\Repos\DataFlexBeadando\AppSrc\Auto.sl)
81427>>>>>>>// Auto.sl
81427>>>>>>>// Auto Lookup List
81427>>>>>>>
81427>>>>>>>Use DFClient.pkg
81427>>>>>>>Use cDbCJGridPromptList.pkg
81427>>>>>>>Use cDbCJGridColumn.pkg
81427>>>>>>>Use Windows.pkg
81427>>>>>>>
81427>>>>>>>Use cAutoDataDictionary.dd
81427>>>>>>>
81427>>>>>>>CD_Popup_Object Auto_sl is a dbModalPanel
81445>>>>>>>>
81445>>>>>>>    Set Location to 5 5
81446>>>>>>>    Set Size to 134 610
81447>>>>>>>    Set Label To "Auto Lookup List"
81448>>>>>>>    Set Border_Style to Border_Thick
81449>>>>>>>    Set Minimize_Icon to False
81450>>>>>>>
81450>>>>>>>
81450>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
81452>>>>>>>    End_Object 
81453>>>>>>>
81453>>>>>>>    Set Main_DD To oAuto_DD
81454>>>>>>>    Set Server  To oAuto_DD
81455>>>>>>>
81455>>>>>>>
81455>>>>>>>
81455>>>>>>>    Object oSelList is a cDbCJGridPromptList
81457>>>>>>>        Set Size to 105 600
81458>>>>>>>        Set Location to 5 5
81459>>>>>>>        Set peAnchors to anAll
81460>>>>>>>        Set psLayoutSection to "Auto_sl_oSelList"
81461>>>>>>>        Set Ordering to 1
81462>>>>>>>        Set pbAutoServer to True
81463>>>>>>>
81463>>>>>>>        Object oAuto_Id is a cDbCJGridColumn
81465>>>>>>>            Entry_Item Auto.Id
81466>>>>>>>            Set piWidth to 63
81467>>>>>>>            Set psCaption to "Azon."
81468>>>>>>>        End_Object 
81469>>>>>>>
81469>>>>>>>        Object oAuto_Alvazszam is a cDbCJGridColumn
81471>>>>>>>            Entry_Item Auto.Alvazszam
81472>>>>>>>            Set piWidth to 210
81473>>>>>>>            Set psCaption to "Alv."
81474>>>>>>>        End_Object 
81475>>>>>>>
81475>>>>>>>        Object oAuto_Motorszam is a cDbCJGridColumn
81477>>>>>>>            Entry_Item Auto.Motorszam
81478>>>>>>>            Set piWidth to 210
81479>>>>>>>            Set psCaption to "Motorsz."
81480>>>>>>>        End_Object 
81481>>>>>>>
81481>>>>>>>        Object oAuto_Marka is a cDbCJGridColumn
81483>>>>>>>            Entry_Item Auto.Marka
81484>>>>>>>            Set piWidth to 210
81485>>>>>>>            Set psCaption to "Mrka"
81486>>>>>>>        End_Object 
81487>>>>>>>
81487>>>>>>>        Object oAuto_Tipus is a cDbCJGridColumn
81489>>>>>>>            Entry_Item Auto.Tipus
81490>>>>>>>            Set piWidth to 210
81491>>>>>>>            Set psCaption to "Tipus"
81492>>>>>>>        End_Object 
81493>>>>>>>
81493>>>>>>>        Object oAuto_Evjarat is a cDbCJGridColumn
81495>>>>>>>            Entry_Item Auto.Evjarat
81496>>>>>>>            Set piWidth to 49
81497>>>>>>>            Set psCaption to "Evj,"
81498>>>>>>>        End_Object 
81499>>>>>>>
81499>>>>>>>        Object oAuto_UtolsoSzerviz is a cDbCJGridColumn
81501>>>>>>>            Entry_Item Auto.UtolsoSzerviz
81502>>>>>>>            Set piWidth to 105
81503>>>>>>>            Set psCaption to "Utol. szv."
81504>>>>>>>        End_Object 
81505>>>>>>>
81505>>>>>>>        Object oAuto_KmAllas is a cDbCJGridColumn
81507>>>>>>>            Entry_Item Auto.KmAllas
81508>>>>>>>            Set piWidth to 105
81509>>>>>>>            Set psCaption to "Km ll."
81510>>>>>>>        End_Object 
81511>>>>>>>
81511>>>>>>>
81511>>>>>>>    End_Object 
81512>>>>>>>
81512>>>>>>>    Object oOk_bn is a Button
81514>>>>>>>        Set Label to "&Ok"
81515>>>>>>>        Set Location to 115 447
81516>>>>>>>        Set peAnchors to anBottomRight
81517>>>>>>>
81517>>>>>>>        Procedure OnClick
81520>>>>>>>            Send OK of oSelList
81521>>>>>>>        End_Procedure
81522>>>>>>>
81522>>>>>>>    End_Object 
81523>>>>>>>
81523>>>>>>>    Object oCancel_bn is a Button
81525>>>>>>>        Set Label to "&Cancel"
81526>>>>>>>        Set Location to 115 501
81527>>>>>>>        Set peAnchors to anBottomRight
81528>>>>>>>
81528>>>>>>>        Procedure OnClick
81531>>>>>>>            Send Cancel of oSelList
81532>>>>>>>        End_Procedure
81533>>>>>>>
81533>>>>>>>    End_Object 
81534>>>>>>>
81534>>>>>>>    Object oSearch_bn is a Button
81536>>>>>>>        Set Label to "&Search..."
81537>>>>>>>        Set Location to 115 555
81538>>>>>>>        Set peAnchors to anBottomRight
81539>>>>>>>
81539>>>>>>>        Procedure OnClick
81542>>>>>>>            Send Search of oSelList
81543>>>>>>>        End_Procedure
81544>>>>>>>
81544>>>>>>>    End_Object 
81545>>>>>>>
81545>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81546>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81547>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81548>>>>>>>
81548>>>>>>>
81548>>>>>>>CD_End_Object // Auto_sl
81550>>>>>>>>
81550>>>
81550>>>ACTIVATE_VIEW Activate_oAuto FOR oAuto
81560>>>>
81560>>>Object oAuto is a dbView
81562>>>    Set Location to 5 5
81563>>>    Set Size to 98 349
81564>>>    Set Label To "Auto"
81565>>>    Set Border_Style to Border_Thick
81566>>>
81566>>>
81566>>>    Object oAuto_DD is a cAutoDataDictionary
81568>>>    End_Object 
81569>>>
81569>>>    Set Main_DD To oAuto_DD
81570>>>    Set Server  To oAuto_DD
81571>>>
81571>>>
81571>>>
81571>>>    Object oAutoId is a dbForm
81573>>>        Entry_Item Auto.Id
81574>>>        Set Size to 13 42
81575>>>        Set Location to 5 51
81576>>>        Set peAnchors to anTopLeftRight
81577>>>        Set Label to "Azonost"
81578>>>        Set Label_Justification_mode to jMode_Left
81579>>>        Set Label_Col_Offset to 46
81580>>>        Set Label_row_Offset to 0
81581>>>    End_Object 
81582>>>
81582>>>    Object oAutoAlvazszam is a dbForm
81584>>>        Entry_Item Auto.Alvazszam
81585>>>        Set Size to 13 126
81586>>>        Set Location to 20 51
81587>>>        Set peAnchors to anTopLeftRight
81588>>>        Set Label to "Alvzszm"
81589>>>        Set Label_Justification_mode to jMode_Left
81590>>>        Set Label_Col_Offset to 46
81591>>>        Set Label_row_Offset to 0
81592>>>    End_Object 
81593>>>
81593>>>    Object oAutoMotorszam is a dbForm
81595>>>        Entry_Item Auto.Motorszam
81596>>>        Set Size to 13 126
81597>>>        Set Location to 20 218
81598>>>        Set peAnchors to anTopRight
81599>>>        Set Label to "Motorszm"
81600>>>        Set Label_Justification_mode to jMode_Left
81601>>>        Set Label_Col_Offset to 36
81602>>>        Set Label_row_Offset to 0
81603>>>    End_Object 
81604>>>
81604>>>    Object oAutoMarka is a dbForm
81606>>>        Entry_Item Auto.Marka
81607>>>        Set Size to 13 126
81608>>>        Set Location to 35 51
81609>>>        Set peAnchors to anTopLeftRight
81610>>>        Set Label to "Mrka"
81611>>>        Set Label_Justification_mode to jMode_Left
81612>>>        Set Label_Col_Offset to 46
81613>>>        Set Label_row_Offset to 0
81614>>>    End_Object 
81615>>>
81615>>>    Object oAutoTipus is a dbForm
81617>>>        Entry_Item Auto.Tipus
81618>>>        Set Size to 13 126
81619>>>        Set Location to 35 201
81620>>>        Set peAnchors to anTopRight
81621>>>        Set Label to "Tipus"
81622>>>        Set Label_Justification_mode to jMode_Left
81623>>>        Set Label_Col_Offset to 19
81624>>>        Set Label_row_Offset to 0
81625>>>    End_Object 
81626>>>
81626>>>    Object oAutoEvjarat is a dbForm
81628>>>        Entry_Item Auto.Evjarat
81629>>>        Set Size to 13 34
81630>>>        Set Location to 50 51
81631>>>        Set peAnchors to anTopLeftRight
81632>>>        Set Label to "Evjarat"
81633>>>        Set Label_Justification_mode to jMode_Left
81634>>>        Set Label_Col_Offset to 46
81635>>>        Set Label_row_Offset to 0
81636>>>    End_Object 
81637>>>
81637>>>    Object oAutoUtolsoSzerviz is a dbForm
81639>>>        Entry_Item Auto.UtolsoSzerviz
81640>>>        Set Size to 13 66
81641>>>        Set Location to 65 51
81642>>>        Set peAnchors to anTopLeftRight
81643>>>        Set Label to "Utols szervz"
81644>>>        Set Label_Justification_mode to jMode_Left
81645>>>        Set Label_Col_Offset to 46
81646>>>        Set Label_row_Offset to 0
81647>>>    End_Object 
81648>>>
81648>>>    Object oAutoKmAllas is a dbForm
81650>>>        Entry_Item Auto.KmAllas
81651>>>        Set Size to 13 66
81652>>>        Set Location to 80 51
81653>>>        Set peAnchors to anTopLeftRight
81654>>>        Set Label to "Kilmter lls"
81655>>>        Set Label_Justification_mode to jMode_Left
81656>>>        Set Label_Col_Offset to 46
81657>>>        Set Label_row_Offset to 0
81658>>>    End_Object 
81659>>>
81659>>>
81659>>>End_Object 
81660>        Use Munka.vw
Including file: Munka.vw    (C:\Repos\DataFlexBeadando\AppSrc\Munka.vw)
81660>>>// C:\Repos\DataFlexBeadando\AppSrc\Munka.vw
81660>>>// Munka
81660>>>//
81660>>>
81660>>>Use DFClient.pkg
81660>>>Use DFEntry.pkg
81660>>>
81660>>>Use cMunkaDataDictionary.dd
Including file: cMunkaDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkaDataDictionary.dd)
81660>>>>>Use DataDict.pkg
81660>>>>>
81660>>>>>Open Munka
Including file: Munka.fd    (C:\Repos\DataFlexBeadando\DDSrc\Munka.fd)
81662>>>>>Open MunkaMunkalap
Including file: MunkaMunkalap.fd    (C:\Repos\DataFlexBeadando\DDSrc\MunkaMunkalap.fd)
81664>>>>>
81664>>>>>Register_Object Munka_sl
81664>>>>>
81664>>>>>Class cMunkaDataDictionary is a DataDictionary
81665>>>>>    
81665>>>>>    Procedure Construct_Object
81667>>>>>        Forward Send Construct_Object
81669>>>>>        Set Main_File to Munka.File_Number
81670>>>>>
81670>>>>>        Set Add_Client_File to MunkaMunkalap.File_Number
81671>>>>>
81671>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81672>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81673>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81674>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81675>>>>>
81675>>>>>        Set Field_Label_Long Field Munka.Id to "Munka azonost"
81676>>>>>        Set Field_Label_Short Field Munka.Id to "Munka azon."
81677>>>>>        Set Field_Prompt_Object Field Munka.Id to Munka_sl
81678>>>>>
81678>>>>>        Set Field_Label_Long Field Munka.Name to "Nv"
81679>>>>>        Set Field_Label_Short Field Munka.Name to "Nv"
81680>>>>>        Set Field_Prompt_Object Field Munka.Name to Munka_sl
81681>>>>>
81681>>>>>        Set Field_Label_Long Field Munka.Leiras to "Lers"
81682>>>>>        Set Field_Label_Short Field Munka.Leiras to "Lers"
81683>>>>>
81683>>>>>        Set Field_Label_Long Field Munka.Egysegar to "Egysgr"
81684>>>>>        Set Field_Label_Short Field Munka.Egysegar to "Egysgr"
81685>>>>>
81685>>>>>    End_Procedure
81686>>>>>
81686>>>>>End_Class
81687>>>>>
81687>>>>>Use Munka.sl
Including file: Munka.sl    (C:\Repos\DataFlexBeadando\AppSrc\Munka.sl)
81687>>>>>>>// Munka.sl
81687>>>>>>>// Munka Lookup List
81687>>>>>>>
81687>>>>>>>Use DFClient.pkg
81687>>>>>>>Use cDbCJGridPromptList.pkg
81687>>>>>>>Use cDbCJGridColumn.pkg
81687>>>>>>>Use Windows.pkg
81687>>>>>>>
81687>>>>>>>Use cMunkaDataDictionary.dd
81687>>>>>>>
81687>>>>>>>CD_Popup_Object Munka_sl is a dbModalPanel
81705>>>>>>>>
81705>>>>>>>    Set Location to 5 5
81706>>>>>>>    Set Size to 134 309
81707>>>>>>>    Set Label To "Munka Lookup List"
81708>>>>>>>    Set Border_Style to Border_Thick
81709>>>>>>>    Set Minimize_Icon to False
81710>>>>>>>
81710>>>>>>>
81710>>>>>>>    Object oMunka_DD is a cMunkaDataDictionary
81712>>>>>>>    End_Object 
81713>>>>>>>
81713>>>>>>>    Set Main_DD To oMunka_DD
81714>>>>>>>    Set Server  To oMunka_DD
81715>>>>>>>
81715>>>>>>>
81715>>>>>>>
81715>>>>>>>    Object oSelList is a cDbCJGridPromptList
81717>>>>>>>        Set Size to 105 299
81718>>>>>>>        Set Location to 5 5
81719>>>>>>>        Set peAnchors to anAll
81720>>>>>>>        Set psLayoutSection to "Munka_sl_oSelList"
81721>>>>>>>        Set Ordering to 1
81722>>>>>>>        Set pbAutoServer to True
81723>>>>>>>
81723>>>>>>>        Object oMunka_Id is a cDbCJGridColumn
81725>>>>>>>            Entry_Item Munka.Id
81726>>>>>>>            Set piWidth to 85
81727>>>>>>>            Set psCaption to "Munka azon."
81728>>>>>>>        End_Object 
81729>>>>>>>
81729>>>>>>>        Object oMunka_Name is a cDbCJGridColumn
81731>>>>>>>            Entry_Item Munka.Name
81732>>>>>>>            Set piWidth to 210
81733>>>>>>>            Set psCaption to "Nv"
81734>>>>>>>        End_Object 
81735>>>>>>>
81735>>>>>>>        Object oMunka_Leiras is a cDbCJGridColumn
81737>>>>>>>            Entry_Item Munka.Leiras
81738>>>>>>>            Set piWidth to 105
81739>>>>>>>            Set psCaption to "Lers"
81740>>>>>>>        End_Object 
81741>>>>>>>
81741>>>>>>>        Object oMunka_Egysegar is a cDbCJGridColumn
81743>>>>>>>            Entry_Item Munka.Egysegar
81744>>>>>>>            Set piWidth to 105
81745>>>>>>>            Set psCaption to "Egysgr"
81746>>>>>>>        End_Object 
81747>>>>>>>
81747>>>>>>>
81747>>>>>>>    End_Object 
81748>>>>>>>
81748>>>>>>>    Object oOk_bn is a Button
81750>>>>>>>        Set Label to "&Ok"
81751>>>>>>>        Set Location to 115 146
81752>>>>>>>        Set peAnchors to anBottomRight
81753>>>>>>>
81753>>>>>>>        Procedure OnClick
81756>>>>>>>            Send OK of oSelList
81757>>>>>>>        End_Procedure
81758>>>>>>>
81758>>>>>>>    End_Object 
81759>>>>>>>
81759>>>>>>>    Object oCancel_bn is a Button
81761>>>>>>>        Set Label to "&Cancel"
81762>>>>>>>        Set Location to 115 200
81763>>>>>>>        Set peAnchors to anBottomRight
81764>>>>>>>
81764>>>>>>>        Procedure OnClick
81767>>>>>>>            Send Cancel of oSelList
81768>>>>>>>        End_Procedure
81769>>>>>>>
81769>>>>>>>    End_Object 
81770>>>>>>>
81770>>>>>>>    Object oSearch_bn is a Button
81772>>>>>>>        Set Label to "&Search..."
81773>>>>>>>        Set Location to 115 254
81774>>>>>>>        Set peAnchors to anBottomRight
81775>>>>>>>
81775>>>>>>>        Procedure OnClick
81778>>>>>>>            Send Search of oSelList
81779>>>>>>>        End_Procedure
81780>>>>>>>
81780>>>>>>>    End_Object 
81781>>>>>>>
81781>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81782>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81783>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81784>>>>>>>
81784>>>>>>>
81784>>>>>>>CD_End_Object // Munka_sl
81786>>>>>>>>
81786>>>
81786>>>ACTIVATE_VIEW Activate_oMunka FOR oMunka
81796>>>>
81796>>>Object oMunka is a dbView
81798>>>    Set Location to 5 5
81799>>>    Set Size to 38 251
81800>>>    Set Label To "Munka"
81801>>>    Set Border_Style to Border_Thick
81802>>>
81802>>>
81802>>>    Object oMunka_DD is a cMunkaDataDictionary
81804>>>    End_Object 
81805>>>
81805>>>    Set Main_DD To oMunka_DD
81806>>>    Set Server  To oMunka_DD
81807>>>
81807>>>
81807>>>
81807>>>    Object oMunkaId is a dbForm
81809>>>        Entry_Item Munka.Id
81810>>>        Set Size to 13 42
81811>>>        Set Location to 5 59
81812>>>        Set peAnchors to anTopLeftRight
81813>>>        Set Label to "Munka azonost"
81814>>>        Set Label_Justification_mode to jMode_Left
81815>>>        Set Label_Col_Offset to 54
81816>>>        Set Label_row_Offset to 0
81817>>>    End_Object 
81818>>>
81818>>>    Object oMunkaName is a dbForm
81820>>>        Entry_Item Munka.Name
81821>>>        Set Size to 13 126
81822>>>        Set Location to 5 120
81823>>>        Set peAnchors to anTopRight
81824>>>        Set Label to "Nv"
81825>>>        Set Label_Justification_mode to jMode_Left
81826>>>        Set Label_Col_Offset to 14
81827>>>        Set Label_row_Offset to 0
81828>>>    End_Object 
81829>>>
81829>>>    Object oMunkaLeiras is a dbForm
81831>>>        Entry_Item Munka.Leiras
81832>>>        Set Size to 13 66
81833>>>        Set Location to 20 59
81834>>>        Set peAnchors to anTopLeftRight
81835>>>        Set Label to "Lers"
81836>>>        Set Label_Justification_mode to jMode_Left
81837>>>        Set Label_Col_Offset to 54
81838>>>        Set Label_row_Offset to 0
81839>>>    End_Object 
81840>>>
81840>>>    Object oMunkaEgysegar is a dbForm
81842>>>        Entry_Item Munka.Egysegar
81843>>>        Set Size to 13 66
81844>>>        Set Location to 20 159
81845>>>        Set peAnchors to anTopRight
81846>>>        Set Label to "Egysgr"
81847>>>        Set Label_Justification_mode to jMode_Left
81848>>>        Set Label_Col_Offset to 29
81849>>>        Set Label_row_Offset to 0
81850>>>    End_Object 
81851>>>
81851>>>
81851>>>End_Object 
81852>        Use Ugyfel.vw
Including file: Ugyfel.vw    (C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.vw)
81852>>>// C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.vw
81852>>>// Ugyfel
81852>>>//
81852>>>
81852>>>Use DFClient.pkg
81852>>>Use DFEntry.pkg
81852>>>
81852>>>Use cUgyfelDataDictionary.dd
Including file: cUgyfelDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cUgyfelDataDictionary.dd)
81852>>>>>Use DataDict.pkg
81852>>>>>
81852>>>>>Open Ugyfel
Including file: Ugyfel.fd    (C:\Repos\DataFlexBeadando\DDSrc\Ugyfel.fd)
81854>>>>>Open Munkalap
81856>>>>>
81856>>>>>Register_Object Ugyfel_sl
81856>>>>>
81856>>>>>Class cUgyfelDataDictionary is a DataDictionary
81857>>>>>    
81857>>>>>    Procedure Construct_Object
81859>>>>>        Forward Send Construct_Object
81861>>>>>        Set Main_File to Ugyfel.File_Number
81862>>>>>
81862>>>>>        Set Add_Client_File to Munkalap.File_Number
81863>>>>>
81863>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81864>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81865>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81866>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81867>>>>>
81867>>>>>        Set Field_Label_Long Field Ugyfel.Id to "gyfl azonost"
81868>>>>>        Set Field_Label_Short Field Ugyfel.Id to "gyf. azon."
81869>>>>>        Set Field_Prompt_Object Field Ugyfel.Id to Ugyfel_sl
81870>>>>>
81870>>>>>        Set Field_Label_Long Field Ugyfel.Nev to "Nv"
81871>>>>>        Set Field_Label_Short Field Ugyfel.Nev to "Nv"
81872>>>>>        Set Field_Prompt_Object Field Ugyfel.Nev to Ugyfel_sl
81873>>>>>
81873>>>>>        Set Field_Mask Field Ugyfel.Adoszam to "########-#-##"
81874>>>>>        Set Field_Label_Long Field Ugyfel.Adoszam to "Adszm"
81875>>>>>        Set Field_Label_Short Field Ugyfel.Adoszam to "A.sz."
81876>>>>>
81876>>>>>        Set Field_Label_Long Field Ugyfel.Cim to "Cm"
81877>>>>>        Set Field_Label_Short Field Ugyfel.Cim to "Cm"
81878>>>>>
81878>>>>>        Set Field_Label_Long Field Ugyfel.Telefon to "Telefon"
81879>>>>>        Set Field_Label_Short Field Ugyfel.Telefon to "tel."
81880>>>>>        Set Field_Mask Field Ugyfel.Telefon to "+##-##-###-####"
81881>>>>>
81881>>>>>        Set Field_Label_Long Field Ugyfel.Bankszamla to "Bankszmla"
81882>>>>>        Set Field_Label_Short Field Ugyfel.Bankszamla to "Bszla."
81883>>>>>        Set Field_Mask Field Ugyfel.Bankszamla to "#######-########-########"
81884>>>>>
81884>>>>>    End_Procedure
81885>>>>>
81885>>>>>End_Class
81886>>>>>
81886>>>>>Use Ugyfel.sl
Including file: Ugyfel.sl    (C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.sl)
81886>>>>>>>// Ugyfel.sl
81886>>>>>>>// Ugyfel Lookup List
81886>>>>>>>
81886>>>>>>>Use DFClient.pkg
81886>>>>>>>Use cDbCJGridPromptList.pkg
81886>>>>>>>Use cDbCJGridColumn.pkg
81886>>>>>>>Use Windows.pkg
81886>>>>>>>
81886>>>>>>>Use cUgyfelDataDictionary.dd
81886>>>>>>>
81886>>>>>>>CD_Popup_Object Ugyfel_sl is a dbModalPanel
81904>>>>>>>>
81904>>>>>>>    Set Location to 5 5
81905>>>>>>>    Set Size to 134 610
81906>>>>>>>    Set Label To "Ugyfel Lookup List"
81907>>>>>>>    Set Border_Style to Border_Thick
81908>>>>>>>    Set Minimize_Icon to False
81909>>>>>>>
81909>>>>>>>
81909>>>>>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
81911>>>>>>>    End_Object 
81912>>>>>>>
81912>>>>>>>    Set Main_DD To oUgyfel_DD
81913>>>>>>>    Set Server  To oUgyfel_DD
81914>>>>>>>
81914>>>>>>>
81914>>>>>>>
81914>>>>>>>    Object oSelList is a cDbCJGridPromptList
81916>>>>>>>        Set Size to 105 600
81917>>>>>>>        Set Location to 5 5
81918>>>>>>>        Set peAnchors to anAll
81919>>>>>>>        Set psLayoutSection to "Ugyfel_sl_oSelList"
81920>>>>>>>        Set Ordering to 1
81921>>>>>>>        Set pbAutoServer to True
81922>>>>>>>
81922>>>>>>>        Object oUgyfel_Id is a cDbCJGridColumn
81924>>>>>>>            Entry_Item Ugyfel.Id
81925>>>>>>>            Set piWidth to 77
81926>>>>>>>            Set psCaption to "gyf. azon."
81927>>>>>>>        End_Object 
81928>>>>>>>
81928>>>>>>>        Object oUgyfel_Nev is a cDbCJGridColumn
81930>>>>>>>            Entry_Item Ugyfel.Nev
81931>>>>>>>            Set piWidth to 262
81932>>>>>>>            Set psCaption to "Nv"
81933>>>>>>>        End_Object 
81934>>>>>>>
81934>>>>>>>        Object oUgyfel_Adoszam is a cDbCJGridColumn
81936>>>>>>>            Entry_Item Ugyfel.Adoszam
81937>>>>>>>            Set piWidth to 136
81938>>>>>>>            Set psCaption to "A.sz."
81939>>>>>>>        End_Object 
81940>>>>>>>
81940>>>>>>>        Object oUgyfel_Cim is a cDbCJGridColumn
81942>>>>>>>            Entry_Item Ugyfel.Cim
81943>>>>>>>            Set piWidth to 262
81944>>>>>>>            Set psCaption to "Cm"
81945>>>>>>>        End_Object 
81946>>>>>>>
81946>>>>>>>        Object oUgyfel_Telefon is a cDbCJGridColumn
81948>>>>>>>            Entry_Item Ugyfel.Telefon
81949>>>>>>>            Set piWidth to 126
81950>>>>>>>            Set psCaption to "tel."
81951>>>>>>>        End_Object 
81952>>>>>>>
81952>>>>>>>        Object oUgyfel_Bankszamla is a cDbCJGridColumn
81954>>>>>>>            Entry_Item Ugyfel.Bankszamla
81955>>>>>>>            Set piWidth to 262
81956>>>>>>>            Set psCaption to "Bszla."
81957>>>>>>>        End_Object 
81958>>>>>>>
81958>>>>>>>
81958>>>>>>>    End_Object 
81959>>>>>>>
81959>>>>>>>    Object oOk_bn is a Button
81961>>>>>>>        Set Label to "&Ok"
81962>>>>>>>        Set Location to 115 447
81963>>>>>>>        Set peAnchors to anBottomRight
81964>>>>>>>
81964>>>>>>>        Procedure OnClick
81967>>>>>>>            Send OK of oSelList
81968>>>>>>>        End_Procedure
81969>>>>>>>
81969>>>>>>>    End_Object 
81970>>>>>>>
81970>>>>>>>    Object oCancel_bn is a Button
81972>>>>>>>        Set Label to "&Cancel"
81973>>>>>>>        Set Location to 115 501
81974>>>>>>>        Set peAnchors to anBottomRight
81975>>>>>>>
81975>>>>>>>        Procedure OnClick
81978>>>>>>>            Send Cancel of oSelList
81979>>>>>>>        End_Procedure
81980>>>>>>>
81980>>>>>>>    End_Object 
81981>>>>>>>
81981>>>>>>>    Object oSearch_bn is a Button
81983>>>>>>>        Set Label to "&Search..."
81984>>>>>>>        Set Location to 115 555
81985>>>>>>>        Set peAnchors to anBottomRight
81986>>>>>>>
81986>>>>>>>        Procedure OnClick
81989>>>>>>>            Send Search of oSelList
81990>>>>>>>        End_Procedure
81991>>>>>>>
81991>>>>>>>    End_Object 
81992>>>>>>>
81992>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81993>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81994>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81995>>>>>>>
81995>>>>>>>
81995>>>>>>>CD_End_Object // Ugyfel_sl
81997>>>>>>>>
81997>>>
81997>>>ACTIVATE_VIEW Activate_oUgyfel FOR oUgyfel
82007>>>>
82007>>>Object oUgyfel is a dbView
82009>>>    Set Location to 5 5
82010>>>    Set Size to 83 350
82011>>>    Set Label To "Ugyfel"
82012>>>    Set Border_Style to Border_Thick
82013>>>
82013>>>
82013>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82015>>>    End_Object 
82016>>>
82016>>>    Set Main_DD To oUgyfel_DD
82017>>>    Set Server  To oUgyfel_DD
82018>>>
82018>>>
82018>>>
82018>>>    Object oUgyfelId is a dbForm
82020>>>        Entry_Item Ugyfel.Id
82021>>>        Set Size to 13 42
82022>>>        Set Location to 5 57
82023>>>        Set peAnchors to anTopLeftRight
82024>>>        Set Label to "gyfl azonost"
82025>>>        Set Label_Justification_mode to jMode_Left
82026>>>        Set Label_Col_Offset to 52
82027>>>        Set Label_row_Offset to 0
82028>>>    End_Object 
82029>>>
82029>>>    Object oUgyfelNev is a dbForm
82031>>>        Entry_Item Ugyfel.Nev
82032>>>        Set Size to 13 250
82033>>>        Set Location to 20 57
82034>>>        Set peAnchors to anTopLeftRight
82035>>>        Set Label to "Nv"
82036>>>        Set Label_Justification_mode to jMode_Left
82037>>>        Set Label_Col_Offset to 52
82038>>>        Set Label_row_Offset to 0
82039>>>    End_Object 
82040>>>
82040>>>    Object oUgyfelAdoszam is a dbForm
82042>>>        Entry_Item Ugyfel.Adoszam
82043>>>        Set Size to 13 84
82044>>>        Set Location to 35 57
82045>>>        Set peAnchors to anTopLeftRight
82046>>>        Set Label to "Adszm"
82047>>>        Set Label_Justification_mode to jMode_Left
82048>>>        Set Label_Col_Offset to 52
82049>>>        Set Label_row_Offset to 0
82050>>>    End_Object 
82051>>>
82051>>>    Object oUgyfelCim is a dbForm
82053>>>        Entry_Item Ugyfel.Cim
82054>>>        Set Size to 13 250
82055>>>        Set Location to 50 57
82056>>>        Set peAnchors to anTopLeftRight
82057>>>        Set Label to "Cm"
82058>>>        Set Label_Justification_mode to jMode_Left
82059>>>        Set Label_Col_Offset to 52
82060>>>        Set Label_row_Offset to 0
82061>>>    End_Object 
82062>>>
82062>>>    Object oUgyfelTelefon is a dbForm
82064>>>        Entry_Item Ugyfel.Telefon
82065>>>        Set Size to 13 78
82066>>>        Set Location to 65 57
82067>>>        Set peAnchors to anTopLeftRight
82068>>>        Set Label to "Telefon"
82069>>>        Set Label_Justification_mode to jMode_Left
82070>>>        Set Label_Col_Offset to 52
82071>>>        Set Label_row_Offset to 0
82072>>>    End_Object 
82073>>>
82073>>>    Object oUgyfelBankszamla is a dbForm
82075>>>        Entry_Item Ugyfel.Bankszamla
82076>>>        Set Size to 13 168
82077>>>        Set Location to 65 177
82078>>>        Set peAnchors to anTopRight
82079>>>        Set Label to "Bankszmla"
82080>>>        Set Label_Justification_mode to jMode_Left
82081>>>        Set Label_Col_Offset to 37
82082>>>        Set Label_row_Offset to 0
82083>>>    End_Object 
82084>>>
82084>>>
82084>>>End_Object 
82085>        Use Munkalap.vw
Including file: Munkalap.vw    (C:\Repos\DataFlexBeadando\AppSrc\Munkalap.vw)
82085>>>// C:\Repos\DataFlexBeadando\AppSrc\Munkalap.vw
82085>>>// Munkalap
82085>>>//
82085>>>
82085>>>Use DFClient.pkg
82085>>>Use DFEntry.pkg
82085>>>Use cDbCJGrid.pkg
82085>>>Use cDbCJGridColumn.pkg
82085>>>
82085>>>Use cUgyfelDataDictionary.dd
82085>>>Use cAutoDataDictionary.dd
82085>>>Use cMunkalapDataDictionary.dd
Including file: cMunkalapDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkalapDataDictionary.dd)
82085>>>>>Use DataDict.pkg
82085>>>>>
82085>>>>>Open Munkalap
82087>>>>>Open Auto
82089>>>>>Open Ugyfel
82091>>>>>Open MunkaMunkalap
82093>>>>>
82093>>>>>Register_Object Munkalap_sl
82093>>>>>
82093>>>>>Class cMunkalapDataDictionary is a DataDictionary
82094>>>>>    
82094>>>>>    Procedure Construct_Object
82096>>>>>        Forward Send Construct_Object
82098>>>>>        Set Main_File to Munkalap.File_Number
82099>>>>>
82099>>>>>        Set Add_Client_File to MunkaMunkalap.File_Number
82100>>>>>
82100>>>>>        Set Add_Server_File to Auto.File_Number
82101>>>>>        Set Add_Server_File to Ugyfel.File_Number
82102>>>>>
82102>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
82103>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
82104>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
82105>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
82106>>>>>
82106>>>>>        Set Field_Label_Long Field Munkalap.Id to "Munkalap azonost"
82107>>>>>        Set Field_Label_Short Field Munkalap.Id to "Munkalap azon."
82108>>>>>        Set Field_Prompt_Object Field Munkalap.Id to Munkalap_sl
82109>>>>>
82109>>>>>        Set Field_Label_Long Field Munkalap.Rogzites to "Rgzts"
82110>>>>>        Set Field_Label_Short Field Munkalap.Rogzites to "Rgz."
82111>>>>>
82111>>>>>        Set Field_Prompt_Object Field Munkalap.UgyfelId to Munkalap_sl
82112>>>>>
82112>>>>>        Set Field_Prompt_Object Field Munkalap.AutoId to Munkalap_sl
82113>>>>>
82113>>>>>        Set Field_Label_Long Field Munkalap.Behozatal to "Behozatal"
82114>>>>>        Set Field_Label_Short Field Munkalap.Behozatal to "Behoz."
82115>>>>>
82115>>>>>        Set Field_Label_Long Field Munkalap.Elvitel to "Elvitel"
82116>>>>>        Set Field_Label_Short Field Munkalap.Elvitel to "Elvitel"
82117>>>>>
82117>>>>>        Set Field_Label_Long Field Munkalap.Akm to "Kilmter eltte"
82118>>>>>        Set Field_Label_Short Field Munkalap.Akm to "Km eltte"
82119>>>>>
82119>>>>>        Set Field_Label_Long Field Munkalap.Bkm to "Kilmterlls utns"
82120>>>>>        Set Field_Label_Short Field Munkalap.Bkm to "Km utna"
82121>>>>>
82121>>>>>    End_Procedure
82122>>>>>
82122>>>>>End_Class
82123>>>>>
82123>>>>>Use Munkalap.sl
Including file: Munkalap.sl    (C:\Repos\DataFlexBeadando\AppSrc\Munkalap.sl)
82123>>>>>>>// Munkalap.sl
82123>>>>>>>// Munkalap Lookup List
82123>>>>>>>
82123>>>>>>>Use DFClient.pkg
82123>>>>>>>Use cDbCJGridPromptList.pkg
82123>>>>>>>Use cDbCJGridColumn.pkg
82123>>>>>>>Use Windows.pkg
82123>>>>>>>
82123>>>>>>>Use cUgyfelDataDictionary.dd
82123>>>>>>>Use cAutoDataDictionary.dd
82123>>>>>>>Use cMunkalapDataDictionary.dd
82123>>>>>>>
82123>>>>>>>CD_Popup_Object Munkalap_sl is a dbModalPanel
82141>>>>>>>>
82141>>>>>>>    Set Location to 5 5
82142>>>>>>>    Set Size to 134 450
82143>>>>>>>    Set Label To "Munkalap Lookup List"
82144>>>>>>>    Set Border_Style to Border_Thick
82145>>>>>>>    Set Minimize_Icon to False
82146>>>>>>>
82146>>>>>>>
82146>>>>>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82148>>>>>>>    End_Object 
82149>>>>>>>
82149>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
82151>>>>>>>    End_Object 
82152>>>>>>>
82152>>>>>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
82154>>>>>>>        Set DDO_Server To oAuto_DD
82155>>>>>>>        Set DDO_Server To oUgyfel_DD
82156>>>>>>>    End_Object 
82157>>>>>>>
82157>>>>>>>    Set Main_DD To oMunkalap_DD
82158>>>>>>>    Set Server  To oMunkalap_DD
82159>>>>>>>
82159>>>>>>>
82159>>>>>>>
82159>>>>>>>    Object oSelList is a cDbCJGridPromptList
82161>>>>>>>        Set Size to 105 440
82162>>>>>>>        Set Location to 5 5
82163>>>>>>>        Set peAnchors to anAll
82164>>>>>>>        Set psLayoutSection to "Munkalap_sl_oSelList"
82165>>>>>>>        Set Ordering to 1
82166>>>>>>>        Set pbAutoServer to True
82167>>>>>>>
82167>>>>>>>        Object oMunkalap_Id is a cDbCJGridColumn
82169>>>>>>>            Entry_Item Munkalap.Id
82170>>>>>>>            Set piWidth to 101
82171>>>>>>>            Set psCaption to "Munkalap azon."
82172>>>>>>>        End_Object 
82173>>>>>>>
82173>>>>>>>        Object oMunkalap_Rogzites is a cDbCJGridColumn
82175>>>>>>>            Entry_Item Munkalap.Rogzites
82176>>>>>>>            Set piWidth to 105
82177>>>>>>>            Set psCaption to "Rgz."
82178>>>>>>>        End_Object 
82179>>>>>>>
82179>>>>>>>        Object oUgyfel_Id is a cDbCJGridColumn
82181>>>>>>>            Entry_Item Ugyfel.Id
82182>>>>>>>            Set piWidth to 63
82183>>>>>>>            Set psCaption to "UgyfelId"
82184>>>>>>>        End_Object 
82185>>>>>>>
82185>>>>>>>        Object oAuto_Id is a cDbCJGridColumn
82187>>>>>>>            Entry_Item Auto.Id
82188>>>>>>>            Set piWidth to 63
82189>>>>>>>            Set psCaption to "AutoId"
82190>>>>>>>        End_Object 
82191>>>>>>>
82191>>>>>>>        Object oMunkalap_Behozatal is a cDbCJGridColumn
82193>>>>>>>            Entry_Item Munkalap.Behozatal
82194>>>>>>>            Set piWidth to 105
82195>>>>>>>            Set psCaption to "Behoz."
82196>>>>>>>        End_Object 
82197>>>>>>>
82197>>>>>>>        Object oMunkalap_Elvitel is a cDbCJGridColumn
82199>>>>>>>            Entry_Item Munkalap.Elvitel
82200>>>>>>>            Set piWidth to 105
82201>>>>>>>            Set psCaption to "Elvitel"
82202>>>>>>>        End_Object 
82203>>>>>>>
82203>>>>>>>        Object oMunkalap_Akm is a cDbCJGridColumn
82205>>>>>>>            Entry_Item Munkalap.Akm
82206>>>>>>>            Set piWidth to 105
82207>>>>>>>            Set psCaption to "Km eltte"
82208>>>>>>>        End_Object 
82209>>>>>>>
82209>>>>>>>        Object oMunkalap_Bkm is a cDbCJGridColumn
82211>>>>>>>            Entry_Item Munkalap.Bkm
82212>>>>>>>            Set piWidth to 105
82213>>>>>>>            Set psCaption to "Km utna"
82214>>>>>>>        End_Object 
82215>>>>>>>
82215>>>>>>>
82215>>>>>>>    End_Object 
82216>>>>>>>
82216>>>>>>>    Object oOk_bn is a Button
82218>>>>>>>        Set Label to "&Ok"
82219>>>>>>>        Set Location to 115 287
82220>>>>>>>        Set peAnchors to anBottomRight
82221>>>>>>>
82221>>>>>>>        Procedure OnClick
82224>>>>>>>            Send OK of oSelList
82225>>>>>>>        End_Procedure
82226>>>>>>>
82226>>>>>>>    End_Object 
82227>>>>>>>
82227>>>>>>>    Object oCancel_bn is a Button
82229>>>>>>>        Set Label to "&Cancel"
82230>>>>>>>        Set Location to 115 341
82231>>>>>>>        Set peAnchors to anBottomRight
82232>>>>>>>
82232>>>>>>>        Procedure OnClick
82235>>>>>>>            Send Cancel of oSelList
82236>>>>>>>        End_Procedure
82237>>>>>>>
82237>>>>>>>    End_Object 
82238>>>>>>>
82238>>>>>>>    Object oSearch_bn is a Button
82240>>>>>>>        Set Label to "&Search..."
82241>>>>>>>        Set Location to 115 395
82242>>>>>>>        Set peAnchors to anBottomRight
82243>>>>>>>
82243>>>>>>>        Procedure OnClick
82246>>>>>>>            Send Search of oSelList
82247>>>>>>>        End_Procedure
82248>>>>>>>
82248>>>>>>>    End_Object 
82249>>>>>>>
82249>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
82250>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
82251>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
82252>>>>>>>
82252>>>>>>>
82252>>>>>>>CD_End_Object // Munkalap_sl
82254>>>>>>>>
82254>>>Use cMunkaDataDictionary.dd
82254>>>Use cMunkaMunkalapDataDictionary.dd
Including file: cMunkaMunkalapDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkaMunkalapDataDictionary.dd)
82254>>>>>Use DataDict.pkg
82254>>>>>
82254>>>>>Open MunkaMunkalap
82256>>>>>Open Munkalap
82258>>>>>Open Munka
82260>>>>>
82260>>>>>Class cMunkaMunkalapDataDictionary is a DataDictionary
82261>>>>>    
82261>>>>>    Procedure Construct_Object
82263>>>>>        Forward Send Construct_Object
82265>>>>>        Set Main_File to MunkaMunkalap.File_Number
82266>>>>>
82266>>>>>        Set Add_Server_File to Munkalap.File_Number
82267>>>>>        Set Add_Server_File to Munka.File_Number
82268>>>>>
82268>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
82269>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
82270>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
82271>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
82272>>>>>
82272>>>>>    End_Procedure
82273>>>>>
82273>>>>>End_Class
82274>>>
82274>>>ACTIVATE_VIEW Activate_oMunkalap FOR oMunkalap
82284>>>>
82284>>>Object oMunkalap is a dbView
82286>>>    Set Location to 5 5
82287>>>    Set Size to 249 369
82288>>>    Set Label To "Munkalap"
82289>>>    Set Border_Style to Border_Thick
82290>>>
82290>>>
82290>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82292>>>    End_Object 
82293>>>
82293>>>    Object oAuto_DD is a cAutoDataDictionary
82295>>>    End_Object 
82296>>>
82296>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
82298>>>        Set DDO_Server To oAuto_DD
82299>>>        Set DDO_Server To oUgyfel_DD
82300>>>        // this lets you save a new parent DD from within child DD
82300>>>        Set Allow_Foreign_New_Save_State to True
82301>>>    End_Object 
82302>>>
82302>>>    Object oMunka_DD is a cMunkaDataDictionary
82304>>>    End_Object 
82305>>>
82305>>>    Object oMunkaMunkalap_DD is a cMunkaMunkalapDataDictionary
82307>>>        Set DDO_Server To oMunkalap_DD
82308>>>        Set DDO_Server To oMunka_DD
82309>>>        Set Constrain_File To Munkalap.File_Number
82310>>>    End_Object 
82311>>>
82311>>>    Set Main_DD To oMunkalap_DD
82312>>>    Set Server  To oMunkalap_DD
82313>>>
82313>>>
82313>>>
82313>>>    Object oMunkalapId is a dbForm
82315>>>        Entry_Item Munkalap.Id
82316>>>        Set Size to 13 42
82317>>>        Set Location to 5 68
82318>>>        Set peAnchors to anTopLeftRight
82319>>>        Set Label to "Munkalap azonost"
82320>>>        Set Label_Justification_mode to jMode_Left
82321>>>        Set Label_Col_Offset to 63
82322>>>        Set Label_row_Offset to 0
82323>>>    End_Object 
82324>>>
82324>>>    Object oUgyfelId is a dbForm
82326>>>        Entry_Item Ugyfel.Id
82327>>>        Set Size to 13 42
82328>>>        Set Location to 20 68
82329>>>        Set peAnchors to anTopLeftRight
82330>>>        Set Label to "gyfl azonost"
82331>>>        Set Label_Justification_mode to jMode_Left
82332>>>        Set Label_Col_Offset to 63
82333>>>        Set Label_row_Offset to 0
82334>>>    End_Object 
82335>>>
82335>>>    Object oUgyfelNev is a dbForm
82337>>>        Entry_Item Ugyfel.Nev
82338>>>        Set Size to 13 250
82339>>>        Set Location to 35 68
82340>>>        Set peAnchors to anTopLeftRight
82341>>>        Set Label to "Nv"
82342>>>        Set Label_Justification_mode to jMode_Left
82343>>>        Set Label_Col_Offset to 63
82344>>>        Set Label_row_Offset to 0
82345>>>    End_Object 
82346>>>
82346>>>    Object oAutoId is a dbForm
82348>>>        Entry_Item Auto.Id
82349>>>        Set Size to 13 42
82350>>>        Set Location to 50 68
82351>>>        Set peAnchors to anTopLeftRight
82352>>>        Set Label to "Azonost"
82353>>>        Set Label_Justification_mode to jMode_Left
82354>>>        Set Label_Col_Offset to 63
82355>>>        Set Label_row_Offset to 0
82356>>>    End_Object 
82357>>>
82357>>>    Object oAutoAlvazszam is a dbForm
82359>>>        Entry_Item Auto.Alvazszam
82360>>>        Set Size to 13 126
82361>>>        Set Location to 65 68
82362>>>        Set peAnchors to anTopLeftRight
82363>>>        Set Label to "Alvzszm"
82364>>>        Set Label_Justification_mode to jMode_Left
82365>>>        Set Label_Col_Offset to 63
82366>>>        Set Label_row_Offset to 0
82367>>>    End_Object 
82368>>>
82368>>>    Object oAutoMotorszam is a dbForm
82370>>>        Entry_Item Auto.Motorszam
82371>>>        Set Size to 13 126
82372>>>        Set Location to 80 68
82373>>>        Set peAnchors to anTopLeftRight
82374>>>        Set Label to "Motorszm"
82375>>>        Set Label_Justification_mode to jMode_Left
82376>>>        Set Label_Col_Offset to 63
82377>>>        Set Label_row_Offset to 0
82378>>>    End_Object 
82379>>>
82379>>>    Object oMunkalapRogzites is a dbForm
82381>>>        Entry_Item Munkalap.Rogzites
82382>>>        Set Size to 13 66
82383>>>        Set Location to 95 68
82384>>>        Set peAnchors to anTopLeftRight
82385>>>        Set Label to "Rgzts"
82386>>>        Set Label_Justification_mode to jMode_Left
82387>>>        Set Label_Col_Offset to 63
82388>>>        Set Label_row_Offset to 0
82389>>>    End_Object 
82390>>>
82390>>>    Object oMunkalapBehozatal is a dbForm
82392>>>        Entry_Item Munkalap.Behozatal
82393>>>        Set Size to 13 66
82394>>>        Set Location to 110 68
82395>>>        Set peAnchors to anTopLeftRight
82396>>>        Set Label to "Behozatal"
82397>>>        Set Label_Justification_mode to jMode_Left
82398>>>        Set Label_Col_Offset to 63
82399>>>        Set Label_row_Offset to 0
82400>>>    End_Object 
82401>>>
82401>>>    Object oMunkalapElvitel is a dbForm
82403>>>        Entry_Item Munkalap.Elvitel
82404>>>        Set Size to 13 66
82405>>>        Set Location to 125 68
82406>>>        Set peAnchors to anTopLeftRight
82407>>>        Set Label to "Elvitel"
82408>>>        Set Label_Justification_mode to jMode_Left
82409>>>        Set Label_Col_Offset to 63
82410>>>        Set Label_row_Offset to 0
82411>>>    End_Object 
82412>>>
82412>>>    Object oMunkalapAkm is a dbForm
82414>>>        Entry_Item Munkalap.Akm
82415>>>        Set Size to 13 66
82416>>>        Set Location to 140 68
82417>>>        Set peAnchors to anTopLeftRight
82418>>>        Set Label to "Kilmter eltte"
82419>>>        Set Label_Justification_mode to jMode_Left
82420>>>        Set Label_Col_Offset to 63
82421>>>        Set Label_row_Offset to 0
82422>>>    End_Object 
82423>>>
82423>>>    Object oMunkalapBkm is a dbForm
82425>>>        Entry_Item Munkalap.Bkm
82426>>>        Set Size to 13 66
82427>>>        Set Location to 155 68
82428>>>        Set peAnchors to anTopLeftRight
82429>>>        Set Label to "Kilmterlls utns"
82430>>>        Set Label_Justification_mode to jMode_Left
82431>>>        Set Label_Col_Offset to 63
82432>>>        Set Label_row_Offset to 0
82433>>>    End_Object 
82434>>>
82434>>>    Object oDetailGrid is a cDbCJGrid
82436>>>        Set Size to 66 359
82437>>>        Set Location to 178 5
82438>>>        Set Server to oMunkaMunkalap_DD
82439>>>        Set Ordering to 1
82440>>>        Set peAnchors to anAll
82441>>>        Set psLayoutSection to "oMunkalap_oDetailGrid"
82442>>>        Set pbAllowInsertRow to False
82443>>>        Set pbHeaderPrompts to True
82444>>>
82444>>>        Object oMunka_Id is a cDbCJGridColumn
82446>>>            Entry_Item Munka.Id
82447>>>            Set piWidth to 85
82448>>>            Set psCaption to "Munka azon."
82449>>>        End_Object 
82450>>>
82450>>>        Object oMunka_Name is a cDbCJGridColumn
82452>>>            Entry_Item Munka.Name
82453>>>            Set piWidth to 210
82454>>>            Set psCaption to "Nv"
82455>>>        End_Object 
82456>>>
82456>>>        Object oMunka_Leiras is a cDbCJGridColumn
82458>>>            Entry_Item Munka.Leiras
82459>>>            Set piWidth to 105
82460>>>            Set psCaption to "Lers"
82461>>>        End_Object 
82462>>>
82462>>>        Object oMunka_Egysegar is a cDbCJGridColumn
82464>>>            Entry_Item Munka.Egysegar
82465>>>            Set piWidth to 105
82466>>>            Set psCaption to "Egysgr"
82467>>>        End_Object 
82468>>>
82468>>>        Object oMunkaMunkalap_Darab is a cDbCJGridColumn
82470>>>            Entry_Item MunkaMunkalap.Darab
82471>>>            Set piWidth to 105
82472>>>            Set psCaption to "Darab"
82473>>>        End_Object 
82474>>>
82474>>>    End_Object 
82475>>>
82475>>>    //-----------------------------------------------------------------------
82475>>>    // Create custom confirmation messages for save and delete
82475>>>    // We must create the new functions and assign verify messages
82475>>>    // to them.
82475>>>    //-----------------------------------------------------------------------
82475>>>
82475>>>    Function ConfirmDeleteHeader Returns Boolean
82478>>>        Boolean bFail
82478>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
82479>>>        Function_Return bFail
82480>>>    End_Function 
82481>>>
82481>>>    // Only confirm on the saving of new records
82481>>>    Function ConfirmSaveHeader Returns Boolean
82484>>>        Boolean bNoSave bHasRecord
82484>>>        Handle  hoSrvr
82484>>>        Get Server to hoSrvr
82485>>>        Get HasRecord of hoSrvr to bHasRecord
82486>>>        If not bHasRecord Begin
82488>>>            Get Confirm "Save this NEW header?" to bNoSave
82489>>>        End
82489>>>>
82489>>>        Function_Return bNoSave
82490>>>    End_Function 
82491>>>
82491>>>    // Define alternate confirmation Messages
82491>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
82492>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
82493>>>    // Saves in header should not clear the view
82493>>>    Set Auto_Clear_Deo_State to False
82494>>>
82494>>>
82494>>>End_Object 
82495>        Use GyakorisagRiport.rv
Including file: GyakorisagRiport.rv    (C:\Repos\DataFlexBeadando\AppSrc\GyakorisagRiport.rv)
82495>>>// GyakorisagRiport.rv
82495>>>// GyakorisagRiport
82495>>>Register_Object oReport
82495>>>
82495>>>Use DFRptVw.pkg
82495>>>Use cWinReport2.pkg
Including file: cWinReport2.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cWinReport2.pkg)
82495>>>>>// cWinReport2.pkg
82495>>>>>
82495>>>>>// defines support for new Winprint2 cWinReport2 class
82495>>>>>
82495>>>>>
82495>>>>>Use DFRpt.pkg              // BasicReport RO Class for VDF
82495>>>>>Use WinPrint2.pkg          // WinPrint2 engine
Including file: Winprint2.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Winprint2.pkg)
82495>>>>>>>// WinPrint2.pkg
82495>>>>>>>//
82495>>>>>>>Use windows.pkg
82495>>>>>>>Use LanguageText.pkg
82495>>>>>>>Use DLL.pkg
82495>>>>>>>Use WinPrint2_Api.pkg
Including file: WinPrint2_API.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\WinPrint2_API.pkg)
82495>>>>>>>>>//WinPrint2_API.pkg
82495>>>>>>>>>
82495>>>>>>>>>Use DLL.pkg
82495>>>>>>>>>
82495>>>>>>>>>External_Function WP_IsPrinterValid "IsPrinterValid" WinPrint.dll ;Returns Boolean // True if the the current printer is a valid one. False, otherwise.
82496>>>>>>>>>
82496>>>>>>>>>External_Function WP_ArePrintersInstalled "ArePrintersInstalled" WinPrint.dll ; // determines whether at least one printer is installedReturns Boolean // True, if a printer is installed, False if it is not.
82497>>>>>>>>>
82497>>>>>>>>>External_Function WP_ExecutePrinterSetupDialog "ExecutePrinterSetupDialog" WinPrint.dll ; // displays the "printer setup" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
82498>>>>>>>>>
82498>>>>>>>>>External_Function WP_ExecutePrintDialog "ExecutePrintDialog" WinPrint.dll ; // displays the "Print" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
82499>>>>>>>>>
82499>>>>>>>>>External_Function WP_GetCurrentDevice "GetCurrentDevice" WinPrint.dll ; // retrieves the name of the current printer device    Address aDevice ; // address of the string (255 chars) that will hold the device name upon returnReturns Boolean // True, if success; False if error occurred
82500>>>>>>>>>
82500>>>>>>>>>External_Function WP_GetPrintDialogFlags "GetPrintDialogFlags" WinPrint.dll ; // retrieves the current print optionsReturns UInteger // array of flags representing print-related options that are currently set
82501>>>>>>>>>
82501>>>>>>>>>External_Function WP_GetUserDefinedPapersize "GetUserDefinedPapersize" WinPrint.dll ;  // gets the size of user-defined paperReturns UInteger // // hi-word=length; lo-word=width
82502>>>>>>>>>
82502>>>>>>>>>External_Function WP_IsPrintDialogFlagSet "IsPrintDialogFlagSet" WinPrint.dll ; // determines whether a specific print-flag is set    UInteger iFlag ; // the printer flagReturns Boolean // True, if the flag is set; False, if it isn't
82503>>>>>>>>>
82503>>>>>>>>>External_Function WP_SelectPrinter "SelectPrinter" WinPrint.dll ; // selects a printer programatically    String sDevice; // the name of the printerReturns Boolean // True, if success; False, if error (such as an invalid printer name)
82504>>>>>>>>>
82504>>>>>>>>>External_Function WP_SetFirstPagePaperSource "SetFirstPagePaperSource"  WinPrint.dll ;        Integer iBin ; // the bim constantReturns Boolean // True if success, false if error
82505>>>>>>>>>
82505>>>>>>>>>External_Function WP_SetNumberOfPrintCopies "SetNumberOfPrintCopies" WinPrint.dll ; // sets the number of copies to print    UInteger iNumCopies; // number of copies to makeReturns Boolean // Always True
82506>>>>>>>>>
82506>>>>>>>>>External_Function WP_SetSpecificPrintDialogFlag "SetSpecificPrintDialogFlag" WinPrint.dll; // Sets/unsets one printer flag    UInteger fFlag; // printer flagReturns Boolean // True, if success; False if error occurred
82507>>>>>>>>>
82507>>>>>>>>>External_Function WP_SetPrintDialogFlags "SetPrintDialogFlags" WinPrint.dll; // Sets/unsets all printer flags in one call    UInteger fFlags; // printer flagsReturns Boolean // True, if success; False if error occurred
82508>>>>>>>>>
82508>>>>>>>>>External_Function WP_SetUserDefinedPapersize "SetUserDefinedPapersize" WinPrint.dll ;  // sets the size of user-defined paper    UInteger iPaperSize ; // hi-word=length; lo-word=widthReturns Boolean // True, if success; False if error occurred
82509>>>>>>>>>
82509>>>>>>>>>External_Function WP_SetFontStyle "SetFontStyle" WinPrint.dll ; // sets multiple font attributes    Integer iStyles ; // series of flagsReturns Boolean // always True
82510>>>>>>>>>
82510>>>>>>>>>External_Function WP_SetFontBold "SetFontBold" WinPrint.dll ; // toggles the bold attribute of the current font    Boolean bBold ; // True to switch bold attribute on; False to switch it offReturns Boolean // always True
82511>>>>>>>>>
82511>>>>>>>>>External_Function WP_SetFontItalic "SetFontItalic" WinPrint.dll ; // toggles the italic attribute of the current font    Boolean bItalic ; // True to switch italic attribute on; False to switch it offReturns Boolean  // always True
82512>>>>>>>>>
82512>>>>>>>>>External_Function WP_SetFontUnderline "SetFontUnderline" WinPrint.dll ; // toggles the underline attribute of the current font    Boolean bUnderline ; // True to switch underline attribute on; False to switch it offReturns Boolean  // always True
82513>>>>>>>>>
82513>>>>>>>>>External_Function WP_SetFontStrikeout "SetFontStrikeout" WinPrint.dll ; // toggles the strikeout attribute of the current font    Boolean bStrikeout ; // True to switch strikeout attribute on; False to switch it offReturns Boolean  // always True
82514>>>>>>>>>
82514>>>>>>>>>External_Function WP_SetFontColor "SetFontColor" WinPrint.dll ; // sets the color of the current font    Integer iColor ; // color of the fontReturns Boolean  // always True
82515>>>>>>>>>
82515>>>>>>>>>External_Function WP_SetFontHeight "SetFontHeight" WinPrint.dll ; // sets the height of the font    UInteger iHeight ; // height of the font in points (multiplied by 100. Eg 12.5 point should be sent as 1250)Returns Boolean  // always True
82516>>>>>>>>>
82516>>>>>>>>>External_Function WP_SetFontName "SetFontName" WinPrint.dll ; // Sets the name of the font to use    String sFontName ; // name of the font to useReturns Boolean  // always True
82517>>>>>>>>>
82517>>>>>>>>>External_Function WP_DrawBitmap "DrawBitmap" WinPrint.dll ; // Draws a bitmap (BMP, JPG)    String  sBitmap;                 // Name of the bitmap    Integer iLeft;                   // distance from left edge to draw bitmap    Integer iTop;                    // distance from top edge to draw bitmap    Integer iWidth;                  // width of the bitmap    Integer iHeight;                 // height of the bitmap    Boolean bUpdateCurrentPosition;  // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
82518>>>>>>>>>
82518>>>>>>>>>External_Function WP_DrawEllipse "DrawEllipse" WinPrint.dll ; // draws an elipse within a bounding rectangle    Integer iLeft;                   // distance from left edge to draw the ellipse    Integer iTop;                    // distance from top edge to draw the ellipse    Integer iWidth;                  // width of the bounding rectangle    Integer iHeight;                 // height of the bounding rectangle    Integer iBorderColor;            // color of the ellipse's edge    Integer iFillColor;              // internal color of the ellipse    Boolean  bFill;                  // should the ellipse be filled? (False=transparent)    UInteger iThickness;             // thickness of the elipse    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the ellipse be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82519>>>>>>>>>
82519>>>>>>>>>External_Function WP_DrawLine "DrawLine" WinPrint.dll ; // draws a line from the current position    Integer iLeft;                   // distance from left edge to draw the line    Integer iTop;                    // distance from top edge to draw the line    Integer iLength;                 // length of the line    Boolean  bHorizontal;            // draw horizontal? (False=vertical)    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
82520>>>>>>>>>
82520>>>>>>>>>External_Function WP_DrawRectangle "DrawRectangle" WinPrint.dll ; // draws a rectangle    Integer iLeft;                   // distance from left edge to draw the rectangle    Integer iTop;                    // distance from top edge to draw the rectangle    Integer iWidth;                  // width of the rectangle    Integer iHeight;                 // height of the rectangle    Integer iBorderColor;            // color of the rectangle's border    Integer iFillColor;              // internal color of the rectangle    Boolean  bFill;                  // should the rectangle be filled? (False=transparent)    UInteger iThickness;             // thickness of the rectangle's border    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the rectangle be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82521>>>>>>>>>
82521>>>>>>>>>External_Function WP_DrawXYLine "DrawXYLine" WinPrint.dll ; // draws a line between two points    Integer iLeftStart;              // distance from left edge to draw from    Integer iTopStart;               // distance from top edge to draw from    Integer iLeftEnd;                // distance from left edge to draw to    Integer iTopEnd;                 // distance from top edge to draw to    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the line be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82522>>>>>>>>>
82522>>>>>>>>>External_Function WP_SetAbsoluteMargins "SetAbsoluteMargins" WinPrint.dll ; // modifies the top/bottom non-printable margin    UInteger iTop;      // the top margin offset    UInteger iBottom;   // the bottom margin offset    Boolean  bAllPages; // should all pages be affected? True=AllPages; False=first page onlyReturns Boolean // always True
82523>>>>>>>>>
82523>>>>>>>>>External_Function WP_SetMargins "SetMargins" WinPrint.dll ; // Sets the user-margins    UInteger iLeft;   // the left margin    UInteger iTop;    // the top margin    UInteger iRight;  // the right margin    UInteger iBottom; // the bottom marginReturns Boolean // always True
82524>>>>>>>>>
82524>>>>>>>>>External_Function WP_CreateDiagram "CreateDiagram" WinPrint.dll ; // Creates a new diagram    UInteger eType;       // type of diagram (Bar, Line, Pie)    UInteger eEffect;     // how it is drawn (2d or 3d, etc)    UInteger iWidth;      // width of the diagram    UInteger iHeight;     // height of the diagram    Boolean  bDrawXyAxis; // draw the xy-axis (for bar charts only)?Returns Handle // unique id for the diagram used in other diagram funtions
82525>>>>>>>>>
82525>>>>>>>>>External_Function WP_AddDiagramEntry "AddDiagramEntry" WinPrint.dll ; // Adds an item into a diagram    Handle   hDiagram;          // diagram handle returned by CreateDiagram()    String   sValueDescription; // description of the item    String   sValue;            // value of the item    Integer iBorderColor;       // color of the item's border    Integer iFillColor;         // color of the item's interior    Boolean  bFilled;           // should the item be drawn filled (with iFillColor), or transparent?    UInteger iNumDecimals;      // Number of decimals in the sValue argument    UInteger eValueOrPercent;   // How the value should be displayed (as value or percentage, etc)    Boolean  bExploded;         // should the value be "pulled out" (pie charts only)Returns Boolean // True, if success; False, if error
82526>>>>>>>>>
82526>>>>>>>>>External_Function WP_DrawDiagram "DrawDiagram" WinPrint.dll ; // draws a diagram    Handle   hDiagram;               // diagram handle returned by CreateDiagram()    UInteger iLeft;                  // x-coordinate to draw the diagram    UInteger iTop;                   // y-coordinate to draw the diagram    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if success; False, if error
82527>>>>>>>>>
82527>>>>>>>>>External_Function WP_LockDiagram "LockDiagram" WinPrint.dll ; // Locks a diagram so that no more entries can be added    Handle hDiagram; // diagram handle returned by CreateDiagram()Returns Boolean // True, if success; False, if error
82528>>>>>>>>>
82528>>>>>>>>>External_Function WP_SetDiagramCaption "SetDiagramCaption" WinPrint.dll ; // Sets the caption of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sCaption; // the diagram's captionReturns Boolean // True, if success; False, if error
82529>>>>>>>>>
82529>>>>>>>>>External_Function WP_SetDiagramXText "SetDiagramXText" WinPrint.dll ; // Sets the horizontal label of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sText;    // the diagram's horizonal labelReturns Boolean // True, if success; False, if error
82530>>>>>>>>>
82530>>>>>>>>>External_Function WP_SetDiagramYText "SetDiagramYText" WinPrint.dll ; // Sets the vertical label of a diagram    Handle  hDiagram;      // diagram handle returned by CreateDiagram()    String  sText;         // the diagram's vertical label    Boolean bVerticalText; // should the text be drawn vertically (False=horizontally)Returns Boolean // True, if success; False, if error
82531>>>>>>>>>
82531>>>>>>>>>External_Function WP_BeginHeader "BeginHeader" WinPrint.dll ; // creates a new header    UInteger iHeaderType; // the type of header    UInteger iSubHeaderNum; // for subheaders, then number (1-0)Returns Boolean // always True
82532>>>>>>>>>
82532>>>>>>>>>External_Function WP_EndHeader "EndHeader" WinPrint.dll ; // declares the end of the current headerReturns Boolean // always True
82533>>>>>>>>>
82533>>>>>>>>>External_Function WP_SetExtraLineCheck "SetExtraLineCheck" WinPrint.dll ; // forces a soft page break if header plus number of lines don't fit on page    UInteger iNumLines; // number of lines in addition to header required before forcing a soft page-breakReturns Boolean; // always True
82534>>>>>>>>>External_Function WP_SetHeaderFrame "SetHeaderFrame" WinPrint.dll ; // sets the style, color and frame of a header    UInteger eFrame;     // style of frame (margin-to-margin, etc)    Integer iColor;      // color of the frame's edge    UInteger iThickness; // thickness of the frame    Integer iFillCol;    // the internal color of the frame (only used if bBilled=True)    Boolean  bFilled;    // True, if the frame should be filled with the iFillColor (False=Transparent)Returns Boolean // Always True
82535>>>>>>>>>
82535>>>>>>>>>External_Function WP_SetHeaderMargin "SetHeaderMargin" WinPrint.dll ; // Sets a margin of space on the inside and outside of the current header    UInteger eType;      // Specifies which margin areas is being set.    Integer  iSize;      // Size of the margin setting in the current report metricsReturns Boolean  // False if document is not started
82536>>>>>>>>>
82536>>>>>>>>>External_Function WP_SetHeaderPlacement "SetHeaderPlacement" WinPrint.dll ; // placement (left, center or right) of the header    UInteger ePlacement; // placed left, center or rightReturns Boolean //always True
82537>>>>>>>>>
82537>>>>>>>>>External_Function WP_SetHeaderWrap "SetHeaderWrap" WinPrint.dll ; // determines whether the current header is drawn on soft page-breaks    Boolean bWrap; // True, to wrap onto following pages; False, for current page onlyReturns Boolean // always True
82538>>>>>>>>>
82538>>>>>>>>>External_Function WP_WriteHeader "WriteHeader" WinPrint.dll ; // writes a header to the current page    UInteger eHeaderType;   // type of header    UInteger iSubHeaderNum; // for subheaders, the number (1-9)Returns Boolean // True, if success; False, if error
82539>>>>>>>>>
82539>>>>>>>>>External_Function WP_RGBToDFPrintColor "RGBToDFPrintColor" WinPrint.dll ; // converts R, G, and B values into a composite color that WinPrint expects    UInteger iRed;   // red component (1-255)    UInteger iGreen; // green component (1-255)    UInteger iBlue;  // blue component (1-255)Returns Integer // composite color
82540>>>>>>>>>
82540>>>>>>>>>External_Function WP_GetMetrics "GetMetrics" WinPrint.dll ; // gets the current unit of measurementReturns UInteger // unit of measurement (Inch or CM)
82541>>>>>>>>>
82541>>>>>>>>>External_Function WP_SetMetrics "SetMetrics" WinPrint.dll ; // sets the unit of measurement   UInteger eMetrics; // Inch or CMReturns Boolean // always True
82542>>>>>>>>>
82542>>>>>>>>>External_Function WP_ClearDocument "ClearDocument" WinPrint.dll ; // clears the resources of the document from memoryReturns Boolean // always True
82543>>>>>>>>>
82543>>>>>>>>>External_Function WP_NewDocument "NewDocument" WinPrint.dll ; // starts a new document, but preserves the printer settings   Boolean bAutoPreview ; // Should the Previewer be displayed immediatelyReturns Boolean // True, if success; False, if an error occurred
82544>>>>>>>>>
82544>>>>>>>>>External_Function WP_EndDocument "EndDocument" WinPrint.dll ; // Indicates that the document is finishedReturns Boolean // always True
82545>>>>>>>>>
82545>>>>>>>>>External_Function WP_ClearPrinter "ClearPrinter" WinPrint.dll ; // clears all printer and document resourcesReturns Boolean // True, if success; False, if an error occurred
82546>>>>>>>>>
82546>>>>>>>>>External_Function WP_ConfirmLines "ConfirmLines" WinPrint.dll ; // ensures that a specified number of lines will fit on the page; if not, a soft page-break is performed automatically    UInteger iNumLines; // number of lines that must fit on the pageReturns Boolean // True, if success; False, if an error occurred
82547>>>>>>>>>
82547>>>>>>>>>External_Function WP_CreatePage "CreatePage" WinPrint.dll ; // creates a new page of specified columns   UInteger iNumColumns; // number of columns (zero= no columns)Returns UInteger; // page number that was created
82548>>>>>>>>>External_Function WP_PreviewDocument "PreviewDocument" WinPrint.dll ; // previews the current document    Boolean bPrintDialog; // Determines whether the Print Dialog (range, etc) is displayed when the "print" button is clicked in the preview window.    Boolean bPrintSetup;  // Determines whether the Print Setup button is enabled (allows to change orientation, etc)    Boolean bPrint;       // Determines whether the Print button is enabledReturns Handle // non-zero = hViewerProcess; zero= error
82549>>>>>>>>>
82549>>>>>>>>>External_Function WP_ClosePreview "ClosePreview" WinPrint.dll ; // closes the preview windowReturns Boolean // True, if closed; False, if an error occurred (such as it not being already open)
82550>>>>>>>>>
82550>>>>>>>>>External_Function WP_PrintDocument "PrintDocument" WinPrint.dll ; // prints the current document    Handle hWndParent; // window handle of object to use for any modal outputReturns Boolean // True, if success; False, if an error occurred
82551>>>>>>>>>
82551>>>>>>>>>External_Function WP_SetAlign "SetAlign" WinPrint.dll ; // align future text    UInteger eAlign; // left, center or rightReturns Boolean // always True
82552>>>>>>>>>
82552>>>>>>>>>External_Function WP_WriteText "WriteText" WinPrint.dll ; // write text to the current position or column    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iColumnNum;        // number of the column to write to (zero=no column, use current position)    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
82553>>>>>>>>>
82553>>>>>>>>>External_Function WP_WriteTextAtPosition "WriteTextAtPosition" WinPrint.dll ; // writes text to a specific position    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iPosition;         // horizontal position to write the text    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
82554>>>>>>>>>
82554>>>>>>>>>External_Function WP_SetProgressCaption "SetProgressCaption" WinPrint.dll ;    String sProgressCaption ;Returns Boolean
82555>>>>>>>>>
82555>>>>>>>>>External_Function WP_SetReportTitle     "SetReportTitle"     WinPrint.dll ;    String sCaption ;Returns Boolean
82556>>>>>>>>>
82556>>>>>>>>>External_Function WP_ViewerWantsToClose "ViewerWantsToClose" WinPrint.dll ;Returns Integer
82557>>>>>>>>>
82557>>>>>>>>>External_Function WP_DisplayMessageBox  "DisplayMessageBox"  WinPrint.dll ;    String sCaption String sText ;Returns Integer
82558>>>>>>>>>
82558>>>>>>>>>External_Function WP_GetViewerWindow "GetViewerWindow" Winprint.dll ;Returns Handle
82559>>>>>>>>>
82559>>>>>>>>>External_Function WP_GetDocumentStatus "GetDocumentStatus" Winprint.dll ;Returns Integer // returns dsNotStarted, dsStarted, or dsFinished
82560>>>>>>>>>
82560>>>>>>>Use WinPrint_Constants.pkg
82560>>>>>>>Use Rgb.pkg
82560>>>>>>>Use GlobalFunctionsProcedures.pkg
82560>>>>>>>
82560>>>>>>>DEFINE INFINITE for -1
82560>>>>>>>DEFINE WAIT_TIMEOUT for |CI$00000102
82560>>>>>>>
82560>>>>>>>
82560>>>>>>>DEFINE QS_KEY            for |CI$0001
82560>>>>>>>DEFINE QS_MOUSEMOVE      for |CI$0002
82560>>>>>>>DEFINE QS_MOUSEBUTTON    for |CI$0004
82560>>>>>>>DEFINE QS_POSTMESSAGE    for |CI$0008
82560>>>>>>>DEFINE QS_TIMER          for |CI$0010
82560>>>>>>>DEFINE QS_PAINT          for |CI$0020
82560>>>>>>>DEFINE QS_SENDMESSAGE    for |CI$0040
82560>>>>>>>DEFINE QS_HOTKEY         for |CI$0080
82560>>>>>>>DEFINE QS_ALLPOSTMESSAGE for |CI$0100
82560>>>>>>>DEFINE QS_MOUSE          for (QS_MOUSEMOVE ior QS_MOUSEBUTTON)
82560>>>>>>>DEFINE QS_INPUT          for (QS_MOUSE ior QS_KEY)
82560>>>>>>>DEFINE QS_ALLEVENTS      for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY)
82560>>>>>>>DEFINE QS_ALLINPUT       for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY ior QS_SENDMESSAGE)
82560>>>>>>>
82560>>>>>>>External_Function WaitForSingleObject "WaitForSingleObject" Kernel32.dll Handle hHandle Dword dwMilliseconds Returns DWord
82561>>>>>>>External_Function GetCurrentProcessId "GetCurrentProcessId" Kernel32.dll Returns DWord
82562>>>>>>>External_Function GetCurrentProcess "GetCurrentProcess" Kernel32.dll Returns DWord
82563>>>>>>>
82563>>>>>>>External_Function MsgWaitForMultipleObjects "MsgWaitForMultipleObjects" User32.dll ;    DWORD nCount;             // number of handles in the object handle array    Address pHandles;     // pointer to the object-handle array    Boolean fWaitAll;     // wait for all or wait for one    DWORD dwMilliseconds; // time-out interval in milliseconds    DWORD dwWakeMask;     // type of input events to wait forReturns Dword
82564>>>>>>>
82564>>>>>>>Use GlobalFunctionsProcedures.pkg
82564>>>>>>>
82564>>>>>>>Class cWinPrint2 is a cObject // JJT: Will we need a windows handle for this like old one
82565>>>>>>>    Procedure Construct_Object
82567>>>>>>>        forward send construct_object
82569>>>>>>>
82569>>>>>>>        //*** internal properties
82569>>>>>>>        Property Integer DFCurrent_Color       0
82570>>>>>>>        Property String  DFCurrent_OutPut      "WinPrint"
82571>>>>>>>        Property Integer DFCurrent_Diagram     0
82572>>>>>>>        Property Integer DFCurrent_HeaderType  0
82573>>>>>>>        Property Integer DFCurrent_HeaderNr    0
82574>>>>>>>        Property Number  DFCurrent_FontSize    10
82575>>>>>>>        Property String  DFCurrent_Font        "Arial"
82576>>>>>>>
82576>>>>>>>        //*** Default values for margins 2.53 CM = 1 inch
82576>>>>>>>        Property Number  DFLeft_Margin    2.53
82577>>>>>>>        Property Number  DFTop_Margin     2.53
82578>>>>>>>        Property Number  DFright_Margin   2.53
82579>>>>>>>        Property Number  DFBottom_Margin  2.53
82580>>>>>>>
82580>>>>>>>        // If WP1 this defaults to false. In 2, it is true which means that the print job
82580>>>>>>>        // dialog appears when you hitprint in previewer.
82580>>>>>>>        Property Integer PrintDlgInPreview   1
82581>>>>>>>         // This does nothing in Wp2 (because you can't to this anyway)
82581>>>>>>>        Property Integer EnablePrintSetupFromPreview  True
82582>>>>>>>        Property Integer EnablePrintFromPreview  1
82583>>>>>>>
82583>>>>>>>        // is the GUI Suspended. This is privately maintained and is used
82583>>>>>>>        // to figure out if a preview panel is up or not
82583>>>>>>>        Property Integer pbIsSuspended False
82584>>>>>>>
82584>>>>>>>        Object oDFColorArray is an Array
82586>>>>>>>           //Moved into array
82586>>>>>>>           Set Value  0  To RGB_WHITE
82587>>>>>>>           Set Value  1  To RGB_RED
82588>>>>>>>           Set Value  2  To RGB_BLUE
82589>>>>>>>           Set Value  3  To RGB_GREEN
82590>>>>>>>           Set Value  4  To RGB_YELLOW
82591>>>>>>>           Set Value  5  To RGB_GREY
82592>>>>>>>           Set Value  6  To RGB_CYAN
82593>>>>>>>           Set Value  7  To RGB_MAGENTA
82594>>>>>>>           Set Value  8  To RGB_DRED
82595>>>>>>>           Set Value  9  To RGB_DBLUE
82596>>>>>>>           Set Value  10 To RGB_DGREEN
82597>>>>>>>           Set Value  11 To RGB_DYELLOW
82598>>>>>>>           Set Value  12 To RGB_DGREY
82599>>>>>>>           Set Value  13 To RGB_DCYAN
82600>>>>>>>           Set Value  14 To RGB_DMAGENTA
82601>>>>>>>           Set Value  15 To RGB_BLACK
82602>>>>>>>        End_Object
82603>>>>>>>
82603>>>>>>>        Object oDiagramArray is an Array
82605>>>>>>>        End_Object
82606>>>>>>>
82606>>>>>>>    End_Procedure
82607>>>>>>>
82607>>>>>>>    Function ViewerWantsToClose returns Boolean
82609>>>>>>>        Function_return (WP_ViewerWantsToClose())
82610>>>>>>>    end_Function
82611>>>>>>>
82611>>>>>>>    Function IsViewerActive returns boolean
82613>>>>>>>        Function_Return (WP_GetViewerWindow()<>0)
82614>>>>>>>    end_function
82615>>>>>>>
82615>>>>>>>    Function IsPrinterValid Returns Boolean
82617>>>>>>>        Function_Return (WP_IsPrinterValid()<>0)
82618>>>>>>>    End_Function
82619>>>>>>>
82619>>>>>>>    Function ArePrintersInstalled returns boolean
82621>>>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
82622>>>>>>>    End_Function
82623>>>>>>>
82623>>>>>>>
82623>>>>>>>    // returns docucument state: dsNotStarted, dsStarted, dsFinished
82623>>>>>>>    Function DocumentStatus returns Integer
82625>>>>>>>        Function_Return (WP_GetDocumentStatus())
82626>>>>>>>    end_function
82627>>>>>>>
82627>>>>>>>    // Might still be called from report class. Leave dummy stub
82627>>>>>>>    Procedure DFZeroCounters
82629>>>>>>>    End_Procedure
82630>>>>>>>
82630>>>>>>>    //***
82630>>>>>>>    Function DFNewPage Integer Columns Returns Integer
82632>>>>>>>        Integer iPageNum
82632>>>>>>>        // This returns a page number used in report object....(this may change)
82632>>>>>>>        Move (WP_CreatePage(Columns)) To iPageNum
82633>>>>>>>        If (iPageNum=0) Begin
82635>>>>>>>            Error DFERR_WINPRINT DFPrintError900
82636>>>>>>>>
82636>>>>>>>        End
82636>>>>>>>>
82636>>>>>>>        Function_Return iPageNum
82637>>>>>>>    End_Function
82638>>>>>>>
82638>>>>>>>    //***Return handle to use for winprint dialog. If main_window
82638>>>>>>>    //   exists, use it. Else, get object's handle
82638>>>>>>>    Function Report_Window_Handle returns handle
82640>>>>>>>        Handle hWnd
82640>>>>>>>        Handle hoObj
82640>>>>>>>        Get Focus of desktop to hoObj // start with the focus
82641>>>>>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
82642>>>>>>>        function_return hWnd
82643>>>>>>>    End_Function
82644>>>>>>>
82644>>>>>>>
82644>>>>>>>    //***
82644>>>>>>>    Function DFPrintDialog Returns Boolean
82646>>>>>>>        Handle hwnd
82646>>>>>>>        Boolean bOk
82646>>>>>>>
82646>>>>>>>        Get Report_Window_Handle to hWnd
82647>>>>>>>        Move (WP_ExecutePrintDialog(hwnd)) To bOk
82648>>>>>>>
82648>>>>>>>        Function_Return bOk
82649>>>>>>>    End_Function
82650>>>>>>>
82650>>>>>>>
82650>>>>>>>    //*** You can only invoke the print setup if the report is cleared. If you try to to do this in
82650>>>>>>>    //    the wrong state you will get an error.
82650>>>>>>>    Function DFPrintSetupDialog Returns Boolean
82652>>>>>>>        Handle hwnd
82652>>>>>>>        Boolean bOk
82652>>>>>>>        Integer iStatus
82652>>>>>>>        Get ArePrintersInstalled to bOk
82653>>>>>>>        If not bOk Begin
82655>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
82656>>>>>>>>
82656>>>>>>>        End
82656>>>>>>>>
82656>>>>>>>        Else Begin
82657>>>>>>>            Get DocumentStatus to iStatus
82658>>>>>>>            
82658>>>>>>>            If (iStatus=dsNotStarted) Begin
82660>>>>>>>                Get Report_Window_Handle to hWnd
82661>>>>>>>                Move (WP_ExecutePrinterSetupDialog(hwnd)) to bOk
82662>>>>>>>                
82662>>>>>>>                // test that the selected printer is valid....
82662>>>>>>>                If bOK Begin
82664>>>>>>>                    Get IsPrinterValid to bOk // if printer not valid, it's not ok
82665>>>>>>>                    If not bOk Begin
82667>>>>>>>                        Error DFERR_WINPRINT DFPrintError936  // could not select a valid printer
82668>>>>>>>>
82668>>>>>>>                    End
82668>>>>>>>>
82668>>>>>>>                End
82668>>>>>>>>
82668>>>>>>>            End
82668>>>>>>>>
82668>>>>>>>            Else Begin
82669>>>>>>>               Error DFERR_WINPRINT DFPrintError966      // cannot change printer when report is active
82670>>>>>>>>
82670>>>>>>>            End
82670>>>>>>>>
82670>>>>>>>        End
82670>>>>>>>>
82670>>>>>>>        Function_Return bOk
82671>>>>>>>    End_Function
82672>>>>>>>
82672>>>>>>>
82672>>>>>>>    //*** Provided for backwards compatibility. DFPrintSetupDialog is more flexible because it returns a
82672>>>>>>>    //    false if cancel was selected.
82672>>>>>>>    Procedure DFPrintSetup
82674>>>>>>>        Boolean bOk
82674>>>>>>>        Get DFPrintSetupDialog to bOk
82675>>>>>>>    End_Procedure
82676>>>>>>>
82676>>>>>>>    //*** This invokes the print job dialog, prints the report, then clears the report document.
82676>>>>>>>    //    This should be called after the report is complete.
82676>>>>>>>    Procedure DFPrint
82678>>>>>>>        Integer bOk
82678>>>>>>>        Get DFPrintDialog To bOk
82679>>>>>>>        If bOk Begin
82681>>>>>>>            Send DFPrintDoc
82682>>>>>>>            Send DFClearDoc
82683>>>>>>>        End
82683>>>>>>>>
82683>>>>>>>    End_Procedure
82684>>>>>>>
82684>>>>>>>    Procedure DFSuspendGui boolean bSuspend
82686>>>>>>>        If (bSuspend<>pbIsSuspended(self)) begin
82688>>>>>>>            Send SuspendGui of Desktop bSuspend
82689>>>>>>>            Set pbIsSuspended to bSuspend
82690>>>>>>>        end
82690>>>>>>>>
82690>>>>>>>    end_procedure
82691>>>>>>>
82691>>>>>>>    // this is protected so that the queue is only pumped if the
82691>>>>>>>    // gui is suspended.
82691>>>>>>>    Procedure PumpMsgQueue
82693>>>>>>>        If (pbIsSuspended(self)) begin
82695>>>>>>>            Send PumpMsgQueue of desktop // permit painting
82696>>>>>>>        end
82696>>>>>>>>
82696>>>>>>>    end_procedure
82697>>>>>>>
82697>>>>>>>
82697>>>>>>>    //*** This does a modeless preview. This is what you'd want during
82697>>>>>>>    //    report generation and it may be what you want for report viewing.
82697>>>>>>>    Procedure DFPreviewNoWait
82699>>>>>>>        Boolean bOk
82699>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
82699>>>>>>>        integer iStatus
82699>>>>>>>        Get PrintDlgInPreview to bPrntDlg
82700>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
82701>>>>>>>        Get EnablePrintFromPreview to bPrint
82702>>>>>>>        Get DocumentStatus to iStatus
82703>>>>>>>        If (iStatus=dsStarted) begin
82705>>>>>>>            Send DfSuspendGui True
82706>>>>>>>        end
82706>>>>>>>>
82706>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To bOk
82707>>>>>>>        If not bOk Begin
82709>>>>>>>            Error DFERR_WINPRINT DFPrintError901
82710>>>>>>>>
82710>>>>>>>            Send DfSuspendGui False
82711>>>>>>>        End
82711>>>>>>>>
82711>>>>>>>    End_Procedure
82712>>>>>>>
82712>>>>>>>
82712>>>>>>>    //*** This does a modal preview. You might want this for report
82712>>>>>>>    //    viewing as the program knows when the viewer is closed
82712>>>>>>>    // Note that this is a private message and it was never intended that this
82712>>>>>>>    // should be used. We expect winprint reports to use modeless viewers.
82712>>>>>>>    Procedure DFPreviewWait
82714>>>>>>>        Handle hViewerProcess
82714>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
82714>>>>>>>        Integer iRetVal
82714>>>>>>>        Integer hwMain hMain
82714>>>>>>>
82714>>>>>>>        Get PrintDlgInPreview to bPrntDlg
82715>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
82716>>>>>>>        Get EnablePrintFromPreview to bPrint
82717>>>>>>>
82717>>>>>>>        Send DfSuspendGui True
82718>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To hViewerProcess
82719>>>>>>>
82719>>>>>>>        If (hViewerProcess = 0) Begin
82721>>>>>>>            Error DFERR_WINPRINT DFPrintError901
82722>>>>>>>>
82722>>>>>>>        End
82722>>>>>>>>
82722>>>>>>>        Else Begin
82723>>>>>>>            // We need to wait for either the Viewer to close, or a WM_PAINT message in the thread's queue...
82723>>>>>>>            Repeat
82723>>>>>>>>
82723>>>>>>>               Move (MsgWaitForMultipleObjects(1, AddressOf(hViewerProcess), False, INFINITE, QS_PAINT)) To iRetVal
82724>>>>>>>               Send PumpMsgQueue // permit painting
82725>>>>>>>            Until (iRetVal = 0) // 0 means that the viewer process terminated
82727>>>>>>>        end
82727>>>>>>>>
82727>>>>>>>        Send DfSuspendGui False
82728>>>>>>>
82728>>>>>>>       // Do what we can to force VDF application to the top.
82728>>>>>>>       // As 12.0 dfSuspendGUI actually properly disables the underlying windows. When the viewer
82728>>>>>>>       // is closed it cannot give the focus back to this so it goes elsewhere. This will force it
82728>>>>>>>       // back. 
82728>>>>>>>
82728>>>>>>>       Get main_window of desktop to hMain
82729>>>>>>>       If hMain Begin
82731>>>>>>>          Get window_handle of hMain to hwMain
82732>>>>>>>          If hwMain Begin
82734>>>>>>>              If (GetForegroundWindow()<>hwMain) Begin
82736>>>>>>>                  Move (SetForegroundWindow(hwMain)) to hwMain
82737>>>>>>>              End
82737>>>>>>>>
82737>>>>>>>          End
82737>>>>>>>>
82737>>>>>>>       End
82737>>>>>>>>
82737>>>>>>>
82737>>>>>>>    End_Procedure
82738>>>>>>>
82738>>>>>>>    Procedure DfPreview
82740>>>>>>>        send DfPreviewNoWait
82741>>>>>>>    end_procedure
82742>>>>>>>
82742>>>>>>>
82742>>>>>>>    //***
82742>>>>>>>    Procedure DFPrintDoc
82744>>>>>>>        Handle hwnd
82744>>>>>>>        Boolean bOk
82744>>>>>>>        Get Report_Window_Handle to hWnd
82745>>>>>>>        Move (WP_PrintDocument(hwnd)) To bOk
82746>>>>>>>
82746>>>>>>>        If not bOk Begin
82748>>>>>>>            Error DFERR_WINPRINT DFPrintError902
82749>>>>>>>>
82749>>>>>>>        End
82749>>>>>>>>
82749>>>>>>>    End_Procedure
82750>>>>>>>
82750>>>>>>>
82750>>>>>>>    //***
82750>>>>>>>    Procedure DFClearDoc
82752>>>>>>>        Boolean bOk
82752>>>>>>>        Get ArePrintersInstalled to bOk
82753>>>>>>>        If bOk begin
82755>>>>>>>            Move (WP_ClearDocument()) To bOk
82756>>>>>>>            Send DFSuspendGUI False
82757>>>>>>>            If not bOk Begin
82759>>>>>>>               Error DFERR_WINPRINT DFPrintError903 // error number right?
82760>>>>>>>>
82760>>>>>>>            End
82760>>>>>>>>
82760>>>>>>>        End
82760>>>>>>>>
82760>>>>>>>    End_Procedure
82761>>>>>>>
82761>>>>>>>    Procedure DFNewDoc Boolean bAutoPreview
82763>>>>>>>        Boolean bOk
82763>>>>>>>        // this is the most likely place we will encounter when we start a report. Check for
82763>>>>>>>        // printers and return an explicit error to make it easy to identify the error
82763>>>>>>>        Get ArePrintersInstalled to bOk
82764>>>>>>>        If not bOk begin
82766>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
82767>>>>>>>>
82767>>>>>>>        end
82767>>>>>>>>
82767>>>>>>>        else begin
82768>>>>>>>            Send DfClearDoc //JJT - a new doc should always start with a clear
82769>>>>>>>            If bAutoPreview Send DFSuspendGUI True
82772>>>>>>>            Move (WP_NewDocument(bAutoPreview)) To bOk
82773>>>>>>>
82773>>>>>>>            If not bOk Begin
82775>>>>>>>               Error DFERR_WINPRINT DFPrintError902  // could not print document
82776>>>>>>>>
82776>>>>>>>               Send DFSuspendGUI False
82777>>>>>>>            End
82777>>>>>>>>
82777>>>>>>>        end
82777>>>>>>>>
82777>>>>>>>    End_Procedure
82778>>>>>>>
82778>>>>>>>    //***
82778>>>>>>>    Procedure DFSetFont String sFontName
82780>>>>>>>        boolean bOk
82780>>>>>>>        Move (WP_SetFontName(sFontName)) To bOk
82781>>>>>>>
82781>>>>>>>        If not bOK Begin
82783>>>>>>>            Error DFERR_WINPRINT DFPrintError904
82784>>>>>>>>
82784>>>>>>>        End
82784>>>>>>>>
82784>>>>>>>    End_Procedure
82785>>>>>>>
82785>>>>>>>
82785>>>>>>>    //***
82785>>>>>>>    Procedure DFSetFontSize Integer iHeight Integer iWidth
82787>>>>>>>        boolean bOk
82787>>>>>>>        // note that width is ignored in new implementation
82787>>>>>>>        Move (WP_SetFontHeight(iHeight)) To bOk
82788>>>>>>>
82788>>>>>>>        If not bOK Begin
82790>>>>>>>            Error DFERR_WINPRINT  DFPrintError905
82791>>>>>>>>
82791>>>>>>>        End
82791>>>>>>>>
82791>>>>>>>    End_Procedure
82792>>>>>>>
82792>>>>>>>
82792>>>>>>>    //***
82792>>>>>>>    Procedure DFSetFontStyle DWORD dwStyle
82794>>>>>>>        boolean bOk
82794>>>>>>>        Move (WP_SetFontStyle(dwStyle)) To bOk
82795>>>>>>>
82795>>>>>>>        If not bOK Begin
82797>>>>>>>            Error DFERR_WINPRINT DFPrintError906
82798>>>>>>>>
82798>>>>>>>        End
82798>>>>>>>>
82798>>>>>>>    End_Procedure
82799>>>>>>>
82799>>>>>>>
82799>>>>>>>    //***
82799>>>>>>>    Procedure DFSetUnderline boolean bUnderline
82801>>>>>>>        boolean bOk
82801>>>>>>>
82801>>>>>>>        Move (WP_SetFontUnderline(bUnderline)) To bOk
82802>>>>>>>
82802>>>>>>>        If not bOK Begin
82804>>>>>>>            Error DFERR_WINPRINT DFPrintError907
82805>>>>>>>>
82805>>>>>>>        End
82805>>>>>>>>
82805>>>>>>>    End_Procedure
82806>>>>>>>
82806>>>>>>>
82806>>>>>>>    //***
82806>>>>>>>    Procedure DFSetBold Boolean bBold
82808>>>>>>>        Boolean bOk
82808>>>>>>>
82808>>>>>>>        Move (WP_SetFontBold(bBold)) To bOk
82809>>>>>>>
82809>>>>>>>        If not bOK Begin
82811>>>>>>>            Error DFERR_WINPRINT DFPrintError908
82812>>>>>>>>
82812>>>>>>>        End
82812>>>>>>>>
82812>>>>>>>    End_Procedure
82813>>>>>>>
82813>>>>>>>
82813>>>>>>>    //***
82813>>>>>>>    Procedure DFSetItalic Boolean bItalic
82815>>>>>>>        Boolean bOk
82815>>>>>>>
82815>>>>>>>        Move (WP_SetFontItalic(bItalic)) To bOk
82816>>>>>>>
82816>>>>>>>        If not bOK Begin
82818>>>>>>>            Error DFERR_WINPRINT DFPrintError909
82819>>>>>>>>
82819>>>>>>>        End
82819>>>>>>>>
82819>>>>>>>    End_Procedure
82820>>>>>>>
82820>>>>>>>
82820>>>>>>>    //***
82820>>>>>>>    Procedure DFSetStrikeout Boolean bStrikeout
82822>>>>>>>        Boolean bOk
82822>>>>>>>
82822>>>>>>>        Move (WP_SetFontStrikeout(bStrikeout)) To bOk
82823>>>>>>>
82823>>>>>>>        If not bOK Begin
82825>>>>>>>            Error DFERR_WINPRINT DFPrintError910
82826>>>>>>>>
82826>>>>>>>        End
82826>>>>>>>>
82826>>>>>>>    End_Procedure
82827>>>>>>>
82827>>>>>>>
82827>>>>>>>    //***
82827>>>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
82829>>>>>>>        Boolean bOk
82829>>>>>>>        integer iLeft iRight iTop iBottom
82829>>>>>>>
82829>>>>>>>        Move (nLeft   * 100) to iLeft
82830>>>>>>>        Move (nRight  * 100) to iRight
82831>>>>>>>        Move (nTop    * 100) to iTop
82832>>>>>>>        Move (nBottom * 100) to iBottom
82833>>>>>>>
82833>>>>>>>        Move (WP_SetMargins(iLeft,iTop,iRight,iBottom)) To bOk
82834>>>>>>>
82834>>>>>>>        If bOk Begin
82836>>>>>>>            Set DFLeft_Margin   To nLeft
82837>>>>>>>            Set DFTop_Margin    To nTop
82838>>>>>>>            Set DFRight_Margin  To nRight
82839>>>>>>>            Set DFBottom_Margin To nBottom
82840>>>>>>>        End
82840>>>>>>>>
82840>>>>>>>        Else Begin
82841>>>>>>>            Error DFERR_WINPRINT DFPrintError911
82842>>>>>>>>
82842>>>>>>>        End
82842>>>>>>>>
82842>>>>>>>    End_Procedure
82843>>>>>>>
82843>>>>>>>
82843>>>>>>>    //***
82843>>>>>>>    Procedure DFSetLeftMargin Number nLeft
82845>>>>>>>        number  nTop nRight nBottom
82845>>>>>>>        Get DFTop_Margin    To nTop
82846>>>>>>>        Get DFRight_Margin  To nRight
82847>>>>>>>        Get DFBottom_Margin To nBottom
82848>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82849>>>>>>>    End_Procedure
82850>>>>>>>
82850>>>>>>>
82850>>>>>>>    //***
82850>>>>>>>    Procedure DFSetRightMargin Number nRight
82852>>>>>>>        number  nLeft nTop nBottom
82852>>>>>>>        Get DFLeft_Margin   To nLeft
82853>>>>>>>        Get DFTop_Margin    To nTop
82854>>>>>>>        Get DFBottom_Margin To nBottom
82855>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82856>>>>>>>    End_Procedure
82857>>>>>>>
82857>>>>>>>
82857>>>>>>>    //***
82857>>>>>>>    Procedure DFSetTopMargin Number nTop
82859>>>>>>>        number  nLeft nRight nBottom
82859>>>>>>>        Get DFLeft_Margin   To nLeft
82860>>>>>>>        Get DFRight_Margin  To nRight
82861>>>>>>>        Get DFBottom_Margin To nBottom
82862>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82863>>>>>>>    End_Procedure
82864>>>>>>>
82864>>>>>>>
82864>>>>>>>    //***
82864>>>>>>>    Procedure DFSetBottomMargin Number nBottom
82866>>>>>>>        number  nLeft nTop nRight
82866>>>>>>>        Get DFLeft_Margin   To nLeft
82867>>>>>>>        Get DFTop_Margin    To nTop
82868>>>>>>>        Get DFRight_Margin  To nRight
82869>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82870>>>>>>>    End_Procedure
82871>>>>>>>
82871>>>>>>>
82871>>>>>>>    //***
82871>>>>>>>    Procedure DFWriteText String sText Integer iStyle Integer iColumn Integer iDecimal Boolean bNewLineAfterPrint
82873>>>>>>>        Boolean bOk
82873>>>>>>>
82873>>>>>>>        Send DFSetFontStyle iStyle
82874>>>>>>>        Get ToAnsi sText To sText
82875>>>>>>>        Move (WP_WriteText(sText,bNewLineAfterPrint,iColumn,iDecimal,0)) To bOk
82876>>>>>>>        If not bOk Begin
82878>>>>>>>            Error DFERR_WINPRINT DFPrintError918
82879>>>>>>>>
82879>>>>>>>        End
82879>>>>>>>>
82879>>>>>>>        Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
82880>>>>>>>    End_Procedure
82881>>>>>>>
82881>>>>>>>    //***
82881>>>>>>>    Procedure DFWrite String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
82883>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
82885>>>>>>>            Move (Rtrim(sText)) to sText
82886>>>>>>>        end
82886>>>>>>>>
82886>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal False
82887>>>>>>>    End_Procedure
82888>>>>>>>
82888>>>>>>>    //***
82888>>>>>>>    Procedure DFWriteLn String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
82890>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
82892>>>>>>>            Move (Rtrim(sText)) to sText
82893>>>>>>>        end
82893>>>>>>>>
82893>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal True
82894>>>>>>>    End_Procedure
82895>>>>>>>
82895>>>>>>>
82895>>>>>>>    //***
82895>>>>>>>    Procedure DFWriteTextAtPosition String sText integer iStyle Number nPosition Integer iDecimal ;                                    Number nMaxLength Boolean bNewLineAfterPrint
82897>>>>>>>        Boolean bOk
82897>>>>>>>        Integer iPosition iMaxLength
82897>>>>>>>        Send DFSetFontStyle iStyle
82898>>>>>>>        Get ToAnsi sText To sText
82899>>>>>>>        Move (nPosition * 100) to iPosition
82900>>>>>>>        Move (nMaxLength * 100) to iMaxLength
82901>>>>>>>        Move (WP_WriteTextAtPosition(sText,bNewLineAfterPrint,iPosition,iDecimal,iMaxLength)) To bOk
82902>>>>>>>        If not bOk Begin
82904>>>>>>>            Error DFERR_WINPRINT DFPrintError922
82905>>>>>>>>
82905>>>>>>>        End
82905>>>>>>>>
82905>>>>>>>         Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
82906>>>>>>>    End_Procedure
82907>>>>>>>
82907>>>>>>>    //***
82907>>>>>>>    Procedure DFWritePos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
82909>>>>>>>        Number nMax
82909>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
82911>>>>>>>            Move (Rtrim(sText)) to sText
82912>>>>>>>        end
82912>>>>>>>>
82912>>>>>>>
82912>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
82915>>>>>>>        Else ;            Move nMaxLength to nMax
82917>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax False
82918>>>>>>>    End_Procedure
82919>>>>>>>
82919>>>>>>>    //***
82919>>>>>>>    Procedure DFWriteLnPos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
82921>>>>>>>        Number nMax
82921>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
82923>>>>>>>            Move (Rtrim(sText)) to sText
82924>>>>>>>        end
82924>>>>>>>>
82924>>>>>>>
82924>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
82927>>>>>>>        Else ;            Move nMaxLength to nMax
82929>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax True
82930>>>>>>>    End_Procedure
82931>>>>>>>
82931>>>>>>>    Procedure DFSetMetrics String sMetrics
82933>>>>>>>        integer eMetrics
82933>>>>>>>        // for backwards compatibility support both string names and integer enumerations
82933>>>>>>>        // it is better to use the enumeration value
82933>>>>>>>        If (sMetrics="INCH" or sMetrics="CM") Begin
82935>>>>>>>            Set DFCurrent_Metrics to sMetrics
82936>>>>>>>        end
82936>>>>>>>>
82936>>>>>>>        else Begin
82937>>>>>>>            Move sMetrics to eMetrics
82938>>>>>>>            Move (WP_SetMetrics(eMetrics)) To eMetrics
82939>>>>>>>        End
82939>>>>>>>>
82939>>>>>>>    End_Procedure
82940>>>>>>>
82940>>>>>>>    Function DFGetMetrics Returns Integer
82942>>>>>>>        Integer eMetrics
82942>>>>>>>        Move (WP_GetMetrics()) To eMetrics
82943>>>>>>>        Function_return eMetrics
82944>>>>>>>    End_Function
82945>>>>>>>
82945>>>>>>>
82945>>>>>>>    //**** Properties Maintained for compatibility with old Winprint (obsolete)
82945>>>>>>>    Function DFCurrent_Metrics returns string
82947>>>>>>>        Integer eMetrics
82947>>>>>>>        Get DFGetMetrics to eMetrics
82948>>>>>>>        Function_return (if(eMetrics=WPM_INCH,"INCH","CM"))
82949>>>>>>>    end_function
82950>>>>>>>
82950>>>>>>>    Procedure Set DFCurrent_Metrics string sCMorINCH
82952>>>>>>>        Send DFSetMetrics (if(sCMorINCH="INCH", WPM_INCH, WPM_CM))
82953>>>>>>>    End_Procedure
82954>>>>>>>
82954>>>>>>>
82954>>>>>>>
82954>>>>>>>
82954>>>>>>>
82954>>>>>>>    //***
82954>>>>>>>    Procedure DFBeginHeaderType Integer iHeaderNr Integer eHeaderType
82956>>>>>>>        Boolean bOk
82956>>>>>>>
82956>>>>>>>        If (eHeaderType=DFSubHeader or eHeaderType=DFSubTotal) Begin
82958>>>>>>>            //*** Do nothing for the moment
82958>>>>>>>        End
82958>>>>>>>>
82958>>>>>>>        Else ;            Move 0 to iHeaderNr // If the user made a mistake
82960>>>>>>>
82960>>>>>>>        Set DFCurrent_HeaderType To eHeaderType
82961>>>>>>>        Set DFCurrent_HeaderNr   To iHeaderNr
82962>>>>>>>
82962>>>>>>>        Move (WP_BeginHeader(eHeaderType, iHeaderNr)) To bOk
82963>>>>>>>
82963>>>>>>>        If not bOk Begin
82965>>>>>>>            Error DFERR_WINPRINT DFPrintError925
82966>>>>>>>>
82966>>>>>>>        End
82966>>>>>>>>
82966>>>>>>>    End_Procedure
82967>>>>>>>
82967>>>>>>>
82967>>>>>>>    //***
82967>>>>>>>    Procedure DFEndHeaderType
82969>>>>>>>        Boolean bOk
82969>>>>>>>
82969>>>>>>>        Move (WP_EndHeader()) To bOk
82970>>>>>>>
82970>>>>>>>        if not bOk begin
82972>>>>>>>            Error DFERR_WINPRINT DFPrintError926
82973>>>>>>>>
82973>>>>>>>        End
82973>>>>>>>>
82973>>>>>>>    End_Procedure
82974>>>>>>>
82974>>>>>>>
82974>>>>>>>    //***
82974>>>>>>>    Procedure DFWriteHeaderType Integer iHeaderNr Integer eHeaderType
82976>>>>>>>        Boolean bOk
82976>>>>>>>        Move (WP_WriteHeader(eHeaderType, iHeaderNr)) To bOk
82977>>>>>>>        if not bOk begin
82979>>>>>>>            Error DFERR_WINPRINT DFPrintError927
82980>>>>>>>>
82980>>>>>>>        End
82980>>>>>>>>
82980>>>>>>>    End_Procedure
82981>>>>>>>
82981>>>>>>>
82981>>>>>>>    //***
82981>>>>>>>    Procedure DFHeaderPosition Integer ePlace
82983>>>>>>>        Boolean bOk
82983>>>>>>>
82983>>>>>>>         Move (WP_SetHeaderPlacement(ePlace)) To bOk
82984>>>>>>>
82984>>>>>>>         if not bOk begin
82986>>>>>>>            Error DFERR_WINPRINT DFPrintError929
82987>>>>>>>>
82987>>>>>>>        End
82987>>>>>>>>
82987>>>>>>>    End_Procedure
82988>>>>>>>
82988>>>>>>>
82988>>>>>>>    //***
82988>>>>>>>    Procedure DFHeaderFrameType Integer eFrame integer iColor Number nWeight;                                Integer iFillColor Boolean bFillFrame
82990>>>>>>>        Integer iWeight
82990>>>>>>>        Boolean bOk
82990>>>>>>>
82990>>>>>>>        move (nWeight*100) To iWeight
82991>>>>>>>
82991>>>>>>>        Move (WP_SetHeaderFrame(eFrame,iColor,iWeight,iFillColor,bFillFrame)) To bOk
82992>>>>>>>
82992>>>>>>>         if not bOk begin
82994>>>>>>>            Error DFERR_WINPRINT DFPrintError930
82995>>>>>>>>
82995>>>>>>>        End
82995>>>>>>>>
82995>>>>>>>    End_Procedure
82996>>>>>>>
82996>>>>>>>  Procedure DFHeaderMargin Integer eType Number nSize
82998>>>>>>>        Boolean bOk
82998>>>>>>>        Integer iSize
82998>>>>>>>
82998>>>>>>>        move (nSize * 100) to iSize
82999>>>>>>>
82999>>>>>>>        move (WP_SetHeaderMargin(eType, iSize)) To bOk
83000>>>>>>>
83000>>>>>>>        if not bOk begin
83002>>>>>>>            Error DFERR_WINPRINT DFPrintError930
83003>>>>>>>>
83003>>>>>>>        end
83003>>>>>>>>
83003>>>>>>>    End_Procedure
83004>>>>>>>
83004>>>>>>>
83004>>>>>>>    //***
83004>>>>>>>    Procedure DFHeaderWrap Integer eOnOff
83006>>>>>>>         Boolean bOk
83006>>>>>>>
83006>>>>>>>         Move (WP_SetHeaderWrap(eOnOff)) To bOk
83007>>>>>>>
83007>>>>>>>         if not bOk begin
83009>>>>>>>            Error DFERR_WINPRINT DFPrintError931
83010>>>>>>>>
83010>>>>>>>        End
83010>>>>>>>>
83010>>>>>>>    End_Procedure
83011>>>>>>>
83011>>>>>>>    //***
83011>>>>>>>    Procedure DFWriteBMP String sFileName Number nStartX Number nStartY Number nHeight Number nWidth Boolean bUCp
83013>>>>>>>        Boolean bOk
83013>>>>>>>        Integer iStartX iStartY iHeight iWidth
83013>>>>>>>
83013>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX to iStartX
83016>>>>>>>        else ;            move (nStartX*100) To iStartX
83018>>>>>>>
83018>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY to iStartY
83021>>>>>>>        else ;            move (nStartY*100) To iStartY
83023>>>>>>>
83023>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
83026>>>>>>>        else ;            move (nWidth*100) To iWidth
83028>>>>>>>
83028>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
83031>>>>>>>        else ;            move (nHeight*100) To iHeight
83033>>>>>>>
83033>>>>>>>        Get_File_Path sFileName To sFileName
83034>>>>>>>        Move (WP_DrawBitmap(sFileName,iStartX,iStartY,iWidth,iHeight,bUCp)) to bOk
83035>>>>>>>
83035>>>>>>>        If not bOk Begin
83037>>>>>>>            Error DFERR_WINPRINT DFPrintError932
83038>>>>>>>>
83038>>>>>>>        End
83038>>>>>>>>
83038>>>>>>>    End_Procedure
83039>>>>>>>
83039>>>>>>>
83039>>>>>>>    //***
83039>>>>>>>    Procedure DFHeaderLineCheck Integer iLines
83041>>>>>>>        Boolean bOk
83041>>>>>>>
83041>>>>>>>         Move (WP_SetExtraLineCheck(iLines)) To bOk
83042>>>>>>>
83042>>>>>>>        If not bOk begin
83044>>>>>>>            Error DFERR_WINPRINT DFPrintError934
83045>>>>>>>>
83045>>>>>>>        End
83045>>>>>>>>
83045>>>>>>>    End_Procedure
83046>>>>>>>
83046>>>>>>>
83046>>>>>>>    //***
83046>>>>>>>    Procedure DFPrintFlags Integer Flags
83048>>>>>>>        Boolean bOk
83048>>>>>>>
83048>>>>>>>         Move (WP_SetPrintDialogFlags(Flags)) To bOk
83049>>>>>>>
83049>>>>>>>        If not bOk begin
83051>>>>>>>            Error DFERR_WINPRINT DFPrintError935
83052>>>>>>>>
83052>>>>>>>        End
83052>>>>>>>>
83052>>>>>>>    End_Procedure
83053>>>>>>>
83053>>>>>>>
83053>>>>>>>    //*** obsolete and maintained for winprint-I backwards compatibility (maybe should be removed)
83053>>>>>>>    //
83053>>>>>>>    Procedure DFSelectPrinter String sDriver String sDevice String sPort Boolean bUpdate
83055>>>>>>>        Send DFSetDevice sDevice
83056>>>>>>>    End_Procedure
83057>>>>>>>
83057>>>>>>>    //*** Preferred usage for WinprintII
83057>>>>>>>    Procedure DFSetDevice String sDevice
83059>>>>>>>        Boolean bOk
83059>>>>>>>
83059>>>>>>>        Move (WP_SelectPrinter(sDevice)) To bOk
83060>>>>>>>
83060>>>>>>>        If not bOk Begin
83062>>>>>>>            Error DFERR_WINPRINT DFPrintError936
83063>>>>>>>>
83063>>>>>>>        End
83063>>>>>>>>
83063>>>>>>>    End_Procedure
83064>>>>>>>
83064>>>>>>>    Procedure DFPrinterBinFirstPage Integer eBin
83066>>>>>>>        Boolean bOk
83066>>>>>>>
83066>>>>>>>         Move (WP_SetFirstPagePaperSource(eBin)) To bOk
83067>>>>>>>
83067>>>>>>>        If not bOk Begin
83069>>>>>>>            Error DFERR_WINPRINT DFPrintError937
83070>>>>>>>>
83070>>>>>>>        End
83070>>>>>>>>
83070>>>>>>>    End_Procedure
83071>>>>>>>
83071>>>>>>>
83071>>>>>>>    //***
83071>>>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
83073>>>>>>>        Integer iColor
83073>>>>>>>
83073>>>>>>>         Move (WP_RGBToDFPrintColor(iRed,iGreen,iBlue)) To iColor
83074>>>>>>>
83074>>>>>>>        If (iColor=0) Begin
83076>>>>>>>            Error DFERR_WINPRINT DFPrintError938
83077>>>>>>>>
83077>>>>>>>        End
83077>>>>>>>>
83077>>>>>>>        Function_Return iColor
83078>>>>>>>    End_Function
83079>>>>>>>
83079>>>>>>>
83079>>>>>>>    //***
83079>>>>>>>    Procedure DFSetDFColor Dword dwColor
83081>>>>>>>        Integer bOk
83081>>>>>>>
83081>>>>>>>         Move (WP_SetFontColor(dwColor)) To bOk
83082>>>>>>>
83082>>>>>>>        If not bOk Begin
83084>>>>>>>            Error DFERR_WINPRINT DFPrintError939
83085>>>>>>>>
83085>>>>>>>        End
83085>>>>>>>>
83085>>>>>>>    End_Procedure
83086>>>>>>>
83086>>>>>>>
83086>>>>>>>    //***
83086>>>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
83088>>>>>>>        Boolean bOk
83088>>>>>>>        Integer iTop iBottom
83088>>>>>>>
83088>>>>>>>        move (nTop*100)    To iTop
83089>>>>>>>        move (nBottom*100) To iBottom
83090>>>>>>>
83090>>>>>>>        Move (WP_SetAbsoluteMargins(iTop,iBottom,bAllPages)) To bOk
83091>>>>>>>
83091>>>>>>>        If Not bOk Begin
83093>>>>>>>            Error DFERR_WINPRINT DFPrintError940
83094>>>>>>>>
83094>>>>>>>        End
83094>>>>>>>>
83094>>>>>>>    End_Procedure
83095>>>>>>>
83095>>>>>>>
83095>>>>>>>    //***
83095>>>>>>>    Procedure DFSetJMode Integer eAlign
83097>>>>>>>        Boolean bOk
83097>>>>>>>
83097>>>>>>>        Move (WP_SetAlign(eAlign)) To bOk
83098>>>>>>>
83098>>>>>>>        If Not bOk Begin
83100>>>>>>>            Error DFERR_WINPRINT DFPrintError941
83101>>>>>>>>
83101>>>>>>>        End
83101>>>>>>>>
83101>>>>>>>    End_Procedure
83102>>>>>>>
83102>>>>>>>
83102>>>>>>>    //***
83102>>>>>>>    Procedure DFWriteEllip Number nStartX Number nStartY Number nHeight Number nWidth ;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
83104>>>>>>>
83104>>>>>>>        Boolean bOk
83104>>>>>>>        Integer iWeight
83104>>>>>>>        Integer iStartX iStartY iHeight iWidth
83104>>>>>>>
83104>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
83107>>>>>>>        else ;            move (nStartX*100) To iStartX
83109>>>>>>>
83109>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
83112>>>>>>>        else ;            move (nStartY*100) To iStartY
83114>>>>>>>
83114>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
83117>>>>>>>        else ;            move (nWidth*100) To iWidth
83119>>>>>>>
83119>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
83122>>>>>>>        else ;            move (nHeight*100) To iHeight
83124>>>>>>>
83124>>>>>>>        move (nWeight*100) To iWeight
83125>>>>>>>
83125>>>>>>>
83125>>>>>>>        Move (WP_DrawEllipse(iStartX,iStartY,iWidth,iHeight,;                        dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
83126>>>>>>>
83126>>>>>>>        If Not bOk Begin
83128>>>>>>>            Error DFERR_WINPRINT DFPrintError942
83129>>>>>>>>
83129>>>>>>>        End
83129>>>>>>>>
83129>>>>>>>    End_Procedure
83130>>>>>>>
83130>>>>>>>
83130>>>>>>>
83130>>>>>>>
83130>>>>>>>    //***
83130>>>>>>>    Procedure DFWriteRect Number nStartX Number nStartY Number nHeight Number nWidth;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
83132>>>>>>>
83132>>>>>>>        Boolean bOk
83132>>>>>>>        Integer iWeight
83132>>>>>>>        Integer iStartX iStartY iHeight iWidth
83132>>>>>>>
83132>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
83135>>>>>>>        else ;            move (nStartX*100) To iStartX
83137>>>>>>>
83137>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
83140>>>>>>>        else ;            move (nStartY*100) To iStartY
83142>>>>>>>
83142>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
83145>>>>>>>        else ;            move (nWidth*100) To iWidth
83147>>>>>>>
83147>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
83150>>>>>>>        else ;            move (nHeight*100) To iHeight
83152>>>>>>>
83152>>>>>>>        move (nWeight*100) To iWeight
83153>>>>>>>
83153>>>>>>>        Move (WP_DrawRectangle(iStartX,iStartY,iWidth,iHeight,;                            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
83154>>>>>>>
83154>>>>>>>        If Not bOk Begin
83156>>>>>>>            Error DFERR_WINPRINT DFPrintError944
83157>>>>>>>>
83157>>>>>>>        End
83157>>>>>>>>
83157>>>>>>>    End_Procedure
83158>>>>>>>
83158>>>>>>>
83158>>>>>>>
83158>>>>>>>
83158>>>>>>>    //***
83158>>>>>>>    Procedure DFLineCheck Integer iLines
83160>>>>>>>        Boolean bOk
83160>>>>>>>
83160>>>>>>>        Move (WP_ConfirmLines(iLines)) To bOk
83161>>>>>>>
83161>>>>>>>        If Not bOk Begin
83163>>>>>>>            Error DFERR_WINPRINT DFPrintError946
83164>>>>>>>>
83164>>>>>>>        End
83164>>>>>>>>
83164>>>>>>>    End_Procedure
83165>>>>>>>
83165>>>>>>>
83165>>>>>>>    //***
83165>>>>>>>    Procedure DFCreateDiagram Integer eType Integer eFx Number nHeight Number nWidth Integer bXyAxis
83167>>>>>>>        Handle hDiagram
83167>>>>>>>        Integer iWidth iHeight
83167>>>>>>>
83167>>>>>>>        move (nHeight*100) To iHeight
83168>>>>>>>        move (nWidth*100)  To iWidth
83169>>>>>>>
83169>>>>>>>        Set DFCurrent_Color To 0
83170>>>>>>>
83170>>>>>>>        Move (WP_CreateDiagram(eType,eFx,iWidth,iHeight,bXyAxis)) To hDiagram
83171>>>>>>>
83171>>>>>>>        If (hDiagram) Begin
83173>>>>>>>            Error DFERR_WINPRINT DFPrintError947
83174>>>>>>>>
83174>>>>>>>        End
83174>>>>>>>>
83174>>>>>>>        Else Begin
83175>>>>>>>            Set DFCurrent_Diagram To hDiagram
83176>>>>>>>        end
83176>>>>>>>>
83176>>>>>>>    End_Procedure
83177>>>>>>>
83177>>>>>>>
83177>>>>>>>    //***
83177>>>>>>>    Procedure DFDiagram_Item handle hDiagram String sLabel Number nValue;                             Dword dwBColor Dword dwFColor Integer eFill;                             Integer iDec Integer eValueOrPercent Integer eExt
83179>>>>>>>
83179>>>>>>>        Boolean bOk
83179>>>>>>>        Integer iCurrColor iValue
83179>>>>>>>
83179>>>>>>>        If (dwFColor = -1) Begin
83181>>>>>>>            Get DFCurrent_Color To iCurrColor
83182>>>>>>>            Increment iCurrColor
83183>>>>>>>            If (iCurrColor>15) Move 1 To iCurrColor
83186>>>>>>>            Set DFCurrent_Color To iCurrColor
83187>>>>>>>            Get DFGetColor iCurrColor To dwFColor
83188>>>>>>>        End
83188>>>>>>>>
83188>>>>>>>
83188>>>>>>>        Move (nValue *100) to iValue
83189>>>>>>>
83189>>>>>>>        Get ToAnsi sLabel To sLabel
83190>>>>>>>
83190>>>>>>>        Move (WP_AddDiagramEntry(hDiagram,sLabel,iValue,dwBColor,dwFColor,eFill,iDec,eValueorPercent,eExt)) To bOk
83191>>>>>>>
83191>>>>>>>        If not bOk Begin
83193>>>>>>>            Error DFERR_WINPRINT DFPrintError948
83194>>>>>>>>
83194>>>>>>>        End
83194>>>>>>>>
83194>>>>>>>    End_Procedure
83195>>>>>>>
83195>>>>>>>
83195>>>>>>>    //***
83195>>>>>>>    Procedure DFLockDiagram Handle hDiagram
83197>>>>>>>        Boolean bOk
83197>>>>>>>
83197>>>>>>>        Move (WP_LockDiagram(hDiagram)) To bOk
83198>>>>>>>
83198>>>>>>>        If not bOk Begin
83200>>>>>>>            Error DFERR_WINPRINT DFPrintError949
83201>>>>>>>>
83201>>>>>>>        End
83201>>>>>>>>
83201>>>>>>>    End_Procedure
83202>>>>>>>
83202>>>>>>>
83202>>>>>>>
83202>>>>>>>    //***
83202>>>>>>>    Procedure DFDrawDiagram Handle hDiagram Number nYPos Number nXPos Boolean bUCp
83204>>>>>>>        Boolean bOk
83204>>>>>>>        Integer iXPos
83204>>>>>>>        Integer iYPos
83204>>>>>>>
83204>>>>>>>        move (nXPos*100) To iXPos
83205>>>>>>>        move (nYPos*100) To iYPos
83206>>>>>>>
83206>>>>>>>        If nYPos Eq -999 Move -999 To iYPos
83209>>>>>>>
83209>>>>>>>        Move (WP_DrawDiagram(hDiagram,iXPos,iYPos,bUCp)) To bOk
83210>>>>>>>
83210>>>>>>>        If not bOk Begin
83212>>>>>>>            Error DFERR_WINPRINT DFPrintError950
83213>>>>>>>>
83213>>>>>>>        End
83213>>>>>>>>
83213>>>>>>>    End_Procedure
83214>>>>>>>
83214>>>>>>>
83214>>>>>>>
83214>>>>>>>    //***
83214>>>>>>>    Procedure DFDiagramLabel handle hDiagram String sLabel
83216>>>>>>>        Boolean bOk
83216>>>>>>>        Integer iLabelLen
83216>>>>>>>
83216>>>>>>>        Get ToAnsi sLabel To sLabel
83217>>>>>>>
83217>>>>>>>        Move (WP_SetDiagramCaption(hDiagram,sLabel)) To bOk
83218>>>>>>>
83218>>>>>>>        if not bOk Begin
83220>>>>>>>            Error DFERR_WINPRINT DFPrintError952
83221>>>>>>>>
83221>>>>>>>        End
83221>>>>>>>>
83221>>>>>>>    End_Procedure
83222>>>>>>>
83222>>>>>>>
83222>>>>>>>    //***
83222>>>>>>>    Procedure DFDiagramXLabel handle hDiagram String sLabel
83224>>>>>>>        Boolean bOk
83224>>>>>>>        Get ToAnsi sLabel To sLabel
83225>>>>>>>
83225>>>>>>>        Move (WP_SetDiagramXText(hDiagram,sLabel)) To bOk
83226>>>>>>>
83226>>>>>>>        if not bOk Begin
83228>>>>>>>            Error DFERR_WINPRINT DFPrintError953
83229>>>>>>>>
83229>>>>>>>        End
83229>>>>>>>>
83229>>>>>>>    End_Procedure
83230>>>>>>>
83230>>>>>>>
83230>>>>>>>    //***
83230>>>>>>>    Procedure DFDiagramYLabel handle hDiagram String sLabel Boolean bVertical
83232>>>>>>>        Boolean bOk
83232>>>>>>>        Get ToAnsi sLabel To sLabel
83233>>>>>>>
83233>>>>>>>        Move (WP_SetDiagramYText(hDiagram,sLabel,bVertical)) To bOk
83234>>>>>>>
83234>>>>>>>        if not bOk Begin
83236>>>>>>>            Error DFERR_WINPRINT DFPrintError954
83237>>>>>>>>
83237>>>>>>>        End
83237>>>>>>>>
83237>>>>>>>    End_Procedure
83238>>>>>>>
83238>>>>>>>
83238>>>>>>>    //***
83238>>>>>>>    Procedure DFWriteXYLine Number nStartX Number nStartY Number nStopX Number nStopY;              Dword dwColor Number nWeight Boolean bWrap Boolean bUCp
83240>>>>>>>
83240>>>>>>>        Boolean bOk
83240>>>>>>>        Integer iStartX iStartY iStopX iStopY
83240>>>>>>>        Integer iWeight
83240>>>>>>>
83240>>>>>>>        move (nStartX*100)  To iStartX
83241>>>>>>>        move (nStartY*100)  To iStartY
83242>>>>>>>        move (nStopX*100)   To iStopX
83243>>>>>>>        move (nStopY*100)   To iStopY
83244>>>>>>>
83244>>>>>>>        move (nWeight*100) To iWeight
83245>>>>>>>
83245>>>>>>>        If (nStopY  = -998) Move -998 To iStopY
83248>>>>>>>        If (nStopX  = -998) Move -998 To iStopX
83251>>>>>>>
83251>>>>>>>        If (nStartY  = -999) Move -999 To iStartY
83254>>>>>>>        If (nStartX  = -999) Move -999 To iStartX
83257>>>>>>>
83257>>>>>>>        Move (WP_DrawXYLine(iStartX,iStartY,iStopX,iStopY,dwColor,iWeight,bUCp,bWrap)) To bOk
83258>>>>>>>
83258>>>>>>>        if not bOk Begin
83260>>>>>>>            Error DFERR_WINPRINT DFPrintError955
83261>>>>>>>>
83261>>>>>>>        End
83261>>>>>>>>
83261>>>>>>>    End_Procedure
83262>>>>>>>
83262>>>>>>>
83262>>>>>>>    //***
83262>>>>>>>    Procedure DFWriteLine Number nStartX Number nStartY Number nLength;                          Boolean bHorizontal Dword dwColor Number nWeight Boolean bUCp
83264>>>>>>>
83264>>>>>>>        Boolean bOk
83264>>>>>>>        Integer iStartX iStartY iLength
83264>>>>>>>        Integer iWeight
83264>>>>>>>
83264>>>>>>>        move (nStartX*100)  To iStartX
83265>>>>>>>        move (nStartY*100)  To iStartY
83266>>>>>>>        move (nLength*100)  To iLength
83267>>>>>>>        move (nWeight*100)  To iWeight
83268>>>>>>>
83268>>>>>>>        If (nStartY = -999) Move -999 To iStartY
83271>>>>>>>        If (nStartX = -999) Move -999 To iStartX
83274>>>>>>>        If (nLength = -998) Move -998 To iLength
83277>>>>>>>
83277>>>>>>>        Move (WP_DrawLine(iSTartX,iStartY,iLength,bHorizontal,dwColor,iWeight,bUCp)) To bOk
83278>>>>>>>
83278>>>>>>>        if not bOk Begin
83280>>>>>>>            Error DFERR_WINPRINT DFPrintError956
83281>>>>>>>>
83281>>>>>>>        End
83281>>>>>>>>
83281>>>>>>>    End_Procedure
83282>>>>>>>
83282>>>>>>>
83282>>>>>>>    //***
83282>>>>>>>    Procedure DFClearPrinter
83284>>>>>>>        Boolean bOk
83284>>>>>>>
83284>>>>>>>        Move (WP_ClearPrinter()) To bOk
83285>>>>>>>
83285>>>>>>>        If not bOk Begin
83287>>>>>>>            Error DFERR_WINPRINT DFPrintError957
83288>>>>>>>>
83288>>>>>>>        End
83288>>>>>>>>
83288>>>>>>>    End_Procedure
83289>>>>>>>
83289>>>>>>>
83289>>>>>>>
83289>>>>>>>    //***
83289>>>>>>>     Function DFGetCurrentDevice Returns String
83291>>>>>>>        Boolean bOk
83291>>>>>>>        String  sDFStr
83291>>>>>>>        Address pDFStr
83291>>>>>>>
83291>>>>>>>        Move (Repeat( Character(0), 255 )) to sDFStr
83292>>>>>>>        GetAddress of sDFStr to pDFStr
83293>>>>>>>
83293>>>>>>>        Move (WP_GetCurrentDevice(pDFStr)) To bOk
83294>>>>>>>
83294>>>>>>>        If not bOk Begin
83296>>>>>>>            Error DFERR_WINPRINT DFPrintError959
83297>>>>>>>>
83297>>>>>>>        End
83297>>>>>>>>
83297>>>>>>>
83297>>>>>>>        Move (CString(sDFStr)) To sDFStr
83298>>>>>>>        Function_Return sDFStr
83299>>>>>>>     End_Function
83300>>>>>>>
83300>>>>>>>
83300>>>>>>>    // Note: DfGetCurrentPort and DFGetCurrentDriver do not exist in winprint2. Trying to
83300>>>>>>>    //       use these will result in a runtime error (which is good - don't use them)
83300>>>>>>>
83300>>>>>>>
83300>>>>>>>    //***
83300>>>>>>>     Function DFGetPrintDialogFlags Returns Dword
83302>>>>>>>        Dword dwRetVal
83302>>>>>>>
83302>>>>>>>        Move (WP_GetPrintDialogFlags()) To dwRetVal
83303>>>>>>>
83303>>>>>>>        Function_Return dwRetVal
83304>>>>>>>     End_Function
83305>>>>>>>
83305>>>>>>>
83305>>>>>>>    //***
83305>>>>>>>    //*** Returns PRN_TRUE=  if the flag is set     (1)
83305>>>>>>>    //*** Returns PRN_FALSE= If the flag not is set (0)
83305>>>>>>>    //***
83305>>>>>>>     Function DFCheckPrintDialogFlag Dword dwPDFlag Returns Boolean
83307>>>>>>>        Boolean bIsSet
83307>>>>>>>
83307>>>>>>>        Move (WP_IsPrintDialogFlagSet(dwPDFlag)) To bIsSet
83308>>>>>>>
83308>>>>>>>        Function_Return bIsSet
83309>>>>>>>     End_Function
83310>>>>>>>
83310>>>>>>>
83310>>>>>>>    //***
83310>>>>>>>     Procedure DFSetSpecPrintFlag Dword dwPDFlag
83312>>>>>>>        Boolean bOk
83312>>>>>>>
83312>>>>>>>        Move (WP_SetSpecificPrintDialogFlag(dwPDFlag)) To bOk
83313>>>>>>>
83313>>>>>>>        If not bOk Begin
83315>>>>>>>            Error DFERR_WINPRINT DFPrintError961
83316>>>>>>>>
83316>>>>>>>        End
83316>>>>>>>>
83316>>>>>>>     End_Procedure
83317>>>>>>>
83317>>>>>>>
83317>>>>>>>    //***
83317>>>>>>>     Function DFGetUserDefinedLength Returns Number
83319>>>>>>>        Integer iRetVal
83319>>>>>>>        Number  nRetVal
83319>>>>>>>
83319>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
83320>>>>>>>
83320>>>>>>>        If (iRetVal=0) Begin
83322>>>>>>>            Error DFERR_WINPRINT DFPrintError962
83323>>>>>>>>
83323>>>>>>>            Function_Return 0
83324>>>>>>>        End
83324>>>>>>>>
83324>>>>>>>
83324>>>>>>>        Move (Hi(iRetVal)) To nRetVal
83325>>>>>>>        move (nRetVal/100) To nRetVal //Returns CM
83326>>>>>>>
83326>>>>>>>        Function_Return nRetVal
83327>>>>>>>     End_Function
83328>>>>>>>
83328>>>>>>>
83328>>>>>>>    //***
83328>>>>>>>     Function DFGetUserDefinedWidth Returns Number
83330>>>>>>>        Integer iRetVal
83330>>>>>>>        Number  nRetVal
83330>>>>>>>
83330>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
83331>>>>>>>
83331>>>>>>>        If (iRetVal=0) Begin
83333>>>>>>>            Error DFERR_WINPRINT DFPrintError963
83334>>>>>>>>
83334>>>>>>>            Function_Return 0
83335>>>>>>>        End
83335>>>>>>>>
83335>>>>>>>
83335>>>>>>>        Move (Low(iRetVal)) To nRetVal
83336>>>>>>>        Move (nRetVal/100) To nRetVal //Returns CM
83337>>>>>>>
83337>>>>>>>        Function_Return nRetVal
83338>>>>>>>     End_Function
83339>>>>>>>
83339>>>>>>>
83339>>>>>>>    //*** To be set in CM
83339>>>>>>>     Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
83341>>>>>>>        Integer bOk
83341>>>>>>>        Integer iLength iWidth iSize
83341>>>>>>>
83341>>>>>>>        move (nLength*100) To iLength
83342>>>>>>>        move (nWidth*100)  To iWidth
83343>>>>>>>        move ((iLength*65536)+iWidth) To iSize
83344>>>>>>>
83344>>>>>>>        Move (WP_SetUserDefinedPapersize(iSize)) To bOk
83345>>>>>>>
83345>>>>>>>        If not bOk Begin
83347>>>>>>>            Error DFERR_WINPRINT DFPrintError964
83348>>>>>>>>
83348>>>>>>>        End
83348>>>>>>>>
83348>>>>>>>     End_Procedure
83349>>>>>>>
83349>>>>>>>     Procedure DFSetNumberOfCopies Integer iNrOfCopies
83351>>>>>>>        Boolean bOk
83351>>>>>>>
83351>>>>>>>        Move (WP_SetNumberOfPrintCopies(iNrOfCopies)) to bOk
83352>>>>>>>
83352>>>>>>>        If not bOk Begin
83354>>>>>>>            Error DFERR_WINPRINT DFPrintError965
83355>>>>>>>>
83355>>>>>>>        end
83355>>>>>>>>
83355>>>>>>>     End_Procedure
83356>>>>>>>
83356>>>>>>>
83356>>>>>>>
83356>>>>>>>
83356>>>>>>>    //*************************************************************
83356>>>>>>>    //*** This procedures and functions are used when building  ***
83356>>>>>>>    //*** complex graphics when you need to change value of the ***
83356>>>>>>>    //*** current diagram, so you can mix diagrams within each  ***
83356>>>>>>>    //*** other.                                                ***
83356>>>>>>>    //*************************************************************
83356>>>>>>>
83356>>>>>>>
83356>>>>>>>    Function DFGetCurrentDiagram Returns Integer
83358>>>>>>>        Integer iRetVal
83358>>>>>>>        Get DFCurrent_Diagram To iRetVal
83359>>>>>>>        Function_Return iRetVal
83360>>>>>>>    End_Function
83361>>>>>>>
83361>>>>>>>    Procedure DFSetCurrentDiagram Integer iDiagram
83363>>>>>>>        Set DFCurrent_Diagram To iDiagram
83364>>>>>>>    End_Procedure
83365>>>>>>>
83365>>>>>>>    Procedure DFSetDiagramList Integer iItem Integer iDiagram
83367>>>>>>>        Set Value of oDiagramArray iItem To iDiagram
83368>>>>>>>    End_Procedure
83369>>>>>>>
83369>>>>>>>    Function DFGetDiagramList Integer iItem Returns Integer
83371>>>>>>>        Integer iRetVal
83371>>>>>>>        Get Value of oDiagramArray iItem To iRetVal
83372>>>>>>>        Function_Return iRetVal
83373>>>>>>>    End_Function
83374>>>>>>>
83374>>>>>>>    Procedure DFClearDiagramList
83376>>>>>>>        Send Delete_Data To oDiagramArray
83377>>>>>>>    End_Procedure
83378>>>>>>>
83378>>>>>>>
83378>>>>>>>    Function DFGetColor Integer iColor Returns Dword
83380>>>>>>>        Dword   dwRetVal
83380>>>>>>>        Get Value of oDFColorArray iColor To dwRetVal
83381>>>>>>>        Function_Return dwRetVal
83382>>>>>>>    End_Function
83383>>>>>>>
83383>>>>>>>    Function DFGetCurrentColor Returns Dword
83385>>>>>>>        Dword   dwRetVal
83385>>>>>>>        Integer iCurrColor
83385>>>>>>>
83385>>>>>>>        Get DFCurrent_Color To iCurrColor
83386>>>>>>>        Get DFGetColor iCurrColor To dwRetVal
83387>>>>>>>
83387>>>>>>>        Function_Return dwRetVal
83388>>>>>>>    End_Function
83389>>>>>>>
83389>>>>>>>    Procedure DFEndDocument
83391>>>>>>>        integer iVoid
83391>>>>>>>        Move (WP_EndDocument()) To iVoid
83392>>>>>>>        Send DfSuspendGui False
83393>>>>>>>    End_procedure
83394>>>>>>>
83394>>>>>>>    Procedure DFClosePreview
83396>>>>>>>        integer iVoid
83396>>>>>>>        Move (WP_ClosePreview()) To iVoid
83397>>>>>>>        Send DfSuspendGui False
83398>>>>>>>    End_procedure
83399>>>>>>>
83399>>>>>>>    Procedure SetProgressCaption string sCaption
83401>>>>>>>        integer iVoid
83401>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
83402>>>>>>>        Move (WP_SetProgressCaption(sCaption)) To iVoid
83403>>>>>>>    End_procedure
83404>>>>>>>
83404>>>>>>>    Procedure SetReportTitle string sTitle
83406>>>>>>>        integer iVoid
83406>>>>>>>        Move (ToAnsi(sTitle)) to sTitle
83407>>>>>>>        Move (WP_SetReportTitle(sTitle)) To iVoid
83408>>>>>>>    End_procedure
83409>>>>>>>
83409>>>>>>>    Function PreviewYesNoBox string sCaption string sText returns integer
83411>>>>>>>        integer eResult
83411>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
83412>>>>>>>        Move (ToAnsi(sText))    to sText
83413>>>>>>>        Move (WP_DisplayMessageBox(sCaption, sText)) To eResult
83414>>>>>>>        Function_return eResult
83415>>>>>>>    end_function
83416>>>>>>>
83416>>>>>>>    // internal function, used to extract different printer flags ranges based on
83416>>>>>>>    // the print flag integer. These flags use a decimal style of packing information
83416>>>>>>>    // where different printer options (paper, bin, etc) use different ranges and
83416>>>>>>>    // different steps. Everything above iTopVal is removed and everything that is not
83416>>>>>>>    // within the iStep range is removed.
83416>>>>>>>    Function PrintFlagRange integer iTopVal integer iStep returns integer
83418>>>>>>>        integer iFgs iFg
83418>>>>>>>        Get DFGetPrintDialogFlags to iFg
83419>>>>>>>        Move (mod(iFg,iTopVal) / iStep * iStep ) to iFg
83420>>>>>>>        function_return iFg
83421>>>>>>>    end_Function
83422>>>>>>>
83422>>>>>>>    Procedure DFSetPrinterPaper integer ePaperType
83424>>>>>>>        Send DFSetSpecPrintFlag ePaperType
83425>>>>>>>    End_Procedure
83426>>>>>>>
83426>>>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
83428>>>>>>>        integer ePaperType
83428>>>>>>>        Get PrintFlagRange 500 10 to ePaperType // 10-490 in steps of 10
83429>>>>>>>        function_return ePaperType
83430>>>>>>>    End_Function
83431>>>>>>>
83431>>>>>>>
83431>>>>>>>    Procedure DFSetPrinterBin integer eBinType
83433>>>>>>>        Send DFSetSpecPrintFlag eBinType
83434>>>>>>>    End_Procedure
83435>>>>>>>
83435>>>>>>>    Function DFGetPrinterBin returns integer //eBinType
83437>>>>>>>        integer eBinType
83437>>>>>>>        Get PrintFlagRange 10000 500 to eBinType // 1000-9000 steps 500
83438>>>>>>>        function_return eBinType
83439>>>>>>>    End_Function
83440>>>>>>>
83440>>>>>>>
83440>>>>>>>    Procedure DFSetPrinterResolution integer eResType
83442>>>>>>>        Send DFSetSpecPrintFlag eResType
83443>>>>>>>    End_Procedure
83444>>>>>>>
83444>>>>>>>    Function DFGetPrinterResolution returns integer //eResType
83446>>>>>>>        integer eResType
83446>>>>>>>        Get PrintFlagRange 50000 10000 to eResType // 10000-500000 steps 10000
83447>>>>>>>        function_return eResType
83448>>>>>>>    End_Function
83449>>>>>>>
83449>>>>>>>
83449>>>>>>>    Procedure DFSetLandscape boolean bIsLandscape
83451>>>>>>>        Send DFSetSpecPrintFlag (If(bIsLandscape,DF_Landscape,DF_Portrait))
83452>>>>>>>    End_Procedure
83453>>>>>>>
83453>>>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
83455>>>>>>>        boolean bIsLandscape
83455>>>>>>>        Get DFCheckPrintDialogFlag DF_Landscape to bIsLandscape
83456>>>>>>>        function_return bIsLandscape
83457>>>>>>>    End_Function
83458>>>>>>>
83458>>>>>>>    Function RGBToWPColor integer iRgb returns integer
83460>>>>>>>        integer iRed iGreen iBlue
83460>>>>>>>        integer iWPColor
83460>>>>>>>        Move (R_from_rgb(iRGB)) to iRed
83461>>>>>>>        Move (G_from_rgb(iRGB)) to iGreen
83462>>>>>>>        Move (B_from_rgb(iRGB)) to iBlue
83463>>>>>>>        Get DfGetDfColor iRed iGreen iBlue to iWPColor
83464>>>>>>>        function_Return iWPColor
83465>>>>>>>    end_function
83466>>>>>>>
83466>>>>>>>
83466>>>>>>>
83466>>>>>>>End_Class
83467>>>>>>>
83467>>>>>>>Global_Variable Integer ghoWinPrint2
83467>>>>>>>
83467>>>>>>>Get Create of desktop U_cWinPrint2 to ghoWinPrint2
83468>>>>>>>
83468>>>>>>>
83468>>>>>Use Winprint_Commands.pkg  // commands used by this class
83468>>>>>
83468>>>>>Class cWinReport2 is a BasicReport
83469>>>>>
83469>>>>>    Procedure Construct_Object
83471>>>>>        Forward send construct_object
83473>>>>>
83473>>>>>        Date Today
83473>>>>>        Sysdate Today
83474>>>>>
83474>>>>>        // should use built in DF function CurrentDateTime()
83474>>>>>        Property Date  RptToday    Today
83475>>>>>
83475>>>>>        Object RptTotal is an Array
83477>>>>>        End_Object
83478>>>>>
83478>>>>>        // If true, report is output upon completion. Either preview
83478>>>>>        // or printer depending on output_device_mode
83478>>>>>        Property Boolean AutoOutput_State True
83479>>>>>
83479>>>>>        // When a new page is created (DFNew_Page) and the number
83479>>>>>        // of columns is not passed, this is used.
83479>>>>>        Property Integer Print_Columns 0
83480>>>>>
83480>>>>>        // This determines if a DFNew_Page should be executed when the
83480>>>>>        // report starts. In some rare cases, you would not want this to
83480>>>>>        // occur until a subheader
83480>>>>>        Property Boolean AutoNew_Page_State True
83481>>>>>
83481>>>>>        // Output device (print or preview). Normally this is delegated to
83481>>>>>        // the report view.
83481>>>>>        //
83481>>>>>
83481>>>>>        Property Integer Private.Output_Device_Mode PRINT_TO_UNDEFINED
83482>>>>>
83482>>>>>        Property Handle phoWinPrint  ghoWinPrint2 // the report engine to use.
83483>>>>>
83483>>>>>        // JJT: For now this is for testing.
83483>>>>>        Property boolean pbModalViewer False
83484>>>>>
83484>>>>>        Property boolean pbMultiReports False
83485>>>>>
83485>>>>>        Property boolean pbFirstPagePrinted false
83486>>>>>
83486>>>>>    End_Procedure
83487>>>>>
83487>>>>>    // returns the current status of Winprint Document object. dsNotStarted, dsStarted, dsFinished
83487>>>>>    // note that the status can reflect a status from a different report. The winprint object is global.
83487>>>>>    Function DocumentStatus returns Boolean
83489>>>>>        integer iStatus
83489>>>>>        Get DocumentStatus of (phoWinprint(self)) to iStatus
83490>>>>>        function_return iStatus
83491>>>>>    End_function
83492>>>>>
83492>>>>>    Function IsViewerActive Returns Boolean
83494>>>>>        Boolean bIsActive
83494>>>>>        Get IsViewerActive of (phoWinPrint(Self)) to bIsActive
83495>>>>>        Function_Return bIsActive
83496>>>>>    End_Function
83497>>>>>
83497>>>>>    Function IsPrinterValid Returns Boolean
83499>>>>>        Function_Return (WP_IsPrinterValid()<>0)
83500>>>>>    End_Function
83501>>>>>
83501>>>>>    Function ArePrintersInstalled Returns Boolean
83503>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
83504>>>>>    End_Function
83505>>>>>
83505>>>>>
83505>>>>>    // All subtotal commands use the outer main report. This makes it easier to keep
83505>>>>>    // track of these numbers
83505>>>>>
83505>>>>>    Procedure Add_SubTotal Integer iCounter Number nData
83507>>>>>        Number nValue
83507>>>>>        Integer iObj
83507>>>>>        Move (RptTotal(Main_Report_Id(Self))) to iObj
83508>>>>>        Get Number_Value of iObj iCounter To nValue
83509>>>>>        Add nData To nValue
83510>>>>>        Set Array_Value of iObj iCounter To nValue
83511>>>>>    End_Procedure
83512>>>>>
83512>>>>>    Procedure Clr_SubTotal Integer iCounter
83514>>>>>        Set Array_Value of (RptTotal(Main_Report_Id(Self))) iCounter To 0
83515>>>>>    End_Procedure
83516>>>>>
83516>>>>>    Procedure Clr_AllSubTotals
83518>>>>>        Send Delete_Data of (RptTotal(Main_Report_Id(Self)))
83519>>>>>    End_Procedure
83520>>>>>
83520>>>>>    Function Sum_SubTotal Integer iTotal Returns Number
83522>>>>>        Number nRetVal
83522>>>>>        Get Number_Value of (RptTotal(Main_Report_Id(Self))) iTotal To nRetVal
83523>>>>>        Function_Return nRetVal
83524>>>>>    End_Function
83525>>>>>
83525>>>>>    //Return sub-total and clear accumulator
83525>>>>>    //
83525>>>>>    Function SubTotal Integer iTotal Returns Number
83527>>>>>        Number nRetVal
83527>>>>>        Get Sum_SubTotal  iTotal to nRetVal
83528>>>>>        Send Clr_SubTotal iTotal
83529>>>>>        Function_Return nRetVal
83530>>>>>    End_Function
83531>>>>>
83531>>>>>
83531>>>>>    // Note: Cols is optional. If no argument is passed it will use
83531>>>>>    //       the object's property Print_Columns (0 by default)
83531>>>>>    //
83531>>>>>    Procedure DFNew_Page Integer Cols
83533>>>>>        Integer PageNumber Columns
83533>>>>>        Boolean bFirstPagePrinted
83533>>>>>        // If no args passed used default setting
83533>>>>>        If (Num_Arguments=0) ;           Move (Print_Columns(Main_Report_id(Self))) to Columns
83536>>>>>        Else ;           Move Cols to Columns
83538>>>>>        Set Page_Feed   to -2   // No FormFeed
83539>>>>>        If (Child_Rpt_State(self)) ;            Send DFNew_Page of (Main_Report_Id(Self)) Columns
83542>>>>>        Else Begin
83543>>>>>            // we only want to print report_header once. When report starts
83543>>>>>            // this is set true, after the first print it is false. You can set
83543>>>>>            // this to true before and explicit dfNew_page to force a header
83543>>>>>            Get pbFirstPagePrinted to bFirstPagePrinted
83544>>>>>            Get  DFNewPage of (phoWinPrint(self)) Columns To PageNumber
83545>>>>>            If (PageNumber<>0) begin // if 0, it failed
83547>>>>>                Set No_PageCheck_State to True
83548>>>>>
83548>>>>>                //Top section
83548>>>>>                Send Page_Top
83549>>>>>                If Not bFirstPagePrinted Send Report_Header
83552>>>>>                Send Page_Header
83553>>>>>                Send Page_Title
83554>>>>>
83554>>>>>                Set New_Page_State to False
83555>>>>>                Set Page_End_State to False
83556>>>>>                Set No_PageCheck_State to False        // No longer Paging
83557>>>>>                Set pbFirstPagePrinted to True
83558>>>>>            End
83558>>>>>>
83558>>>>>        End
83558>>>>>>
83558>>>>>
83558>>>>>        // Footer section
83558>>>>>        //
83558>>>>>        // DO NOT CHANGE THE ORDER OF BOTTOM SECTIONS !!!!!
83558>>>>>        //
83558>>>>>
83558>>>>>        Send Page_Bottom
83559>>>>>
83559>>>>>        // in WinPrint it is not possible to replace Page_Footer
83559>>>>>        // with Report_Footer. If you use Report_Footer you will
83559>>>>>        // have both Page_Footer and Report_Footer
83559>>>>>        //
83559>>>>>        //If LastTime eq 0 Send Page_Footer
83559>>>>>        //else             Send Report_Footer
83559>>>>>
83559>>>>>        Send Page_Footer
83560>>>>>        Send Page_Total
83561>>>>>    End_Procedure
83562>>>>>
83562>>>>>    Procedure Ending_Main_Report
83564>>>>>        Boolean bCancel bMultiReports
83564>>>>>
83564>>>>>        Get Cancelled_state to bCancel
83565>>>>>        Get pbMultiReports to bMultiReports
83566>>>>>
83566>>>>>        Forward Send Ending_Main_Report
83568>>>>>
83568>>>>>        If bCancel Begin
83570>>>>>            Send DFEndDocument
83571>>>>>            Send DFClearDoc // this will also close the previewer
83572>>>>>        end
83572>>>>>>
83572>>>>>        Else Begin
83573>>>>>            Send Report_Footer
83574>>>>>
83574>>>>>            // if multi-reports, we don't do an end of report yet. The programmer must
83574>>>>>            // manually end the report by sending EndMultiReport
83574>>>>>            If (not(bMultiReports)) begin
83576>>>>>                Send EndWinPrintReport
83577>>>>>            end
83577>>>>>>
83577>>>>>
83577>>>>>        end
83577>>>>>>
83577>>>>>
83577>>>>>    End_Procedure
83578>>>>>
83578>>>>>    // This must get called when you are running multiple reports (pbMultiReport).
83578>>>>>    // Send this when the last report is complete.
83578>>>>>    Procedure EndMultiReport
83580>>>>>        Send EndWinPrintReport
83581>>>>>    End_procedure
83582>>>>>
83582>>>>>
83582>>>>>    Procedure EndWinPrintReport
83584>>>>>        Boolean bAutoOutput
83584>>>>>        integer iStatus eMode
83584>>>>>        Get DocumentStatus to iStatus
83585>>>>>        If (iStatus<>dsStarted) procedure_return
83588>>>>>
83588>>>>>        // this tells winprint that the report is complete
83588>>>>>        Send DFEndDocument
83589>>>>>        // if auto-output we print or display automatically.
83589>>>>>        // for winprint2, if in preview mode you must do this so the previewer can enter
83589>>>>>        // a modal state (which it may or may not need to do).
83589>>>>>        Get AutoOutput_state to bAutoOutput
83590>>>>>        Get Output_device_mode to eMode
83591>>>>>        If (bAutoOutput or eMode=PRINT_TO_WINDOW) begin
83593>>>>>            Send PrintReport
83594>>>>>            // if auto output, we assume that you are done when it is all over
83594>>>>>            // we only can do this with the modal viewer
83594>>>>>            If (bAutoOutput and pbModalViewer(self)) begin
83596>>>>>                Send DFClearDoc
83597>>>>>            end
83597>>>>>>
83597>>>>>        end
83597>>>>>>
83597>>>>>
83597>>>>>    End_Procedure
83598>>>>>
83598>>>>>
83598>>>>>    Function Setup_Report Returns Integer
83600>>>>>        Integer iErr iStatus eMode
83600>>>>>        Boolean bActiveViewer bChildReport bMultiReports bOk
83600>>>>>
83600>>>>>        Get Child_rpt_state to bChildReport
83601>>>>>
83601>>>>>        If not bChildReport Begin
83603>>>>>
83603>>>>>            // This makes sure that we are pointing to the new winprint2 engine object.
83603>>>>>            // normally this will be the new winprint, but it can be redirected
83603>>>>>            Get phoWinPrint to WinPrintID
83604>>>>>
83604>>>>>            // winprint must have installed printer. If not installed, generate error and stop the report
83604>>>>>            Get ArePrintersInstalled to bOk
83605>>>>>            If not bOk Begin
83607>>>>>                Error DFERR_WINPRINT C_$NoInstalledPrinters
83608>>>>>>
83608>>>>>                Function_Return 1
83609>>>>>            End
83609>>>>>>
83609>>>>>
83609>>>>>            // check if selected printer is valid. If not, generate error and stop the report
83609>>>>>            Get IsPrinterValid to bOk
83610>>>>>            If not bOk Begin
83612>>>>>                Error DFERR_WINPRINT DFPrintError936    // Could not select a valid printer
83613>>>>>>
83613>>>>>                Function_Return 1
83614>>>>>            End
83614>>>>>>
83614>>>>>
83614>>>>>            // make sure it is ok to start a new report but try to be smart about it.
83614>>>>>            // if a report is active (dsstarted or dsFinished) check to see if it is
83614>>>>>            // finished w/ no viewer. If so, assume the user closed the report and is done
83614>>>>>            // so just clear the report. If a viewer is present, declare an error.
83614>>>>>            Get DocumentStatus to iStatus
83615>>>>>            Get pbMultiReports to bMultiReports
83616>>>>>            // multi-report only in-progress is multi and it is started
83616>>>>>            Move (bMultiReports and iStatus=dsStarted) to bMultiReports
83617>>>>>            If not bMultiReports Begin
83619>>>>>                If (iStatus<>dsNotStarted) Begin
83621>>>>>                    Get IsViewerActive to bActiveViewer
83622>>>>>                    If (iStatus=dsFinished and not(bActiveViewer)) Begin
83624>>>>>                        Send DfClearDoc
83625>>>>>                    End
83625>>>>>>
83625>>>>>                    Else Begin
83626>>>>>                        Error DFERR_WINPRINT DFPrintError967
83627>>>>>>
83627>>>>>                        Function_Return 1
83628>>>>>                    End
83628>>>>>>
83628>>>>>                End
83628>>>>>>
83628>>>>>
83628>>>>>                // all new reports by default allow printing from viewer and they have the print job set up when you select print
83628>>>>>                // if you need to change these defaults, you can change these inside of Starting_main_report
83628>>>>>                // We only do this with non-multi-reports.
83628>>>>>                Send DFSetPrintDlgInPreview      True
83629>>>>>                Send DFSetEnablePrintFromPreview True
83630>>>>>
83630>>>>>            End
83630>>>>>>
83630>>>>>
83630>>>>>            // In the new winprint, this message is not needed and is a stub. For
83630>>>>>            // now it is in here for compatibility purposes
83630>>>>>            //You MUST always start a new report with this procedure
83630>>>>>            Send DFZeroCounters of (phoWinPrint(Self))
83631>>>>>            Send Clr_AllSubTotals
83632>>>>>
83632>>>>>        End
83632>>>>>>
83632>>>>>
83632>>>>>        Forward Get Setup_report to iErr
83634>>>>>
83634>>>>>        If (iErr=0) Begin
83636>>>>>            If not bChildReport Begin
83638>>>>>                // if part of a multi-report we don't do a new doc
83638>>>>>                If not bMultiReports Begin
83640>>>>>                    Get Output_Device_Mode to eMode
83641>>>>>                    Send DFNewDoc of (phoWinPrint(Self))  (eMode = PRINT_TO_WINDOW) // pass True of display while printing
83642>>>>>                End
83642>>>>>>
83642>>>>>                // Do new page if not part of a multi-report and we say don't do a new page
83642>>>>>                If (not(bMultiReports) or AutoNew_Page_State(Self)) Begin
83644>>>>>                    Set pbFirstPagePrinted to False // tells new page that this is the first time for this report
83645>>>>>                    Send DFNew_page
83646>>>>>                End
83646>>>>>>
83646>>>>>            End
83646>>>>>>
83646>>>>>        End
83646>>>>>>
83646>>>>>        Function_Return iErr
83647>>>>>    End_Function
83648>>>>>
83648>>>>>
83648>>>>>
83648>>>>>    // Cancel RO behavior - there is no device to close
83648>>>>>    //
83648>>>>>    Procedure Close_Output_Device
83650>>>>>    End_Procedure
83651>>>>>
83651>>>>>    // Cancel RO Behavior
83651>>>>>    //
83651>>>>>    Procedure Initialize_Output_Device
83653>>>>>    End_procedure
83654>>>>>
83654>>>>>
83654>>>>>    Function Output_Device_Mode Returns Integer
83656>>>>>        Integer hoId
83656>>>>>        String DevMode
83656>>>>>        Get Private.Output_Device_Mode to DevMode
83657>>>>>        If (DevMode=PRINT_TO_UNDEFINED) Begin
83659>>>>>            Get Report_View_Id to hoId
83660>>>>>            If hoID ;                Get OutPut_Device_Mode of hoID to DevMode
83663>>>>>            If (DevMode=PRINT_TO_UNDEFINED) ;                Move PRINT_TO_WINDOW to DevMode
83666>>>>>        End
83666>>>>>>
83666>>>>>        Function_Return DevMode
83667>>>>>    End_Function // Output_Destination
83668>>>>>
83668>>>>>    Procedure Set Output_Device_Mode Integer DevMode
83670>>>>>        Set Private.Output_Device_Mode to DevMode
83671>>>>>    End_Procedure // Set Output_Device
83672>>>>>
83672>>>>>    // displays a metric ruler in .5 increments. This can be
83672>>>>>    // sent to make it easy to see how fields and labels should
83672>>>>>    // be moved for alignment.
83672>>>>>    //
83672>>>>>    Procedure ShowRuler
83674>>>>>        integer i
83674>>>>>        number n
83674>>>>>        for i from 0 to 30
83680>>>>>>
83680>>>>>            Send DFWritePos of (phoWinPrint(self)) (String(i)) FONT_DEFAULT i -1 0
83681>>>>>            Move (i+.5) to n
83682>>>>>            Send DFWritePos of (phoWinPrint(self)) "." FONT_DEFAULT n -1 0
83683>>>>>        Loop
83684>>>>>>
83684>>>>>        Send DFWriteln of (phoWinPrint(self)) ''  FONT_DEFAULT FONT_DEFAULT -1
83685>>>>>    End_procedure
83686>>>>>
83686>>>>>      // status panel related agumentations to handle the auto-previewer
83686>>>>>
83686>>>>>      Procedure Update_Status string sVal
83688>>>>>         Integer eMode
83688>>>>>         Get Output_device_mode to eMode
83689>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83691>>>>>            Send SetProgressCaption  of (phoWinPrint(self)) sVal
83692>>>>>         End
83692>>>>>>
83692>>>>>         Else Begin
83693>>>>>            forward Send Update_Status sVal
83695>>>>>         end
83695>>>>>>
83695>>>>>      End_Procedure
83696>>>>>
83696>>>>>      Procedure Start_Status
83698>>>>>         Integer eMode
83698>>>>>         string sTitle sCaption
83698>>>>>         Get Output_device_mode to eMode
83699>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83701>>>>>            Get Report_Caption to sCaption
83702>>>>>            Get Report_Title to sTitle
83703>>>>>            If (sTitle<>"" and sCaption<>"") begin
83705>>>>>                Move ( sCaption- ":" * sTitle) to sTitle
83706>>>>>            end
83706>>>>>>
83706>>>>>            else begin
83707>>>>>                Move (sCaption - sTitle) to sTitle
83708>>>>>            end
83708>>>>>>
83708>>>>>            Send SetReportTitle of (phoWinPrint(self)) sTitle
83709>>>>>         End
83709>>>>>>
83709>>>>>         Else Begin
83710>>>>>            forward Send Start_status
83712>>>>>         end
83712>>>>>>
83712>>>>>      End_Procedure
83713>>>>>
83713>>>>>      Procedure Resume_Status
83715>>>>>         Integer eMode
83715>>>>>         Get Output_device_mode to eMode
83716>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83718>>>>>            Send DfPreviewNoWait of (phoWinPrint(self))
83719>>>>>         End
83719>>>>>>
83719>>>>>         Else Begin
83720>>>>>            forward Send Resume_Status
83722>>>>>         end
83722>>>>>>
83722>>>>>      End_Procedure
83723>>>>>
83723>>>>>      Procedure End_Status
83725>>>>>         Integer eMode
83725>>>>>         Get Output_device_mode to eMode
83726>>>>>         If (error_processing_state(self)) Begin
83728>>>>>            Send DFClosePreview
83729>>>>>         end
83729>>>>>>
83729>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83731>>>>>         End
83731>>>>>>
83731>>>>>         Else Begin
83732>>>>>            forward Send End_Status
83734>>>>>         end
83734>>>>>>
83734>>>>>      End_Procedure
83735>>>>>
83735>>>>>    Function Report_Interrupt Returns Integer
83737>>>>>         integer eStat
83737>>>>>         String sMess
83737>>>>>         Boolean bActiveViewer
83737>>>>>         Get IsViewerActive to bActiveViewer
83738>>>>>         If (Error_Check_State(self)) begin
83740>>>>>            Move C_$AnErrorWishToCancel to sMess
83741>>>>>         end
83741>>>>>>
83741>>>>>         Else begin
83742>>>>>            Move  C_$CancelThisReport to sMess
83743>>>>>         end
83743>>>>>>
83743>>>>>         If bActiveViewer Begin
83745>>>>>            Get PreviewYesNoBox of (phoWinPrint(self)) C_$ReportInterrupt sMess to eStat
83746>>>>>         end
83746>>>>>>
83746>>>>>         Else Begin
83747>>>>>            Get YesNo_Box sMess C_$ReportInterrupt to eStat
83748>>>>>         End
83748>>>>>>
83748>>>>>
83748>>>>>         Function_Return (eStat=MBR_YES)
83749>>>>>
83749>>>>>  End_Function
83750>>>>>
83750>>>>>  Function Test_KeyPressed Returns Integer
83752>>>>>     Boolean bStop bError bActiveViewer
83752>>>>>     integer eMode
83752>>>>>     // winreport will do this also, but this makes sure that this gets called
83752>>>>>     // for each body loop -- even if the body loop prints nothing
83752>>>>>     Send PumpMsgQueue of (phoWinPrint(self)) // permit painting
83753>>>>>     Get IsViewerActive to bActiveViewer
83754>>>>>     Get Output_device_mode to eMode
83755>>>>>     If bActiveViewer Begin
83757>>>>>        Get ViewerWantsToClose of (phoWinPrint(self)) to bStop
83758>>>>>        Get Error_Check_State to bError
83759>>>>>        if (bStop or bError) begin
83761>>>>>            Get Report_Interrupt to bStop
83762>>>>>        end
83762>>>>>>
83762>>>>>     end
83762>>>>>>
83762>>>>>     Else Begin
83763>>>>>        Forward Get Test_KeyPressed to bStop
83765>>>>>        If (eMode=PRINT_TO_WINDOW and not(bStop)) Begin
83767>>>>>            Send DfPreviewNoWait
83768>>>>>        end
83768>>>>>>
83768>>>>>     End
83768>>>>>>
83768>>>>>
83768>>>>>     Function_Return bStop
83769>>>>>  End_Function
83770>>>>>
83770>>>>>    Procedure OnClosingView
83772>>>>>        Send DFClearDoc
83773>>>>>    end_procedure
83774>>>>>
83774>>>>>
83774>>>>>    // Attempt to make this as intuitive as possible. You cannot invoke this when a
83774>>>>>    // report is active. If a report is not finished, you cannot do this.
83774>>>>>    // If a report is finsihed it may or may not have a viewer present.
83774>>>>>    // If a viewer is not present, we will clear the exising report (making the assumption
83774>>>>>    // that a modeless viewer was closed and the report will not be invoked again). If a viewer
83774>>>>>    // is active, we will pass this through to the winprint object which will show an error
83774>>>>>
83774>>>>>    Function DFPrintSetupDialog Returns Boolean// invoke printer setup dialog
83776>>>>>        Integer iStatus
83776>>>>>        Boolean bActiveViewer bOk
83776>>>>>        // we must have printers installed for this to work
83776>>>>>        Get ArePrintersInstalled to bOk
83777>>>>>        If not bOk Begin
83779>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
83780>>>>>>
83780>>>>>        End
83780>>>>>>
83780>>>>>        Else Begin
83781>>>>>            Get DocumentStatus to iStatus
83782>>>>>            If (iStatus=dsFinished) Begin
83784>>>>>                Get IsViewerActive to bActiveViewer
83785>>>>>                If not bActiveViewer Begin
83787>>>>>                    Send DfClearDoc
83788>>>>>                End
83788>>>>>>
83788>>>>>            End
83788>>>>>>
83788>>>>>            // the winprint object will generate an error if the status is not dsNotStarted.
83788>>>>>            // we want those errors
83788>>>>>            Get DFPrintSetupDialog of (phoWinPrint(Self)) to bOk
83789>>>>>        End
83789>>>>>>
83789>>>>>        Function_Return bOk
83790>>>>>    End_Procedure
83791>>>>>
83791>>>>>    // It is better to use DFPrintSetupDialog which tells you if the dialog was canceled
83791>>>>>    Procedure DFPrintSetup // invoke printer setup dialog
83793>>>>>        Boolean bOk
83793>>>>>        Get DFPrintSetupDialog to bOk
83794>>>>>    End_Procedure
83795>>>>>
83795>>>>>    Procedure DFClearDoc // clear document, remove viewer
83797>>>>>        Send DFClearDoc of (phoWinPrint(self))
83798>>>>>    end_procedure
83799>>>>>
83799>>>>>    Procedure DFEndDocument // tell winprint that the report is complete
83801>>>>>        Send DfEndDocument of (phoWinPrint(self))
83802>>>>>    end_procedure
83803>>>>>
83803>>>>>    Procedure DFClosePreview //close the previewer, does not clear the document
83805>>>>>        Send DfClosePreview of (phoWinPrint(self))
83806>>>>>    end_procedure
83807>>>>>
83807>>>>>    Procedure DFPrintDialog // popup print job dialog
83809>>>>>        Send DFPrintDialog of (phoWinPrint(self))
83810>>>>>    End_procedure
83811>>>>>
83811>>>>>    Procedure DFPrint // print with printer dialog
83813>>>>>        Send DFPrint of (phoWinPrint(self))
83814>>>>>    End_procedure
83815>>>>>
83815>>>>>    Procedure DFPrintDoc // print without printer dialog
83817>>>>>        Send DFPrintDoc of (phoWinPrint(self))
83818>>>>>    End_Procedure
83819>>>>>
83819>>>>>    Procedure DFPreviewWait // invoke previewer in modal mode
83821>>>>>       Send DFPreviewWait of (phoWinPrint(self))
83822>>>>>    End_Procedure
83823>>>>>
83823>>>>>    Procedure DFPreviewNoWait // invoke previwer in modeless mode
83825>>>>>       Send DFPreviewNoWait of (phoWinPrint(self))
83826>>>>>    End_Procedure
83827>>>>>
83827>>>>>    Procedure DFPreview // invokde previewer based on pbModalViewer property
83829>>>>>       Boolean bModalViewer
83829>>>>>       Get pbModalViewer to bModalViewer
83830>>>>>       If bModalViewer Begin
83832>>>>>           Send DFPreviewWait
83833>>>>>       end
83833>>>>>>
83833>>>>>       else Begin
83834>>>>>           Send DFPreviewNoWait
83835>>>>>       end
83835>>>>>>
83835>>>>>   End_Procedure
83836>>>>>
83836>>>>>    // Print report to appropriate device (printer, preview) based
83836>>>>>    // on output_device_mode
83836>>>>>    //
83836>>>>>    Procedure PrintReport
83838>>>>>        Integer eMode
83838>>>>>        Get OutPut_Device_Mode to eMode
83839>>>>>        If ((eMode=PRINT_TO_WINDOW) or (eMode=DEFERRED_PRINT_TO_WINDOW)) Begin
83841>>>>>           Send DFPreview
83842>>>>>        end
83842>>>>>>
83842>>>>>        Else If (eMode=PRINT_TO_PRINTER_NO_DIALOG) Begin
83845>>>>>           Send DFPrintDoc // print, no print job dialog
83846>>>>>        end
83846>>>>>>
83846>>>>>        Else Begin // (eMode=PRINT_TO_PRINTER)
83847>>>>>           Send DFPrint // print with print job dialog
83848>>>>>        end
83848>>>>>>
83848>>>>>    End_Procedure
83849>>>>>
83849>>>>>
83849>>>>>    Procedure DFSetPrinterPaper integer ePaperType
83851>>>>>        Send DFSetPrinterPaper of (phoWinPrint(self)) ePaperType
83852>>>>>    End_Procedure
83853>>>>>
83853>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
83855>>>>>        integer ePaperType
83855>>>>>        Get DFGetPrinterPaper of (phoWinPrint(self)) to ePaperType
83856>>>>>        Function_return ePaperType
83857>>>>>    end_function
83858>>>>>
83858>>>>>
83858>>>>>    Procedure DFSetPrinterBin integer eBinType
83860>>>>>        Send DFSetPrinterBin of (phoWinPrint(self)) eBinType
83861>>>>>    End_Procedure
83862>>>>>
83862>>>>>    Function DFGetPrinterBin returns integer //eBinType
83864>>>>>        integer eBinType
83864>>>>>        Get DFGetPrinterBin of (phoWinPrint(self)) to eBinType
83865>>>>>        Function_return eBinType
83866>>>>>    end_function
83867>>>>>
83867>>>>>
83867>>>>>    Procedure DFSetPrinterResolution integer eResType
83869>>>>>        Send DFSetPrinterResolution of (phoWinPrint(self)) eResType
83870>>>>>    End_Procedure
83871>>>>>
83871>>>>>    Function DFGetPrinterResolution returns integer //eResType
83873>>>>>        Boolean eResType
83873>>>>>        Get DFGetPrinterResolution of (phoWinPrint(self)) to eResType
83874>>>>>        Function_return eResType
83875>>>>>    end_function
83876>>>>>
83876>>>>>
83876>>>>>    Procedure DFSetLandscape boolean bIsLandscape
83878>>>>>        Send DFSetLandscape of (phoWinPrint(self)) bIsLandscape
83879>>>>>    End_Procedure
83880>>>>>
83880>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
83882>>>>>        Boolean bIsLandscape
83882>>>>>        Get DFGetLandscape of (phoWinPrint(self)) to bIsLandscape
83883>>>>>        Function_return bIsLandscape
83884>>>>>    end_function
83885>>>>>
83885>>>>>    Procedure DFSetMetrics integer eType
83887>>>>>        Send DFSetMetrics of (phoWinPrint(self)) eType
83888>>>>>    End_Procedure
83889>>>>>
83889>>>>>    Function DFGetMetrics returns integer
83891>>>>>        integer eType
83891>>>>>        Get DFGetMetrics of (phoWinPrint(self)) to eType
83892>>>>>        Function_return eType
83893>>>>>    end_function
83894>>>>>
83894>>>>>
83894>>>>>    Procedure DFSetPrintDlgInPreview boolean bShowDialog
83896>>>>>        Set PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
83897>>>>>    End_Procedure
83898>>>>>
83898>>>>>    Function DFGetPrintDlgInPreview returns boolean
83900>>>>>        boolean bShowDialog
83900>>>>>        Get PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
83901>>>>>        Function_return bShowDialog
83902>>>>>    end_function
83903>>>>>
83903>>>>>
83903>>>>>    Procedure DFSetEnablePrintFromPreview boolean bEnablePrint
83905>>>>>        Set EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
83906>>>>>    End_Procedure
83907>>>>>
83907>>>>>    Function DFGetEnablePrintFromPreview returns boolean
83909>>>>>        boolean bEnablePrint
83909>>>>>        Get EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
83910>>>>>        Function_return bEnablePrint
83911>>>>>    end_function
83912>>>>>
83912>>>>>
83912>>>>>
83912>>>>>    Procedure DFSetMargins number nLeft number nTop number nRight number nBottom
83914>>>>>        Send DFSetMargins of (phoWinPrint(self)) nLeft nTop nRight nBottom
83915>>>>>    End_Procedure
83916>>>>>
83916>>>>>    Procedure DFSetTopBottom number nTop number nBottom Boolean bAllPages
83918>>>>>        Send DFSetTopBottom of (phoWinPrint(self)) nTop nBottom bAllPages
83919>>>>>    End_Procedure
83920>>>>>
83920>>>>>
83920>>>>>    Procedure DFSetDevice string sPrinterName
83922>>>>>        Send DFSetDevice of (phoWinPrint(self)) sPrinterName
83923>>>>>    End_Procedure
83924>>>>>
83924>>>>>    Function DFGetCurrentDevice returns string // sPrinterName
83926>>>>>        String sPrinterName
83926>>>>>        Get DFGetCurrentDevice of (phoWinPrint(self)) to sPrinterName
83927>>>>>        Function_return sPrinterName
83928>>>>>    end_function
83929>>>>>
83929>>>>>
83929>>>>>    Procedure DFSetUserDefinedPapersize number nLength number nWidth
83931>>>>>        Send DFSetUserDefinedPapersize of (phoWinPrint(self)) nLength nWidth
83932>>>>>    End_Procedure
83933>>>>>
83933>>>>>    Function DFGetUserDefinedLength returns number
83935>>>>>        number nSize
83935>>>>>        Get DFGetUserDefinedLength of (phoWinPrint(self)) to nSize
83936>>>>>        Function_return nSize
83937>>>>>    end_function
83938>>>>>
83938>>>>>    Function DFGetUserDefinedWidth returns number
83940>>>>>        number nSize
83940>>>>>        Get DFGetUserDefinedWidth of (phoWinPrint(self)) to nSize
83941>>>>>        Function_return nSize
83942>>>>>    end_function
83943>>>>>
83943>>>>>
83943>>>>>    Procedure DFSetNumberOfCopies integer iCopies
83945>>>>>        Send DFSetNumberOfCopies of (phoWinPrint(self)) iCopies
83946>>>>>    End_Procedure
83947>>>>>
83947>>>>>    Procedure DFPrinterBinFirstPage integer eBinType
83949>>>>>        Send DFPrinterBinFirstPage of (phoWinPrint(self)) eBinType
83950>>>>>    End_Procedure
83951>>>>>
83951>>>>>    Procedure DFClearPrinter
83953>>>>>        Send DFClearPrinter of (phoWinPrint(self))
83954>>>>>    End_Procedure
83955>>>>>
83955>>>>>    Function DFGetDFColor integer iRed integer iGreen integer iBlue returns integer
83957>>>>>        integer iWPColor
83957>>>>>        Get DFGetDFColor of (phoWinPrint(self)) iRed iGreen iBlue to iWPColor
83958>>>>>        Function_return iWPColor
83959>>>>>    end_function
83960>>>>>
83960>>>>>    Function RGBToWPColor integer iRgb returns integer
83962>>>>>        integer iWPColor
83962>>>>>        Get RGBToWPColor of (phoWinPrint(self)) iRGB to iWPColor
83963>>>>>        Function_return iWPColor
83964>>>>>    end_function
83965>>>>>
83965>>>>>
83965>>>>>End_Class
83966>>>Use Windows.pkg
83966>>>
83966>>>Use cUgyfelDataDictionary.dd
83966>>>Use cAutoDataDictionary.dd
83966>>>Use cMunkalapDataDictionary.dd
83966>>>
83966>>>ACTIVATE_VIEW Activate_oGyakorisagRiport FOR oGyakorisagRiport
83976>>>>
83976>>>Object oGyakorisagRiport is a ReportView
83978>>>    Set Location to 6 6
83979>>>    Set Size to 60 202
83980>>>    Set Label To "GyakorisagRiport"
83981>>>
83981>>>
83981>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
83983>>>    End_Object 
83984>>>
83984>>>    Object oAuto_DD is a cAutoDataDictionary
83986>>>    End_Object 
83987>>>
83987>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
83989>>>        Set DDO_Server To oAuto_DD
83990>>>        Set DDO_Server To oUgyfel_DD
83991>>>    End_Object 
83992>>>
83992>>>    Set Main_DD To oMunkalap_DD
83993>>>
83993>>>
83993>>>
83993>>>
83993>>>    Object oPrintTo is a RadioGroup
83995>>>        Set Size to 38 118
83996>>>        Set Location to 10 12
83997>>>        Set Label to "Send Report to"
83998>>>
83998>>>        Object oRadio1 is a Radio
84000>>>            Set Label to "Report Viewer"
84001>>>            Set Size to 10 61
84002>>>            Set Location to 12 6
84003>>>            Set Status_Help to "Prints the report to screen"
84004>>>        End_Object 
84005>>>
84005>>>        Object oRadio2 is a Radio
84007>>>            Set Label to "Printer"
84008>>>            Set Size to 10 42
84009>>>            Set Location to 24 6
84010>>>            Set Status_Help to "Prints the report to printer"
84011>>>        End_Object 
84012>>>
84012>>>
84012>>>        Function IsToPrinter Returns boolean
84015>>>            integer iRadio
84015>>>            Get Current_radio to iRadio
84016>>>            Function_return (iRadio=1)
84017>>>        End_Function 
84018>>>
84018>>>    End_Object 
84019>>>
84019>>>    Object oBtnPrint is a Button
84021>>>        Set Label to "Print"
84022>>>        Set Location to 5 140
84023>>>        Set Status_Help to "Print the Selected report"
84024>>>        Set Default_State to TRUE
84025>>>        Procedure OnClick
84028>>>            Send StartReport
84029>>>        End_Procedure
84030>>>    End_Object 
84031>>>
84031>>>    Object oBtnPrinterSetup is a Button
84033>>>        Set Label to "Printer Setup"
84034>>>        Set Location to 22 140
84035>>>        Set Status_Help to "Set up printer for report"
84036>>>        Procedure OnClick
84039>>>            Send DFPrintSetup of oReport
84040>>>        End_Procedure
84041>>>    End_Object 
84042>>>
84042>>>    Object oBtnCancel is a Button
84044>>>        Set Label to "Cancel"
84045>>>        Set Location to 39 140
84046>>>        Set Status_Help to "Close this Panel"
84047>>>        Procedure OnClick
84050>>>            Send Close_Panel
84051>>>        End_Procedure
84052>>>    End_Object 
84053>>>
84053>>>
84053>>>
84053>>>    Object oReport is a cWinReport2
84055>>>
84055>>>        Set Report_Title to "GyakorisagRiport"
84056>>>
84056>>>        // Set DDO, Index and breaks for the report
84056>>>        Set Server to oMunkalap_DD
84057>>>        Set Ordering to 1
84058>>>        // Report_Breaks file.field // no breaks in this report
84058>>>
84058>>>        Function Starting_Main_Report Returns Integer
84061>>>            Boolean bErr
84061>>>            Send DFSetMetrics wpm_cm
84062>>>            Send DFSetmargins 1 1 1 1
84063>>>            //Send DFSetLandscape false // This can be used to force a page orientation
84063>>>            Forward Get Starting_Main_Report to bErr
84065>>>            Function_return bErr
84066>>>        End_Function 
84067>>>
84067>>>        // Page_Top is printed first at the top margin of each page
84067>>>        Procedure Page_Top 
84070>>>            string  sFont
84070>>>            integer iFontSize
84070>>>
84070>>>            Move "arial" to sFont
84071>>>            Move 10 to iFontSize
84072>>>
84072>>>            DFFont sFont
84073>>>            DFFontSize iFontSize
84074>>>            DFBeginHeader DFPageTop
84075>>>                DFHeaderFrame Hdr_NoFrame
84076>>>                DFHeaderPos   Hdr_Left
84077>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
84078>>>            DFEndHeader
84080>>>
84080>>>        End_Procedure 
84081>>>
84081>>>        // Report_Header is printed once in a report after Page_Top
84081>>>        //Procedure Report_Header
84081>>>        //    string  sFont
84081>>>        //    integer iFontSize
84081>>>        //    Move "arial" to sFont
84081>>>        //    Move 10 to iFontSize
84081>>>        //    DFFont sFont
84081>>>        //    DFFontSize iFontSize
84081>>>        //    DFBeginHeader  DFReportHeader
84081>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84081>>>        //        DFHeaderPos    Hdr_Left
84081>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84081>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
84081>>>        //    DFEndHeader
84081>>>        //End_Procedure
84081>>>
84081>>>        Procedure Page_Header 
84084>>>            integer iFill iBorder iStyle
84084>>>            string  sFont sReportTitle
84084>>>            integer iFontSize
84084>>>
84084>>>            Move "arial" to sFont
84085>>>            Move 16 to iFontSize
84086>>>            Move (Font_bold + rgb_White) to iStyle
84087>>>            Move (rgb_dGrey) to iFill
84088>>>            Move (rgb_dGrey) to iBorder
84089>>>            Get Report_Title to sReportTitle
84090>>>
84090>>>            DFFont sFont
84091>>>            DFFontSize iFontSize
84092>>>            DFBeginHeader DFPageHeader
84093>>>                DFHeaderPos   Hdr_Left
84094>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84095>>>                DFWritelnPos sReportTitle 0.1 iStyle
84096>>>                DFHeaderMargin HM_BottomOuter 0.08
84097>>>            DFEndHeader
84099>>>
84099>>>        End_Procedure 
84100>>>
84100>>>        Procedure Page_Title 
84103>>>            string  sFont 
84103>>>            integer iFontSize iHeaderStyle iFill iBorder
84103>>>
84103>>>            Move "arial" to sFont
84104>>>            Move 10 to iFontSize
84105>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
84106>>>            Move (rgb_Grey) to iFill
84107>>>            Move (rgb_Grey) to iBorder
84108>>>
84108>>>            DFFont sFont
84109>>>            DFFontSize iFontSize
84110>>>            DFBeginHeader DFPageTitle
84111>>>                DFHeaderPos   Hdr_Left
84112>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84113>>>                DFHeaderMargin HM_TopInner    0.04
84114>>>                DFHeaderMargin HM_BottomInner 0.04
84115>>>                DFHeaderMargin HM_BottomOuter 0.08
84116>>>
84116>>>                DFWritePos "Mrka"                        0.08 iHeaderStyle -1 4.26
84117>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
84118>>>                DFWriteLn
84119>>>            DFEndHeader
84121>>>
84121>>>        End_Procedure 
84122>>>
84122>>>        Procedure Body 
84125>>>            string  sFont 
84125>>>            integer iFontSize iStyle
84125>>>
84125>>>            Move "arial" to sFont
84126>>>            Move 10 to iFontSize
84127>>>            Move (font_default) to iStyle
84128>>>
84128>>>            DFFont sFont
84129>>>            DFFontSize iFontSize
84130>>>
84130>>>            DFWritePos Auto.Marka                     0.08 iStyle -1 4.26
84131>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
84132>>>            DFWriteLn
84133>>>
84133>>>        End_Procedure 
84134>>>
84134>>>        // Totals appear at the end of the report before Report_Footer
84134>>>        //Procedure Total
84134>>>        //    string  sFont
84134>>>        //    integer iFontSize
84134>>>        //    Move "arial" to sFont
84134>>>        //    Move 10 to iFontSize
84134>>>        //    DFFont sFont
84134>>>        //    DFFontSize iFontSize
84134>>>        //    DFBeginHeader  DFTotal
84134>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84134>>>        //        DFHeaderPos    Hdr_Left
84134>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84134>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
84134>>>        //    DFEndHeader
84134>>>        //End_Procedure
84134>>>
84134>>>        // Report_Footer is printed once on the last page before Page_Footer
84134>>>        //Procedure Report_Footer
84134>>>        //    string  sFont
84134>>>        //    integer iFontSize
84134>>>        //    Move "arial" to sFont
84134>>>        //    Move 10 to iFontSize
84134>>>        //    DFFont sFont
84134>>>        //    DFFontSize iFontSize
84134>>>        //    DFBeginHeader DFReportFooter
84134>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84134>>>        //        DFHeaderPos    Hdr_Left
84134>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84134>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
84134>>>        //    DFEndHeader
84134>>>        //End_Procedure
84134>>>
84134>>>        // // Page_Footer is printed on each page before Page_Bottom
84134>>>        //Procedure Page_Footer
84134>>>        //    string  sFont
84134>>>        //    integer iFontSize
84134>>>        //    Move "arial" to sFont
84134>>>        //    Move 10 to iFontSize
84134>>>        //    DFFont sFont
84134>>>        //    DFFontSize iFontSize
84134>>>        //    DFBeginHeader DFPageFooter
84134>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84134>>>        //        DFHeaderPos    Hdr_Left
84134>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84134>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
84134>>>        //    DFEndHeader
84134>>>        //End_Procedure
84134>>>
84134>>>
84134>>>        // Page_Bottom is printed last at the bottom margin of each page
84134>>>        Procedure Page_Bottom 
84137>>>            string sFont
84137>>>            integer iFontSize iBorder iStyle
84137>>>            DateTime dtDT
84137>>>
84137>>>            Move (CurrentDateTime()) to dtDT
84138>>>
84138>>>            Move "arial" to sFont
84139>>>            Move 10 to iFontSize
84140>>>            Move (font_default) to iStyle
84141>>>            Move (rgb_dGrey) to iBorder
84142>>>
84142>>>            DFFont sFont
84143>>>            DFFontSize iFontSize
84144>>>            DFBeginHeader DFPageBottom
84145>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
84146>>>                DFHeaderPos Hdr_Left
84147>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
84148>>>            DFEndHeader
84150>>>
84150>>>        End_Procedure 
84151>>>
84151>>>        // Returns string with description of selection ranges
84151>>>        // Pass: Selection title, start value and end value. Return: description
84151>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
84154>>>            string sText
84154>>>            If (sStart=""  AND sStop="")  function_return ""
84157>>>            If (sStart="0" AND sStop="0") function_return ""
84160>>>            If (sStart<>"" AND sStop<>"") begin
84162>>>                Move ("between" * sStart * "and" * sStop) to sText
84163>>>            end
84163>>>>
84163>>>            Else if (sStart > "") begin
84166>>>                Move ("starting at" * sStart) to sText
84167>>>            end
84167>>>>
84167>>>            Else if (sStop > "") begin
84170>>>                Move ("up to" * sStop) to sText
84171>>>            End
84171>>>>
84171>>>            function_return (sTitle * sText)
84172>>>        End_Function
84173>>>
84173>>>    End_Object 
84174>>>
84174>>>    Procedure StartReport 
84177>>>        Boolean bToPrinter
84177>>>
84177>>>        // determine if direct print
84177>>>        Get IsToPrinter of oPrintTo to bToPrinter
84178>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
84179>>>
84179>>>        // run the report
84179>>>        Send Run_Report of oReport
84180>>>
84180>>>    End_Procedure 
84181>>>
84181>>>End_Object 
84182>        Use Report.rv
Including file: Report.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report.rv)
84182>>>// Report.rv
84182>>>// Report
84182>>>Register_Object oReport
84182>>>Use DFRptVw.pkg
84182>>>Use cWinReport2.pkg
84182>>>Use Windows.pkg
84182>>>
84182>>>Use cUgyfelDataDictionary.dd
84182>>>Use cAutoDataDictionary.dd
84182>>>Use cMunkalapDataDictionary.dd
84182>>>
84182>>>ACTIVATE_VIEW Activate_oReport FOR oReport
84192>>>>
84192>>>Object oReport is a ReportView
84194>>>    Set Location to 6 6
84195>>>    Set Size to 60 202
84196>>>    Set Label To "Report"
84197>>>
84197>>>
84197>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
84199>>>    End_Object 
84200>>>
84200>>>    Object oAuto_DD is a cAutoDataDictionary
84202>>>    End_Object 
84203>>>
84203>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84205>>>        Set DDO_Server To oAuto_DD
84206>>>        Set DDO_Server To oUgyfel_DD
84207>>>        Set Constrain_File To Auto.File_Number
84208>>>    End_Object 
84209>>>
84209>>>    Set Main_DD To oAuto_DD
84210>>>
84210>>>
84210>>>
84210>>>
84210>>>    Object oPrintTo is a RadioGroup
84212>>>        Set Size to 38 118
84213>>>        Set Location to 10 12
84214>>>        Set Label to "Send Report to"
84215>>>
84215>>>        Object oRadio1 is a Radio
84217>>>            Set Label to "Report Viewer"
84218>>>            Set Size to 10 61
84219>>>            Set Location to 12 6
84220>>>            Set Status_Help to "Prints the report to screen"
84221>>>        End_Object 
84222>>>
84222>>>        Object oRadio2 is a Radio
84224>>>            Set Label to "Printer"
84225>>>            Set Size to 10 42
84226>>>            Set Location to 24 6
84227>>>            Set Status_Help to "Prints the report to printer"
84228>>>        End_Object 
84229>>>
84229>>>
84229>>>        Function IsToPrinter Returns Boolean
84232>>>            integer iRadio
84232>>>            Get Current_Radio to iRadio
84233>>>            Function_Return (iRadio=1)
84234>>>        End_Function 
84235>>>
84235>>>    End_Object 
84236>>>
84236>>>    Object oBtnPrint is a Button
84238>>>        Set Label to "Print"
84239>>>        Set Location to 5 140
84240>>>        Set Status_Help to "Print the selected report"
84241>>>        Set Default_State to TRUE
84242>>>        Procedure OnClick
84245>>>            Send StartReport
84246>>>        End_Procedure
84247>>>    End_Object 
84248>>>
84248>>>    Object oBtnPrinterSetup is a Button
84250>>>        Set Label to "Printer Setup"
84251>>>        Set Location to 22 140
84252>>>        Set Status_Help to "Set up printer for report"
84253>>>        Procedure OnClick
84256>>>            Send DFPrintSetup of oReport
84257>>>        End_Procedure
84258>>>    End_Object 
84259>>>
84259>>>    Object oBtnCancel is a Button
84261>>>        Set Label to "Cancel"
84262>>>        Set Location to 39 140
84263>>>        Set Status_Help to "Close this Panel"
84264>>>        Procedure OnClick
84267>>>            Send Close_Panel
84268>>>        End_Procedure
84269>>>    End_Object 
84270>>>
84270>>>
84270>>>
84270>>>    Object oReport is a cWinReport2
84272>>>
84272>>>        Set Report_Title to "Report"
84273>>>        Object oReport2 is a cWinReport2
84275>>>
84275>>>
84275>>>            // Set DDO, Index and breaks for the report
84275>>>            Set Server to oMunkalap_DD
84276>>>            Set Ordering to 0
84277>>>            Procedure Body 
84280>>>                string  sFont 
84280>>>                integer iFontSize iStyle
84280>>>
84280>>>                Move "Times New Roman" to sFont
84281>>>                Move 10 to iFontSize
84282>>>                Move (font_default) to iStyle
84283>>>
84283>>>                DFFont sFont
84284>>>                DFFontSize iFontSize
84285>>>
84285>>>                DFWritePos Munkalap.Rogzites              0.08 iStyle -1 2.13
84286>>>                DFWriteLn
84287>>>
84287>>>            End_Procedure 
84288>>>
84288>>>        End_Object 
84289>>>
84289>>>        // Set DDO, Index and breaks for the report
84289>>>        Set Server to oAuto_DD
84290>>>        Set Ordering to 1
84291>>>        Report_Breaks (SerializeRowId(GetRowId(Auto.File_Number)))
84305>>>
84305>>>        Function Starting_Main_Report Returns Integer
84308>>>            Boolean bErr
84308>>>            Send DFSetMetrics wpm_cm
84309>>>            Send DFSetmargins 1 1 1 1
84310>>>            //Send DFSetLandscape false // This can be used to force a page orientation
84310>>>            Forward Get Starting_Main_Report to bErr
84312>>>            Function_return bErr
84313>>>        End_Function 
84314>>>
84314>>>        // Page_Top is printed first at the top margin of each page
84314>>>        Procedure Page_Top 
84317>>>            string  sFont
84317>>>            integer iFontSize
84317>>>
84317>>>            Move "Times New Roman" to sFont
84318>>>            Move 10 to iFontSize
84319>>>
84319>>>            DFFont sFont
84320>>>            DFFontSize iFontSize
84321>>>            DFBeginHeader DFPageTop
84322>>>                DFHeaderFrame Hdr_NoFrame
84323>>>                DFHeaderPos   Hdr_Left
84324>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
84325>>>            DFEndHeader
84327>>>
84327>>>        End_Procedure 
84328>>>
84328>>>        // Report_Header is printed once in a report after Page_Top
84328>>>        //Procedure Report_Header
84328>>>        //    string  sFont
84328>>>        //    integer iFontSize
84328>>>        //    Move "Times New Roman" to sFont
84328>>>        //    Move 10 to iFontSize
84328>>>        //    DFFont sFont
84328>>>        //    DFFontSize iFontSize
84328>>>        //    DFBeginHeader  DFReportHeader
84328>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84328>>>        //        DFHeaderPos    Hdr_Left
84328>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84328>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
84328>>>        //    DFEndHeader
84328>>>        //End_Procedure
84328>>>
84328>>>        Procedure Page_Header 
84331>>>            integer iFill iBorder iStyle
84331>>>            string  sFont sReportTitle
84331>>>            integer iFontSize
84331>>>
84331>>>            Move "Times New Roman" to sFont
84332>>>            Move 16 to iFontSize
84333>>>            Move (Font_bold + rgb_White) to iStyle
84334>>>            Move (rgb_dGrey) to iFill
84335>>>            Move (rgb_dGrey) to iBorder
84336>>>            Get Report_Title to sReportTitle
84337>>>
84337>>>            DFFont sFont
84338>>>            DFFontSize iFontSize
84339>>>            DFBeginHeader DFPageHeader
84340>>>                DFHeaderPos   Hdr_Left
84341>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84342>>>                DFWritelnPos sReportTitle 0.1 iStyle
84343>>>                DFHeaderMargin HM_BottomOuter 0.08
84344>>>            DFEndHeader
84346>>>
84346>>>        End_Procedure 
84347>>>
84347>>>        // Page_Title appears on every page after Page_Header
84347>>>        //Procedure Page_Title
84347>>>        //    string  sFont
84347>>>        //    integer iFontSize
84347>>>        //    Move "Times New Roman" to sFont
84347>>>        //    Move 10 to iFontSize
84347>>>        //    DFFont sFont
84347>>>        //    DFFontSize iFontSize
84347>>>        //    DFBeginHeader  DFPageTitle
84347>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84347>>>        //        DFHeaderPos    Hdr_Left
84347>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84347>>>        //        DFWrite     "Page_Title" (Font_Bold+Font_Center)
84347>>>        //    DFEndHeader
84347>>>        //End_Procedure
84347>>>
84347>>>        Procedure SubHeader1 
84350>>>            string  sFont 
84350>>>            integer iFontSize iStyle
84350>>>            integer iFill iBorder iHeaderStyle
84350>>>
84350>>>
84350>>>            // If (Page_end_State(self)) Begin // Page_end_State must get set in subtotal 1
84350>>>            //    Send DFNew_Page // this will force a new page
84350>>>            // End
84350>>>
84350>>>            Move "Times New Roman" to sFont
84351>>>            Move 10 to iFontSize
84352>>>            Move (font_bold) to iStyle
84353>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
84354>>>            Move (rgb_dGrey) to iBorder
84355>>>            Get DFGetDFColor 242 242 242 to iFill
84356>>>
84356>>>            DFFont sFont
84357>>>            DFFontSize iFontSize
84358>>>            DFBeginHeader DFSubHeader 1
84359>>>                DFHeaderLineCheck 5
84360>>>                DFHeaderWrap   HDR_Wrap
84361>>>                DFHeaderPos    HDR_Left
84362>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
84363>>>                DFHeaderMargin hm_BottomOuter 0.08
84364>>>                DFHeaderMargin hm_TopInner    0.04
84365>>>                DFHeaderMargin hm_BottomInner 0.04
84366>>>
84366>>>                // display fields to be placed in this sub-header
84366>>>                DFWritePos "Mrka:"                      0.1 iHeaderStyle -1 4.9
84367>>>                DFWritePos Auto.Marka                     5 iStyle -1
84368>>>                DFWriteLn
84369>>>
84369>>>                // write the heading for the body section
84369>>>                DFFontSize 1 // create a very small space on top of and below the horizontal bar
84370>>>                DFWriteLn
84371>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
84372>>>                DFWriteLn
84373>>>                DFFontSize iFontSize
84374>>>                DFWritePos "Rgz."                        0.08 iHeaderStyle -1 2.13
84375>>>                DFWriteLn
84376>>>
84376>>>            DFEndHeader
84378>>>
84378>>>        End_Procedure 
84379>>>
84379>>>        Procedure SubTotal1 
84382>>>            // SubTotal section is not used
84382>>>
84382>>>            // Set Page_end_State to True // force a page-break when this section ends
84382>>>
84382>>>        End_Procedure 
84383>>>
84383>>>        // Totals appear at the end of the report before Report_Footer
84383>>>        //Procedure Total
84383>>>        //    string  sFont
84383>>>        //    integer iFontSize
84383>>>        //    Move "Times New Roman" to sFont
84383>>>        //    Move 10 to iFontSize
84383>>>        //    DFFont sFont
84383>>>        //    DFFontSize iFontSize
84383>>>        //    DFBeginHeader  DFTotal
84383>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84383>>>        //        DFHeaderPos    Hdr_Left
84383>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84383>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
84383>>>        //    DFEndHeader
84383>>>        //End_Procedure
84383>>>
84383>>>        // Report_Footer is printed once on the last page before Page_Footer
84383>>>        //Procedure Report_Footer
84383>>>        //    string  sFont
84383>>>        //    integer iFontSize
84383>>>        //    Move "Times New Roman" to sFont
84383>>>        //    Move 10 to iFontSize
84383>>>        //    DFFont sFont
84383>>>        //    DFFontSize iFontSize
84383>>>        //    DFBeginHeader DFReportFooter
84383>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84383>>>        //        DFHeaderPos    Hdr_Left
84383>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84383>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
84383>>>        //    DFEndHeader
84383>>>        //End_Procedure
84383>>>
84383>>>        // // Page_Footer is printed on each page before Page_Bottom
84383>>>        //Procedure Page_Footer
84383>>>        //    string  sFont
84383>>>        //    integer iFontSize
84383>>>        //    Move "Times New Roman" to sFont
84383>>>        //    Move 10 to iFontSize
84383>>>        //    DFFont sFont
84383>>>        //    DFFontSize iFontSize
84383>>>        //    DFBeginHeader DFPageFooter
84383>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84383>>>        //        DFHeaderPos    Hdr_Left
84383>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84383>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
84383>>>        //    DFEndHeader
84383>>>        //End_Procedure
84383>>>
84383>>>
84383>>>        // Page_Bottom is printed last at the bottom margin of each page
84383>>>        Procedure Page_Bottom 
84386>>>            string sFont
84386>>>            integer iFontSize iBorder iStyle
84386>>>            DateTime dtDT
84386>>>
84386>>>            Move (CurrentDateTime()) to dtDT
84387>>>
84387>>>            Move "Times New Roman" to sFont
84388>>>            Move 10 to iFontSize
84389>>>            Move (font_default) to iStyle
84390>>>            Move (rgb_dGrey) to iBorder
84391>>>
84391>>>            DFFont sFont
84392>>>            DFFontSize iFontSize
84393>>>            DFBeginHeader DFPageBottom
84394>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
84395>>>                DFHeaderPos Hdr_Left
84396>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
84397>>>            DFEndHeader
84399>>>
84399>>>        End_Procedure 
84400>>>
84400>>>        // Returns string with description of selection ranges
84400>>>        // Pass: Selection title, start value and end value. Return: description
84400>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
84403>>>            string sText
84403>>>            If (sStart=""  AND sStop="")  function_return ""
84406>>>            If (sStart="0" AND sStop="0") function_return ""
84409>>>            If (sStart<>"" AND sStop<>"") begin
84411>>>                Move ("between" * sStart * "and" * sStop) to sText
84412>>>            end
84412>>>>
84412>>>            Else if (sStart > "") Begin
84415>>>                Move ("starting at" * sStart) to sText
84416>>>            end
84416>>>>
84416>>>            Else if (sStop > "") begin
84419>>>                Move ("up to" * sStop) to sText
84420>>>            End
84420>>>>
84420>>>            function_return (sTitle * sText)
84421>>>        End_Function
84422>>>
84422>>>    End_Object 
84423>>>
84423>>>    Procedure StartReport 
84426>>>        Boolean bToPrinter
84426>>>
84426>>>        // determine if direct print
84426>>>        Get IsToPrinter of oPrintTo to bToPrinter
84427>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
84428>>>
84428>>>        // run the report
84428>>>        Send Run_Report of oReport
84429>>>
84429>>>    End_Procedure 
84430>>>
84430>>>End_Object 
84431>        Use MunkalapKeszites.vw
Including file: MunkalapKeszites.vw    (C:\Repos\DataFlexBeadando\AppSrc\MunkalapKeszites.vw)
84431>>>// C:\Repos\DataFlexBeadando\AppSrc\MunkalapKeszites.vw
84431>>>// MunkalapKeszites
84431>>>//
84431>>>
84431>>>Use DFClient.pkg
84431>>>Use DFEntry.pkg
84431>>>Use cDbCJGrid.pkg
84431>>>Use cDbCJGridColumn.pkg
84431>>>
84431>>>Use cUgyfelDataDictionary.dd
84431>>>Use cAutoDataDictionary.dd
84431>>>Use cMunkalapDataDictionary.dd
84431>>>Use cMunkaDataDictionary.dd
84431>>>Use cMunkaMunkalapDataDictionary.dd
84431>>>
84431>>>ACTIVATE_VIEW Activate_oMunkalapKeszites FOR oMunkalapKeszites
84441>>>>
84441>>>Object oMunkalapKeszites is a dbView
84443>>>    Set Location to 5 5
84444>>>    Set Size to 204 309
84445>>>    Set Label To "MunkalapKeszites"
84446>>>    Set Border_Style to Border_Thick
84447>>>
84447>>>
84447>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
84449>>>    End_Object 
84450>>>
84450>>>    Object oAuto_DD is a cAutoDataDictionary
84452>>>    End_Object 
84453>>>
84453>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84455>>>        Set DDO_Server To oAuto_DD
84456>>>        Set DDO_Server To oUgyfel_DD
84457>>>        // this lets you save a new parent DD from within child DD
84457>>>        Set Allow_Foreign_New_Save_State to True
84458>>>    End_Object 
84459>>>
84459>>>    Object oMunka_DD is a cMunkaDataDictionary
84461>>>    End_Object 
84462>>>
84462>>>    Object oMunkaMunkalap_DD is a cMunkaMunkalapDataDictionary
84464>>>        Set DDO_Server To oMunkalap_DD
84465>>>        Set DDO_Server To oMunka_DD
84466>>>        Set Constrain_File To Munkalap.File_Number
84467>>>    End_Object 
84468>>>
84468>>>    Set Main_DD To oMunkalap_DD
84469>>>    Set Server  To oMunkalap_DD
84470>>>
84470>>>
84470>>>
84470>>>    Object oMunkalapId is a dbForm
84472>>>        Entry_Item Munkalap.Id
84473>>>        Set Size to 13 42
84474>>>        Set Location to 5 68
84475>>>        Set peAnchors to anTopLeftRight
84476>>>        Set Label to "Munkalap azonost"
84477>>>        Set Label_Justification_mode to jMode_Left
84478>>>        Set Label_Col_Offset to 63
84479>>>        Set Label_row_Offset to 0
84480>>>    End_Object 
84481>>>
84481>>>    Object oUgyfelId is a dbForm
84483>>>        Entry_Item Ugyfel.Id
84484>>>        Set Size to 13 42
84485>>>        Set Location to 20 68
84486>>>        Set peAnchors to anTopLeftRight
84487>>>        Set Label to "gyfl azonost"
84488>>>        Set Label_Justification_mode to jMode_Left
84489>>>        Set Label_Col_Offset to 63
84490>>>        Set Label_row_Offset to 0
84491>>>    End_Object 
84492>>>
84492>>>    Object oAutoId is a dbForm
84494>>>        Entry_Item Auto.Id
84495>>>        Set Size to 13 42
84496>>>        Set Location to 35 68
84497>>>        Set peAnchors to anTopLeftRight
84498>>>        Set Label to "Azonost"
84499>>>        Set Label_Justification_mode to jMode_Left
84500>>>        Set Label_Col_Offset to 63
84501>>>        Set Label_row_Offset to 0
84502>>>    End_Object 
84503>>>
84503>>>    Object oMunkalapBehozatal is a dbForm
84505>>>        Entry_Item Munkalap.Behozatal
84506>>>        Set Size to 13 66
84507>>>        Set Location to 50 68
84508>>>        Set peAnchors to anTopLeftRight
84509>>>        Set Label to "Behozatal"
84510>>>        Set Label_Justification_mode to jMode_Left
84511>>>        Set Label_Col_Offset to 63
84512>>>        Set Label_row_Offset to 0
84513>>>    End_Object 
84514>>>
84514>>>    Object oMunkalapElvitel is a dbForm
84516>>>        Entry_Item Munkalap.Elvitel
84517>>>        Set Size to 13 66
84518>>>        Set Location to 65 68
84519>>>        Set peAnchors to anTopLeftRight
84520>>>        Set Label to "Elvitel"
84521>>>        Set Label_Justification_mode to jMode_Left
84522>>>        Set Label_Col_Offset to 63
84523>>>        Set Label_row_Offset to 0
84524>>>    End_Object 
84525>>>
84525>>>    Object oMunkalapAkm is a dbForm
84527>>>        Entry_Item Munkalap.Akm
84528>>>        Set Size to 13 66
84529>>>        Set Location to 80 68
84530>>>        Set peAnchors to anTopLeftRight
84531>>>        Set Label to "Kilmter eltte"
84532>>>        Set Label_Justification_mode to jMode_Left
84533>>>        Set Label_Col_Offset to 63
84534>>>        Set Label_row_Offset to 0
84535>>>    End_Object 
84536>>>
84536>>>    Object oMunkalapBkm is a dbForm
84538>>>        Entry_Item Munkalap.Bkm
84539>>>        Set Size to 13 66
84540>>>        Set Location to 95 68
84541>>>        Set peAnchors to anTopLeftRight
84542>>>        Set Label to "Kilmterlls utns"
84543>>>        Set Label_Justification_mode to jMode_Left
84544>>>        Set Label_Col_Offset to 63
84545>>>        Set Label_row_Offset to 0
84546>>>    End_Object 
84547>>>
84547>>>    Object oAutoMarka is a dbForm
84549>>>        Entry_Item Auto.Marka
84550>>>        Set Size to 13 126
84551>>>        Set Location to 110 68
84552>>>        Set peAnchors to anTopLeftRight
84553>>>        Set Label to "AutoMarka"
84554>>>        Set Label_Justification_mode to jMode_Left
84555>>>        Set Label_Col_Offset to 63
84556>>>        Set Label_row_Offset to 0
84557>>>    End_Object 
84558>>>
84558>>>    Object oDetailGrid is a cDbCJGrid
84560>>>        Set Size to 66 299
84561>>>        Set Location to 133 5
84562>>>        Set Server to oMunkaMunkalap_DD
84563>>>        Set Ordering to 1
84564>>>        Set peAnchors to anAll
84565>>>        Set psLayoutSection to "oMunkalapKeszites_oDetailGrid"
84566>>>        Set pbAllowInsertRow to False
84567>>>        Set pbHeaderPrompts to True
84568>>>
84568>>>        Object oMunka_Id is a cDbCJGridColumn
84570>>>            Entry_Item Munka.Id
84571>>>            Set piWidth to 85
84572>>>            Set psCaption to "Munka azon."
84573>>>        End_Object 
84574>>>
84574>>>        Object oMunka_Name is a cDbCJGridColumn
84576>>>            Entry_Item Munka.Name
84577>>>            Set piWidth to 210
84578>>>            Set psCaption to "Nv"
84579>>>        End_Object 
84580>>>
84580>>>        Object oMunka_Leiras is a cDbCJGridColumn
84582>>>            Entry_Item Munka.Leiras
84583>>>            Set piWidth to 105
84584>>>            Set psCaption to "Lers"
84585>>>        End_Object 
84586>>>
84586>>>        Object oMunka_Egysegar is a cDbCJGridColumn
84588>>>            Entry_Item Munka.Egysegar
84589>>>            Set piWidth to 105
84590>>>            Set psCaption to "Egysgr"
84591>>>        End_Object 
84592>>>
84592>>>    End_Object 
84593>>>
84593>>>    //-----------------------------------------------------------------------
84593>>>    // Create custom confirmation messages for save and delete
84593>>>    // We must create the new functions and assign verify messages
84593>>>    // to them.
84593>>>    //-----------------------------------------------------------------------
84593>>>
84593>>>    Function ConfirmDeleteHeader Returns Boolean
84596>>>        Boolean bFail
84596>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
84597>>>        Function_Return bFail
84598>>>    End_Function 
84599>>>
84599>>>    // Only confirm on the saving of new records
84599>>>    Function ConfirmSaveHeader Returns Boolean
84602>>>        Boolean bNoSave bHasRecord
84602>>>        Handle  hoSrvr
84602>>>        Get Server to hoSrvr
84603>>>        Get HasRecord of hoSrvr to bHasRecord
84604>>>        If not bHasRecord Begin
84606>>>            Get Confirm "Save this NEW header?" to bNoSave
84607>>>        End
84607>>>>
84607>>>        Function_Return bNoSave
84608>>>    End_Function 
84609>>>
84609>>>    // Define alternate confirmation Messages
84609>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
84610>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
84611>>>    // Saves in header should not clear the view
84611>>>    Set Auto_Clear_Deo_State to False
84612>>>
84612>>>
84612>>>End_Object 
84613>        Use Report2.rv
Including file: Report2.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report2.rv)
84613>>>// Report2.rv
84613>>>// Report2
84613>>>Register_Object oReport
84613>>>
84613>>>Use DFRptVw.pkg
84613>>>Use cWinReport2.pkg
84613>>>Use Windows.pkg
84613>>>
84613>>>Use cUgyfelDataDictionary.dd
84613>>>Use cAutoDataDictionary.dd
84613>>>Use cMunkalapDataDictionary.dd
84613>>>
84613>>>ACTIVATE_VIEW Activate_oReport2 FOR oReport2
84623>>>>
84623>>>Object oReport2 is a ReportView
84625>>>    Set Location to 6 6
84626>>>    Set Size to 100 202
84627>>>    Set Label To "Report2"
84628>>>
84628>>>
84628>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
84630>>>    End_Object 
84631>>>
84631>>>    Object oAuto_DD is a cAutoDataDictionary
84633>>>    End_Object 
84634>>>
84634>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84636>>>        Set DDO_Server To oAuto_DD
84637>>>        Set DDO_Server To oUgyfel_DD
84638>>>        Property Date pdStartRogzites
84640>>>        Property Date pdStopRogzites
84642>>>
84642>>>        Procedure OnConstrain 
84645>>>            Date dStart dStop
84645>>>
84645>>>            Get pdStartRogzites To dStart
84646>>>            Get pdStopRogzites To dStop
84647>>>
84647>>>            Case Begin
84647>>>                Case (dStart <> 0 and dStop <> 0)
84649>>>                    Constrain Munkalap.Rogzites between dStart and dStop
84653>>>                    Case Break
84654>>>                Case (dStart <> 0)
84657>>>                    Constrain Munkalap.Rogzites GE dStart
84659>>>                    Case Break
84660>>>                Case (dStop <> 0)
84663>>>                    Constrain Munkalap.Rogzites LE dStop
84665>>>            Case End
84665>>>        End_Procedure 
84666>>>    End_Object 
84667>>>
84667>>>    Set Main_DD To oMunkalap_DD
84668>>>
84668>>>
84668>>>
84668>>>    Object oRogzitesSelection is a Group
84670>>>        Set Size to 35 179
84671>>>        Set Location to 5 12
84672>>>        Set Label to "Select Rgzts"
84673>>>
84673>>>        Object oSelStart is a Form
84675>>>            Set Label to "From:"
84676>>>            Set Size to 13 60
84677>>>            Set Location to 13 30
84678>>>            Set Status_Help to "First value in selection range."
84679>>>            Set Label_Col_Offset to 2
84680>>>            Set Label_Justification_Mode to jMode_Right
84681>>>            Set Form_datatype to mask_date_window
84682>>>        End_Object 
84683>>>
84683>>>        Object oSelStop is a Form
84685>>>            Set Label to "To:"
84686>>>            Set Size to 14 60
84687>>>            Set Location to 13 111
84688>>>            Set Status_Help to "Last value in selection range."
84689>>>            Set Label_Col_Offset to 2
84690>>>            Set Label_Justification_Mode to jMode_Right
84691>>>            Set Form_datatype to mask_date_window
84692>>>        End_Object 
84693>>>
84693>>>
84693>>>        Function StartValue returns String
84696>>>            string sValue
84696>>>            Get Value of oSelStart to sValue
84697>>>            Function_return sValue
84698>>>        End_Function 
84699>>>
84699>>>        Function StopValue returns String
84702>>>            string sValue
84702>>>            Get Value of oSelStop to sValue
84703>>>            Function_return sValue
84704>>>        End_Function 
84705>>>
84705>>>    End_Object 
84706>>>
84706>>>    Object oPrintTo is a RadioGroup
84708>>>        Set Size to 38 118
84709>>>        Set Location to 50 12
84710>>>        Set Label to "Send Report to"
84711>>>
84711>>>        Object oRadio1 is a Radio
84713>>>            Set Label to "Report Viewer"
84714>>>            Set Size to 10 61
84715>>>            Set Location to 12 6
84716>>>            Set Status_Help to "Prints the report to screen"
84717>>>        End_Object 
84718>>>
84718>>>        Object oRadio2 is a Radio
84720>>>            Set Label to "Printer"
84721>>>            Set Size to 10 42
84722>>>            Set Location to 24 6
84723>>>            Set Status_Help to "Prints the report to printer"
84724>>>        End_Object 
84725>>>
84725>>>
84725>>>        Function IsToPrinter Returns boolean
84728>>>            integer iRadio
84728>>>            Get Current_radio to iRadio
84729>>>            Function_return (iRadio=1)
84730>>>        End_Function 
84731>>>
84731>>>    End_Object 
84732>>>
84732>>>    Object oBtnPrint is a Button
84734>>>        Set Label to "Print"
84735>>>        Set Location to 45 140
84736>>>        Set Status_Help to "Print the Selected report"
84737>>>        Set Default_State to TRUE
84738>>>        Procedure OnClick
84741>>>            Send StartReport
84742>>>        End_Procedure
84743>>>    End_Object 
84744>>>
84744>>>    Object oBtnPrinterSetup is a Button
84746>>>        Set Label to "Printer Setup"
84747>>>        Set Location to 62 140
84748>>>        Set Status_Help to "Set up printer for report"
84749>>>        Procedure OnClick
84752>>>            Send DFPrintSetup of oReport
84753>>>        End_Procedure
84754>>>    End_Object 
84755>>>
84755>>>    Object oBtnCancel is a Button
84757>>>        Set Label to "Cancel"
84758>>>        Set Location to 79 140
84759>>>        Set Status_Help to "Close this Panel"
84760>>>        Procedure OnClick
84763>>>            Send Close_Panel
84764>>>        End_Procedure
84765>>>    End_Object 
84766>>>
84766>>>
84766>>>
84766>>>    Object oReport is a cWinReport2
84768>>>
84768>>>        Set Report_Title to "Report2"
84769>>>
84769>>>        // Set DDO, Index and breaks for the report
84769>>>        Set Server to oMunkalap_DD
84770>>>        Set Ordering to 3
84771>>>        Report_Breaks Munkalap.AutoMarka
84785>>>
84785>>>        Function Starting_Main_Report Returns Integer
84788>>>            Boolean bErr
84788>>>            Send DFSetMetrics wpm_cm
84789>>>            Send DFSetmargins 1 1 1 1
84790>>>            //Send DFSetLandscape false // This can be used to force a page orientation
84790>>>            Forward Get Starting_Main_Report to bErr
84792>>>            Function_return bErr
84793>>>        End_Function 
84794>>>
84794>>>        // Page_Top is printed first at the top margin of each page
84794>>>        Procedure Page_Top 
84797>>>            string  sFont
84797>>>            integer iFontSize
84797>>>
84797>>>            Move "arial" to sFont
84798>>>            Move 10 to iFontSize
84799>>>
84799>>>            DFFont sFont
84800>>>            DFFontSize iFontSize
84801>>>            DFBeginHeader DFPageTop
84802>>>                DFHeaderFrame Hdr_NoFrame
84803>>>                DFHeaderPos   Hdr_Left
84804>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
84805>>>            DFEndHeader
84807>>>
84807>>>        End_Procedure 
84808>>>
84808>>>        // Report_Header is printed once in a report after Page_Top
84808>>>        //Procedure Report_Header
84808>>>        //    string  sFont
84808>>>        //    integer iFontSize
84808>>>        //    Move "arial" to sFont
84808>>>        //    Move 10 to iFontSize
84808>>>        //    DFFont sFont
84808>>>        //    DFFontSize iFontSize
84808>>>        //    DFBeginHeader  DFReportHeader
84808>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84808>>>        //        DFHeaderPos    Hdr_Left
84808>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84808>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
84808>>>        //    DFEndHeader
84808>>>        //End_Procedure
84808>>>
84808>>>        Procedure Page_Header 
84811>>>            integer iFill iBorder iStyle
84811>>>            string  sFont sReportTitle
84811>>>            integer iFontSize
84811>>>
84811>>>            Move "arial" to sFont
84812>>>            Move 16 to iFontSize
84813>>>            Move (Font_bold + rgb_White) to iStyle
84814>>>            Move (rgb_dGrey) to iFill
84815>>>            Move (rgb_dGrey) to iBorder
84816>>>            Get Report_Title to sReportTitle
84817>>>
84817>>>            DFFont sFont
84818>>>            DFFontSize iFontSize
84819>>>            DFBeginHeader DFPageHeader
84820>>>                DFHeaderPos   Hdr_Left
84821>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84822>>>                DFWritelnPos sReportTitle 0.1 iStyle
84823>>>                DFHeaderMargin HM_BottomOuter 0.08
84824>>>            DFEndHeader
84826>>>
84826>>>        End_Procedure 
84827>>>
84827>>>        Procedure Page_Title 
84830>>>            string  sFont 
84830>>>            integer iFontSize iHeaderStyle iFill iBorder
84830>>>
84830>>>            Move "arial" to sFont
84831>>>            Move 10 to iFontSize
84832>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
84833>>>            Move (rgb_Grey) to iFill
84834>>>            Move (rgb_Grey) to iBorder
84835>>>
84835>>>            DFFont sFont
84836>>>            DFFontSize iFontSize
84837>>>            DFBeginHeader DFPageTitle
84838>>>                DFHeaderPos   Hdr_Left
84839>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84840>>>                DFHeaderMargin HM_TopInner    0.04
84841>>>                DFHeaderMargin HM_BottomInner 0.04
84842>>>                DFHeaderMargin HM_BottomOuter 0.08
84843>>>
84843>>>                DFWritePos "AutoMarka"                    0.08 iHeaderStyle -1 4.26
84844>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
84845>>>                DFWriteLn
84846>>>            DFEndHeader
84848>>>
84848>>>        End_Procedure 
84849>>>
84849>>>        Procedure SubHeader1 
84852>>>            string  sFont 
84852>>>            integer iFontSize iStyle
84852>>>
84852>>>            Move "arial" to sFont
84853>>>            Move 10 to iFontSize
84854>>>            Move (font_bold) to iStyle
84855>>>
84855>>>            DFFont sFont
84856>>>            DFFontSize iFontSize
84857>>>            DFBeginHeader DFSubHeader 1
84858>>>                DFHeaderLineCheck 5
84859>>>                DFHeaderWrap   HDR_Wrap
84860>>>                DFHeaderPos    HDR_Left
84861>>>                DFHeaderFrame HDR_NoFrame
84862>>>                DFWritePos ("Recnum: Munkalap.Recnum") 0.1 iStyle
84863>>>            DFEndHeader
84865>>>
84865>>>        End_Procedure 
84866>>>
84866>>>        Procedure Body 
84869>>>            string  sFont 
84869>>>            integer iFontSize iStyle
84869>>>
84869>>>            Move "arial" to sFont
84870>>>            Move 10 to iFontSize
84871>>>            Move (font_default) to iStyle
84872>>>
84872>>>            DFFont sFont
84873>>>            DFFontSize iFontSize
84874>>>
84874>>>            DFWritePos Munkalap.AutoMarka             0.08 iStyle -1 4.26
84875>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
84876>>>            DFWriteLn
84877>>>            Send Add_SubTotal 1 1
84878>>>
84878>>>        End_Procedure 
84879>>>
84879>>>        Procedure SubTotal1 
84882>>>            string  sFont 
84882>>>            integer iFontSize iStyle iFill iBorder
84882>>>            number  nAmount
84882>>>
84882>>>            Move "arial" to sFont
84883>>>            Move 10 to iFontSize
84884>>>            Move (font_bold) to iStyle
84885>>>            Move (rgb_dGrey) to iBorder
84886>>>            Get DFGetDFColor 242 242 242 to iFill
84887>>>
84887>>>            DFFont sFont
84888>>>            DFFontSize iFontSize
84889>>>            DFBeginHeader DFSubTotal 1
84890>>>                DFHeaderPos   Hdr_Left
84891>>>                DFHeaderWrap  Hdr_NoWrap
84892>>>                DFHeaderFrame HDR_NoFrame
84893>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84894>>>
84894>>>                Get SubTotal ( 1 + 0) to nAmount
84895>>>                Send Add_SubTotal ( 1 + 2) 1
84896>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
84897>>>                DFWriteLn
84898>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
84899>>>                DFWriteLn
84900>>>            DFEndHeader
84902>>>
84902>>>        End_Procedure 
84903>>>
84903>>>        Procedure Total 
84906>>>            string  sFont 
84906>>>            integer iFontSize iStyle iFill iBorder
84906>>>            number  nAmount
84906>>>
84906>>>            Move "arial" to sFont
84907>>>            Move 10 to iFontSize
84908>>>            Move (font_bold) to iStyle
84909>>>            Move (rgb_Grey) to iFill
84910>>>            Move (rgb_dGrey) to iBorder
84911>>>
84911>>>            DFFont sFont
84912>>>            DFFontSize iFontSize
84913>>>            DFBeginHeader DFTotal
84914>>>                DFHeaderPos   Hdr_Left
84915>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84916>>>
84916>>>                Get SubTotal ( 1 + 2) to nAmount
84917>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
84918>>>                DFWriteLn
84919>>>            DFEndHeader
84921>>>
84921>>>        End_Procedure 
84922>>>
84922>>>        // Report_Footer is printed once on the last page before Page_Footer
84922>>>        //Procedure Report_Footer
84922>>>        //    string  sFont
84922>>>        //    integer iFontSize
84922>>>        //    Move "arial" to sFont
84922>>>        //    Move 10 to iFontSize
84922>>>        //    DFFont sFont
84922>>>        //    DFFontSize iFontSize
84922>>>        //    DFBeginHeader DFReportFooter
84922>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84922>>>        //        DFHeaderPos    Hdr_Left
84922>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84922>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
84922>>>        //    DFEndHeader
84922>>>        //End_Procedure
84922>>>
84922>>>        Procedure Page_Footer 
84925>>>            string sStart sStop sText
84925>>>            string  sFont 
84925>>>            integer iFontSize iStyle
84925>>>
84925>>>            Move "arial" to sFont
84926>>>            Move 10 to iFontSize
84927>>>            Move (font_default) to iStyle
84928>>>
84928>>>            DFFont sFont
84929>>>            DFFontSize iFontSize
84930>>>            DFBeginHeader DFPageFooter
84931>>>                DFHeaderFrame hdr_NoFrame
84932>>>                DFHeaderPos   hdr_Left
84933>>>
84933>>>                Get pdStartRogzites of oMunkalap_DD to sStart
84934>>>                Get pdStopRogzites  of oMunkalap_DD to sStop
84935>>>                Get SelectionCriteraDescription "Munkalap.Rogzites" sStart sStop to sText
84936>>>                If (sText<>"") begin
84938>>>                    DFWriteLnPos sText 0.1
84939>>>                end
84939>>>>
84939>>>
84939>>>            DFEndHeader
84941>>>        End_Procedure 
84942>>>
84942>>>        // Page_Bottom is printed last at the bottom margin of each page
84942>>>        Procedure Page_Bottom 
84945>>>            string sFont
84945>>>            integer iFontSize iBorder iStyle
84945>>>            DateTime dtDT
84945>>>
84945>>>            Move (CurrentDateTime()) to dtDT
84946>>>
84946>>>            Move "arial" to sFont
84947>>>            Move 10 to iFontSize
84948>>>            Move (font_default) to iStyle
84949>>>            Move (rgb_dGrey) to iBorder
84950>>>
84950>>>            DFFont sFont
84951>>>            DFFontSize iFontSize
84952>>>            DFBeginHeader DFPageBottom
84953>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
84954>>>                DFHeaderPos Hdr_Left
84955>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
84956>>>            DFEndHeader
84958>>>
84958>>>        End_Procedure 
84959>>>
84959>>>        // Returns string with description of selection ranges
84959>>>        // Pass: Selection title, start value and end value. Return: description
84959>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
84962>>>            string sText
84962>>>            If (sStart=""  AND sStop="")  function_return ""
84965>>>            If (sStart="0" AND sStop="0") function_return ""
84968>>>            If (sStart<>"" AND sStop<>"") begin
84970>>>                Move ("between" * sStart * "and" * sStop) to sText
84971>>>            end
84971>>>>
84971>>>            Else if (sStart > "") begin
84974>>>                Move ("starting at" * sStart) to sText
84975>>>            end
84975>>>>
84975>>>            Else if (sStop > "") begin
84978>>>                Move ("up to" * sStop) to sText
84979>>>            End
84979>>>>
84979>>>            function_return (sTitle * sText)
84980>>>        End_Function
84981>>>
84981>>>    End_Object 
84982>>>
84982>>>    Procedure StartReport 
84985>>>        Boolean bToPrinter
84985>>>        String sValue
84985>>>        Date dStart dStop
84985>>>
84985>>>        // Set all selection critera properties
84985>>>        Get StartValue of oRogzitesSelection to sValue
84986>>>        Set pdStartRogzites of oMunkalap_DD To sValue
84987>>>
84987>>>        Get StopValue of oRogzitesSelection to sValue
84988>>>        Set pdStopRogzites of oMunkalap_DD To sValue
84989>>>
84989>>>
84989>>>        // determine if direct print
84989>>>        Get IsToPrinter of oPrintTo to bToPrinter
84990>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
84991>>>
84991>>>        // run the report
84991>>>        Send Run_Report of oReport
84992>>>
84992>>>    End_Procedure 
84993>>>
84993>>>End_Object 
84994>        Use Report3.rv
Including file: Report3.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report3.rv)
84994>>>// Report3.rv
84994>>>// Report3
84994>>>Register_Object oReport
84994>>>
84994>>>Use DFRptVw.pkg
84994>>>Use cWinReport2.pkg
84994>>>Use Windows.pkg
84994>>>
84994>>>Use cUgyfelDataDictionary.dd
84994>>>Use cAutoDataDictionary.dd
84994>>>Use cMunkalapDataDictionary.dd
84994>>>
84994>>>ACTIVATE_VIEW Activate_oReport3 FOR oReport3
85004>>>>
85004>>>Object oReport3 is a ReportView
85006>>>    Set Location to 6 6
85007>>>    Set Size to 60 202
85008>>>    Set Label To "Report3"
85009>>>
85009>>>
85009>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
85011>>>    End_Object 
85012>>>
85012>>>    Object oAuto_DD is a cAutoDataDictionary
85014>>>    End_Object 
85015>>>
85015>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
85017>>>        Set DDO_Server To oAuto_DD
85018>>>        Set DDO_Server To oUgyfel_DD
85019>>>    End_Object 
85020>>>
85020>>>    Set Main_DD To oMunkalap_DD
85021>>>
85021>>>
85021>>>
85021>>>
85021>>>    Object oPrintTo is a RadioGroup
85023>>>        Set Size to 38 118
85024>>>        Set Location to 10 12
85025>>>        Set Label to "Send Report to"
85026>>>
85026>>>        Object oRadio1 is a Radio
85028>>>            Set Label to "Report Viewer"
85029>>>            Set Size to 10 61
85030>>>            Set Location to 12 6
85031>>>            Set Status_Help to "Prints the report to screen"
85032>>>        End_Object 
85033>>>
85033>>>        Object oRadio2 is a Radio
85035>>>            Set Label to "Printer"
85036>>>            Set Size to 10 42
85037>>>            Set Location to 24 6
85038>>>            Set Status_Help to "Prints the report to printer"
85039>>>        End_Object 
85040>>>
85040>>>
85040>>>        Function IsToPrinter Returns boolean
85043>>>            integer iRadio
85043>>>            Get Current_radio to iRadio
85044>>>            Function_return (iRadio=1)
85045>>>        End_Function 
85046>>>
85046>>>    End_Object 
85047>>>
85047>>>    Object oBtnPrint is a Button
85049>>>        Set Label to "Print"
85050>>>        Set Location to 5 140
85051>>>        Set Status_Help to "Print the Selected report"
85052>>>        Set Default_State to TRUE
85053>>>        Procedure OnClick
85056>>>            Send StartReport
85057>>>        End_Procedure
85058>>>    End_Object 
85059>>>
85059>>>    Object oBtnPrinterSetup is a Button
85061>>>        Set Label to "Printer Setup"
85062>>>        Set Location to 22 140
85063>>>        Set Status_Help to "Set up printer for report"
85064>>>        Procedure OnClick
85067>>>            Send DFPrintSetup of oReport
85068>>>        End_Procedure
85069>>>    End_Object 
85070>>>
85070>>>    Object oBtnCancel is a Button
85072>>>        Set Label to "Cancel"
85073>>>        Set Location to 39 140
85074>>>        Set Status_Help to "Close this Panel"
85075>>>        Procedure OnClick
85078>>>            Send Close_Panel
85079>>>        End_Procedure
85080>>>    End_Object 
85081>>>
85081>>>
85081>>>
85081>>>    Object oReport is a cWinReport2
85083>>>
85083>>>        Set Report_Title to "Report3"
85084>>>
85084>>>        // Set DDO, Index and breaks for the report
85084>>>        Set Server to oMunkalap_DD
85085>>>        Set Ordering to 3
85086>>>        Report_Breaks Munkalap.AutoMarka
85100>>>
85100>>>        Function Starting_Main_Report Returns Integer
85103>>>            Boolean bErr
85103>>>            Send DFSetMetrics wpm_cm
85104>>>            Send DFSetmargins 1 1 1 1
85105>>>            //Send DFSetLandscape false // This can be used to force a page orientation
85105>>>            Forward Get Starting_Main_Report to bErr
85107>>>            Function_return bErr
85108>>>        End_Function 
85109>>>
85109>>>        // Page_Top is printed first at the top margin of each page
85109>>>        Procedure Page_Top 
85112>>>            string  sFont
85112>>>            integer iFontSize
85112>>>
85112>>>            Move "arial" to sFont
85113>>>            Move 10 to iFontSize
85114>>>
85114>>>            DFFont sFont
85115>>>            DFFontSize iFontSize
85116>>>            DFBeginHeader DFPageTop
85117>>>                DFHeaderFrame Hdr_NoFrame
85118>>>                DFHeaderPos   Hdr_Left
85119>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
85120>>>            DFEndHeader
85122>>>
85122>>>        End_Procedure 
85123>>>
85123>>>        // Report_Header is printed once in a report after Page_Top
85123>>>        //Procedure Report_Header
85123>>>        //    string  sFont
85123>>>        //    integer iFontSize
85123>>>        //    Move "arial" to sFont
85123>>>        //    Move 10 to iFontSize
85123>>>        //    DFFont sFont
85123>>>        //    DFFontSize iFontSize
85123>>>        //    DFBeginHeader  DFReportHeader
85123>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85123>>>        //        DFHeaderPos    Hdr_Left
85123>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85123>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
85123>>>        //    DFEndHeader
85123>>>        //End_Procedure
85123>>>
85123>>>        Procedure Page_Header 
85126>>>            integer iFill iBorder iStyle
85126>>>            string  sFont sReportTitle
85126>>>            integer iFontSize
85126>>>
85126>>>            Move "arial" to sFont
85127>>>            Move 16 to iFontSize
85128>>>            Move (Font_bold + rgb_White) to iStyle
85129>>>            Move (rgb_dGrey) to iFill
85130>>>            Move (rgb_dGrey) to iBorder
85131>>>            Get Report_Title to sReportTitle
85132>>>
85132>>>            DFFont sFont
85133>>>            DFFontSize iFontSize
85134>>>            DFBeginHeader DFPageHeader
85135>>>                DFHeaderPos   Hdr_Left
85136>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85137>>>                DFWritelnPos sReportTitle 0.1 iStyle
85138>>>                DFHeaderMargin HM_BottomOuter 0.08
85139>>>            DFEndHeader
85141>>>
85141>>>        End_Procedure 
85142>>>
85142>>>        Procedure Page_Title 
85145>>>            string  sFont 
85145>>>            integer iFontSize iHeaderStyle iFill iBorder
85145>>>
85145>>>            Move "arial" to sFont
85146>>>            Move 10 to iFontSize
85147>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
85148>>>            Move (rgb_Grey) to iFill
85149>>>            Move (rgb_Grey) to iBorder
85150>>>
85150>>>            DFFont sFont
85151>>>            DFFontSize iFontSize
85152>>>            DFBeginHeader DFPageTitle
85153>>>                DFHeaderPos   Hdr_Left
85154>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85155>>>                DFHeaderMargin HM_TopInner    0.04
85156>>>                DFHeaderMargin HM_BottomInner 0.04
85157>>>                DFHeaderMargin HM_BottomOuter 0.08
85158>>>
85158>>>                DFWritePos "AutoMarka"                    0.08 iHeaderStyle -1 4.26
85159>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
85160>>>                DFWriteLn
85161>>>            DFEndHeader
85163>>>
85163>>>        End_Procedure 
85164>>>
85164>>>        Procedure SubHeader1 
85167>>>            string  sFont 
85167>>>            integer iFontSize iStyle
85167>>>
85167>>>            Move "arial" to sFont
85168>>>            Move 10 to iFontSize
85169>>>            Move (font_bold) to iStyle
85170>>>
85170>>>            DFFont sFont
85171>>>            DFFontSize iFontSize
85172>>>            DFBeginHeader DFSubHeader 1
85173>>>                DFHeaderLineCheck 5
85174>>>                DFHeaderWrap   HDR_Wrap
85175>>>                DFHeaderPos    HDR_Left
85176>>>                DFHeaderFrame HDR_NoFrame
85177>>>                DFWritePos ("Recnum: Munkalap.Recnum") 0.1 iStyle
85178>>>            DFEndHeader
85180>>>
85180>>>        End_Procedure 
85181>>>
85181>>>        Procedure Body 
85184>>>            string  sFont 
85184>>>            integer iFontSize iStyle
85184>>>
85184>>>            Move "arial" to sFont
85185>>>            Move 10 to iFontSize
85186>>>            Move (font_default) to iStyle
85187>>>
85187>>>            DFFont sFont
85188>>>            DFFontSize iFontSize
85189>>>
85189>>>            DFWritePos Munkalap.AutoMarka             0.08 iStyle -1 4.26
85190>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
85191>>>            DFWriteLn
85192>>>            Send Add_SubTotal 1 1
85193>>>
85193>>>        End_Procedure 
85194>>>
85194>>>        Procedure SubTotal1 
85197>>>            string  sFont 
85197>>>            integer iFontSize iStyle iFill iBorder
85197>>>            number  nAmount
85197>>>
85197>>>            Move "arial" to sFont
85198>>>            Move 10 to iFontSize
85199>>>            Move (font_bold) to iStyle
85200>>>            Move (rgb_dGrey) to iBorder
85201>>>            Get DFGetDFColor 242 242 242 to iFill
85202>>>
85202>>>            DFFont sFont
85203>>>            DFFontSize iFontSize
85204>>>            DFBeginHeader DFSubTotal 1
85205>>>                DFHeaderPos   Hdr_Left
85206>>>                DFHeaderWrap  Hdr_NoWrap
85207>>>                DFHeaderFrame HDR_NoFrame
85208>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85209>>>
85209>>>                Get SubTotal ( 1 + 0) to nAmount
85210>>>                Send Add_SubTotal ( 1 + 2) 1
85211>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85212>>>                DFWriteLn
85213>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
85214>>>                DFWriteLn
85215>>>            DFEndHeader
85217>>>
85217>>>        End_Procedure 
85218>>>
85218>>>        Procedure Total 
85221>>>            string  sFont 
85221>>>            integer iFontSize iStyle iFill iBorder
85221>>>            number  nAmount
85221>>>
85221>>>            Move "arial" to sFont
85222>>>            Move 10 to iFontSize
85223>>>            Move (font_bold) to iStyle
85224>>>            Move (rgb_Grey) to iFill
85225>>>            Move (rgb_dGrey) to iBorder
85226>>>
85226>>>            DFFont sFont
85227>>>            DFFontSize iFontSize
85228>>>            DFBeginHeader DFTotal
85229>>>                DFHeaderPos   Hdr_Left
85230>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85231>>>
85231>>>                Get SubTotal ( 1 + 2) to nAmount
85232>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85233>>>                DFWriteLn
85234>>>            DFEndHeader
85236>>>
85236>>>        End_Procedure 
85237>>>
85237>>>        // Report_Footer is printed once on the last page before Page_Footer
85237>>>        //Procedure Report_Footer
85237>>>        //    string  sFont
85237>>>        //    integer iFontSize
85237>>>        //    Move "arial" to sFont
85237>>>        //    Move 10 to iFontSize
85237>>>        //    DFFont sFont
85237>>>        //    DFFontSize iFontSize
85237>>>        //    DFBeginHeader DFReportFooter
85237>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85237>>>        //        DFHeaderPos    Hdr_Left
85237>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85237>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
85237>>>        //    DFEndHeader
85237>>>        //End_Procedure
85237>>>
85237>>>        // // Page_Footer is printed on each page before Page_Bottom
85237>>>        //Procedure Page_Footer
85237>>>        //    string  sFont
85237>>>        //    integer iFontSize
85237>>>        //    Move "arial" to sFont
85237>>>        //    Move 10 to iFontSize
85237>>>        //    DFFont sFont
85237>>>        //    DFFontSize iFontSize
85237>>>        //    DFBeginHeader DFPageFooter
85237>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85237>>>        //        DFHeaderPos    Hdr_Left
85237>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85237>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
85237>>>        //    DFEndHeader
85237>>>        //End_Procedure
85237>>>
85237>>>
85237>>>        // Page_Bottom is printed last at the bottom margin of each page
85237>>>        Procedure Page_Bottom 
85240>>>            string sFont
85240>>>            integer iFontSize iBorder iStyle
85240>>>            DateTime dtDT
85240>>>
85240>>>            Move (CurrentDateTime()) to dtDT
85241>>>
85241>>>            Move "arial" to sFont
85242>>>            Move 10 to iFontSize
85243>>>            Move (font_default) to iStyle
85244>>>            Move (rgb_dGrey) to iBorder
85245>>>
85245>>>            DFFont sFont
85246>>>            DFFontSize iFontSize
85247>>>            DFBeginHeader DFPageBottom
85248>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
85249>>>                DFHeaderPos Hdr_Left
85250>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
85251>>>            DFEndHeader
85253>>>
85253>>>        End_Procedure 
85254>>>
85254>>>        // Returns string with description of selection ranges
85254>>>        // Pass: Selection title, start value and end value. Return: description
85254>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
85257>>>            string sText
85257>>>            If (sStart=""  AND sStop="")  function_return ""
85260>>>            If (sStart="0" AND sStop="0") function_return ""
85263>>>            If (sStart<>"" AND sStop<>"") begin
85265>>>                Move ("between" * sStart * "and" * sStop) to sText
85266>>>            end
85266>>>>
85266>>>            Else if (sStart > "") begin
85269>>>                Move ("starting at" * sStart) to sText
85270>>>            end
85270>>>>
85270>>>            Else if (sStop > "") begin
85273>>>                Move ("up to" * sStop) to sText
85274>>>            End
85274>>>>
85274>>>            function_return (sTitle * sText)
85275>>>        End_Function
85276>>>
85276>>>    End_Object 
85277>>>
85277>>>    Procedure StartReport 
85280>>>        Boolean bToPrinter
85280>>>
85280>>>        // determine if direct print
85280>>>        Get IsToPrinter of oPrintTo to bToPrinter
85281>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
85282>>>
85282>>>        // run the report
85282>>>        Send Run_Report of oReport
85283>>>
85283>>>    End_Procedure 
85284>>>
85284>>>End_Object 
85285>        Use Report4.rv
Including file: Report4.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report4.rv)
85285>>>// Report4.rv
85285>>>// Report4
85285>>>Register_Object oReport
85285>>>
85285>>>Use DFRptVw.pkg
85285>>>Use cWinReport2.pkg
85285>>>Use Windows.pkg
85285>>>
85285>>>Use cUgyfelDataDictionary.dd
85285>>>Use cAutoDataDictionary.dd
85285>>>Use cMunkalapDataDictionary.dd
85285>>>
85285>>>ACTIVATE_VIEW Activate_oReport4 FOR oReport4
85295>>>>
85295>>>Object oReport4 is a ReportView
85297>>>    Set Location to 6 6
85298>>>    Set Size to 60 202
85299>>>    Set Label To "Report4"
85300>>>
85300>>>
85300>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
85302>>>    End_Object 
85303>>>
85303>>>    Object oAuto_DD is a cAutoDataDictionary
85305>>>    End_Object 
85306>>>
85306>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
85308>>>        Set DDO_Server To oAuto_DD
85309>>>        Set DDO_Server To oUgyfel_DD
85310>>>    End_Object 
85311>>>
85311>>>    Set Main_DD To oMunkalap_DD
85312>>>
85312>>>
85312>>>
85312>>>
85312>>>    Object oPrintTo is a RadioGroup
85314>>>        Set Size to 38 118
85315>>>        Set Location to 10 12
85316>>>        Set Label to "Send Report to"
85317>>>
85317>>>        Object oRadio1 is a Radio
85319>>>            Set Label to "Report Viewer"
85320>>>            Set Size to 10 61
85321>>>            Set Location to 12 6
85322>>>            Set Status_Help to "Prints the report to screen"
85323>>>        End_Object 
85324>>>
85324>>>        Object oRadio2 is a Radio
85326>>>            Set Label to "Printer"
85327>>>            Set Size to 10 42
85328>>>            Set Location to 24 6
85329>>>            Set Status_Help to "Prints the report to printer"
85330>>>        End_Object 
85331>>>
85331>>>
85331>>>        Function IsToPrinter Returns boolean
85334>>>            integer iRadio
85334>>>            Get Current_radio to iRadio
85335>>>            Function_return (iRadio=1)
85336>>>        End_Function 
85337>>>
85337>>>    End_Object 
85338>>>
85338>>>    Object oBtnPrint is a Button
85340>>>        Set Label to "Print"
85341>>>        Set Location to 5 140
85342>>>        Set Status_Help to "Print the Selected report"
85343>>>        Set Default_State to TRUE
85344>>>        Procedure OnClick
85347>>>            Send StartReport
85348>>>        End_Procedure
85349>>>    End_Object 
85350>>>
85350>>>    Object oBtnPrinterSetup is a Button
85352>>>        Set Label to "Printer Setup"
85353>>>        Set Location to 22 140
85354>>>        Set Status_Help to "Set up printer for report"
85355>>>        Procedure OnClick
85358>>>            Send DFPrintSetup of oReport
85359>>>        End_Procedure
85360>>>    End_Object 
85361>>>
85361>>>    Object oBtnCancel is a Button
85363>>>        Set Label to "Cancel"
85364>>>        Set Location to 39 140
85365>>>        Set Status_Help to "Close this Panel"
85366>>>        Procedure OnClick
85369>>>            Send Close_Panel
85370>>>        End_Procedure
85371>>>    End_Object 
85372>>>
85372>>>
85372>>>
85372>>>    Object oReport is a cWinReport2
85374>>>
85374>>>        Set Report_Title to "Report4"
85375>>>
85375>>>        // Set DDO, Index and breaks for the report
85375>>>        Set Server to oMunkalap_DD
85376>>>        Set Ordering to 4
85377>>>        Report_Breaks Munkalap.AutoMarka
85391>>>
85391>>>        Function Starting_Main_Report Returns Integer
85394>>>            Boolean bErr
85394>>>            Send DFSetMetrics wpm_cm
85395>>>            Send DFSetmargins 1 1 1 1
85396>>>            //Send DFSetLandscape false // This can be used to force a page orientation
85396>>>            Forward Get Starting_Main_Report to bErr
85398>>>            Function_return bErr
85399>>>        End_Function 
85400>>>
85400>>>        // Page_Top is printed first at the top margin of each page
85400>>>        Procedure Page_Top 
85403>>>            string  sFont
85403>>>            integer iFontSize
85403>>>
85403>>>            Move "arial" to sFont
85404>>>            Move 10 to iFontSize
85405>>>
85405>>>            DFFont sFont
85406>>>            DFFontSize iFontSize
85407>>>            DFBeginHeader DFPageTop
85408>>>                DFHeaderFrame Hdr_NoFrame
85409>>>                DFHeaderPos   Hdr_Left
85410>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
85411>>>            DFEndHeader
85413>>>
85413>>>        End_Procedure 
85414>>>
85414>>>        // Report_Header is printed once in a report after Page_Top
85414>>>        //Procedure Report_Header
85414>>>        //    string  sFont
85414>>>        //    integer iFontSize
85414>>>        //    Move "arial" to sFont
85414>>>        //    Move 10 to iFontSize
85414>>>        //    DFFont sFont
85414>>>        //    DFFontSize iFontSize
85414>>>        //    DFBeginHeader  DFReportHeader
85414>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85414>>>        //        DFHeaderPos    Hdr_Left
85414>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85414>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
85414>>>        //    DFEndHeader
85414>>>        //End_Procedure
85414>>>
85414>>>        Procedure Page_Header 
85417>>>            integer iFill iBorder iStyle
85417>>>            string  sFont sReportTitle
85417>>>            integer iFontSize
85417>>>
85417>>>            Move "arial" to sFont
85418>>>            Move 16 to iFontSize
85419>>>            Move (Font_bold + rgb_White) to iStyle
85420>>>            Move (rgb_dGrey) to iFill
85421>>>            Move (rgb_dGrey) to iBorder
85422>>>            Get Report_Title to sReportTitle
85423>>>
85423>>>            DFFont sFont
85424>>>            DFFontSize iFontSize
85425>>>            DFBeginHeader DFPageHeader
85426>>>                DFHeaderPos   Hdr_Left
85427>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85428>>>                DFWritelnPos sReportTitle 0.1 iStyle
85429>>>                DFHeaderMargin HM_BottomOuter 0.08
85430>>>            DFEndHeader
85432>>>
85432>>>        End_Procedure 
85433>>>
85433>>>        Procedure Page_Title 
85436>>>            string  sFont 
85436>>>            integer iFontSize iHeaderStyle iFill iBorder
85436>>>
85436>>>            Move "arial" to sFont
85437>>>            Move 10 to iFontSize
85438>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
85439>>>            Move (rgb_Grey) to iFill
85440>>>            Move (rgb_Grey) to iBorder
85441>>>
85441>>>            DFFont sFont
85442>>>            DFFontSize iFontSize
85443>>>            DFBeginHeader DFPageTitle
85444>>>                DFHeaderPos   Hdr_Left
85445>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85446>>>                DFHeaderMargin HM_TopInner    0.04
85447>>>                DFHeaderMargin HM_BottomInner 0.04
85448>>>                DFHeaderMargin HM_BottomOuter 0.08
85449>>>
85449>>>                DFWritePos "AutoMarka"                    0.08 iHeaderStyle -1 4.26
85450>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
85451>>>                DFWriteLn
85452>>>            DFEndHeader
85454>>>
85454>>>        End_Procedure 
85455>>>
85455>>>        Procedure SubHeader1 
85458>>>            string  sFont 
85458>>>            integer iFontSize iStyle
85458>>>
85458>>>            Move "arial" to sFont
85459>>>            Move 10 to iFontSize
85460>>>            Move (font_bold) to iStyle
85461>>>
85461>>>            DFFont sFont
85462>>>            DFFontSize iFontSize
85463>>>            DFBeginHeader DFSubHeader 1
85464>>>                DFHeaderLineCheck 5
85465>>>                DFHeaderWrap   HDR_Wrap
85466>>>                DFHeaderPos    HDR_Left
85467>>>                DFHeaderFrame HDR_NoFrame
85468>>>                DFWritePos ("Recnum: Munkalap.Recnum") 0.1 iStyle
85469>>>            DFEndHeader
85471>>>
85471>>>        End_Procedure 
85472>>>
85472>>>        Procedure Body 
85475>>>            string  sFont 
85475>>>            integer iFontSize iStyle
85475>>>
85475>>>            Move "arial" to sFont
85476>>>            Move 10 to iFontSize
85477>>>            Move (font_default) to iStyle
85478>>>
85478>>>            DFFont sFont
85479>>>            DFFontSize iFontSize
85480>>>
85480>>>            DFWritePos Munkalap.AutoMarka             0.08 iStyle -1 4.26
85481>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
85482>>>            DFWriteLn
85483>>>            Send Add_SubTotal 1 1
85484>>>
85484>>>        End_Procedure 
85485>>>
85485>>>        Procedure SubTotal1 
85488>>>            string  sFont 
85488>>>            integer iFontSize iStyle iFill iBorder
85488>>>            number  nAmount
85488>>>
85488>>>            Move "arial" to sFont
85489>>>            Move 10 to iFontSize
85490>>>            Move (font_bold) to iStyle
85491>>>            Move (rgb_dGrey) to iBorder
85492>>>            Get DFGetDFColor 242 242 242 to iFill
85493>>>
85493>>>            DFFont sFont
85494>>>            DFFontSize iFontSize
85495>>>            DFBeginHeader DFSubTotal 1
85496>>>                DFHeaderPos   Hdr_Left
85497>>>                DFHeaderWrap  Hdr_NoWrap
85498>>>                DFHeaderFrame HDR_NoFrame
85499>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85500>>>
85500>>>                Get SubTotal ( 1 + 0) to nAmount
85501>>>                Send Add_SubTotal ( 1 + 2) 1
85502>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85503>>>                DFWriteLn
85504>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
85505>>>                DFWriteLn
85506>>>            DFEndHeader
85508>>>
85508>>>        End_Procedure 
85509>>>
85509>>>        Procedure Total 
85512>>>            string  sFont 
85512>>>            integer iFontSize iStyle iFill iBorder
85512>>>            number  nAmount
85512>>>
85512>>>            Move "arial" to sFont
85513>>>            Move 10 to iFontSize
85514>>>            Move (font_bold) to iStyle
85515>>>            Move (rgb_Grey) to iFill
85516>>>            Move (rgb_dGrey) to iBorder
85517>>>
85517>>>            DFFont sFont
85518>>>            DFFontSize iFontSize
85519>>>            DFBeginHeader DFTotal
85520>>>                DFHeaderPos   Hdr_Left
85521>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85522>>>
85522>>>                Get SubTotal ( 1 + 2) to nAmount
85523>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85524>>>                DFWriteLn
85525>>>            DFEndHeader
85527>>>
85527>>>        End_Procedure 
85528>>>
85528>>>        // Report_Footer is printed once on the last page before Page_Footer
85528>>>        //Procedure Report_Footer
85528>>>        //    string  sFont
85528>>>        //    integer iFontSize
85528>>>        //    Move "arial" to sFont
85528>>>        //    Move 10 to iFontSize
85528>>>        //    DFFont sFont
85528>>>        //    DFFontSize iFontSize
85528>>>        //    DFBeginHeader DFReportFooter
85528>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85528>>>        //        DFHeaderPos    Hdr_Left
85528>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85528>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
85528>>>        //    DFEndHeader
85528>>>        //End_Procedure
85528>>>
85528>>>        // // Page_Footer is printed on each page before Page_Bottom
85528>>>        //Procedure Page_Footer
85528>>>        //    string  sFont
85528>>>        //    integer iFontSize
85528>>>        //    Move "arial" to sFont
85528>>>        //    Move 10 to iFontSize
85528>>>        //    DFFont sFont
85528>>>        //    DFFontSize iFontSize
85528>>>        //    DFBeginHeader DFPageFooter
85528>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85528>>>        //        DFHeaderPos    Hdr_Left
85528>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85528>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
85528>>>        //    DFEndHeader
85528>>>        //End_Procedure
85528>>>
85528>>>
85528>>>        // Page_Bottom is printed last at the bottom margin of each page
85528>>>        Procedure Page_Bottom 
85531>>>            string sFont
85531>>>            integer iFontSize iBorder iStyle
85531>>>            DateTime dtDT
85531>>>
85531>>>            Move (CurrentDateTime()) to dtDT
85532>>>
85532>>>            Move "arial" to sFont
85533>>>            Move 10 to iFontSize
85534>>>            Move (font_default) to iStyle
85535>>>            Move (rgb_dGrey) to iBorder
85536>>>
85536>>>            DFFont sFont
85537>>>            DFFontSize iFontSize
85538>>>            DFBeginHeader DFPageBottom
85539>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
85540>>>                DFHeaderPos Hdr_Left
85541>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
85542>>>            DFEndHeader
85544>>>
85544>>>        End_Procedure 
85545>>>
85545>>>        // Returns string with description of selection ranges
85545>>>        // Pass: Selection title, start value and end value. Return: description
85545>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
85548>>>            string sText
85548>>>            If (sStart=""  AND sStop="")  function_return ""
85551>>>            If (sStart="0" AND sStop="0") function_return ""
85554>>>            If (sStart<>"" AND sStop<>"") begin
85556>>>                Move ("between" * sStart * "and" * sStop) to sText
85557>>>            end
85557>>>>
85557>>>            Else if (sStart > "") begin
85560>>>                Move ("starting at" * sStart) to sText
85561>>>            end
85561>>>>
85561>>>            Else if (sStop > "") begin
85564>>>                Move ("up to" * sStop) to sText
85565>>>            End
85565>>>>
85565>>>            function_return (sTitle * sText)
85566>>>        End_Function
85567>>>
85567>>>    End_Object 
85568>>>
85568>>>    Procedure StartReport 
85571>>>        Boolean bToPrinter
85571>>>
85571>>>        // determine if direct print
85571>>>        Get IsToPrinter of oPrintTo to bToPrinter
85572>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
85573>>>
85573>>>        // run the report
85573>>>        Send Run_Report of oReport
85574>>>
85574>>>    End_Procedure 
85575>>>
85575>>>End_Object 
85576>        Use VeglegesReport.rv
Including file: VeglegesReport.rv    (C:\Repos\DataFlexBeadando\AppSrc\VeglegesReport.rv)
85576>>>// VeglegesReport.rv
85576>>>// VeglegesReport
85576>>>Register_Object oReport
85576>>>
85576>>>Use DFRptVw.pkg
85576>>>Use cWinReport2.pkg
85576>>>Use Windows.pkg
85576>>>
85576>>>Use cUgyfelDataDictionary.dd
85576>>>Use cAutoDataDictionary.dd
85576>>>Use cMunkalapDataDictionary.dd
85576>>>
85576>>>ACTIVATE_VIEW Activate_oVeglegesReport FOR oVeglegesReport
85586>>>>
85586>>>Object oVeglegesReport is a ReportView
85588>>>    Set Location to 6 6
85589>>>    Set Size to 100 202
85590>>>    Set Label To "VeglegesReport"
85591>>>
85591>>>
85591>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
85593>>>    End_Object 
85594>>>
85594>>>    Object oAuto_DD is a cAutoDataDictionary
85596>>>    End_Object 
85597>>>
85597>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
85599>>>        Set DDO_Server To oAuto_DD
85600>>>        Set DDO_Server To oUgyfel_DD
85601>>>        Property Date pdStartRogzites
85603>>>        Property Date pdStopRogzites
85605>>>
85605>>>        Procedure OnConstrain 
85608>>>            Date dStart dStop
85608>>>
85608>>>            Get pdStartRogzites To dStart
85609>>>            Get pdStopRogzites To dStop
85610>>>
85610>>>            Case Begin
85610>>>                Case (dStart <> 0 and dStop <> 0)
85612>>>                    Constrain Munkalap.Rogzites between dStart and dStop
85616>>>                    Case Break
85617>>>                Case (dStart <> 0)
85620>>>                    Constrain Munkalap.Rogzites GE dStart
85622>>>                    Case Break
85623>>>                Case (dStop <> 0)
85626>>>                    Constrain Munkalap.Rogzites LE dStop
85628>>>            Case End
85628>>>        End_Procedure 
85629>>>    End_Object 
85630>>>
85630>>>    Set Main_DD To oMunkalap_DD
85631>>>
85631>>>
85631>>>
85631>>>    Object oRogzitesSelection is a Group
85633>>>        Set Size to 35 179
85634>>>        Set Location to 5 12
85635>>>        Set Label to "Select Rgzts"
85636>>>
85636>>>        Object oSelStart is a Form
85638>>>            Set Label to "From:"
85639>>>            Set Size to 13 60
85640>>>            Set Location to 13 30
85641>>>            Set Status_Help to "First value in selection range."
85642>>>            Set Label_Col_Offset to 2
85643>>>            Set Label_Justification_Mode to jMode_Right
85644>>>            Set Form_datatype to mask_date_window
85645>>>        End_Object 
85646>>>
85646>>>        Object oSelStop is a Form
85648>>>            Set Label to "To:"
85649>>>            Set Size to 14 60
85650>>>            Set Location to 13 111
85651>>>            Set Status_Help to "Last value in selection range."
85652>>>            Set Label_Col_Offset to 2
85653>>>            Set Label_Justification_Mode to jMode_Right
85654>>>            Set Form_datatype to mask_date_window
85655>>>        End_Object 
85656>>>
85656>>>
85656>>>        Function StartValue returns String
85659>>>            string sValue
85659>>>            Get Value of oSelStart to sValue
85660>>>            Function_return sValue
85661>>>        End_Function 
85662>>>
85662>>>        Function StopValue returns String
85665>>>            string sValue
85665>>>            Get Value of oSelStop to sValue
85666>>>            Function_return sValue
85667>>>        End_Function 
85668>>>
85668>>>    End_Object 
85669>>>
85669>>>    Object oPrintTo is a RadioGroup
85671>>>        Set Size to 38 118
85672>>>        Set Location to 50 12
85673>>>        Set Label to "Send Report to"
85674>>>
85674>>>        Object oRadio1 is a Radio
85676>>>            Set Label to "Report Viewer"
85677>>>            Set Size to 10 61
85678>>>            Set Location to 12 6
85679>>>            Set Status_Help to "Prints the report to screen"
85680>>>        End_Object 
85681>>>
85681>>>        Object oRadio2 is a Radio
85683>>>            Set Label to "Printer"
85684>>>            Set Size to 10 42
85685>>>            Set Location to 24 6
85686>>>            Set Status_Help to "Prints the report to printer"
85687>>>        End_Object 
85688>>>
85688>>>
85688>>>        Function IsToPrinter Returns boolean
85691>>>            integer iRadio
85691>>>            Get Current_radio to iRadio
85692>>>            Function_return (iRadio=1)
85693>>>        End_Function 
85694>>>
85694>>>    End_Object 
85695>>>
85695>>>    Object oBtnPrint is a Button
85697>>>        Set Label to "Print"
85698>>>        Set Location to 45 140
85699>>>        Set Status_Help to "Print the Selected report"
85700>>>        Set Default_State to TRUE
85701>>>        Procedure OnClick
85704>>>            Send StartReport
85705>>>        End_Procedure
85706>>>    End_Object 
85707>>>
85707>>>    Object oBtnPrinterSetup is a Button
85709>>>        Set Label to "Printer Setup"
85710>>>        Set Location to 62 140
85711>>>        Set Status_Help to "Set up printer for report"
85712>>>        Procedure OnClick
85715>>>            Send DFPrintSetup of oReport
85716>>>        End_Procedure
85717>>>    End_Object 
85718>>>
85718>>>    Object oBtnCancel is a Button
85720>>>        Set Label to "Cancel"
85721>>>        Set Location to 79 140
85722>>>        Set Status_Help to "Close this Panel"
85723>>>        Procedure OnClick
85726>>>            Send Close_Panel
85727>>>        End_Procedure
85728>>>    End_Object 
85729>>>
85729>>>
85729>>>
85729>>>    Object oReport is a cWinReport2
85731>>>
85731>>>        Set Report_Title to "VeglegesReport"
85732>>>
85732>>>        // Set DDO, Index and breaks for the report
85732>>>        Set Server to oMunkalap_DD
85733>>>        Set Ordering to 4
85734>>>        Report_Breaks Munkalap.AutoMarka
85748>>>
85748>>>        Function Starting_Main_Report Returns Integer
85751>>>            Boolean bErr
85751>>>            Send DFSetMetrics wpm_cm
85752>>>            Send DFSetmargins 1 1 1 1
85753>>>            //Send DFSetLandscape false // This can be used to force a page orientation
85753>>>            Forward Get Starting_Main_Report to bErr
85755>>>            Function_return bErr
85756>>>        End_Function 
85757>>>
85757>>>        // Page_Top is printed first at the top margin of each page
85757>>>        Procedure Page_Top 
85760>>>            string  sFont
85760>>>            integer iFontSize
85760>>>
85760>>>            Move "arial" to sFont
85761>>>            Move 10 to iFontSize
85762>>>
85762>>>            DFFont sFont
85763>>>            DFFontSize iFontSize
85764>>>            DFBeginHeader DFPageTop
85765>>>                DFHeaderFrame Hdr_NoFrame
85766>>>                DFHeaderPos   Hdr_Left
85767>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
85768>>>            DFEndHeader
85770>>>
85770>>>        End_Procedure 
85771>>>
85771>>>        // Report_Header is printed once in a report after Page_Top
85771>>>        //Procedure Report_Header
85771>>>        //    string  sFont
85771>>>        //    integer iFontSize
85771>>>        //    Move "arial" to sFont
85771>>>        //    Move 10 to iFontSize
85771>>>        //    DFFont sFont
85771>>>        //    DFFontSize iFontSize
85771>>>        //    DFBeginHeader  DFReportHeader
85771>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85771>>>        //        DFHeaderPos    Hdr_Left
85771>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85771>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
85771>>>        //    DFEndHeader
85771>>>        //End_Procedure
85771>>>
85771>>>        Procedure Page_Header 
85774>>>            integer iFill iBorder iStyle
85774>>>            string  sFont sReportTitle
85774>>>            integer iFontSize
85774>>>
85774>>>            Move "arial" to sFont
85775>>>            Move 16 to iFontSize
85776>>>            Move (Font_bold + rgb_White) to iStyle
85777>>>            Move (rgb_dGrey) to iFill
85778>>>            Move (rgb_dGrey) to iBorder
85779>>>            Get Report_Title to sReportTitle
85780>>>
85780>>>            DFFont sFont
85781>>>            DFFontSize iFontSize
85782>>>            DFBeginHeader DFPageHeader
85783>>>                DFHeaderPos   Hdr_Left
85784>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85785>>>                DFWritelnPos sReportTitle 0.1 iStyle
85786>>>                DFHeaderMargin HM_BottomOuter 0.08
85787>>>            DFEndHeader
85789>>>
85789>>>        End_Procedure 
85790>>>
85790>>>        Procedure Page_Title 
85793>>>            string  sFont 
85793>>>            integer iFontSize iHeaderStyle iFill iBorder
85793>>>
85793>>>            Move "arial" to sFont
85794>>>            Move 10 to iFontSize
85795>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
85796>>>            Move (rgb_Grey) to iFill
85797>>>            Move (rgb_Grey) to iBorder
85798>>>
85798>>>            DFFont sFont
85799>>>            DFFontSize iFontSize
85800>>>            DFBeginHeader DFPageTitle
85801>>>                DFHeaderPos   Hdr_Left
85802>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85803>>>                DFHeaderMargin HM_TopInner    0.04
85804>>>                DFHeaderMargin HM_BottomInner 0.04
85805>>>                DFHeaderMargin HM_BottomOuter 0.08
85806>>>
85806>>>                DFWritePos "AutoMarka"                    0.08 iHeaderStyle -1 4.26
85807>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
85808>>>                DFWritePos "Nv"                          6.63 iHeaderStyle -1 21.33
85809>>>                DFWriteLn
85810>>>            DFEndHeader
85812>>>
85812>>>        End_Procedure 
85813>>>
85813>>>        Procedure SubHeader1 
85816>>>            string  sFont 
85816>>>            integer iFontSize iStyle
85816>>>
85816>>>            Move "arial" to sFont
85817>>>            Move 10 to iFontSize
85818>>>            Move (font_bold) to iStyle
85819>>>
85819>>>            DFFont sFont
85820>>>            DFFontSize iFontSize
85821>>>            DFBeginHeader DFSubHeader 1
85822>>>                DFHeaderLineCheck 5
85823>>>                DFHeaderWrap   HDR_Wrap
85824>>>                DFHeaderPos    HDR_Left
85825>>>                DFHeaderFrame HDR_NoFrame
85826>>>                DFWritePos ("Recnum: Munkalap.Recnum") 0.1 iStyle
85827>>>            DFEndHeader
85829>>>
85829>>>        End_Procedure 
85830>>>
85830>>>        Procedure Body 
85833>>>            string  sFont 
85833>>>            integer iFontSize iStyle
85833>>>
85833>>>            Move "arial" to sFont
85834>>>            Move 10 to iFontSize
85835>>>            Move (font_default) to iStyle
85836>>>
85836>>>            DFFont sFont
85837>>>            DFFontSize iFontSize
85838>>>
85838>>>            DFWritePos Munkalap.AutoMarka             0.08 iStyle -1 4.26
85839>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
85840>>>            Send Add_SubTotal 1 1
85841>>>            DFWritePos Ugyfel.Nev                     6.63 iStyle -1 21.33
85842>>>            DFWriteLn
85843>>>
85843>>>        End_Procedure 
85844>>>
85844>>>        Procedure SubTotal1 
85847>>>            string  sFont 
85847>>>            integer iFontSize iStyle iFill iBorder
85847>>>            number  nAmount
85847>>>
85847>>>            Move "arial" to sFont
85848>>>            Move 10 to iFontSize
85849>>>            Move (font_bold) to iStyle
85850>>>            Move (rgb_dGrey) to iBorder
85851>>>            Get DFGetDFColor 242 242 242 to iFill
85852>>>
85852>>>            DFFont sFont
85853>>>            DFFontSize iFontSize
85854>>>            DFBeginHeader DFSubTotal 1
85855>>>                DFHeaderPos   Hdr_Left
85856>>>                DFHeaderWrap  Hdr_NoWrap
85857>>>                DFHeaderFrame HDR_NoFrame
85858>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85859>>>
85859>>>                Get SubTotal ( 1 + 0) to nAmount
85860>>>                Send Add_SubTotal ( 1 + 3) 1
85861>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85862>>>                DFWriteLn
85863>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
85864>>>                DFWriteLn
85865>>>            DFEndHeader
85867>>>
85867>>>        End_Procedure 
85868>>>
85868>>>        Procedure Total 
85871>>>            string  sFont 
85871>>>            integer iFontSize iStyle iFill iBorder
85871>>>            number  nAmount
85871>>>
85871>>>            Move "arial" to sFont
85872>>>            Move 10 to iFontSize
85873>>>            Move (font_bold) to iStyle
85874>>>            Move (rgb_Grey) to iFill
85875>>>            Move (rgb_dGrey) to iBorder
85876>>>
85876>>>            DFFont sFont
85877>>>            DFFontSize iFontSize
85878>>>            DFBeginHeader DFTotal
85879>>>                DFHeaderPos   Hdr_Left
85880>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85881>>>
85881>>>                Get SubTotal ( 1 + 3) to nAmount
85882>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85883>>>                DFWriteLn
85884>>>            DFEndHeader
85886>>>
85886>>>        End_Procedure 
85887>>>
85887>>>        // Report_Footer is printed once on the last page before Page_Footer
85887>>>        //Procedure Report_Footer
85887>>>        //    string  sFont
85887>>>        //    integer iFontSize
85887>>>        //    Move "arial" to sFont
85887>>>        //    Move 10 to iFontSize
85887>>>        //    DFFont sFont
85887>>>        //    DFFontSize iFontSize
85887>>>        //    DFBeginHeader DFReportFooter
85887>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85887>>>        //        DFHeaderPos    Hdr_Left
85887>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85887>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
85887>>>        //    DFEndHeader
85887>>>        //End_Procedure
85887>>>
85887>>>        Procedure Page_Footer 
85890>>>            string sStart sStop sText
85890>>>            string  sFont 
85890>>>            integer iFontSize iStyle
85890>>>
85890>>>            Move "arial" to sFont
85891>>>            Move 10 to iFontSize
85892>>>            Move (font_default) to iStyle
85893>>>
85893>>>            DFFont sFont
85894>>>            DFFontSize iFontSize
85895>>>            DFBeginHeader DFPageFooter
85896>>>                DFHeaderFrame hdr_NoFrame
85897>>>                DFHeaderPos   hdr_Left
85898>>>
85898>>>                Get pdStartRogzites of oMunkalap_DD to sStart
85899>>>                Get pdStopRogzites  of oMunkalap_DD to sStop
85900>>>                Get SelectionCriteraDescription "Munkalap.Rogzites" sStart sStop to sText
85901>>>                If (sText<>"") begin
85903>>>                    DFWriteLnPos sText 0.1
85904>>>                end
85904>>>>
85904>>>
85904>>>            DFEndHeader
85906>>>        End_Procedure 
85907>>>
85907>>>        // Page_Bottom is printed last at the bottom margin of each page
85907>>>        Procedure Page_Bottom 
85910>>>            string sFont
85910>>>            integer iFontSize iBorder iStyle
85910>>>            DateTime dtDT
85910>>>
85910>>>            Move (CurrentDateTime()) to dtDT
85911>>>
85911>>>            Move "arial" to sFont
85912>>>            Move 10 to iFontSize
85913>>>            Move (font_default) to iStyle
85914>>>            Move (rgb_dGrey) to iBorder
85915>>>
85915>>>            DFFont sFont
85916>>>            DFFontSize iFontSize
85917>>>            DFBeginHeader DFPageBottom
85918>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
85919>>>                DFHeaderPos Hdr_Left
85920>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
85921>>>            DFEndHeader
85923>>>
85923>>>        End_Procedure 
85924>>>
85924>>>        // Returns string with description of selection ranges
85924>>>        // Pass: Selection title, start value and end value. Return: description
85924>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
85927>>>            string sText
85927>>>            If (sStart=""  AND sStop="")  function_return ""
85930>>>            If (sStart="0" AND sStop="0") function_return ""
85933>>>            If (sStart<>"" AND sStop<>"") begin
85935>>>                Move ("between" * sStart * "and" * sStop) to sText
85936>>>            end
85936>>>>
85936>>>            Else if (sStart > "") begin
85939>>>                Move ("starting at" * sStart) to sText
85940>>>            end
85940>>>>
85940>>>            Else if (sStop > "") begin
85943>>>                Move ("up to" * sStop) to sText
85944>>>            End
85944>>>>
85944>>>            function_return (sTitle * sText)
85945>>>        End_Function
85946>>>
85946>>>    End_Object 
85947>>>
85947>>>    Procedure StartReport 
85950>>>        Boolean bToPrinter
85950>>>        String sValue
85950>>>        Date dStart dStop
85950>>>
85950>>>        // Set all selection critera properties
85950>>>        Get StartValue of oRogzitesSelection to sValue
85951>>>        Set pdStartRogzites of oMunkalap_DD To sValue
85952>>>
85952>>>        Get StopValue of oRogzitesSelection to sValue
85953>>>        Set pdStopRogzites of oMunkalap_DD To sValue
85954>>>
85954>>>
85954>>>        // determine if direct print
85954>>>        Get IsToPrinter of oPrintTo to bToPrinter
85955>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
85956>>>
85956>>>        // run the report
85956>>>        Send Run_Report of oReport
85957>>>
85957>>>    End_Procedure 
85958>>>
85958>>>End_Object 
85959>
85959>        Procedure Activate_About
85962>            Send DoAbout "" "" "" "" ""
85963>        End_Procedure
85964>
85964>    End_Object
85965>
85965>End_Object
85966>
85966>Start_UI
85967>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 47911
Total Resources: 0
Total Commands : 85966
Total Windows  : 1
Total Pages    : 1
Static Data    : 542557
Message area   : 601796
Total Blocks   : 30770
