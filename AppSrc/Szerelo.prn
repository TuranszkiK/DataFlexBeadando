Compiling Program: C:\Repos\DataFlexBeadando\AppSrc\Szerelo.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.0\Pkg\dfallent.pkd)
79228>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardCommandBarSystem.pkg)
79228>>>// these are all the packages used in a standard MDI menubar/toolbar system
79228>>>
79228>>>Use cCJCommandBarSystem.pkg
79228>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardMenuItemClasses.pkg)
79228>>>>>Use Dfpanel.pkg
79228>>>>>Use cCJCommandBarSystem.pkg
79228>>>>>Use LanguageText.pkg
79228>>>>>
79228>>>>>
79228>>>>>Class cCJUndoMenuItem is a cCJMenuItem
79229>>>>>    
79229>>>>>    Procedure Construct_Object
79231>>>>>        Forward Send Construct_Object
79233>>>>>        Set psCaption   to C_$CaptionUndo
79234>>>>>        Set psToolTip to C_$ToolTipUndo
79235>>>>>        Set psDescription to C_$DescUndo
79236>>>>>        Set psImage to "ActionUndo.ico"
79237>>>>>        Set pbActiveUpdate to True
79238>>>>>        Set psCategory to C_$CategoryEdit
79239>>>>>        Set psShortcut to C_$Key_Ctrl_Z
79240>>>>>    End_Procedure
79241>>>>>
79241>>>>>    Procedure OnExecute Variant vCommandBarControl
79243>>>>>        Send Undo of (focus(Self))
79244>>>>>    End_Procedure
79245>>>>>    
79245>>>>>    Function IsEnabled Returns Boolean
79247>>>>>        Boolean bEnabled
79247>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
79248>>>>>        Function_Return bEnabled
79249>>>>>    End_Function
79250>>>>>         
79250>>>>>End_Class
79251>>>>>
79251>>>>>
79251>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
79252>>>>>    
79252>>>>>    Procedure Construct_Object
79254>>>>>        Forward Send Construct_Object
79256>>>>>        Set psCaption   to C_$CaptionDelete
79257>>>>>        Set psToolTip to C_$ToolTipDelete
79258>>>>>        Set psDescription to C_$DescDelete
79259>>>>>        Set psImage to "actionDelete.ico"
79260>>>>>        Set psShortcut to C_$Key_Delete
79261>>>>>        Set pbActiveUpdate to True
79262>>>>>        Set psCategory to C_$CategoryEdit
79263>>>>>    End_Procedure
79264>>>>>
79264>>>>>
79264>>>>>    Procedure OnExecute Variant vCommandBarControl
79266>>>>>        Send Delete of (focus(Self))
79267>>>>>    End_Procedure
79268>>>>>    
79268>>>>>    Function IsEnabled Returns Boolean
79270>>>>>        Boolean bEnabled
79270>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
79271>>>>>        Function_Return bEnabled
79272>>>>>    End_Function
79273>>>>>         
79273>>>>>End_Class
79274>>>>>
79274>>>>>
79274>>>>>Class cCJCutMenuItem is a cCJMenuItem
79275>>>>>    
79275>>>>>    Procedure Construct_Object
79277>>>>>        Forward Send Construct_Object
79279>>>>>        Set psCaption   to C_$CaptionCut
79280>>>>>        Set psToolTip to C_$TooltipCut
79281>>>>>        Set psDescription to C_$DescCut
79282>>>>>        Set psImage to "actionCut.ico"
79283>>>>>        Set psShortcut to C_$Key_Ctrl_X
79284>>>>>        Set pbActiveUpdate to True
79285>>>>>        Set psCategory to C_$CategoryEdit
79286>>>>>    End_Procedure
79287>>>>>
79287>>>>>
79287>>>>>    Procedure OnExecute Variant vCommandBarControl
79289>>>>>        Send Cut of (focus(Self))
79290>>>>>    End_Procedure
79291>>>>>    
79291>>>>>    Function IsEnabled Returns Boolean
79293>>>>>        Boolean bEnabled
79293>>>>>        Get CanCut of (Focus(Self)) to bEnabled
79294>>>>>        Function_Return bEnabled
79295>>>>>    End_Function
79296>>>>>         
79296>>>>>End_Class
79297>>>>>
79297>>>>>
79297>>>>>Class cCJCopyMenuItem is a cCJMenuItem
79298>>>>>    
79298>>>>>    Procedure Construct_Object
79300>>>>>        Forward Send Construct_Object
79302>>>>>        Set psCaption   to C_$CaptionCopy
79303>>>>>        Set psToolTip to C_$ToolTipCopy
79304>>>>>        Set psDescription to C_$DescCopy
79305>>>>>        Set psImage to "actionCopy.ico"
79306>>>>>        Set psShortcut to C_$Key_Ctrl_C
79307>>>>>        Set pbActiveUpdate to True
79308>>>>>        Set psCategory to C_$CategoryEdit
79309>>>>>    End_Procedure
79310>>>>>
79310>>>>>
79310>>>>>    Procedure OnExecute Variant vCommandBarControl
79312>>>>>        Send Copy of (focus(Self))
79313>>>>>    End_Procedure
79314>>>>>    
79314>>>>>    Function IsEnabled Returns Boolean
79316>>>>>        Boolean bEnabled
79316>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
79317>>>>>        Function_Return bEnabled
79318>>>>>    End_Function
79319>>>>>         
79319>>>>>End_Class
79320>>>>>
79320>>>>>
79320>>>>>Class cCJPasteMenuItem is a cCJMenuItem
79321>>>>>    
79321>>>>>    Procedure Construct_Object
79323>>>>>        Forward Send Construct_Object
79325>>>>>        Set psCaption   to C_$CaptionPaste
79326>>>>>        Set psToolTip to C_$ToolTipPaste
79327>>>>>        Set psDescription to C_$DescPaste
79328>>>>>        Set psImage to "actionPaste.ico"
79329>>>>>        Set pbActiveUpdate to True
79330>>>>>        Set psShortcut to C_$Key_Ctrl_V
79331>>>>>        Set psCategory to C_$CategoryEdit
79332>>>>>    End_Procedure
79333>>>>>
79333>>>>>
79333>>>>>    Procedure OnExecute Variant vCommandBarControl
79335>>>>>        Send Paste of (focus(Self))
79336>>>>>    End_Procedure
79337>>>>>    
79337>>>>>    Function IsEnabled Returns Boolean
79339>>>>>        Boolean bEnabled
79339>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
79340>>>>>        Function_Return bEnabled
79341>>>>>    End_Function
79342>>>>>         
79342>>>>>End_Class
79343>>>>>
79343>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
79344>>>>>    
79344>>>>>    Procedure Construct_Object
79346>>>>>        Forward Send Construct_Object
79348>>>>>        Set psCaption   to C_$CaptionSelectAll
79349>>>>>        Set psToolTip to C_$ToolTipSelectAll
79350>>>>>        Set psDescription to C_$DescSelectAll
79351>>>>>        Set pbActiveUpdate to True
79352>>>>>        Set psShortcut to C_$Key_Ctrl_A
79353>>>>>        Set psCategory to C_$CategoryEdit
79354>>>>>    End_Procedure
79355>>>>>
79355>>>>>
79355>>>>>    Procedure OnExecute Variant vCommandBarControl
79357>>>>>        Send Select_All of (focus(Self))
79358>>>>>    End_Procedure
79359>>>>>    
79359>>>>>    Function IsEnabled Returns Boolean
79361>>>>>        Boolean bEnabled
79361>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
79362>>>>>        Function_Return bEnabled
79363>>>>>    End_Function
79364>>>>>         
79364>>>>>End_Class
79365>>>>>
79365>>>>> 
79365>>>>>Class cCJExitMenuItem is a cCJMenuItem
79366>>>>>
79366>>>>>    Procedure Construct_Object
79368>>>>>        Forward Send Construct_Object
79370>>>>>        Set psCaption to C_$CaptionExit
79371>>>>>        Set psToolTip to C_$ToolTipExit
79372>>>>>        Set psDescription to C_$ToolTipExit
79373>>>>>        Set psShortcut to C_$Key_Alt_F4
79374>>>>>        Set psCategory to C_$CategoryFile
79375>>>>>    End_Procedure
79376>>>>>
79376>>>>>    Procedure OnExecute Variant vCommandBarControl
79378>>>>>        Send Exit_Application of Desktop
79379>>>>>    End_Procedure
79380>>>>>
79380>>>>>End_Class           
79381>>>>>
79381>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
79382>>>>>
79382>>>>>    Procedure Construct_Object
79384>>>>>        Forward Send Construct_Object
79386>>>>>        Set psCaption to C_$CaptionHelp
79387>>>>>        Set psDescription to C_$ToolTipHelp
79388>>>>>        Set psToolTip to C_$DescHelp
79389>>>>>        Set psImage to "ActionHelp.ico"
79390>>>>>        Set psShortcut to "F1"
79391>>>>>        Set psCategory to C_$CategoryHelp
79392>>>>>    End_Procedure
79393>>>>>    
79393>>>>>    Procedure OnExecute Variant vCommandBarControl
79395>>>>>        Send Help of (Focus(Self))
79396>>>>>    End_Procedure
79397>>>>>
79397>>>>>End_Class
79398>>>>>
79398>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
79399>>>>>
79399>>>>>    Procedure Construct_Object
79401>>>>>        Forward Send Construct_Object
79403>>>>>        Set psCaption to C_$CaptionAddStatusbar
79404>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
79405>>>>>        Set psDescription to  C_$DescAddStatusbar
79406>>>>>        Set psCategory to C_$CategoryWindow
79407>>>>>    End_Procedure
79408>>>>>
79408>>>>>    Procedure OnExecute Variant vCommandBarControl
79410>>>>>        Handle hoCommandBars hoClientArea
79410>>>>>        Get CommandBarSystemObject to hoCommandBars
79411>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79412>>>>>        If hoClientArea Begin
79414>>>>>            // the clientarea's parent panel has message
79414>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
79415>>>>>        End
79415>>>>>>
79415>>>>>    End_Procedure
79416>>>>>
79416>>>>>     Function IsChecked Returns Boolean
79418>>>>>        Boolean bOn
79418>>>>>        Handle hoCommandBars hoClientArea
79418>>>>>        Get CommandBarSystemObject to hoCommandBars
79419>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79420>>>>>        If hoClientArea Begin
79422>>>>>            // the clientarea's parent panel has message
79422>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
79423>>>>>        End
79423>>>>>>
79423>>>>>        Function_Return bOn
79424>>>>>     End_Function
79425>>>>>End_Class
79426>>>>>
79426>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
79427>>>>>
79427>>>>>    Procedure Construct_Object
79429>>>>>        Forward Send Construct_Object
79431>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
79432>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
79433>>>>>        Set psDescription to C_$DescAutoArrangeIcons
79434>>>>>        Set psCategory to C_$CategoryWindow
79435>>>>>    End_Procedure
79436>>>>>
79436>>>>>    Procedure OnExecute Variant vCommandBarControl
79438>>>>>        Handle hoCommandBars hoClientArea
79438>>>>>        Get CommandBarSystemObject to hoCommandBars
79439>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79440>>>>>        If hoClientArea Begin
79442>>>>>            // the clientarea's parent panel has message
79442>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
79443>>>>>        End
79443>>>>>>
79443>>>>>    End_Procedure
79444>>>>>    
79444>>>>>     Function IsChecked Returns Boolean
79446>>>>>        Boolean bOn
79446>>>>>        Handle hoCommandBars hoClientArea
79446>>>>>        Get CommandBarSystemObject to hoCommandBars
79447>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79448>>>>>        If hoClientArea Begin
79450>>>>>            // the clientarea's parent panel has message
79450>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
79451>>>>>        End
79451>>>>>>
79451>>>>>        Function_Return bOn
79452>>>>>     End_Function
79453>>>>>End_Class
79454>>>>>
79454>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
79455>>>>>
79455>>>>>    Procedure Construct_Object
79457>>>>>        Forward Send Construct_Object
79459>>>>>        Set psCaption to C_$CaptionRestoreMenus
79460>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
79461>>>>>        Set psDescription to C_$DescRestoreMenus
79462>>>>>        Set psCategory to C_$CategoryWindow
79463>>>>>    End_Procedure
79464>>>>>
79464>>>>>    Procedure OnExecute Variant vCommandBarControl
79466>>>>>        Handle hoCommandBars
79466>>>>>        Get CommandBarSystemObject to hoCommandBars
79467>>>>>        Send RestoreLayout of hoCommandBars
79468>>>>>    End_Procedure
79469>>>>>    
79469>>>>>End_Class
79470>>>>>
79470>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
79471>>>>>
79471>>>>>    Procedure Construct_Object
79473>>>>>        Forward Send Construct_Object
79475>>>>>        Set psCaption to C_$CaptionCascade
79476>>>>>        Set psToolTip to C_$ToolTipCascade
79477>>>>>        Set psDescription to  C_$DescCascade
79478>>>>>        Set psImage to "ActionCascade.ico"
79479>>>>>        Set psCategory to C_$CategoryWindow
79480>>>>>    End_Procedure
79481>>>>>    
79481>>>>>    Procedure OnExecute Variant vCommandBarControl
79483>>>>>        Handle hoCommandBars hoClientArea
79483>>>>>        Get CommandBarSystemObject to hoCommandBars
79484>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79485>>>>>        If hoClientArea Begin
79487>>>>>            Send Cascade_Windows of hoClientArea
79488>>>>>        End
79488>>>>>>
79488>>>>>    End_Procedure
79489>>>>>End_Class
79490>>>>>
79490>>>>>Class cCJTileHorizontally is a cCJMenuItem
79491>>>>>
79491>>>>>    Procedure Construct_Object
79493>>>>>        Forward Send Construct_Object
79495>>>>>        Set psCaption to C_$CaptionTileHorizontally 
79496>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
79497>>>>>        Set psDescription to  C_$DescTileHorizontally
79498>>>>>        Set psImage to "ActionTileHorizontally.ico"
79499>>>>>        Set psCategory to C_$CategoryWindow
79500>>>>>    End_Procedure
79501>>>>>
79501>>>>>    Procedure OnExecute Variant vCommandBarControl
79503>>>>>        Handle hoCommandBars hoClientArea
79503>>>>>        Get CommandBarSystemObject to hoCommandBars
79504>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79505>>>>>        If hoClientArea Begin
79507>>>>>            Send Tile_Windows_Horizontal of hoClientArea
79508>>>>>        End
79508>>>>>>
79508>>>>>    End_Procedure
79509>>>>>End_Class
79510>>>>>
79510>>>>>Class cCJTileVertically is a cCJMenuItem
79511>>>>>
79511>>>>>    Procedure Construct_Object
79513>>>>>        Forward Send Construct_Object
79515>>>>>        Set psCaption to C_$CaptionTileVertically  
79516>>>>>        Set psToolTip to C_$ToolTipTileVertically
79517>>>>>        Set psDescription to  C_$DescTileVertically
79518>>>>>        Set psImage to "ActionTileVertically.ico"
79519>>>>>        Set psCategory to C_$CategoryWindow
79520>>>>>    End_Procedure
79521>>>>>
79521>>>>>    Procedure OnExecute Variant vCommandBarControl
79523>>>>>        Handle hoCommandBars hoClientArea
79523>>>>>        Get CommandBarSystemObject to hoCommandBars
79524>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79525>>>>>        If hoClientArea Begin
79527>>>>>            Send Tile_Windows_Vertical of hoClientArea
79528>>>>>        End
79528>>>>>>
79528>>>>>    End_Procedure
79529>>>>>End_Class
79530>>>>>
79530>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
79531>>>>>
79531>>>>>    Procedure Construct_Object
79533>>>>>        Forward Send Construct_Object
79535>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
79536>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
79537>>>>>        Set psDescription to  C_$DescMinimizeWindows
79538>>>>>        Set psCategory to C_$CategoryWindow
79539>>>>>    End_Procedure
79540>>>>>
79540>>>>>    Procedure OnExecute Variant vCommandBarControl
79542>>>>>        Handle hoCommandBars hoClientArea
79542>>>>>        Get CommandBarSystemObject to hoCommandBars
79543>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79544>>>>>        If hoClientArea Begin
79546>>>>>            // the clientarea's parent panel has message
79546>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
79547>>>>>        End
79547>>>>>>
79547>>>>>    End_Procedure
79548>>>>>End_Class
79549>>>>>
79549>>>>>
79549>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
79550>>>>>
79550>>>>>    Procedure Construct_Object
79552>>>>>        Forward Send Construct_Object
79554>>>>>        Set psCaption to C_$CaptionRestoreWindows
79555>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
79556>>>>>        Set psDescription to  C_$DescRestoreWindows
79557>>>>>        Set psCategory to C_$CategoryWindow
79558>>>>>    End_Procedure
79559>>>>>
79559>>>>>    Procedure OnExecute Variant vCommandBarControl
79561>>>>>        Handle hoCommandBars hoClientArea
79561>>>>>        Get CommandBarSystemObject to hoCommandBars
79562>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79563>>>>>        If hoClientArea Begin
79565>>>>>            // the clientarea's parent panel has message
79565>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
79566>>>>>        End
79566>>>>>>
79566>>>>>    End_Procedure
79567>>>>>End_Class
79568>>>>>
79568>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
79569>>>>>
79569>>>>>    Procedure Construct_Object
79571>>>>>        Forward Send Construct_Object
79573>>>>>        Set psCaption to C_$CaptionArrangeIcons  
79574>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
79575>>>>>        Set psDescription to  C_$DescArrangeIcons
79576>>>>>        Set psCategory to C_$CategoryWindow
79577>>>>>    End_Procedure
79578>>>>>
79578>>>>>    Procedure OnExecute Variant vCommandBarControl
79580>>>>>        Handle hoCommandBars hoClientArea
79580>>>>>        Get CommandBarSystemObject to hoCommandBars
79581>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79582>>>>>        If hoClientArea Begin
79584>>>>>            Send Arrange_Icons of hoClientArea
79585>>>>>        End
79585>>>>>>
79585>>>>>    End_Procedure
79586>>>>>
79586>>>>>End_Class
79587>>>>>    
79587>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJAboutMenuItem.pkg)
79587>>>>>Use cCJCommandBarSystem.pkg
79587>>>>>Use LanguageText.pkg
79587>>>>>
79587>>>>>// It is expected that if you use this class that you provide an about object that is
79587>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
79587>>>>>// because you may wish to create your own custom about package.
79587>>>>>
79587>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
79588>>>>>
79588>>>>>    Procedure Construct_Object
79590>>>>>        Forward Send Construct_Object
79592>>>>>        Set psCaption to C_$CaptionAbout
79593>>>>>        Set psDescription to C_$ToolTipAbout
79594>>>>>        Set psToolTip to C_$DescAbout
79595>>>>>        Set psImage to "ActionAbout.ico"
79596>>>>>        Set psCategory to C_$CategoryHelp
79597>>>>>    End_Procedure
79598>>>>>    
79598>>>>>    Procedure OnExecute Variant vCommandBarControl
79600>>>>>        Handle hoCommandBars hoClientArea
79600>>>>>        Get CommandBarSystemObject to hoCommandBars
79601>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
79602>>>>>        If hoClientArea Begin
79604>>>>>            Send Activate_About of hoClientArea
79605>>>>>        End
79605>>>>>>
79605>>>>>    End_Procedure
79606>>>>>
79606>>>>>End_Class
79607>>>>>
79607>>>>>
79607>>>Use cCJDeoMenuItemClasses.pkg
79607>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJMDIWindowsMenuItem.pkg)
79607>>>>>Use cCJCommandBarSystem.pkg
79607>>>>>
79607>>>>>Register_Function Client_ID Returns Integer
79607>>>>>
79607>>>>>// only used by cCJMDIWIndowsMenuItem
79607>>>>>Class cCJMDIWindowItem is a cCJMenuItem
79608>>>>>
79608>>>>>    Procedure Construct_Object
79610>>>>>        Forward Send Construct_Object
79612>>>>>        Property Handle phWindow 0 // object id of view
79613>>>>>        Set pbControlFlagNoMovable to True
79614>>>>>        Set pbActiveUpdate to True
79615>>>>>    End_Procedure
79616>>>>>    
79616>>>>>    Procedure OnExecute Variant vCommandBarControl
79618>>>>>        Handle hWindow
79618>>>>>        Get phWindow to hWindow
79619>>>>>        Send Activate_View of hWindow
79620>>>>>    End_Procedure
79621>>>>>    
79621>>>>>End_Class                
79622>>>>>
79622>>>>>
79622>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
79623>>>>>    
79623>>>>>    Procedure Construct_Object
79625>>>>>        Forward Send Construct_Object
79627>>>>>        Property Handle[] phArrayOfWindows
79628>>>>>        Set peControlType to xtpControlPopup
79629>>>>>        Set psCategory to C_$CategoryWindow
79630>>>>>    End_Procedure
79631>>>>>    
79631>>>>>     // This adds MDI windows to the existing menu items.
79631>>>>>     // This removes any existing windows menus and always adds a new set to the end
79631>>>>>
79631>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
79633>>>>>        Handle  hClientArea hView
79633>>>>>        String  sLabel
79633>>>>>        Integer i iWindows
79633>>>>>        Handle[] hArrayOfWindows
79634>>>>>        Variant vItem
79634>>>>>        
79634>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
79634>>>>>        // also assume that destroying an action removes all menu instances of that action
79634>>>>>        Get phArrayOfWindows to hArrayOfWindows
79635>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
79636>>>>>        For i from 0 to (iWindows-1)
79642>>>>>>
79642>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
79643>>>>>        Loop
79644>>>>>>
79644>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
79645>>>>>
79645>>>>>        // Add all views to this menu. Create the action and add the item
79645>>>>>        Move 0 to i
79646>>>>>        Get Client_Id to hClientArea // object id of client area
79647>>>>>        If (hClientArea > 0) Begin
79649>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
79650>>>>>            While (hView <> 0)
79654>>>>>                If (Active_State(hView)) Begin
79656>>>>>                    // create the action
79656>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
79657>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
79658>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
79659>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
79660>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
79662>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
79663>>>>>                    End
79663>>>>>>
79663>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
79664>>>>>                    If (i=0) Begin
79666>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
79667>>>>>                    End
79667>>>>>>
79667>>>>>                    // Create a menu item for this action
79667>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
79668>>>>>                    Increment i
79669>>>>>                End
79669>>>>>>
79669>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
79670>>>>>            Loop
79671>>>>>>
79671>>>>>        End
79671>>>>>>
79671>>>>>
79671>>>>>        Set phArrayOfWindows to hArrayOfWindows
79672>>>>>
79672>>>>>     End_Procedure
79673>>>>>     
79673>>>>>End_Class
79674>>>>>
79674>
79674>Object oHtmlHelp is a cHtmlHelp
79676>End_Object
79677>
79677>Object oApplication is a cApplication
79679>    Set peHelpType to htHtmlHelp
79680>
79680>    Object oConnection is a cConnection
79682>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\LoginEncryption.pkg)
79682>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cLoginEncryption.pkg)
79682>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCryptographer.pkg)
79682>>>>>>>Use VdfBase.pkg
79682>>>>>>>
79682>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\CryptographerConstants.pkg)
79682>>>>>>>>>//                                      
79682>>>>>>>>>// File    : CryptographerConstants.pkg
79682>>>>>>>>>//
79682>>>>>>>>>//   Author  : Ulbe Stellema
79682>>>>>>>>>//             Data Access Worldwide
79682>>>>>>>>>//
79682>>>>>>>>>//   Date    : October 4, 2009
79682>>>>>>>>>//
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>// Algorithm classes
79682>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
79682>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
79682>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
79682>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
79682>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
79682>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
79682>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
79682>>>>>>>>>
79682>>>>>>>>>// Algorithm types
79682>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
79682>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
79682>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
79682>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
79682>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
79682>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
79682>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
79682>>>>>>>>>
79682>>>>>>>>>// Generic sub-ids
79682>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
79682>>>>>>>>>
79682>>>>>>>>>// RSA sub-ids
79682>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
79682>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
79682>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
79682>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
79682>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
79682>>>>>>>>>
79682>>>>>>>>>// DSS sub-ids
79682>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
79682>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
79682>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
79682>>>>>>>>>
79682>>>>>>>>>// DES sub_ids
79682>>>>>>>>>Define ALG_SID_DES                      for 1
79682>>>>>>>>>Define ALG_SID_3DES                     for 3
79682>>>>>>>>>Define ALG_SID_DESX                     for 4
79682>>>>>>>>>Define ALG_SID_IDEA                     for 5
79682>>>>>>>>>Define ALG_SID_CAST                     for 6
79682>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
79682>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
79682>>>>>>>>>Define ALG_SID_3DES_112                 for 9
79682>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
79682>>>>>>>>>Define ALG_SID_RC5                      for 13
79682>>>>>>>>>Define ALG_SID_AES_128                  for 14
79682>>>>>>>>>Define ALG_SID_AES_192                  for 15
79682>>>>>>>>>Define ALG_SID_AES_256                  for 16
79682>>>>>>>>>Define ALG_SID_AES                      for 17
79682>>>>>>>>>
79682>>>>>>>>>// Fortezza sub-ids
79682>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
79682>>>>>>>>>Define ALG_SID_TEK                      for 11
79682>>>>>>>>>
79682>>>>>>>>>// RC2 sub-ids
79682>>>>>>>>>Define ALG_SID_RC2                      for 2
79682>>>>>>>>>
79682>>>>>>>>>// Stream cipher sub-ids
79682>>>>>>>>>Define ALG_SID_RC4                      for 1
79682>>>>>>>>>Define ALG_SID_SEAL                     for 2
79682>>>>>>>>>
79682>>>>>>>>>// Diffie-Hellman sub-ids
79682>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
79682>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
79682>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
79682>>>>>>>>>Define ALG_SID_KEA                      for 4
79682>>>>>>>>>
79682>>>>>>>>>// Hash sub ids
79682>>>>>>>>>Define ALG_SID_MD2                      for 1
79682>>>>>>>>>Define ALG_SID_MD4                      for 2
79682>>>>>>>>>Define ALG_SID_MD5                      for 3
79682>>>>>>>>>Define ALG_SID_SHA                      for 4
79682>>>>>>>>>Define ALG_SID_SHA1                     for 4
79682>>>>>>>>>Define ALG_SID_MAC                      for 5
79682>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
79682>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
79682>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
79682>>>>>>>>>Define ALG_SID_HMAC                     for 9
79682>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
79682>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
79682>>>>>>>>>Define ALG_SID_SHA_256                  for 12
79682>>>>>>>>>Define ALG_SID_SHA_384                  for 13
79682>>>>>>>>>Define ALG_SID_SHA_512                  for 14
79682>>>>>>>>>
79682>>>>>>>>>// secure channel sub ids
79682>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
79682>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
79682>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
79682>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
79682>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
79682>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
79682>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
79682>>>>>>>>>
79682>>>>>>>>>// algorithm identifier definitions
79682>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
79682>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
79682>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
79682>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
79682>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
79682>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
79682>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
79682>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
79682>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
79682>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
79682>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
79682>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
79682>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
79682>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
79682>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
79682>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
79682>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
79682>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
79682>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
79682>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
79682>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
79682>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
79682>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
79682>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
79682>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
79682>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
79682>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
79682>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
79682>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
79682>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
79682>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
79682>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
79682>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
79682>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
79682>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
79682>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
79682>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
79682>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
79682>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
79682>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
79682>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
79682>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
79682>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
79682>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
79682>>>>>>>>>
79682>>>>>>>>>// Providers
79682>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
79682>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
79682>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
79682>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
79682>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
79682>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
79682>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
79682>>>>>>>>>
79682>>>>>>>>>// dwFlags definitions for CryptAcquireContext
79682>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
79682>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
79682>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
79682>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
79682>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
79682>>>>>>>>>
79682>>>>>>>>>// dwFlag definitions for CryptGenKey
79682>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
79682>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
79682>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
79682>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
79682>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
79682>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
79682>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
79682>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
79682>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
79682>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
79682>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
79682>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
79682>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
79682>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
79682>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
79682>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
79682>>>>>>>>>
79682>>>>>>>>>// Provider types
79682>>>>>>>>>Define PROV_RSA_FULL                    for 1
79682>>>>>>>>>Define PROV_RSA_SIG                     for 2
79682>>>>>>>>>Define PROV_DSS                         for 3
79682>>>>>>>>>Define PROV_FORTEZZA                    for 4
79682>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
79682>>>>>>>>>Define PROV_SSL                         for 6
79682>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
79682>>>>>>>>>Define PROV_DSS_DH                      for 13
79682>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
79682>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
79682>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
79682>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
79682>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
79682>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
79682>>>>>>>>>Define PROV_RNG                         for 21
79682>>>>>>>>>Define PROV_INTEL_SEC                   for 22
79682>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
79682>>>>>>>>>Define PROV_RSA_AES                     for 24
79682>>>>>>>>>
79682>>>>>>>>>// KP_MODE
79682>>>>>>>>>// KP_MODE
79682>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
79682>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
79682>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
79682>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
79682>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
79682>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
79682>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
79682>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
79682>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
79682>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
79682>>>>>>>>>
79682>>>>>>>>>// dwParam definitions for CryptGetKeyParam
79682>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
79682>>>>>>>>>Define KP_SALT                          for 2       // Salt value
79682>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
79682>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
79682>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
79682>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
79682>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
79682>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
79682>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
79682>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
79682>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
79682>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
79682>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
79682>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
79682>>>>>>>>>Define KP_Y                             for 15      // Y value
79682>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
79682>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
79682>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
79682>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
79682>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
79682>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
79682>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
79682>>>>>>>>>Define KP_RP                            for 23
79682>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
79682>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
79682>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
79682>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
79682>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
79682>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
79682>>>>>>>>>Define KP_KEYVAL                        for 30
79682>>>>>>>>>Define KP_ADMIN_PIN                     for 31
79682>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
79682>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
79682>>>>>>>>>Define KP_PREHASH                       for 34
79682>>>>>>>>>Define KP_ROUNDS                        for 35
79682>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
79682>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
79682>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
79682>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
79682>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
79682>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
79682>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
79682>>>>>>>>>
79682>>>>>>>>>// dwParam definitions for CryptGetHashParam
79682>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
79682>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
79682>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
79682>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
79682>>>>>>>>>
79682>>>>>>>>>// key BLOB types
79682>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
79682>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
79682>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
79682>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
79682>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
79682>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
79682>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
79682>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
79682>>>>>>>>>
79682>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
79682>>>>>>>>>
79682>>>>>>>>>//  Structure cryptimportkey
79682>>>>>>>>>Struct PUBLICKEYSTRUC
79682>>>>>>>>>    UChar    bType
79682>>>>>>>>>    UChar    bVersion
79682>>>>>>>>>    UShort   reserved
79682>>>>>>>>>    UInteger aiKeyAlg
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>Struct tPLAINTEXTKEYBLOB
79682>>>>>>>>>    PUBLICKEYSTRUC hdr
79682>>>>>>>>>    PUBLICKEYSTRUC hdr
79682>>>>>>>>>    UInteger       dwKeySize
79682>>>>>>>>>//    UChar[]        rgbKeyData
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
79682>>>>>>>>>Struct HMAC_INFO
79682>>>>>>>>>    UInteger HashAlgid
79682>>>>>>>>>    Pointer pbInnerString
79682>>>>>>>>>    DWord cbInnerString
79682>>>>>>>>>    Pointer pbOuterString
79682>>>>>>>>>    DWord cbOuterString
79682>>>>>>>>>End_Struct
79682>>>>>>>>>
79682>>>>>>>>>
79682>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
79683>>>>>>>>>
79683>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
79684>>>>>>>>>
79684>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
79685>>>>>>>>>
79685>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
79686>>>>>>>>>
79686>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
79687>>>>>>>>>
79687>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
79688>>>>>>>>>
79688>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
79689>>>>>>>>>
79689>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
79690>>>>>>>>>
79690>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
79691>>>>>>>>>
79691>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
79692>>>>>>>>>    
79692>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
79693>>>>>>>>>
79693>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
79694>>>>>>>>>
79694>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
79695>>>>>>>>>
79695>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
79696>>>>>>>>>    
79696>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
79697>>>>>>>>>    
79697>>>>>>>
79697>>>>>>>Class cCryptographer is a cObject
79698>>>>>>>    
79698>>>>>>>    // Procedure : Construct_Object
79698>>>>>>>    // Purpose   : Object constructor
79698>>>>>>>    Procedure Construct_Object
79700>>>>>>>        Forward Send Construct_Object
79702>>>>>>>
79702>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
79703>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
79704>>>>>>>        Property Integer    piCipher    CALG_RC4
79705>>>>>>>        Property Integer    piHash      CALG_MD5
79706>>>>>>>        
79706>>>>>>>        // Private properties
79706>>>>>>>        Property Handle     Private_phProv
79707>>>>>>>    End_Procedure
79708>>>>>>>    
79708>>>>>>>    
79708>>>>>>>    // Function : AcquireContext
79708>>>>>>>    // Purpose  : Acquire key container handle
79708>>>>>>>    Function AcquireContext Returns Handle
79710>>>>>>>        Integer iProvider
79710>>>>>>>        String sProvider
79710>>>>>>>        Handle hProv
79710>>>>>>>        Boolean bOk
79710>>>>>>>        Address addrProv
79710>>>>>>>        
79710>>>>>>>        Move 0 to hProv
79711>>>>>>>        Get piProvider to iProvider
79712>>>>>>>        Get psProvider to sProvider
79713>>>>>>>        
79713>>>>>>>        //  Determine address to be passed as provider
79713>>>>>>>        If (Trim(sProvider) <> "") Begin
79715>>>>>>>            Move (AddressOf(sProvider)) to addrProv
79716>>>>>>>        End
79716>>>>>>>>
79716>>>>>>>        Else Begin
79717>>>>>>>            Move 0 to addrProv
79718>>>>>>>        End
79718>>>>>>>>
79718>>>>>>>        
79718>>>>>>>        //  Acquire Crypto Context
79718>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
79719>>>>>>>        If (not(bOk) or hProv = 0) Begin
79721>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
79722>>>>>>>        End
79722>>>>>>>>
79722>>>>>>>        
79722>>>>>>>        If (not(bOk) or hProv = 0) Begin
79724>>>>>>>            // Fallback to original
79724>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
79725>>>>>>>            
79725>>>>>>>            If (not(bOk) or hProv = 0) Begin
79727>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
79728>>>>>>>            End
79728>>>>>>>>
79728>>>>>>>        End
79728>>>>>>>>
79728>>>>>>>        Set Private_phProv to hProv
79729>>>>>>>        
79729>>>>>>>        Function_Return hProv
79730>>>>>>>    End_Function
79731>>>>>>>    
79731>>>>>>>    // Function : ReleaseContext
79731>>>>>>>    // Purpose  : Releases key container handle
79731>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
79733>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
79734>>>>>>>    End_Function
79735>>>>>>>    
79735>>>>>>>    // Function : CreateHash
79735>>>>>>>    // Purpose  : Creates hash object
79735>>>>>>>    Function CreateHash Handle hProv Returns Handle
79737>>>>>>>        Integer iAlgorithm
79737>>>>>>>        Handle hHash
79737>>>>>>>        Boolean bOk
79737>>>>>>>        
79737>>>>>>>        Move 0 to hHash
79738>>>>>>>        Get piHash to iAlgorithm
79739>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
79740>>>>>>>        
79740>>>>>>>        Function_Return hHash
79741>>>>>>>    End_Function
79742>>>>>>>    
79742>>>>>>>    // Function : DestroyHash
79742>>>>>>>    // Purpose  : Destroys the hash object
79742>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
79744>>>>>>>        Function_Return (CryptDestroyHash(hHash))
79745>>>>>>>    End_Function
79746>>>>>>>    
79746>>>>>>>    // Function : HashData
79746>>>>>>>    // Purpose  : Adds data to hash object
79746>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
79748>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
79749>>>>>>>    End_Function
79750>>>>>>>    
79750>>>>>>>    // Function : DeriveKey
79750>>>>>>>    // Purpose  : Generates session key
79750>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
79752>>>>>>>        Integer iAlgorithm
79752>>>>>>>        Handle hKey
79752>>>>>>>        Boolean bOk
79752>>>>>>>        
79752>>>>>>>        Move 0 to hKey
79753>>>>>>>        Get piCipher to iAlgorithm
79754>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
79755>>>>>>>        
79755>>>>>>>        Function_Return hKey
79756>>>>>>>    End_Function
79757>>>>>>>    
79757>>>>>>>    // Function : ImportPlainTextKey
79757>>>>>>>    // Purpose  : Imports a plain text key
79757>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
79759>>>>>>>        tPLAINTEXTKEYBLOB blobhead
79759>>>>>>>        tPLAINTEXTKEYBLOB blobhead
79759>>>>>>>        Boolean   bSuccess
79759>>>>>>>        Handle    hKey
79759>>>>>>>        Integer   iHeadSize iKeySize
79759>>>>>>>        UChar[]   ucaKeyblob
79760>>>>>>>        Integer iVoid
79760>>>>>>>    
79760>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
79761>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
79762>>>>>>>    
79762>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
79763>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
79764>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
79765>>>>>>>        Move iKeySize           to blobhead.dwKeySize
79766>>>>>>>    
79766>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
79767>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
79768>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
79769>>>>>>>    
79769>>>>>>>        Move 0 to hKey
79770>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
79771>>>>>>>        If (not(bSuccess)) Begin 
79773>>>>>>>            Move (ShowLastError()) to iVoid
79774>>>>>>>        End
79774>>>>>>>>
79774>>>>>>>    
79774>>>>>>>        Function_Return hKey
79775>>>>>>>    End_Function
79776>>>>>>>
79776>>>>>>>    // Function : DestroyKey
79776>>>>>>>    // Purpose  : Destroys the key
79776>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
79778>>>>>>>        Function_Return (CryptDestroyKey(hKey))
79779>>>>>>>    End_Function
79780>>>>>>>    
79780>>>>>>>    // Function : KeyParameter
79780>>>>>>>    // Purpose  : Retrieves key data
79780>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
79782>>>>>>>        Integer iBuffer iLen
79782>>>>>>>        Boolean bOk
79782>>>>>>>        
79782>>>>>>>        Move (SizeOfType(Integer)) to iLen
79783>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
79784>>>>>>>        Function_Return iBuffer
79785>>>>>>>    End_Function
79786>>>>>>>    
79786>>>>>>>    // Function : HashValue
79786>>>>>>>    // Purpose  : Retrieves a hash value
79786>>>>>>>    Function HashValue Handle lhHash Returns String
79788>>>>>>>        Pointer lpSize
79788>>>>>>>        Pointer lpHash
79788>>>>>>>        String  lsSize
79788>>>>>>>        String  lsHash
79788>>>>>>>        Integer liResult
79788>>>>>>>
79788>>>>>>>        Move (Repeat(Character(0),4)) to lsSize
79789>>>>>>>        GetAddress of lsSize to lpSize
79790>>>>>>>
79790>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,lpSize,0)) to liResult
79791>>>>>>>        If (liResult = 0) Function_Return ""
79794>>>>>>>
79794>>>>>>>        Move (Repeat(Character(0),BytesTodWord(lsSize,1))) to lsHash
79795>>>>>>>        GetAddress of lsHash to lpHash
79796>>>>>>>
79796>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,lpHash,lpSize,0)) to liResult
79797>>>>>>>        If (liResult = 0) Function_Return ""
79800>>>>>>>
79800>>>>>>>        Function_Return lsHash
79801>>>>>>>    End_Function  // HashValue
79802>>>>>>>    
79802>>>>>>>            
79802>>>>>>>    // Function : Encrypt
79802>>>>>>>    // Purpose  : Encrypts data
79802>>>>>>>    Function Encrypt String sPassword String sData Returns String
79804>>>>>>>        Handle hProv hHash hKey
79804>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
79804>>>>>>>        Boolean bOk
79804>>>>>>>        
79804>>>>>>>        Get AcquireContext to hProv
79805>>>>>>>        If (hProv) Begin
79807>>>>>>>            Get CreateHash hProv to hHash
79808>>>>>>>            If (hHash) Begin
79810>>>>>>>                Get HashData hHash sPassword to bOk
79811>>>>>>>                If (bOk) Begin
79813>>>>>>>                    Get piCipher to iAlgorithm
79814>>>>>>>                    Get DeriveKey hProv hHash to hKey
79815>>>>>>>                End // If (bOk) Begin            
79815>>>>>>>>
79815>>>>>>>                Get DestroyHash hHash to bOk
79816>>>>>>>            End // If (hHash) Begin
79816>>>>>>>>
79816>>>>>>>            
79816>>>>>>>            If (hKey) Begin
79818>>>>>>>                //  First call to determine resulting data size
79818>>>>>>>                Move (Length(sData)) to iDataLen
79819>>>>>>>                Move (Length(sData)) to iCipherLen
79820>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
79821>>>>>>>                
79821>>>>>>>                //  Reserve space in string
79821>>>>>>>                If (iDataLen < iCipherLen) Begin
79823>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
79824>>>>>>>                End
79824>>>>>>>>
79824>>>>>>>                
79824>>>>>>>                //  Call to really decrypt
79824>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
79825>>>>>>>                //If (not(bOk)) Begin
79825>>>>>>>                    //Move "" to sData
79825>>>>>>>                    //Move (GetLastError()) to iErr
79825>>>>>>>                //End
79825>>>>>>>                
79825>>>>>>>                Get DestroyKey hKey to bOk
79826>>>>>>>            End // If (hKey) Begin
79826>>>>>>>>
79826>>>>>>>            Get ReleaseContext hProv to bOk
79827>>>>>>>        End // If (hProv) Begin
79827>>>>>>>>
79827>>>>>>>        Function_Return sData
79828>>>>>>>    End_Function
79829>>>>>>>    
79829>>>>>>>    // Function : Decrypt
79829>>>>>>>    // Purpose  : Decrypts data
79829>>>>>>>    Function Decrypt String sPassword String sData Returns String
79831>>>>>>>        Handle hProv hHash hKey
79831>>>>>>>        Integer iAlgorithm iDataLen
79831>>>>>>>        Boolean bOk
79831>>>>>>>        
79831>>>>>>>        Get AcquireContext to hProv
79832>>>>>>>        If (hProv) Begin
79834>>>>>>>            Get CreateHash hProv to hHash
79835>>>>>>>            If (hHash) Begin
79837>>>>>>>                Get HashData hHash sPassword to bOk
79838>>>>>>>                If (bOk) Begin
79840>>>>>>>                    Get piCipher to iAlgorithm
79841>>>>>>>                    Get DeriveKey hProv hHash to hKey
79842>>>>>>>                End // If (bOk) Begin            
79842>>>>>>>>
79842>>>>>>>                Get DestroyHash hHash to bOk
79843>>>>>>>            End // If (hHash) Begin
79843>>>>>>>>
79843>>>>>>>            
79843>>>>>>>            If (hKey) Begin
79845>>>>>>>                Move (Length(sData)) to iDataLen
79846>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
79847>>>>>>>                //If (bOk = False) Move "" to sData
79847>>>>>>>                
79847>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
79847>>>>>>>                If (Length(sData) > iDataLen) Begin
79849>>>>>>>                    Move (Left(sData, iDataLen)) to sData
79850>>>>>>>                End
79850>>>>>>>>
79850>>>>>>>                
79850>>>>>>>                Get DestroyKey hKey to bOk
79851>>>>>>>            End // If (hKey) Begin
79851>>>>>>>>
79851>>>>>>>            Get ReleaseContext hProv to bOk
79852>>>>>>>        End // If (hProv) Begin
79852>>>>>>>>
79852>>>>>>>        Function_Return sData
79853>>>>>>>    End_Function
79854>>>>>>>    
79854>>>>>>>    //  Function : GenerateRandom
79854>>>>>>>    //  Purpose  : Generates random data.
79854>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
79856>>>>>>>        Handle hProv
79856>>>>>>>        UChar[] uaResult
79857>>>>>>>        Boolean bRes
79857>>>>>>>        
79857>>>>>>>        Get AcquireContext to hProv
79858>>>>>>>        
79858>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
79859>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
79860>>>>>>>        
79860>>>>>>>        Get ReleaseContext hProv to bRes
79861>>>>>>>        
79861>>>>>>>        Function_Return uaResult
79862>>>>>>>    End_Function
79863>>>>>>>    
79863>>>>>>>    //  Function : GenerateRandomString
79863>>>>>>>    //  Purpose  : Generates random data and does a base64 encoding to properly present it as a string.
79863>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
79865>>>>>>>        String sResult
79865>>>>>>>        UChar[] aData
79866>>>>>>>        Address pBase64
79866>>>>>>>        Integer iVoid
79866>>>>>>>
79866>>>>>>>        Get GenerateRandom iLenght to aData
79867>>>>>>>        
79867>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
79868>>>>>>>        Move pBase64 to sResult
79869>>>>>>>        Move (Free(pBase64)) to iVoid    
79870>>>>>>>        
79870>>>>>>>        Function_Return (Left(sResult, iLenght))
79871>>>>>>>    End_Function
79872>>>>>>>
79872>>>>>>>End_Class
79873>>>>>
79873>>>>>Class cLoginEncryption is a cObject
79874>>>>>    
79874>>>>>    Procedure Construct_Object
79876>>>>>        Forward Send Construct_Object
79878>>>>>        // this must be set to a multi (40ish) character random key
79878>>>>>        Property String psEncryptPassword ""
79879>>>>>    
79879>>>>>        Object oDataCrypter is a cCryptographer
79881>>>>>            Set piHash to CALG_SHA_256
79882>>>>>            Set piCipher to CALG_AES_256
79883>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
79884>>>>>            Set piProvider to PROV_RSA_AES
79885>>>>>        End_Object
79886>>>>>    End_Procedure
79887>>>>>        
79887>>>>>    // This can be augmented to return a password encryption key using any
79887>>>>>    // hidden mechanism desired.    
79887>>>>>    Function GetEncryptionPassword Returns String
79889>>>>>        String sPassword
79889>>>>>        Get psEncryptPassword to sPassword    
79890>>>>>        Function_Return sPassword
79891>>>>>    End_Function
79892>>>>>    
79892>>>>>    // EncryptPassword:
79892>>>>>    
79892>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
79892>>>>>    //
79892>>>>>    // Params:
79892>>>>>    //   sPlainText     String to encrypt.
79892>>>>>    // Returns:
79892>>>>>    //   Base64 encoded hash.
79892>>>>>    Function EncryptPassword String sPlainText Returns String
79894>>>>>        String sEncryptPassword sBinary sBase64
79894>>>>>        Address pBase64
79894>>>>>        Integer iVoid
79894>>>>>        
79894>>>>>        //  Encrypt Key
79894>>>>>        Get GetEncryptionPassword to sEncryptPassword
79895>>>>>        If (sEncryptPassword = "") Begin
79897>>>>>            Error DFERR_PROGRAM "No encryption password set" 
79898>>>>>>
79898>>>>>        End
79898>>>>>>
79898>>>>>        
79898>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
79899>>>>>        
79899>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
79901>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
79902>>>>>>
79902>>>>>            Function_Return ""
79903>>>>>        End
79903>>>>>>
79903>>>>>        
79903>>>>>        //  Encode binary hash to Base64
79903>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
79904>>>>>        Move pBase64 to sBase64
79905>>>>>        Move (Free(pBase64)) to iVoid
79906>>>>>        
79906>>>>>        Function_Return sBase64
79907>>>>>    End_Function
79908>>>>>    
79908>>>>>    
79908>>>>>    // DecryptPassword:
79908>>>>>    
79908>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
79908>>>>>    //
79908>>>>>    // Params:
79908>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
79908>>>>>    // Returns:
79908>>>>>    //   Readable plain text password
79908>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
79910>>>>>        String sEncryptPassword sPlainText sBinary
79910>>>>>        Boolean bIsHex
79910>>>>>        Integer iLen iVoid
79910>>>>>        Address pBinary
79910>>>>>        
79910>>>>>        If (sBase64EncryptedPassword <> "") Begin
79912>>>>>            //  Decode from Base64
79912>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
79913>>>>>            
79913>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
79914>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
79915>>>>>            
79915>>>>>            Move (Free(pBinary)) to iVoid
79916>>>>>    
79916>>>>>            //  Encrypted binary hash to string
79916>>>>>            Get GetEncryptionPassword to sEncryptPassword
79917>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
79918>>>>>        End
79918>>>>>>
79918>>>>>        
79918>>>>>        Function_Return sPlainText
79919>>>>>    End_Function
79920>>>>>End_Class
79921>>>>>    
79921>>>
79921>>>Object oLoginEncryption is a cLoginEncryption
79923>>>
79923>>>    // this must be created in your appsrc directory and must contain an encryption
79923>>>    // key that is set to psEncryptPassword. It will look something like this
79923>>>    //
79923>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
79923>>>    //  
Including file: LoginEncryptionKey.inc    (C:\Repos\DataFlexBeadando\AppSrc\LoginEncryptionKey.inc)
79923>>>>// Studio generated login encryption key
79923>>>>Set psEncryptPassword to "8eH5|`Xs0c>fum6W8E6^}#@XhoWPuDN)Usf_t<]("
79924>>>>
79924>>>    
79924>>>    // use this to register this object to your cConnection Object. This object
79924>>>    // must be created after the cConnection object
79924>>>    Move Self to ghoLoginEncryption
79925>>>End_Object
79926>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DatabaseLoginDialog.dg)
79926>>>
79926>>>Use Windows.pkg
79926>>>Use cConnection.pkg
79926>>>Use dfLine.pkg
79926>>>
79926>>>Object oDatabaseLoginDialog is a ModalPanel
79928>>>    Set Label to "Database Login"
79929>>>    Set Location to 2 2
79930>>>    Set Size to 110 211
79931>>>
79931>>>    Property String psId
79933>>>    Property Boolean pbOk False
79935>>>    Property Boolean pbChanged False
79937>>>    Property Boolean pbAllowRemember True
79939>>>
79939>>>    // this registers this object with the cConnection object.
79939>>>    Move Self to ghoLoginConnectDialog
79940>>>
79940>>>    Object oUserIDForm is a Form
79942>>>        Set Label to "User Name"
79943>>>        Set Size to 13 85
79944>>>        Set Location to 34 79
79945>>>        Set Label_Col_Offset to 64
79946>>>                Set peAnchors to anTopLeftRight
79947>>>    End_Object
79948>>>
79948>>>    Object oPwdForm is a Form
79950>>>        Set Size to 13 85
79951>>>        Set Location to 49 79
79952>>>        Set Label_Col_Offset to 64
79953>>>        Set Password_State to True
79954>>>                Set peAnchors to anTopLeftRight
79955>>>        Set Label to "Password"
79956>>>    End_Object
79957>>>
79957>>>    Object oTrustedConnection is a CheckBox
79959>>>        Set Size to 10 50
79960>>>        Set Location to 65 79
79961>>>        Set Label to "Trusted Connection"
79962>>>    End_Object
79963>>>
79963>>>    Object oRemember is a CheckBox
79965>>>        Set Size to 10 50
79966>>>        Set Location to 79 14
79967>>>        Set Label to "Remember and don't ask again"
79968>>>        Set Checked_State to True
79969>>>    End_Object
79970>>>
79970>>>    Object oLogin_btn is a Button
79972>>>        Set Label to "&Login"
79973>>>        Set Location to 92 102
79974>>>        Set peAnchors to anBottomRight
79975>>>        Set Default_State to True
79976>>>
79976>>>        Procedure OnClick
79979>>>            Boolean bTrust
79979>>>            String sUser sPwd sConn sErr sId
79979>>>            Integer iError
79979>>>            Get psId to sId
79980>>>            Get Value of oUserIDForm to sUser
79981>>>            Get Value of oPwdForm to sPwd
79982>>>            Get Checked_State of oTrustedConnection to bTrust
79983>>>            
79983>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
79984>>>            If (iError=0) Begin
79986>>>                Set pbOk to True
79987>>>                Set pbChanged to True
79988>>>                // using Stop_UI instead of close_panel keeps it running when the dialog
79988>>>                // is the only dialog and it closes
79988>>>                Send Stop_UI
79989>>>//                Send Close_Panel
79989>>>            End
79989>>>>
79989>>>            Else Begin
79990>>>                Get psErrorText of ghoConnection to sErr
79991>>>                Send UserError sErr "Login Error"
79992>>>            End
79992>>>>
79992>>>        End_Procedure
79993>>>    End_Object
79994>>>
79994>>>    Object oCancel_btn is a Button
79996>>>        Set Label to "&Cancel"
79997>>>        Set Location to 92 157
79998>>>        Set peAnchors to anBottomRight
79999>>>
79999>>>        Procedure OnClick
80002>>>            Send Stop_UI
80003>>>//            Send Close_Panel
80003>>>        End_Procedure
80004>>>    End_Object
80005>>>
80005>>>    Object oConnectionIdInfo is a TextBox
80007>>>        Set Size to 10 50
80008>>>        Set Location to 4 14
80009>>>        Set Label to 'Connection Id='
80010>>>    End_Object
80011>>>
80011>>>    Object oConnectionServerInfo is a TextBox
80013>>>        Set Size to 10 50
80014>>>        Set Location to 16 14
80015>>>        Set Label to 'Server'
80016>>>    End_Object
80017>>>
80017>>>    Object oLineControl1 is a LineControl
80019>>>        Set Size to 2 202
80020>>>        Set Location to 29 5
80021>>>    End_Object
80022>>>
80022>>>    Function LoginConnectIdDialog String sId Returns Boolean
80025>>>         Boolean bOk bChanged bTrusted bAllowRemember bRemember
80025>>>         String sUser sPwd sDescription
80025>>>         tConnection Connect
80025>>>         tConnection Connect
80025>>>         
80025>>>         Get pbAllowRemember to bAllowRemember
80026>>>         
80026>>>
80026>>>         If not bAllowRemember Begin
80028>>>            Set Enabled_State of oRemember to bRemember
80029>>>            Set Visible_State of oRemember to bRemember
80030>>>         End
80030>>>>
80030>>>         
80030>>>         Get ConnectionIdInfo of ghoConnection sId to Connect
80031>>>         Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
80032>>>         Set Value of oConnectionServerInfo to Connect.sString
80033>>>
80033>>>         Set psId to sId
80034>>>         Set pbOk to False
80035>>>         Set pbChanged to False
80036>>>         Set Value of oUserIDForm to Connect.sUID
80037>>>         Set Value of oPwdForm to ""
80038>>>         
80038>>>         Send Popup
80039>>>         
80039>>>         Get pbOk to bOk
80040>>>         Get pbChanged to bChanged
80041>>>         If (bChanged and bOk) Begin
80043>>>            If bAllowRemember Begin
80045>>>                Get Checked_State of oRemember to bRemember
80046>>>                If bRemember Begin
80048>>>                    Get Checked_State of oTrustedConnection to bTrusted
80049>>>                    If not (bTrusted) Begin
80051>>>                        Get Value of oUserIDForm to sUser
80052>>>                        Get Value of oPwdForm to sPwd
80053>>>                    End
80053>>>>
80053>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
80054>>>                 End
80054>>>>
80054>>>             End
80054>>>>
80054>>>         End
80054>>>>
80054>>>         Function_Return bOk
80055>>>    End_Function
80056>>>    
80056>>>    
80056>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
80057>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
80058>>>End_Object
80059>>>
80059>    End_Object
80060>
80060>End_Object
80061>
80061>Object oToolTipController is a cToolTipController
80063>    Move Self to ghoToolTipController
80064>End_Object
80065>
80065>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oEditContextMenu.pkg)
80065>>>Use cCJStandardMenuItemClasses.pkg
80065>>>
80065>>>Object oEditContextMenu is a cCJContextMenu
80067>>>    
80067>>>    Move Self to Default_Form_Floating_Menu_ID
80068>>>    
80068>>>    Object oUndoMenuItem is a cCJUndoMenuItem
80070>>>    End_Object
80071>>>    
80071>>>    Object oCutMenuItem is a cCJCutMenuItem
80073>>>        Set pbControlBeginGroup to True
80074>>>    End_Object
80075>>>    
80075>>>    Object oCopyMenuItem is a cCJCopyMenuItem
80077>>>    End_Object
80078>>>
80078>>>    Object oPasteMenuItem is a cCJPasteMenuItem
80080>>>    End_Object
80081>>>
80081>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
80083>>>    End_Object
80084>>>
80084>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
80086>>>        Set pbControlBeginGroup to True
80087>>>    End_Object
80088>>>
80088>>>End_Object
80089>>>
80089>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oDEOEditContextMenu17.pkg)
80089>>>Use Windows.pkg
80089>>>Use cCJStandardMenuItemClasses.pkg
80089>>>Use cCJDeoMenuItemClasses.pkg
80089>>>
80089>>>
80089>>>Object oDEOEditContextMenu17 is a cCJContextMenu
80091>>>    
80091>>>    Move Self to Default_dbFloating_Menu_ID
80092>>>    
80092>>>    Object oUndoMenuItem is a cCJUndoMenuItem
80094>>>    End_Object
80095>>>    
80095>>>    Object oCutMenuItem is a cCJCutMenuItem
80097>>>        Set pbControlBeginGroup to True
80098>>>    End_Object
80099>>>    
80099>>>    Object oCopyMenuItem is a cCJCopyMenuItem
80101>>>    End_Object
80102>>>
80102>>>    Object oPasteMenuItem is a cCJPasteMenuItem
80104>>>    End_Object
80105>>>
80105>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
80107>>>    End_Object
80108>>>
80108>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
80110>>>        Set pbControlBeginGroup to True
80111>>>    End_Object
80112>>>
80112>>>    Object oPromptMenuItem is a cCJPromptMenuItem
80114>>>        Set pbControlBeginGroup to True
80115>>>    End_Object
80116>>>
80116>>>    Object oFindNextMenu is a cCJFindNextMenuItem
80118>>>        Set pbControlBeginGroup to True
80119>>>    End_Object
80120>>>
80120>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
80122>>>    End_Object
80123>>>
80123>>>    Object oClearMenuItem is a cCJClearMenuItem
80125>>>        Set pbControlBeginGroup to True
80126>>>    End_Object
80127>>>
80127>>>    Object oClearAllMenu is a cCJClearAllMenuItem
80129>>>    End_Object
80130>>>
80130>>>    Object oSaveMenu is a cCJSaveMenuItem
80132>>>    End_Object
80133>>>    
80133>>>    Object oDeleteMenu is a cCJDeleteMenuItem
80135>>>    End_Object
80136>>>
80136>>>    Object oRememberitem is a cCJRememberFieldMenuItem
80138>>>        Set pbControlBeginGroup to True
80139>>>    End_Object
80140>>>
80140>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
80142>>>    End_Object
80143>>>
80143>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
80145>>>    End_Object
80146>>>
80146>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
80148>>>    End_Object
80149>>>
80149>>>End_Object
80150>
80150>Object oMain is a Panel
80152>    Set Label To "My Project"
80153>    Set Location to 4 3
80154>    Set Size to 300 450
80155>
80155>    Object oCommandBarSystem is a cCJCommandBarSystem
80157>        Set pbTimerUpdate to True
80158>        Set peVisualTheme to xtpThemeOffice2013Outlook
80159>        Set pbAutoResizeIcons to True
80160>
80160>        Procedure OnCreateCommandBars
80163>            Handle hoOptions
80163>            Get OptionsObject to hoOptions
80164>            Forward Send OnCreateCommandBars
80166>        End_Procedure
80167>
80167>        Object oMenuBar is a cCJMenuBar
80169>
80169>            Object oFileMenu is a cCJMenuItem
80171>                Set peControlType to xtpControlPopup          
80172>                Set psCaption   to "&File"
80173>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
80174>                Set psCategory to "Menus"
80175>
80175>                Object oClearMenuItem is a cCJClearMenuItem
80177>                    Set pbAddToDesignerMenu to True
80178>                End_Object
80179>
80179>                Object oClearAllMenu is a cCJClearAllMenuItem
80181>                    Set pbAddToDesignerMenu to True
80182>                End_Object
80183>
80183>                Object oPromptMenuItem is a cCJPromptMenuItem
80185>                    Set pbAddToDesignerMenu to True
80186>                    Set pbControlBeginGroup to True
80187>                End_Object
80188>
80188>                Object oFindMenuItem is a cCJFindMenuItem
80190>                    Set pbAddToDesignerMenu to True
80191>                    Set pbControlBeginGroup to True
80192>                End_Object
80193>
80193>                Object oFindNextMenu is a cCJFindNextMenuItem
80195>                    Set pbAddToDesignerMenu to True
80196>                End_Object
80197>
80197>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
80199>                    Set pbAddToDesignerMenu to True
80200>                End_Object
80201>
80201>                Object oFindFirstMenu is a cCJFindFirstMenuItem
80203>                    Set pbAddToDesignerMenu to True
80204>                End_Object
80205>
80205>                Object oFindLastMenu is a cCJFindLastMenuItem
80207>                    Set pbAddToDesignerMenu to True
80208>                End_Object
80209>
80209>                Object oSaveMenuItem is a cCJSaveMenuItem
80211>                    Set pbAddToDesignerMenu to True
80212>                    Set pbControlBeginGroup to True
80213>                End_Object
80214>
80214>                Object oDeleteMenuItem is a cCJDeleteMenuItem
80216>                    Set pbAddToDesignerMenu to True
80217>                End_Object
80218>
80218>                Object oExitMenu is a cCJExitMenuItem
80220>                    Set pbControlBeginGroup to True
80221>                End_Object
80222>
80222>            End_Object
80223>
80223>            Object oViewMenu is a cCJMenuItem
80225>                Set peControlType to xtpControlPopup
80226>                Set psCaption to "&View"
80227>                Set psToolTip to "View"
80228>                Set psDescription to "Available Views"
80229>
80229>                Object oAutoMenuItem is a cCJMenuItem
80231>                    Set psCaption to "Auto"
80232>                    Set psTooltip to "Auto"
80233>                
80233>                    Procedure OnExecute Variant vCommandBarControl
80236>                        Handle hoClient
80236>                        Get Client_Id to hoClient
80237>                        Send Activate_oAuto of hoClient
80238>                    End_Procedure
80239>                End_Object
80240>
80240>                Object oMunkaMenuItem is a cCJMenuItem
80242>                    Set psCaption to "Munka"
80243>                    Set psTooltip to "Munka"
80244>                
80244>                    Procedure OnExecute Variant vCommandBarControl
80247>                        Handle hoClient
80247>                        Get Client_Id to hoClient
80248>                        Send Activate_oMunka of hoClient
80249>                    End_Procedure
80250>                End_Object
80251>
80251>                Object oUgyfelMenuItem is a cCJMenuItem
80253>                    Set psCaption to "Ugyfel"
80254>                    Set psTooltip to "Ugyfel"
80255>                
80255>                    Procedure OnExecute Variant vCommandBarControl
80258>                        Handle hoClient
80258>                        Get Client_Id to hoClient
80259>                        Send Activate_oUgyfel of hoClient
80260>                    End_Procedure
80261>                End_Object
80262>
80262>                Object oMunkalapMenuItem is a cCJMenuItem
80264>                    Set psCaption to "Munkalap"
80265>                    Set psTooltip to "Munkalap"
80266>                
80266>                    Procedure OnExecute Variant vCommandBarControl
80269>                        Handle hoClient
80269>                        Get Client_Id to hoClient
80270>                        Send Activate_oMunkalap of hoClient
80271>                    End_Procedure
80272>                End_Object
80273>
80273>                Object oMunkalapKeszitesMenuItem is a cCJMenuItem
80275>                    Set psCaption to "MunkalapKeszites"
80276>                    Set psTooltip to "MunkalapKeszites"
80277>                
80277>                    Procedure OnExecute Variant vCommandBarControl
80280>                        Handle hoClient
80280>                        Get Client_Id to hoClient
80281>                        Send Activate_oMunkalapKeszites of hoClient
80282>                    End_Procedure
80283>                End_Object
80284>
80284>                Object oMunkalapVegleges2MenuItem is a cCJMenuItem
80286>                    Set psCaption to "MunkalapVegleges2"
80287>                    Set psTooltip to "MunkalapVegleges2"
80288>                
80288>                    Procedure OnExecute Variant vCommandBarControl
80291>                        Handle hoClient
80291>                        Get Client_Id to hoClient
80292>                        Send Activate_oMunkalapVegleges2 of hoClient
80293>                    End_Procedure
80294>                End_Object
80295>            End_Object
80296>            
80296>            Object oReportMenu is a cCJMenuItem
80298>                Set peControlType to xtpControlPopup
80299>                Set psCaption to "&Report"
80300>                Set psToolTip to "Report"
80301>                Set psDescription to "Available Reports"
80302>
80302>                Object oGyakorisagRiportMenuItem is a cCJMenuItem
80304>                    Set psCaption to "GyakorisagRiport"
80305>                    Set psTooltip to "GyakorisagRiport"
80306>                
80306>                    Procedure OnExecute Variant vCommandBarControl
80309>                        Handle hoClient
80309>                        Get Client_Id to hoClient
80310>                        Send Activate_oGyakorisagRiport of hoClient
80311>                    End_Procedure
80312>                End_Object
80313>
80313>                Object oReportMenuItem is a cCJMenuItem
80315>                    Set psCaption to "Report"
80316>                    Set psTooltip to "Report"
80317>                
80317>                    Procedure OnExecute Variant vCommandBarControl
80320>                        Handle hoClient
80320>                        Get Client_Id to hoClient
80321>                        Send Activate_oReport of hoClient
80322>                    End_Procedure
80323>                End_Object
80324>
80324>                Object oReport2MenuItem is a cCJMenuItem
80326>                    Set psCaption to "Report2"
80327>                    Set psTooltip to "Report2"
80328>                
80328>                    Procedure OnExecute Variant vCommandBarControl
80331>                        Handle hoClient
80331>                        Get Client_Id to hoClient
80332>                        Send Activate_oReport2 of hoClient
80333>                    End_Procedure
80334>                End_Object
80335>
80335>                Object oReport3MenuItem is a cCJMenuItem
80337>                    Set psCaption to "Report3"
80338>                    Set psTooltip to "Report3"
80339>                
80339>                    Procedure OnExecute Variant vCommandBarControl
80342>                        Handle hoClient
80342>                        Get Client_Id to hoClient
80343>                        Send Activate_oReport3 of hoClient
80344>                    End_Procedure
80345>                End_Object
80346>
80346>                Object oReport4MenuItem is a cCJMenuItem
80348>                    Set psCaption to "Report4"
80349>                    Set psTooltip to "Report4"
80350>                
80350>                    Procedure OnExecute Variant vCommandBarControl
80353>                        Handle hoClient
80353>                        Get Client_Id to hoClient
80354>                        Send Activate_oReport4 of hoClient
80355>                    End_Procedure
80356>                End_Object
80357>
80357>                Object oVeglegesReportMenuItem is a cCJMenuItem
80359>                    Set psCaption to "VeglegesReport"
80360>                    Set psTooltip to "VeglegesReport"
80361>                
80361>                    Procedure OnExecute Variant vCommandBarControl
80364>                        Handle hoClient
80364>                        Get Client_Id to hoClient
80365>                        Send Activate_oVeglegesReport of hoClient
80366>                    End_Procedure
80367>                End_Object
80368>            End_Object
80369>
80369>            Object oNavigateMenu is a cCJMenuItem
80371>                Set peControlType to xtpControlPopup      
80372>                Set psCaption to "&Navigate"    
80373>                Set psTooltip to "Navigate"    
80374>                Set psDescription to "Move to different areas of the application"
80375>
80375>                Object oNextAreaMenu is a cCJNextAreaMenu
80377>                End_Object
80378>
80378>                Object oPriorAreaMenu is a cCJPriorAreaMenu
80380>                End_Object
80381>
80381>                Object oNextViewMenu is a cCJNextViewMenu
80383>                End_Object
80384>
80384>                Object oPriorViewMenu is a cCJPriorViewMenu
80386>                End_Object
80387>
80387>                Object oPromptMenu is a cCJPromptMenuItem
80389>                    Set pbControlBeginGroup to True
80390>                End_Object
80391>
80391>                Object oZoomMenu is a cCJZoomMenuItem
80393>                End_Object
80394>
80394>            End_Object
80395>
80395>            Object oWindowMenu is a cCJMDIWindowsMenuItem
80397>                Set peControlType to xtpControlPopup
80398>                Set psCaption to "&Window"
80399>                Set psToolTip to "Window"
80400>                Set psDescription to "Display Current Views and set other display options."    
80401>
80401>                // These are the static windows items. More will be created in onInitPopup 
80401>                Object oDisplayOptionsMenu is a cCJMenuItem
80403>                    Set peControlType to xtpControlPopup          
80404>                    Set psCaption to "&Display Options"
80405>                    Set psToolTip to "Display Options"
80406>                    Set psDescription to "Set display options"
80407>
80407>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
80409>                    End_Object
80410>
80410>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
80412>                    End_Object
80413>
80413>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
80415>                        Set pbControlBeginGroup to True
80416>                    End_Object
80417>
80417>                End_Object
80418>
80418>                Object oCascadeMenu is a cCJCascadeMenuItem
80420>                    Set pbControlBeginGroup to True
80421>                End_Object
80422>
80422>                Object oHorizTile is a cCJTileHorizontally
80424>                End_Object
80425>
80425>                Object oVertTile is a cCJTileVertically
80427>                End_Object
80428>
80428>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
80430>                    Set pbControlBeginGroup to True
80431>                End_Object
80432>
80432>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
80434>                End_Object
80435>
80435>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
80437>                    Set pbControlBeginGroup to True
80438>                End_Object
80439>
80439>            End_Object
80440>
80440>            Object oHelpMenu is a cCJMenuItem
80442>                Set peControlType to xtpControlPopup    
80443>                Set psCaption to "&Help"
80444>                Set psDescription to "Access Information for learning and using this DataFlex application."
80445>                Set psToolTip to "Help"
80446>
80446>                Object oHelpMenuItem is a cCJHelpMenuItem 
80448>                End_Object
80449>
80449>                Object oAboutMenuItem is a cCJAboutMenuItem
80451>                End_Object
80452>
80452>            End_Object
80453>
80453>        End_Object
80454>
80454>        Object oFindToolBar is a cCJToolbar
80456>            Set psTitle to "Finding Toolbar"
80457>
80457>            Object oFindFirstTool is a cCJFindFirstMenuItem
80459>            End_Object
80460>
80460>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
80462>            End_Object
80463>
80463>            Object oFindMenuTool is a cCJFindMenuItem
80465>            End_Object
80466>
80466>            Object oFindNextTool is a cCJFindNextMenuItem
80468>            End_Object
80469>
80469>            Object oFindLastTool is a cCJFindLastMenuItem
80471>            End_Object
80472>
80472>            Object oPromptToolItem is a cCJPromptMenuItem
80474>                Set pbControlBeginGroup to True
80475>            End_Object
80476>
80476>        End_Object
80477>
80477>        Object oFileToolBar is a cCJToolbar
80479>            Set psTitle to "Data Entry Toolbar"
80480>
80480>            Object oClearToolItem is a cCJClearMenuItem
80482>                Set peControlStyle to xtpButtonIconAndCaption
80483>            End_Object
80484>
80484>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
80486>                Set peControlStyle to xtpButtonIconAndCaption
80487>            End_Object
80488>
80488>            Object oSaveToolItem is a cCJSaveMenuItem
80490>                Set peControlStyle to xtpButtonIconAndCaption
80491>                Set pbControlBeginGroup to True
80492>            End_Object
80493>
80493>            Object oDeleteToolItem is a cCJDeleteMenuItem
80495>                Set peControlStyle to xtpButtonIconAndCaption
80496>            End_Object
80497>
80497>        End_Object
80498>
80498>        Object oEditToolBar is a cCJToolbar
80500>            Set psTitle to "Edit Toolbar"
80501>
80501>            Object oCutToolbarItem is a cCJCutMenuItem
80503>            End_Object
80504>
80504>            Object oCopyToolbarItem is a cCJCopyMenuItem
80506>            End_Object
80507>
80507>            Object oPasteToolbarItem is a cCJPasteMenuItem
80509>            End_Object
80510>
80510>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
80512>                Set pbControlBeginGroup to True
80513>            End_Object
80514>
80514>        End_Object
80515>
80515>        Object oRememberToolbar is a cCJToolbar
80517>            Set psTitle to C_$Remember
80518>
80518>            Object oRememberItems is a cCJMenuItem
80520>
80520>                Set peControlType to xtpControlPopup
80521>                Set peControlStyle to xtpButtonCaption
80522>                Set psCaption to C_$Remember
80523>                
80523>                Object oMenuItem is a cCJRememberFieldMenuItem
80525>                    Set peControlStyle to xtpButtonIconAndCaption
80526>                End_Object
80527>                
80527>                Object oMenuItem is a cCJRememberLastFieldMenuItem
80529>                    Set peControlStyle to xtpButtonIconAndCaption
80530>                End_Object
80531>                
80531>                Object oMenuItem is a cCJUnRememberFieldMenuItem
80533>                    Set peControlStyle to xtpButtonIconAndCaption
80534>                End_Object
80535>                
80535>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
80537>                    Set peControlStyle to xtpButtonIconAndCaption
80538>                End_Object
80539>
80539>            End_Object
80540>            
80540>        End_Object
80541>        
80541>        Object oStatusBar is a cCJStatusBar
80543>
80543>            Object oStatusPane1 is a cCJStatusBarPane
80545>                Set piID to sbpIDIdlePane
80546>                Set pbStyleStretch to True
80547>            End_Object
80548>
80548>            Object oStatusPane2 is a cCJStatusBarPane
80550>                Set phoViewPane to Self
80551>                Set pbStyleStretch to True
80552>            End_Object
80553>
80553>        End_Object
80554>
80554>    End_Object
80555>
80555>    Object oClientArea is a ClientArea
80557>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\StdAbout.pkg)
80557>>>//************************************************************************
80557>>>// Confidential Trade Secret.
80557>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
80557>>>// as an unpublished work.  All rights reserved.
80557>>>// DataFlex is a registered trademark of Data Access Corporation.
80557>>>//
80557>>>//************************************************************************
80557>>>//************************************************************************
80557>>>//
80557>>>// $File name  : StdAbout.pkg
80557>>>// $File title : Standard about object package for VDF
80557>>>// Notice      :
80557>>>// $Author(s)  : John Tuohy
80557>>>//
80557>>>// $Rev History
80557>>>//
80557>>>// JT 06/27/97   File created
80557>>>//************************************************************************
80557>>>
80557>>>// This provides a quick and simple way to create an about package for a program.
80557>>>// You need to create a message inside you client area called Activate_About.
80557>>>// Within this message you should send the message DoAbout passing needed
80557>>>// string information.
80557>>>//
80557>>>//       Procedure Activate_About
80557>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
80557>>>//       End_Procedure
80557>>>//    where: sTitle =     Name of application. If none provided, uses caption
80557>>>//                        bar title
80557>>>//           sVersion   = Version Line. If none provided, will be blank
80557>>>//           sCopyRight = Copyright Line. If none provided, will be blank
80557>>>//           sAuthor    = Author name, blank if none provided
80557>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
80557>>>//                        is used.
80557>>>// It is expected that you will place this in your own object package. For
80557>>>// example an order about package may look like this:
80557>>>//
80557>>>//   // OrderAbout.pkg
80557>>>//   Use StdAbout.pkg
80557>>>//   Procedure Activate_About
80557>>>//      String sTitle sCopyright sVersion sAuthor
80557>>>//      Move "My Order Entry System" to sTitle
80557>>>//      Move "Version 2.1" to sVersion
80557>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
80557>>>//      Move "John Smith"  to sAuthor
80557>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
80557>>>//   end_procedure
80557>>>//   // end of file.
80557>>>
80557>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfabout.pkg)
80557>>>>>//************************************************************************
80557>>>>>// Confidential Trade Secret.
80557>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
80557>>>>>// as an unpublished work.  All rights reserved.
80557>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
80557>>>>>//
80557>>>>>//************************************************************************
80557>>>>>//************************************************************************
80557>>>>>//
80557>>>>>// $File name  : DfAbout.pkg
80557>>>>>// $File title : About class support
80557>>>>>// Notice      :
80557>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
80557>>>>>//
80557>>>>>// $Rev History
80557>>>>>//
80557>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
80557>>>>>//                Windows for the size first. 
80557>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
80557>>>>>//                with anchor technique. Removed unnessary property in the
80557>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
80557>>>>>//                object To better look in Windows XP. Repositioned the close
80557>>>>>//                button in the sysinfo dialog To line up with the display area
80557>>>>>//                Replaced obsolete code and techniques. Removed dead code.
80557>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
80557>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
80557>>>>>//                the global Workspace object, if it is present
80557>>>>>// JJT 11/05/98   Added version information
80557>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
80557>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
80557>>>>>//                workspace package.
80557>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
80557>>>>>//                class can create this object.
80557>>>>>//                Cleaned up the interface (used correct classes and messages)
80557>>>>>//                Added workspace reporting support To sys-info.
80557>>>>>//                Turned off wrapping in the sys-info editor.
80557>>>>>// KR  ??/??/96   File created
80557>>>>>//************************************************************************
80557>>>>>Use LanguageText.pkg
80557>>>>>Use Windows.pkg
80557>>>>>Use DFbitmap.pkg
80557>>>>>Use GlobalFunctionsProcedures.pkg
80557>>>>>Use cTextEdit.pkg
80557>>>>>
80557>>>>>Use cli.pkg
80557>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DFBTRDRV.PKG)
80557>>>>>>>//****************************************************************************
80557>>>>>>>//
80557>>>>>>>// $File name  : DFBTRDRV.PKG
80557>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
80557>>>>>>>// Notice      : This package contains constants and commands, used to call
80557>>>>>>>//               specific functions in the DFBTRDRV.
80557>>>>>>>// $Author(s)  : Eddy Kleinjan
80557>>>>>>>//
80557>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
80557>>>>>>>// Created     : 01-07-97 @ 12:00:00
80557>>>>>>>//
80557>>>>>>>// Changed     : 04-04-2001.
80557>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
80557>>>>>>>//
80557>>>>>>>// Changed     : June 6, 2001
80557>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
80557>>>>>>>//
80557>>>>>>>//               Added DFBTR_DDF_OWNER command.
80557>>>>>>>//
80557>>>>>>>// Changed     : June 12, 2001
80557>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
80557>>>>>>>//
80557>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
80557>>>>>>>//
80557>>>>>>>// Changed     : August 4, 2004
80557>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
80557>>>>>>>//
80557>>>>>>>//               Added cDfbtrdrvHandler class.
80557>>>>>>>//               New functions in this class:
80557>>>>>>>//                  Function CKRevision Returns String
80557>>>>>>>//                  Function CkUsesUri Returns Integer
80557>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
80557>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
80557>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
80557>>>>>>>//
80557>>>>>>>// Changed     : September 30, 2005
80557>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
80557>>>>>>>//
80557>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
80557>>>>>>>//****************************************************************************
80557>>>>>>>Use Ui
80557>>>>>>>//
80557>>>>>>>// Driver Indentification
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//*** Driver attributes
80557>>>>>>>//
80557>>>>>>>// Call_Driver functions ID's
80557>>>>>>>//
80557>>>>>>>//
80557>>>>>>>// DFBTRFN_CONVERT_FILE options
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// DFBTRFN_SET_OWNER options
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to create all vars which may be needed
80557>>>>>>>// in other commands.
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to set the owner of a Btrieve file.
80557>>>>>>>// File must have been opened.
80557>>>>>>>// Filenumber needs to be passed.
80557>>>>>>>// To clear set the owner to "".
80557>>>>>>>// Examples:
80557>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
80557>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
80557>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
80557>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
80557>>>>>>>// To clear:
80557>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to parse DFBTR_SET_OWNVER
80557>>>>>>>// options.
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to parse for Callback
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to clear the owner of a Btrieve file.
80557>>>>>>>// File must have been opened.
80557>>>>>>>// Filenumber needs to be passed.
80557>>>>>>>// Examples:
80557>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to add a owner name to the internal list of ownernames
80557>>>>>>>// which will be tries when opening files.
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to remove all owners from the internal list of ownernames
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to set the owner name to be used when opening the DDF files.
80557>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
80557>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
80557>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to change the transaction type.
80557>>>>>>>// Valid types are:
80557>>>>>>>//     DFBTRTT_NONE
80557>>>>>>>//     DFBTRTT_EXCLUSIVE
80557>>>>>>>//     DFBTRTT_CONCURRENT
80557>>>>>>>//
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to get the current transaction type.
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to set explicit_locking
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to get explicit locking
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//
80557>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
80557>>>>>>>//
80557>>>>>>>
80557>>>>>>>//*****************************************************************************
80557>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
80557>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
80557>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
80557>>>>>>>//*****************************************************************************
80557>>>>>>>
80557>>>>>>>Class cDFBtrDrvHandler Is An Array
80558>>>>>>>
80558>>>>>>>    Procedure Construct_Object Integer iImage
80560>>>>>>>        Forward Send Construct_object iImage
80562>>>>>>>
80562>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
80563>>>>>>>    End_Procedure // Construct_Object
80564>>>>>>>
80564>>>>>>>
80564>>>>>>>
80564>>>>>>>    //***
80564>>>>>>>    //*** Function: CKRevsion
80564>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
80564>>>>>>>    //***
80564>>>>>>>
80564>>>>>>>    Function CKRevision Returns String
80566>>>>>>>        Local String  sDriverID
80566>>>>>>>        Local String  sRevision
80566>>>>>>>        Local String  sVoid
80566>>>>>>>        Local Integer iRetval
80566>>>>>>>
80566>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80566>>>>>>>        // This error would otherwise be raised when we have an older
80566>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80566>>>>>>>        Send Ignore_error To Error_object_Id 20491
80567>>>>>>>        Get psDriverID To sDriverID
80568>>>>>>>        Move (Repeat(" ", 255)) To sRevision
80569>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
80574>>>>>>>        Send Trap_Error To Error_object_Id 20491
80575>>>>>>>        If (Trim(sRevision) = "") Begin
80577>>>>>>>            // Unable to get the revision. return all zeroes.
80577>>>>>>>            Move "0.0.0.0" To sRevision
80578>>>>>>>        End
80578>>>>>>>>
80578>>>>>>>        Function_Return sRevision
80579>>>>>>>    End_Function // CKRevision
80580>>>>>>>
80580>>>>>>>    Function CkUsesUri Returns Integer
80582>>>>>>>        Local String  sDriverID
80582>>>>>>>        Local String  sVoid1
80582>>>>>>>        Local String  sVoid2
80582>>>>>>>        Local Integer iRetval
80582>>>>>>>
80582>>>>>>>        Get psDriverID To sDriverID
80583>>>>>>>
80583>>>>>>>        Move 0 To iRetval
80584>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80584>>>>>>>        // This error would otherwise be raised when we have an older
80584>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
80584>>>>>>>        Send Ignore_error To Error_object_Id 20491
80585>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
80590>>>>>>>        Send Trap_Error To Error_object_Id 20491
80591>>>>>>>
80591>>>>>>>        Function_Return iRetval
80592>>>>>>>    End_Function // CKUsesUri
80593>>>>>>>
80593>>>>>>>
80593>>>>>>>
80593>>>>>>>    //***
80593>>>>>>>    //*** Function: ExtractPartFromRevsion
80593>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
80593>>>>>>>    //***
80593>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
80593>>>>>>>    //***
80593>>>>>>>
80593>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
80595>>>>>>>        Local Integer iPartRev
80595>>>>>>>        Local Integer iCurrentPart
80595>>>>>>>        Local Integer iSeparatorPos
80595>>>>>>>
80595>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
80598>>>>>>>
80598>>>>>>>        Move 0 To iCurrentPart
80599>>>>>>>        Repeat
80599>>>>>>>>
80599>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
80600>>>>>>>            If (iSeparatorPos > 0) Begin
80602>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
80603>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
80604>>>>>>>                Increment iCurrentPart
80605>>>>>>>            End
80605>>>>>>>>
80605>>>>>>>            Else If (sRevision <> "") Begin
80608>>>>>>>                Move sRevision To iPartRev
80609>>>>>>>                Move "" To sRevision
80610>>>>>>>                Increment iCurrentPart
80611>>>>>>>            End
80611>>>>>>>>
80611>>>>>>>            Else ;                Move -1 To iPartRev
80613>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
80615>>>>>>>
80615>>>>>>>        Function_Return iPartRev
80616>>>>>>>    End_Function // EcxtractPartFromRevision
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>
80617>>>>>>>    //***
80617>>>>>>>    //*** Function: CKMajorRevision
80617>>>>>>>    //*** Purpose : Returns the major revision of the CK
80617>>>>>>>    //***
80617>>>>>>>
80617>>>>>>>    Function CKMajorRevision Returns Integer
80619>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
80620>>>>>>>    End_Function // CKMajorRevision
80621>>>>>>>
80621>>>>>>>
80621>>>>>>>
80621>>>>>>>    //***
80621>>>>>>>    //*** Function: CKMinorRevision
80621>>>>>>>    //*** Purpose : Returns the minor revision of the CK
80621>>>>>>>    //***
80621>>>>>>>
80621>>>>>>>    Function CKMinorRevision Returns Integer
80623>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
80624>>>>>>>    End_Function // CKMinorRevision
80625>>>>>>>
80625>>>>>>>
80625>>>>>>>
80625>>>>>>>    //***
80625>>>>>>>    //*** Function: CKReleaseRevision
80625>>>>>>>    //*** Purpose : Returns the release revision of the CK
80625>>>>>>>    //***
80625>>>>>>>
80625>>>>>>>    Function CKReleaseRevision Returns Integer
80627>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
80628>>>>>>>    End_Function // CKReleaseRevision
80629>>>>>>>
80629>>>>>>>
80629>>>>>>>
80629>>>>>>>    //***
80629>>>>>>>    //*** Function: CKBuildRevision
80629>>>>>>>    //*** Purpose : Returns the major revision of the CK
80629>>>>>>>    //***
80629>>>>>>>
80629>>>>>>>    Function CKBuildRevision Returns Integer
80631>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
80632>>>>>>>    End_Function // CKBuildRevision
80633>>>>>>>
80633>>>>>>>
80633>>>>>>>
80633>>>>>>>    //***
80633>>>>>>>    //*** Function: IsMinimalRevision
80633>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
80633>>>>>>>    //***
80633>>>>>>>
80633>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
80635>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
80638>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
80641>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
80644>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
80647>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
80650>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
80654>>>>>>>            End
80654>>>>>>>>
80654>>>>>>>        End
80654>>>>>>>>
80654>>>>>>>
80654>>>>>>>        Function_Return (FALSE)
80655>>>>>>>    End_Function // IsMinimalRevision
80656>>>>>>>
80656>>>>>>>    //   Functions to query the Pervasive.SQL version:
80656>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
80656>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
80656>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
80656>>>>>>>    //
80656>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
80656>>>>>>>    //   in the following format:
80656>>>>>>>    //       <version>.<revision>.<type>
80656>>>>>>>    //   possible values for <type>:
80656>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
80656>>>>>>>    //         server using Workgroup authentication mode
80656>>>>>>>    //       C for client cache engine
80656>>>>>>>    //       D for DOS workstation
80656>>>>>>>    //       N for client Requester
80656>>>>>>>    //       S for NetWare server
80656>>>>>>>    //       T for 32-bit Windows server engine
80656>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
80656>>>>>>>    //
80656>>>>>>>    //   example:
80656>>>>>>>    //       8.50.T
80656>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
80656>>>>>>>    //   32-bits Windows server.
80656>>>>>>>    //
80656>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
80656>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
80656>>>>>>>    //
80656>>>>>>>    //   If the version information is not available or can not be obtained
80656>>>>>>>    //   the functions will return "0.0.0"
80656>>>>>>>
80656>>>>>>>
80656>>>>>>>    //***
80656>>>>>>>    //*** Function: PSQLRequesterVersionInfo
80656>>>>>>>    //*** Purpose : Returns the version information of the
80656>>>>>>>    //***           Pervasive.SQL Client requester.
80656>>>>>>>
80656>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
80658>>>>>>>
80658>>>>>>>        Local String  sDriverID
80658>>>>>>>        Local String  sVersion
80658>>>>>>>        Local String  sVoid
80658>>>>>>>        Local Integer iRetval
80658>>>>>>>
80658>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80658>>>>>>>        // This error would otherwise be raised when we have an older
80658>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80658>>>>>>>        Send Ignore_error To Error_object_Id 20491
80659>>>>>>>        Get psDriverID To sDriverID
80660>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80661>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80666>>>>>>>        Send Trap_Error To Error_object_Id 20491
80667>>>>>>>        If (Trim(sVersion) = "") Begin
80669>>>>>>>            // Unable to get the revision. return all zeroes.
80669>>>>>>>            Move "0.0.0" To sVersion
80670>>>>>>>        End
80670>>>>>>>>
80670>>>>>>>        Function_Return sVersion
80671>>>>>>>    End_Function //  PSQLRequesterVersion
80672>>>>>>>
80672>>>>>>>    //***
80672>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
80672>>>>>>>    //*** Purpose : Returns the version information of the
80672>>>>>>>    //***           Pervasive.SQL Local Engine
80672>>>>>>>
80672>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
80674>>>>>>>
80674>>>>>>>        Local String  sDriverID
80674>>>>>>>        Local String  sVersion
80674>>>>>>>        Local String  sVoid
80674>>>>>>>        Local Integer iRetval
80674>>>>>>>
80674>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80674>>>>>>>        // This error would otherwise be raised when we have an older
80674>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80674>>>>>>>        Send Ignore_error To Error_object_Id 20491
80675>>>>>>>        Get psDriverID To sDriverID
80676>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80677>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80682>>>>>>>        Send Trap_Error To Error_object_Id 20491
80683>>>>>>>        If (Trim(sVersion) = "") Begin
80685>>>>>>>            // Unable to get the revision. return all zeroes.
80685>>>>>>>            Move "0.0.0" To sVersion
80686>>>>>>>        End
80686>>>>>>>>
80686>>>>>>>        Function_Return sVersion
80687>>>>>>>    End_Function //  PSQLLocalEngineVersion
80688>>>>>>>
80688>>>>>>>    //***
80688>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
80688>>>>>>>    //*** Purpose : Returns the version information of the
80688>>>>>>>    //***           Pervasive.SQL Server Engine
80688>>>>>>>
80688>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
80690>>>>>>>
80690>>>>>>>        Local String  sDriverID
80690>>>>>>>        Local String  sVersion
80690>>>>>>>        Local String  sVoid
80690>>>>>>>        Local Integer iRetval
80690>>>>>>>
80690>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
80690>>>>>>>        // This error would otherwise be raised when we have an older
80690>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
80690>>>>>>>        Send Ignore_error To Error_object_Id 20491
80691>>>>>>>        Get psDriverID To sDriverID
80692>>>>>>>        Move (Repeat(" ", 255)) To sVersion
80693>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
80698>>>>>>>        Send Trap_Error To Error_object_Id 20491
80699>>>>>>>        If (Trim(sVersion) = "") Begin
80701>>>>>>>            // Unable to get the revision. return all zeroes.
80701>>>>>>>            Move "0.0.0" To sVersion
80702>>>>>>>        End
80702>>>>>>>>
80702>>>>>>>        Function_Return sVersion
80703>>>>>>>    End_Function //  PSQLServerEngineVersion
80704>>>>>>>
80704>>>>>>>End_Class // cDfbtrdrvHandler
80705>>>>>>>
80705>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\MSSqldrv.pkg)
80705>>>>>>>//*****************************************************************************
80705>>>>>>>//*** MSSQLDRV.PKG                                                          ***
80705>>>>>>>//***                                                                       ***
80705>>>>>>>//*** Author: Ben Weijers                                                   ***
80705>>>>>>>//***         Data Access Nederland                                         ***
80705>>>>>>>//***         29 June 1998                                                  ***
80705>>>>>>>//***                                                                       ***
80705>>>>>>>//***                                                                       ***
80705>>>>>>>//*** Purpose:                                                              ***
80705>>>>>>>//***   Package that declares MS SQL driver constants and functions.        ***
80705>>>>>>>//****                                                                      ***
80705>>>>>>>//***   This package can be used by developers who want to add Data Access  ***
80705>>>>>>>//***   MS SQL Client specific code to a DataFlex application.              ***
80705>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
80705>>>>>>>//***             Changed EnumerateServers function to use the highest      ***
80705>>>>>>>//***             available SQL Server client driver.                       ***
80705>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
80705>>>>>>>//***             mssqldrv.pkg                                              ***
80705>>>>>>>//***   Updated:  November 6th 2013 (Current CK build: 6.0.0.19)            ***
80705>>>>>>>//***             Added constants for SQL Server specific native types      ***
80705>>>>>>>//***             ( var...(max) types, money types, datetime types)         ***
80705>>>>>>>//*****************************************************************************
80705>>>>>>>
80705>>>>>>>Use Cli.pkg
80705>>>>>>>Use SQL.pkg
80705>>>>>>>
80705>>>>>>>//*** Driver Indentification
80705>>>>>>>
80705>>>>>>>//*** Error number constants
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>// SQL Server spcific types. 
80705>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
80705>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
80705>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
80705>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
80705>>>>>>>
80705>>>>>>>// SQL Server spcific types. 
80705>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
80705>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
80705>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
80705>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
80705>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
80705>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
80705>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>//*****************************************************************************
80705>>>>>>>//*** MSSQL_SetConstraint <FileNum> <ConstraintText>                        ***
80705>>>>>>>//***                                                                       ***
80705>>>>>>>//***   Setup a constraint for a file.                                      ***
80705>>>>>>>//*****************************************************************************
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>
80705>>>>>>>Class cMSSQLHandler Is A cCLIHandler
80706>>>>>>>
80706>>>>>>>    Procedure Construct_Object
80708>>>>>>>        Forward Send Construct_Object
80710>>>>>>>
80710>>>>>>>        Set psDriverID To MSSQLDRV_ID
80711>>>>>>>    End_Procedure // Construct_Object
80712>>>>>>>
80712>>>>>>>
80712>>>>>>>
80712>>>>>>>    //***
80712>>>>>>>    //*** Function: ExtractList
80712>>>>>>>    //*** Purpose : Extract the list from the out connect string.
80712>>>>>>>    //***
80712>>>>>>>
80712>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
80714>>>>>>>        Local String  sItem
80714>>>>>>>        Local Integer iStart
80714>>>>>>>        Local Integer iEnd
80714>>>>>>>
80714>>>>>>>        If (hoStore = 0) ;            Move Current_object To hoStore
80717>>>>>>>
80717>>>>>>>        Send Delete_Data To hoStore
80718>>>>>>>        Move (Pos("{", sOutConnStr)) To iStart
80719>>>>>>>        While (iStart > 0)
80723>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) To sOutConnStr
80724>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 To iStart
80727>>>>>>>            Else Begin
80728>>>>>>>                Move (Pos(",", sOutConnStr)) To iStart
80729>>>>>>>                Move (Pos("}", sOutConnStr)) To iEnd
80730>>>>>>>                If ((iStart = 0) Or (iEnd < iStart)) ;                    Move iEnd To iStart
80733>>>>>>>
80733>>>>>>>                If (iStart > 0) ;                    Set Value Of hoStore Item (Item_Count(Current_Object)) To (Left(sOutConnStr, iStart - 1))
80736>>>>>>>
80736>>>>>>>                If (iStart = iEnd) ;                    Move 0 To iStart
80739>>>>>>>            End
80739>>>>>>>>
80739>>>>>>>        Loop
80740>>>>>>>>
80740>>>>>>>
80740>>>>>>>        Function_Return (Item_Count(hoStore))
80741>>>>>>>    End_Procedure // ExtractList
80742>>>>>>>
80742>>>>>>>
80742>>>>>>>
80742>>>>>>>    //***
80742>>>>>>>    //*** Function: BrowseConnect
80742>>>>>>>    //*** Purpose : Call the driver's browse connect function
80742>>>>>>>    //***
80742>>>>>>>
80742>>>>>>>    Function BrowseConnect String sInConnStr Returns String
80744>>>>>>>        Local String  sDriver
80744>>>>>>>        Local String  sOutConnStr
80744>>>>>>>        Local Integer iArg
80744>>>>>>>        Local Integer iRetval
80744>>>>>>>
80744>>>>>>>        Get psDriverID To sDriver
80745>>>>>>>        If (sDriver <> "") Begin
80747>>>>>>>            Move (Repeat(" ", 8192)) To sOutConnStr
80748>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
80753>>>>>>>        End
80753>>>>>>>>
80753>>>>>>>
80753>>>>>>>        Function_Return sOutConnStr
80754>>>>>>>    End_Function// BrowseConnect
80755>>>>>>>
80755>>>>>>>
80755>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
80757>>>>>>>        Local String  sDriver
80757>>>>>>>        Local String  sOutConnStr
80757>>>>>>>        Local Integer iArg
80757>>>>>>>        Local Integer iRetval
80757>>>>>>>        
80757>>>>>>>        Move 1 to iArg // Browses only local
80758>>>>>>>
80758>>>>>>>        Get psDriverID to sDriver
80759>>>>>>>        If (sDriver <> "") Begin
80761>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
80762>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
80767>>>>>>>        End
80767>>>>>>>>
80767>>>>>>>
80767>>>>>>>        Function_Return sOutConnStr
80768>>>>>>>    End_Function// BrowseConnect
80769>>>>>>>
80769>>>>>>>
80769>>>>>>>    Function DriverIndex String sDriver Returns Integer
80771>>>>>>>    
80771>>>>>>>        Local String  sCurrentDriver
80771>>>>>>>        Local Integer iNumberOfDrivers iDriver iCount
80771>>>>>>>    
80771>>>>>>>        Move 0 to iDriver
80772>>>>>>>    
80772>>>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
80775>>>>>>>        For iCount from 1 to iNumberOfDrivers
80781>>>>>>>>
80781>>>>>>>    
80781>>>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
80784>>>>>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriver) ) Begin
80786>>>>>>>                Move iCount to iDriver
80787>>>>>>>            End
80787>>>>>>>>
80787>>>>>>>        Loop
80788>>>>>>>>
80788>>>>>>>    
80788>>>>>>>        Function_Return iDriver
80789>>>>>>>    
80789>>>>>>>    End_Function 
80790>>>>>>>
80790>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
80792>>>>>>>        
80792>>>>>>>        Local String  sServerList
80792>>>>>>>        Local Integer iNumServers
80792>>>>>>>        Local Integer iDriver
80792>>>>>>>        Local Integer iClientVersion
80792>>>>>>>        Local String  sDriver
80792>>>>>>>        
80792>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
80793>>>>>>>
80793>>>>>>>        If (iDriver) Begin
80795>>>>>>>                
80795>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
80798>>>>>>>            
80798>>>>>>>            Case Begin
80798>>>>>>>    
80798>>>>>>>                Case (iClientVersion = SQLSERVER2016CLIENT)
80800>>>>>>>                    Move SQLSERVER2016DRVRSTR to sDriver
80801>>>>>>>                    Case Break
80802>>>>>>>    
80802>>>>>>>                Case (iClientVersion = SQLSERVER2014CLIENT)
80805>>>>>>>                    Move SQLSERVER2014DRVRSTR to sDriver
80806>>>>>>>                    Case Break
80807>>>>>>>            
80807>>>>>>>                Case (iClientVersion = SQLSERVER2012CLIENT)
80810>>>>>>>                    Move SQLSERVER2012DRVRSTR to sDriver
80811>>>>>>>                    Case Break
80812>>>>>>>    
80812>>>>>>>                Case (iClientVersion = SQLSERVER2008CLIENT)
80815>>>>>>>                    Move SQLSERVER2008DRVRSTR to sDriver
80816>>>>>>>                    Case Break
80817>>>>>>>    
80817>>>>>>>                Case (iClientVersion = SQLSERVER2005CLIENT)
80820>>>>>>>                    Move SQLSERVER2005DRVRSTR to sDriver
80821>>>>>>>                    Case Break
80822>>>>>>>            
80822>>>>>>>                Case (iClientVersion = SQLSERVER2000CLIENT)
80825>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
80826>>>>>>>                    Case Break
80827>>>>>>>            
80827>>>>>>>                Case Else
80827>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
80828>>>>>>>            
80828>>>>>>>            Case End
80828>>>>>>>    
80828>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
80829>>>>>>>            If (iNetworkLocal = 0) Begin
80831>>>>>>>                Get BrowseConnect sDriver to sServerList
80832>>>>>>>            End
80832>>>>>>>>
80832>>>>>>>            Else Begin
80833>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
80834>>>>>>>            End
80834>>>>>>>>
80834>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
80835>>>>>>>        End
80835>>>>>>>>
80835>>>>>>>        
80835>>>>>>>        Function_Return iNumServers
80836>>>>>>>        
80836>>>>>>>    End_Function
80837>>>>>>>
80837>>>>>>>    //***
80837>>>>>>>    //*** Procedure: EnumerateServers
80837>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
80837>>>>>>>    //***            This function will return all SQL Server instances on the network. 
80837>>>>>>>    //***            This may take a long time. 
80837>>>>>>>    //***            To enumerate only local SQL Server instances use EnumerateServersLocal 
80837>>>>>>>    Function EnumerateServers Returns Integer
80839>>>>>>>
80839>>>>>>>        Local Integer iNumServers
80839>>>>>>>        Local Integer iNetworkLocal
80839>>>>>>>        
80839>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
80840>>>>>>>        
80840>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
80841>>>>>>>        
80841>>>>>>>        Function_Return iNumServers
80842>>>>>>>        
80842>>>>>>>    End_Function
80843>>>>>>>
80843>>>>>>>
80843>>>>>>>    //***
80843>>>>>>>    //*** Procedure: EnumerateServersLocal
80843>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
80843>>>>>>>    //***            This function will return only return SQL Server instance on the local machine
80843>>>>>>>    //***            To enumerate all SQL Server instances in a network use EnumerateServers
80843>>>>>>>    Function EnumerateServersLocal Returns Integer
80845>>>>>>>
80845>>>>>>>        Local Integer iNumServers
80845>>>>>>>        Local Integer iNetworkLocal
80845>>>>>>>        
80845>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
80846>>>>>>>        
80846>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
80847>>>>>>>        
80847>>>>>>>        Function_Return iNumServers
80848>>>>>>>        
80848>>>>>>>    End_Function
80849>>>>>>>
80849>>>>>>>    
80849>>>>>>>
80849>>>>>>>    //***
80849>>>>>>>    //*** Function: EnumerateDatabases
80849>>>>>>>    //*** Purpose : Enumerate database in a given server.
80849>>>>>>>    //***
80849>>>>>>>
80849>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
80851>>>>>>>        Local Integer hoSQL
80851>>>>>>>        Local String  sConnect
80851>>>>>>>        Local String  sDatabase
80851>>>>>>>        Local Integer hdbc
80851>>>>>>>        Local Integer hstmt
80851>>>>>>>        Local Integer iFetchResult
80851>>>>>>>
80851>>>>>>>        If (Num_Arguments < 3) ;            Move "" To sPassWord
80854>>>>>>>        If (Num_Arguments < 2) ;            Move "" To sUser
80857>>>>>>>
80857>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") To sConnect
80860>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") To sConnect
80862>>>>>>>
80862>>>>>>>        Object oEnumDBSQLmanager Is A cSQLHandleManager
80864>>>>>>>            Move Current_Object To hoSQL
80865>>>>>>>        End_Object // oEnumDBSQLManager
80866>>>>>>>
80866>>>>>>>        If (hoSQL <> 0) Begin
80868>>>>>>>            Get SQLConnect Of hoSQL "MSSQLDRV" sConnect To hdbc
80869>>>>>>>            If (hdbc <> 0) Begin
80871>>>>>>>                Get SQLOpen Of hdbc To hstmt
80872>>>>>>>                If (hstmt <> 0) Begin
80874>>>>>>>                    //*** We could do a direct select on the sysdatabases table but we use
80874>>>>>>>                    //*** the stored procedure sp_database instead. SQL Server recommends this
80874>>>>>>>                    //*** approach in case meta data might change, the stored procedure will
80874>>>>>>>                    //*** stay the same.
80874>>>>>>>                    Send SQLSetProcedureName To hstmt "sp_databases"
80875>>>>>>>                    Send SQLCall To hstmt
80876>>>>>>>                    Repeat
80876>>>>>>>>
80876>>>>>>>                        Get SQLFetch Of hstmt To iFetchResult
80877>>>>>>>                        If (iFetchResult <> 0) Begin
80879>>>>>>>                            Get SQLColumnValue Of hstmt 1 To sDatabase
80880>>>>>>>                            Set Value Item (Item_Count(Current_Object)) To sDatabase
80881>>>>>>>                        End
80881>>>>>>>>
80881>>>>>>>                    Until (iFetchResult = 0)
80883>>>>>>>
80883>>>>>>>                    Send SQLClose To hstmt
80884>>>>>>>                End
80884>>>>>>>>
80884>>>>>>>                Send SQLDisconnect To hdbc
80885>>>>>>>            End
80885>>>>>>>>
80885>>>>>>>        End
80885>>>>>>>>
80885>>>>>>>        Send Destroy_Object To hoSQL
80886>>>>>>>
80886>>>>>>>        Function_return (Item_Count(Current_Object))
80887>>>>>>>    End_Function // EnumerateDatabases
80888>>>>>>>
80888>>>>>>>
80888>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
80890>>>>>>>        
80890>>>>>>>        Local String  sSqlServerClientVersionName
80890>>>>>>>        
80890>>>>>>>            
80890>>>>>>>        Case Begin
80890>>>>>>>
80890>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
80892>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
80893>>>>>>>                Case Break
80894>>>>>>>
80894>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
80897>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
80898>>>>>>>                Case Break
80899>>>>>>>        
80899>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
80902>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
80903>>>>>>>                Case Break
80904>>>>>>>
80904>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
80907>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
80908>>>>>>>                Case Break
80909>>>>>>>
80909>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
80912>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
80913>>>>>>>                Case Break
80914>>>>>>>        
80914>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
80917>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
80918>>>>>>>                Case Break
80919>>>>>>>        
80919>>>>>>>            Case Else
80919>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
80920>>>>>>>        
80920>>>>>>>        Case End
80920>>>>>>>    
80920>>>>>>>        
80920>>>>>>>        Function_Return sSqlServerClientVersionName
80921>>>>>>>        
80921>>>>>>>    End_Function
80922>>>>>>>
80922>>>>>>>
80922>>>>>>>End_Class // cMSSQLHandler
80923>>>>>>>
80923>>>>>
80923>>>>>
80923>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
80924>>>>>
80924>>>>>Register_Function phoWorkspace Returns Handle
80924>>>>>Register_Function Help_filename Returns String
80924>>>>>Register_Function GetHelpFile Returns String
80924>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
80924>>>>>
80924>>>>>//****************************************************************************
80924>>>>>// $Module type: FUNCTION
80924>>>>>// $Module name: Network_User_Name
80924>>>>>// $Author     : AK/VOO/KCR
80924>>>>>// Created     : 09-24-96 @ 19:17
80924>>>>>//
80924>>>>>// Description
80924>>>>>//    This function reads the current username Of windows and returns that
80924>>>>>//    name or an text unknown user
80924>>>>>//
80924>>>>>// $Rev History
80924>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
80924>>>>>//  07/25/2003  Replaced obsolete code
80924>>>>>//  09/24/1996  Module header created
80924>>>>>//****************************************************************************
80924>>>>>Function Network_User_Name for cDesktop Returns String
80926>>>>>    String sName
80926>>>>>    Integer iRetval iLength
80926>>>>>
80926>>>>>    Move 0 to iLength
80927>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
80928>>>>>    ZeroString iLength to sName
80929>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
80930>>>>>
80930>>>>>    If (iRetval = NO_ERROR) Begin
80932>>>>>        Function_Return (CString (sName))
80933>>>>>    End
80933>>>>>>
80933>>>>>    
80933>>>>>    Function_Return "User Unknown"
80934>>>>>End_Function
80935>>>>>
80935>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
80935>>>>>Type MEMORYSTATUS
80935>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
80935>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
80935>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
80935>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
80935>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
80935>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
80935>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
80935>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
80935>>>>>End_Type // MEMORYSTATUS
80935>>>>>
80935>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
80936>>>>>
80936>>>>>Struct tWinMemoryStatusEx
80936>>>>>    UInteger dwLength                
80936>>>>>    UInteger dwMemoryLoad          
80936>>>>>    UBigInt ullTotalPhys           
80936>>>>>    UBigInt ullAvailPhys           
80936>>>>>    UBigInt ullTotalPageFile       
80936>>>>>    UBigInt ullAvailPageFile       
80936>>>>>    UBigInt ullTotalVirtual        
80936>>>>>    UBigInt ullAvailVirtual        
80936>>>>>    UBigInt ullAvailExtendedVirtual
80936>>>>>End_Struct
80936>>>>>
80936>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
80937>>>>>
80937>>>>>Class SysinfoDisplay is a cTextEdit
80938>>>>>    Procedure Construct_Object
80940>>>>>        Forward Send Construct_Object
80942>>>>>
80942>>>>>        Set Location To 6 6
80943>>>>>        Set Size To 110 255
80944>>>>>        Set Read_Only_State To True
80945>>>>>        Set pbWrap to False
80946>>>>>    End_Procedure
80947>>>>>
80947>>>>>    //****************************************************************************
80947>>>>>    // $Module type: PROCEDURE
80947>>>>>    // $Module name: Show_Current_Directory
80947>>>>>    // $Author     : VOO
80947>>>>>    // Created     : 06-10-96 @ 15:24
80947>>>>>    //
80947>>>>>    // Description
80947>>>>>    //    This method will show the name Of the current directory in the system
80947>>>>>    //    information box
80947>>>>>    //
80947>>>>>    // $Rev History
80947>>>>>    //    06-10-96  Module header created
80947>>>>>    //****************************************************************************
80947>>>>>    Procedure Show_Current_Directory
80949>>>>>        String sDir
80949>>>>>
80949>>>>>        Get_Current_Directory To sDir
80950>>>>>
80950>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
80951>>>>>    End_Procedure
80952>>>>>
80952>>>>>    Procedure Show_Windows_Directory
80954>>>>>        String sWindir
80954>>>>>
80954>>>>>        Get_Windows_Directory To sWindir
80955>>>>>
80955>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
80956>>>>>    End_Procedure
80957>>>>>
80957>>>>>    Procedure Show_Current_User
80959>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
80960>>>>>    End_Procedure
80961>>>>>
80961>>>>>    Procedure Show_Number_Format
80963>>>>>        Integer iFormat
80963>>>>>        String sFormatText
80963>>>>>
80963>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
80966>>>>>        Move (Character (iFormat)) To sFormatText
80967>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
80968>>>>>
80968>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
80971>>>>>        Move (Character (iFormat)) to sFormatText
80972>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
80973>>>>>    End_Procedure
80974>>>>>
80974>>>>>    Procedure Show_Filelist_Name
80976>>>>>        String sFilename
80976>>>>>
80976>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
80979>>>>>
80979>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
80980>>>>>        Send AppendTextLn ""
80981>>>>>    End_Procedure
80982>>>>>
80982>>>>>    Procedure Show_Lock_Delay
80984>>>>>        Integer iLockdelay
80984>>>>>
80984>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
80987>>>>>
80987>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
80988>>>>>    End_Procedure
80989>>>>>
80989>>>>>    Procedure Show_Lock_Timeout
80991>>>>>        Integer iLockTimeout
80991>>>>>
80991>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
80994>>>>>
80994>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
80995>>>>>    End_Procedure
80996>>>>>
80996>>>>>    Procedure Show_Screen_Size
80998>>>>>        Integer iYscreensize iXscreensize
80998>>>>>
80998>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
80999>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
81000>>>>>
81000>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
81001>>>>>    End_Procedure
81002>>>>>
81002>>>>>    Procedure Show_Page_Size
81004>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
81005>>>>>    End_procedure
81006>>>>>
81006>>>>>    Procedure Show_Date
81008>>>>>        Date dToday
81008>>>>>
81008>>>>>        Sysdate dToday
81009>>>>>
81009>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
81010>>>>>    End_procedure
81011>>>>>
81011>>>>>    Procedure Show_Date_Format
81013>>>>>        Integer iDateFormat
81013>>>>>        String sDateFormat
81013>>>>>
81013>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
81016>>>>>        Case Begin
81016>>>>>            Case (iDateFormat = DF_DATE_USA)
81018>>>>>                Move C_$USA To sDateFormat
81019>>>>>                Case Break
81020>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
81023>>>>>                Move C_$European To sDateFormat
81024>>>>>                Case Break
81025>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
81028>>>>>                Move C_$Military To sDateFormat
81029>>>>>                Case Break
81030>>>>>            Case Else
81030>>>>>                Move C_$UnknownDateType To sDateFormat
81031>>>>>                Case Break
81032>>>>>        Case End
81032>>>>>
81032>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
81033>>>>>    End_Procedure
81034>>>>>
81034>>>>>    Procedure Show_Systemresources
81036>>>>>        tWinMemoryStatusEx MemoryStatusInfo
81036>>>>>        tWinMemoryStatusEx MemoryStatusInfo
81036>>>>>        Integer iRetval
81036>>>>>
81036>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
81037>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
81038>>>>>        If (iRetval = 0) Begin
81040>>>>>            Move (ShowLastError ()) to iRetval
81041>>>>>        End
81041>>>>>>
81041>>>>>
81041>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
81042>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
81043>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
81044>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
81045>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
81046>>>>>    End_Procedure
81047>>>>>
81047>>>>>    Procedure Show_Registration
81049>>>>>        String sRegName
81049>>>>>        Integer iSN iMaxUsers
81049>>>>>
81049>>>>>        Registration sRegName iSN
81050>>>>>>
81050>>>>>        
81050>>>>>        Get_Licensed_Max_Users to iMaxUsers
81051>>>>>
81051>>>>>        Send AppendTextLn ""
81052>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
81053>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
81054>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
81055>>>>>    End_Procedure
81056>>>>>
81056>>>>>    //****************************************************************************
81056>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
81056>>>>>    // To the workspace object passing the an object and message To send back
81056>>>>>    // To this object. It is expected that the workspace object will send this
81056>>>>>    // message for every line Of information it wants displayed (passing the
81056>>>>>    // information To be displayed
81056>>>>>    //****************************************************************************
81056>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
81056>>>>>
81056>>>>>    Procedure Show_ServicePack
81058>>>>>        String sKey sVersionDescription sVersion 
81058>>>>>        Handle hoRegistry
81058>>>>>        Boolean bExists bOpened
81058>>>>>        
81058>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
81059>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
81060>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
81061>>>>>
81061>>>>>        Move C_DFVersionRegistryRoot to sKey
81062>>>>>        Get KeyExists of hoRegistry sKey to bExists
81063>>>>>        If (bExists) Begin
81065>>>>>            Get OpenKey of hoRegistry sKey to bOpened
81066>>>>>            If (bOpened) Begin
81068>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
81069>>>>>                If (bExists) Begin
81071>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
81072>>>>>                End
81072>>>>>>
81072>>>>>                
81072>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
81073>>>>>                If (bExists) Begin
81075>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
81076>>>>>                End                
81076>>>>>>
81076>>>>>                Send CloseKey of hoRegistry
81077>>>>>            End
81077>>>>>>
81077>>>>>        End
81077>>>>>>
81077>>>>>        Send Destroy of hoRegistry
81078>>>>>
81078>>>>>        If (sVersionDescription <> "") Begin
81080>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
81081>>>>>           Send AppendTextLn ""
81082>>>>>        End
81082>>>>>>
81082>>>>>    End_Procedure
81083>>>>>    
81083>>>>>
81083>>>>>    Procedure Show_WorkspaceInformation
81085>>>>>        Integer hoWorkspace
81085>>>>>
81085>>>>>        If (ghoApplication <> 0) Begin
81087>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
81088>>>>>            If (hoWorkspace <> 0) Begin
81090>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
81091>>>>>                Send AppendTextLn ""
81092>>>>>            End
81092>>>>>>
81092>>>>>        End
81092>>>>>>
81092>>>>>    End_Procedure
81093>>>>>
81093>>>>>    //****************************************************************************
81093>>>>>    // If connection ids are used, we will send the message EnumerateConnections
81093>>>>>    // to the connection manager object passing the an object and message to send 
81093>>>>>    // back to this object. It is expected that the connection manager object will 
81093>>>>>    // send this message for every line Of information it wants displayed (passing 
81093>>>>>    // the information To be displayed
81093>>>>>    //****************************************************************************
81093>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
81093>>>>>
81093>>>>>    Procedure Show_ConnectionIdInformation
81095>>>>>        If (ghoConnection > 0) Begin
81097>>>>>            Send AppendTextLn ""
81098>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
81099>>>>>        End
81099>>>>>>
81099>>>>>    End_Procedure
81100>>>>>
81100>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
81102>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
81103>>>>>    End_Function
81104>>>>>
81104>>>>>    Procedure Show_Versions
81106>>>>>        Integer iVersion iRevision iBuild
81106>>>>>
81106>>>>>        Version_Information iVersion iRevision iBuild
81108>>>>>
81108>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
81109>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
81110>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
81111>>>>>    End_Procedure
81112>>>>>    
81112>>>>>    Function CKRevisionNumber String sDriverID Returns String
81114>>>>>        Handle hoCLIHandler
81114>>>>>        Handle hoDFBtrDrvHandler
81114>>>>>        String sCKRevision
81114>>>>>
81114>>>>>
81114>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
81116>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
81117>>>>>            Set psDriverID of hoCLIHandler to sDriverID
81118>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
81119>>>>>            Send Destroy of hoCLIHandler
81120>>>>>        End
81120>>>>>>
81120>>>>>        Else Begin
81121>>>>>            If (sDriverID = "DFBTRDRV") Begin
81123>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
81124>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
81125>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
81126>>>>>                Send Destroy of hoDFBtrDrvHandler
81127>>>>>            End
81127>>>>>>
81127>>>>>        End
81127>>>>>>
81127>>>>>        
81127>>>>>        Function_Return sCKRevision
81128>>>>>    End_Function
81129>>>>>    
81129>>>>>    
81129>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
81131>>>>>        
81131>>>>>        If (sDriverID = "DATAFLEX") Begin
81133>>>>>            Function_Return False
81134>>>>>        End
81134>>>>>>
81134>>>>>    
81134>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
81135>>>>>    End_Function    
81136>>>>>
81136>>>>>
81136>>>>>    //***
81136>>>>>    //*** BW
81136>>>>>    //*** Procedure: Show_Drivers
81136>>>>>    //*** Purpose  : Show loaded database drivers
81136>>>>>    //***
81136>>>>>
81136>>>>>    Procedure Show_Drivers
81138>>>>>        String sCurrentDriver sRevNumber
81138>>>>>        String sLoadedDrivers sClientDriver
81138>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
81138>>>>>        Boolean bOK 
81138>>>>>        Handle hoMsqlDrv
81138>>>>>
81138>>>>>        Move "" To sLoadedDrivers
81139>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
81142>>>>>        For iCount from 1 to iNumberOfDrivers
81148>>>>>>
81148>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
81151>>>>>            If (sLoadedDrivers <> "") Begin
81153>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
81154>>>>>            End
81154>>>>>>
81154>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
81155>>>>>            If (bOK) Begin
81157>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
81159>>>>>                    Move iCount to iMSSQLIndex
81160>>>>>                End
81160>>>>>>
81160>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
81161>>>>>                // if mssqldrv, show the client number
81161>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
81162>>>>>            End
81162>>>>>>
81162>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
81163>>>>>        Loop
81164>>>>>>
81164>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
81165>>>>>        If (iMSSQLIndex>0) Begin
81167>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
81170>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
81171>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
81172>>>>>            Send Destroy of hoMsqlDrv
81173>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
81174>>>>>        End
81174>>>>>>
81174>>>>>    End_Procedure
81175>>>>>
81175>>>>>    Procedure Show_HelpFile
81177>>>>>        String sHelpFile
81177>>>>>        Integer eHelpType
81177>>>>>
81177>>>>>        If (ghoApplication <> 0) Begin
81179>>>>>            Get peHelpType Of ghoApplication To eHelpType
81180>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
81182>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
81183>>>>>            End
81183>>>>>>
81183>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
81186>>>>>                Get Help_filename Of Help_object_id To sHelpFile
81187>>>>>            End
81187>>>>>>
81187>>>>>            Else Begin
81188>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
81189>>>>>            End
81189>>>>>>
81189>>>>>
81189>>>>>            Send AppendTextLn ""
81190>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
81191>>>>>        End
81191>>>>>>
81191>>>>>    End_Procedure
81192>>>>>
81192>>>>>    Procedure Show_EnterAsTab
81194>>>>>        Boolean bEnterKeyAsTabKey
81194>>>>>        String sText
81194>>>>>
81194>>>>>        If (ghoApplication <> 0) Begin
81196>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
81197>>>>>            If (bEnterKeyAsTabKey) Begin
81199>>>>>                Move "True" To sText
81200>>>>>            End
81200>>>>>>
81200>>>>>            Else Begin
81201>>>>>                Move "False" To sText
81202>>>>>            End
81202>>>>>>
81202>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
81203>>>>>        End
81203>>>>>>
81203>>>>>    End_Procedure
81204>>>>>
81204>>>>>    //****************************************************************************
81204>>>>>    // $Module type: PROCEDURE
81204>>>>>    // $Module name: Add_Focus
81204>>>>>    // $Author     : VOO
81204>>>>>    // Created     : 24-09-96 @ 19:43
81204>>>>>    //
81204>>>>>    // Description
81204>>>>>    //    During activation we will remove the old information and add the newly
81204>>>>>    //    found systeminformation
81204>>>>>    //
81204>>>>>    // $Rev History
81204>>>>>    //    24-09-96  Module header created
81204>>>>>    //****************************************************************************
81204>>>>>    Procedure Add_Focus Integer hoRoot
81206>>>>>        Forward Send Add_Focus hoRoot
81208>>>>>
81208>>>>>        Send Delete_Data
81209>>>>>
81209>>>>>        Set Changed_State To False
81210>>>>>        Set Read_Only_State To True
81211>>>>>
81211>>>>>        Send Show_ServicePack
81212>>>>>        Send Show_Versions   
81213>>>>>        Send Show_Drivers         
81214>>>>>        If (ghoConnection <> 0) Begin
81216>>>>>            Send Show_ConnectionIdInformation
81217>>>>>        End
81217>>>>>>
81217>>>>>        Send Show_HelpFile
81218>>>>>        Send Show_Current_Directory
81219>>>>>        Send Show_Filelist_Name          
81220>>>>>        If (ghoApplication <> 0) Begin
81222>>>>>            Send Show_WorkSpaceInformation // added To show WS info
81223>>>>>        End
81223>>>>>>
81223>>>>>        Send Show_Current_User 
81224>>>>>        Send Show_Windows_Directory 
81225>>>>>        Send Show_Screen_Size
81226>>>>>        Send Show_Page_Size
81227>>>>>        Send Show_EnterAsTab        
81228>>>>>        Send Show_Number_Format
81229>>>>>        Send Show_Date_Format
81230>>>>>        Send Show_Lock_Delay
81231>>>>>        Send Show_Lock_Timeout
81232>>>>>        Send Show_Date
81233>>>>>        Send Show_Systemresources
81234>>>>>        Send Show_Registration
81235>>>>>        Send Beginning_of_Data
81236>>>>>
81236>>>>>        Set Icon to 'default.ico'
81237>>>>>    End_Procedure
81238>>>>>End_Class
81239>>>>>
81239>>>>>//****************************************************************************
81239>>>>>// $Module type: OBJECT
81239>>>>>// $Module name: Sysinfo_Dialog
81239>>>>>// $Author     : VOO
81239>>>>>// Created     : 24-09-96 @ 18:47
81239>>>>>//
81239>>>>>// Description
81239>>>>>//    This object shows the systeminformation on the screen
81239>>>>>//
81239>>>>>// $Rev History
81239>>>>>//    24-09-96  Module header created
81239>>>>>//****************************************************************************
81239>>>>>Class SysInfoDialog Is A ModalPanel
81240>>>>>    Procedure Construct_Object
81242>>>>>        Forward Send Construct_Object
81244>>>>>
81244>>>>>        Set Label to C_$SystemInformation
81245>>>>>        Set Size to 140 267
81246>>>>>        Set piMinSize to 140 267
81247>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
81248>>>>>        Set Border_Style to Border_Thick
81249>>>>>
81249>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
81251>>>>>            Set peAnchors to anAll
81252>>>>>        End_Object
81253>>>>>
81253>>>>>        Object oCloseButton Is A Button
81255>>>>>            Set Label To C_$Close
81256>>>>>            Set Location To 120 210
81257>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
81258>>>>>            Set Default_State To True
81259>>>>>            Set peAnchors to anBottomRight
81260>>>>>        End_Object
81261>>>>>
81261>>>>>        On_Key kCancel Send Close_Panel
81262>>>>>    End_Procedure
81263>>>>>End_Class
81264>>>>>
81264>>>>>// Purpose:
81264>>>>>//
81264>>>>>// Ken Ross 12/17/96 5:16PM
81264>>>>>//
81264>>>>>Class AboutDialog Is A ModalPanel
81265>>>>>    Procedure Construct_Object
81267>>>>>        String sVdfRootDir
81267>>>>>
81267>>>>>        Forward Send Construct_Object
81269>>>>>
81269>>>>>        Set Label To C_$About
81270>>>>>        Set Size to 89 212
81271>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
81272>>>>>
81272>>>>>        Object oSysInfoDialog Is A SysInfoDialog
81274>>>>>        End_Object
81275>>>>>
81275>>>>>        Object oBox Is A Container3d
81277>>>>>            Set Border_Style To Border_StaticEdge
81278>>>>>            Set Size to 63 202
81279>>>>>            Set Location To 4 5
81280>>>>>
81280>>>>>            Object oAboutGraphic Is A BitmapContainer
81282>>>>>                Set Border_Style To Border_None
81283>>>>>                Set Bitmap_Style To Bitmap_Center
81284>>>>>                Set Size To 48 48
81285>>>>>                Set Location To 7 2
81286>>>>>            End_Object
81287>>>>>
81287>>>>>            Object oProductName Is A TextBox
81289>>>>>                Set Label To C_$ProductName
81290>>>>>                Set Size To 10 45
81291>>>>>                Set Location To 8 53
81292>>>>>            End_Object
81293>>>>>
81293>>>>>            Object oVersion Is A TextBox
81295>>>>>                Set Label To C_$Version
81296>>>>>                Set Size To 10 25
81297>>>>>                Set Location To 21 53
81298>>>>>            End_Object
81299>>>>>
81299>>>>>            Object oCopyright Is A TextBox
81301>>>>>                Set Label To C_$Copyright
81302>>>>>                Set Size To 10 31
81303>>>>>                Set Location To 34 53
81304>>>>>            End_Object
81305>>>>>
81305>>>>>            Object oAuthor Is A TextBox
81307>>>>>                Set Label To C_$Author
81308>>>>>                Set Size To 10 22
81309>>>>>                Set Location To 46 53
81310>>>>>            End_Object
81311>>>>>        End_Object
81312>>>>>
81312>>>>>        Object oOKButton Is A Button
81314>>>>>            On_Item C_$OK Send Close_Panel
81315>>>>>            Set Size To 14 50
81316>>>>>            Set Location To 71 157
81317>>>>>        End_Object
81318>>>>>
81318>>>>>        Object oSysInfoButton Is A Button
81320>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
81321>>>>>            Set Size To 14 50
81322>>>>>            Set Location To 71 101
81323>>>>>        End_Object
81324>>>>>
81324>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
81325>>>>>
81325>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
81326>>>>>    End_Procedure
81327>>>>>
81327>>>>>    Procedure Set ProductName String sProductName
81329>>>>>        Set Label Of oProductName To sProductName
81330>>>>>    End_Procedure
81331>>>>>
81331>>>>>    Procedure Set Version String sVersion
81333>>>>>        Set Label Of oVersion To sVersion
81334>>>>>    End_Procedure
81335>>>>>
81335>>>>>    Procedure Set Copyright string sCopyright
81337>>>>>        Set Label Of oCopyright To sCopyright
81338>>>>>    End_Procedure
81339>>>>>
81339>>>>>    Procedure Set Author String sAuthor
81341>>>>>        Set Label Of oAuthor To sAuthor
81342>>>>>    End_Procedure
81343>>>>>
81343>>>>>    Procedure Set Logo string sLogo
81345>>>>>        // square bitmaps Of 42x42 work best
81345>>>>>        Set Bitmap Of oAboutGraphic To sLogo
81346>>>>>    End_Procedure
81347>>>>>
81347>>>>>    Procedure Show_Sysinfo
81349>>>>>        Send Popup_Modal Of oSysinfoDialog
81350>>>>>    End_Procedure
81351>>>>>
81351>>>>>    Procedure End_Construct_Object
81353>>>>>        Handle hoVersionInfo
81353>>>>>        Boolean bIncluded
81353>>>>>        Integer iMajor iMinor iRelease iBuild
81353>>>>>        String sLabel
81353>>>>>
81353>>>>>        Get Label Of oVersion To sLabel
81354>>>>>        If (sLabel = C_$VERSION) Begin
81356>>>>>            // set it To the version info Of the program, if available
81356>>>>>            If (ghoApplication <> 0) Begin
81358>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
81359>>>>>                If (hoVersionInfo <> 0) Begin
81361>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
81362>>>>>                    If (bIncluded) Begin
81364>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
81365>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
81366>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
81367>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
81368>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
81369>>>>>                        Set Version to sLabel
81370>>>>>                    End
81370>>>>>>
81370>>>>>                End
81370>>>>>>
81370>>>>>            End
81370>>>>>>
81370>>>>>        End
81370>>>>>>
81370>>>>>
81370>>>>>        Forward Send End_Construct_Object
81372>>>>>    End_Procedure
81373>>>>>End_Class
81374>>>
81374>>>// *************************************************************************
81374>>>//  Public message. This is the default message. It is expected that you will
81374>>>//   create your own message to override this
81374>>>// *************************************************************************
81374>>>
81374>>>Procedure Activate_About
81377>>>   Send DoAbout "" "" "" "" ""
81378>>>End_Procedure
81379>>>
81379>>>// *************************************************************************
81379>>>//  Public message. It is expected that you will send this message (most
81379>>>//  likely from Activate_About. This creates an about object, activates it
81379>>>//  and destroys it when done. It is not exepected that you will augment this.
81379>>>// *************************************************************************
81379>>>
81379>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
81382>>>        integer hoObj hoMain
81382>>>
81382>>>        // create object
81382>>>        Object About is an AboutDialog
81384>>>            // if no title passed use the label of the main panel
81384>>>            // (if a main panel exists).
81384>>>            if sTitle     eq '' Begin
81386>>>                Get Main_Window of desktop to hoMain
81387>>>                if hoMain Get Label of hoMain to sTitle
81390>>>            end
81390>>>>
81390>>>            set productname to sTitle
81391>>>            set version     to sVersion
81392>>>            set copyright   to sCopyRight
81393>>>            set author      to sAuthor
81394>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
81397>>>            Move self to hoObj // object Id
81398>>>        End_Object
81399>>>        Send Popup   of hoObj    // popup the about object
81400>>>        Send Destroy of hoObj // when done, it will be destroyed
81401>>>End_procedure
81402>        Use Auto.vw
Including file: Auto.vw    (C:\Repos\DataFlexBeadando\AppSrc\Auto.vw)
81402>>>// C:\Repos\DataFlexBeadando\AppSrc\Auto.vw
81402>>>// Auto
81402>>>//
81402>>>
81402>>>Use DFClient.pkg
81402>>>Use DFEntry.pkg
81402>>>
81402>>>Use cAutoDataDictionary.dd
Including file: cAutoDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cAutoDataDictionary.dd)
81402>>>>>Use DataDict.pkg
81402>>>>>
81402>>>>>Open Auto
Including file: Auto.fd    (C:\Repos\DataFlexBeadando\DDSrc\Auto.fd)
81404>>>>>Open Munkalap
Including file: Munkalap.fd    (C:\Repos\DataFlexBeadando\DDSrc\Munkalap.fd)
81406>>>>>
81406>>>>>Register_Object Auto_sl
81406>>>>>
81406>>>>>Class cAutoDataDictionary is a DataDictionary
81407>>>>>    
81407>>>>>    Procedure Construct_Object
81409>>>>>        Forward Send Construct_Object
81411>>>>>        Set Main_File to Auto.File_Number
81412>>>>>
81412>>>>>        Set Add_Client_File to Munkalap.File_Number
81413>>>>>
81413>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81414>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81415>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81416>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81417>>>>>
81417>>>>>        Set Field_Label_Long Field Auto.Id to "Azonost"
81418>>>>>        Set Field_Label_Short Field Auto.Id to "Azon."
81419>>>>>        Set Field_Prompt_Object Field Auto.Id to Auto_sl
81420>>>>>
81420>>>>>        Set Field_Label_Long Field Auto.Alvazszam to "Alvzszm"
81421>>>>>        Set Field_Label_Short Field Auto.Alvazszam to "Alv."
81422>>>>>        Set Field_Prompt_Object Field Auto.Alvazszam to Auto_sl
81423>>>>>
81423>>>>>        Set Field_Label_Long Field Auto.Motorszam to "Motorszm"
81424>>>>>        Set Field_Label_Short Field Auto.Motorszam to "Motorsz."
81425>>>>>        Set Field_Prompt_Object Field Auto.Motorszam to Auto_sl
81426>>>>>
81426>>>>>        Set Field_Label_Long Field Auto.Marka to "Mrka"
81427>>>>>        Set Field_Label_Short Field Auto.Marka to "Mrka"
81428>>>>>
81428>>>>>        Set Field_Label_Long Field Auto.Tipus to "Tipus"
81429>>>>>        Set Field_Label_Short Field Auto.Tipus to "Tipus"
81430>>>>>
81430>>>>>        Set Field_Label_Long Field Auto.Evjarat to "Evjarat"
81431>>>>>        Set Field_Label_Short Field Auto.Evjarat to "Evj,"
81432>>>>>
81432>>>>>        Set Field_Label_Long Field Auto.UtolsoSzerviz to "Utols szervz"
81433>>>>>        Set Field_Label_Short Field Auto.UtolsoSzerviz to "Utol. szv."
81434>>>>>
81434>>>>>        Set Field_Label_Long Field Auto.KmAllas to "Kilmter lls"
81435>>>>>        Set Field_Label_Short Field Auto.KmAllas to "Km ll."
81436>>>>>
81436>>>>>    End_Procedure
81437>>>>>
81437>>>>>End_Class
81438>>>>>
81438>>>>>Use Auto.sl
Including file: Auto.sl    (C:\Repos\DataFlexBeadando\AppSrc\Auto.sl)
81438>>>>>>>// Auto.sl
81438>>>>>>>// Auto Lookup List
81438>>>>>>>
81438>>>>>>>Use DFClient.pkg
81438>>>>>>>Use cDbCJGridPromptList.pkg
81438>>>>>>>Use cDbCJGridColumn.pkg
81438>>>>>>>Use Windows.pkg
81438>>>>>>>
81438>>>>>>>Use cAutoDataDictionary.dd
81438>>>>>>>
81438>>>>>>>CD_Popup_Object Auto_sl is a dbModalPanel
81456>>>>>>>>
81456>>>>>>>    Set Location to 5 5
81457>>>>>>>    Set Size to 134 610
81458>>>>>>>    Set Label To "Auto Lookup List"
81459>>>>>>>    Set Border_Style to Border_Thick
81460>>>>>>>    Set Minimize_Icon to False
81461>>>>>>>
81461>>>>>>>
81461>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
81463>>>>>>>    End_Object 
81464>>>>>>>
81464>>>>>>>    Set Main_DD To oAuto_DD
81465>>>>>>>    Set Server  To oAuto_DD
81466>>>>>>>
81466>>>>>>>
81466>>>>>>>
81466>>>>>>>    Object oSelList is a cDbCJGridPromptList
81468>>>>>>>        Set Size to 105 600
81469>>>>>>>        Set Location to 5 5
81470>>>>>>>        Set peAnchors to anAll
81471>>>>>>>        Set psLayoutSection to "Auto_sl_oSelList"
81472>>>>>>>        Set Ordering to 1
81473>>>>>>>        Set pbAutoServer to True
81474>>>>>>>
81474>>>>>>>        Object oAuto_Id is a cDbCJGridColumn
81476>>>>>>>            Entry_Item Auto.Id
81477>>>>>>>            Set piWidth to 63
81478>>>>>>>            Set psCaption to "Azon."
81479>>>>>>>        End_Object 
81480>>>>>>>
81480>>>>>>>        Object oAuto_Alvazszam is a cDbCJGridColumn
81482>>>>>>>            Entry_Item Auto.Alvazszam
81483>>>>>>>            Set piWidth to 210
81484>>>>>>>            Set psCaption to "Alv."
81485>>>>>>>        End_Object 
81486>>>>>>>
81486>>>>>>>        Object oAuto_Motorszam is a cDbCJGridColumn
81488>>>>>>>            Entry_Item Auto.Motorszam
81489>>>>>>>            Set piWidth to 210
81490>>>>>>>            Set psCaption to "Motorsz."
81491>>>>>>>        End_Object 
81492>>>>>>>
81492>>>>>>>        Object oAuto_Marka is a cDbCJGridColumn
81494>>>>>>>            Entry_Item Auto.Marka
81495>>>>>>>            Set piWidth to 210
81496>>>>>>>            Set psCaption to "Mrka"
81497>>>>>>>        End_Object 
81498>>>>>>>
81498>>>>>>>        Object oAuto_Tipus is a cDbCJGridColumn
81500>>>>>>>            Entry_Item Auto.Tipus
81501>>>>>>>            Set piWidth to 210
81502>>>>>>>            Set psCaption to "Tipus"
81503>>>>>>>        End_Object 
81504>>>>>>>
81504>>>>>>>        Object oAuto_Evjarat is a cDbCJGridColumn
81506>>>>>>>            Entry_Item Auto.Evjarat
81507>>>>>>>            Set piWidth to 49
81508>>>>>>>            Set psCaption to "Evj,"
81509>>>>>>>        End_Object 
81510>>>>>>>
81510>>>>>>>        Object oAuto_UtolsoSzerviz is a cDbCJGridColumn
81512>>>>>>>            Entry_Item Auto.UtolsoSzerviz
81513>>>>>>>            Set piWidth to 105
81514>>>>>>>            Set psCaption to "Utol. szv."
81515>>>>>>>        End_Object 
81516>>>>>>>
81516>>>>>>>        Object oAuto_KmAllas is a cDbCJGridColumn
81518>>>>>>>            Entry_Item Auto.KmAllas
81519>>>>>>>            Set piWidth to 105
81520>>>>>>>            Set psCaption to "Km ll."
81521>>>>>>>        End_Object 
81522>>>>>>>
81522>>>>>>>
81522>>>>>>>    End_Object 
81523>>>>>>>
81523>>>>>>>    Object oOk_bn is a Button
81525>>>>>>>        Set Label to "&Ok"
81526>>>>>>>        Set Location to 115 447
81527>>>>>>>        Set peAnchors to anBottomRight
81528>>>>>>>
81528>>>>>>>        Procedure OnClick
81531>>>>>>>            Send OK of oSelList
81532>>>>>>>        End_Procedure
81533>>>>>>>
81533>>>>>>>    End_Object 
81534>>>>>>>
81534>>>>>>>    Object oCancel_bn is a Button
81536>>>>>>>        Set Label to "&Cancel"
81537>>>>>>>        Set Location to 115 501
81538>>>>>>>        Set peAnchors to anBottomRight
81539>>>>>>>
81539>>>>>>>        Procedure OnClick
81542>>>>>>>            Send Cancel of oSelList
81543>>>>>>>        End_Procedure
81544>>>>>>>
81544>>>>>>>    End_Object 
81545>>>>>>>
81545>>>>>>>    Object oSearch_bn is a Button
81547>>>>>>>        Set Label to "&Search..."
81548>>>>>>>        Set Location to 115 555
81549>>>>>>>        Set peAnchors to anBottomRight
81550>>>>>>>
81550>>>>>>>        Procedure OnClick
81553>>>>>>>            Send Search of oSelList
81554>>>>>>>        End_Procedure
81555>>>>>>>
81555>>>>>>>    End_Object 
81556>>>>>>>
81556>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81557>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81558>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81559>>>>>>>
81559>>>>>>>
81559>>>>>>>CD_End_Object // Auto_sl
81561>>>>>>>>
81561>>>
81561>>>ACTIVATE_VIEW Activate_oAuto FOR oAuto
81571>>>>
81571>>>Object oAuto is a dbView
81573>>>    Set Location to 5 5
81574>>>    Set Size to 98 349
81575>>>    Set Label To "Auto"
81576>>>    Set Border_Style to Border_Thick
81577>>>
81577>>>
81577>>>    Object oAuto_DD is a cAutoDataDictionary
81579>>>    End_Object 
81580>>>
81580>>>    Set Main_DD To oAuto_DD
81581>>>    Set Server  To oAuto_DD
81582>>>
81582>>>
81582>>>
81582>>>    Object oAutoId is a dbForm
81584>>>        Entry_Item Auto.Id
81585>>>        Set Size to 13 42
81586>>>        Set Location to 5 51
81587>>>        Set peAnchors to anTopLeftRight
81588>>>        Set Label to "Azonost"
81589>>>        Set Label_Justification_mode to jMode_Left
81590>>>        Set Label_Col_Offset to 46
81591>>>        Set Label_row_Offset to 0
81592>>>    End_Object 
81593>>>
81593>>>    Object oAutoAlvazszam is a dbForm
81595>>>        Entry_Item Auto.Alvazszam
81596>>>        Set Size to 13 126
81597>>>        Set Location to 20 51
81598>>>        Set peAnchors to anTopLeftRight
81599>>>        Set Label to "Alvzszm"
81600>>>        Set Label_Justification_mode to jMode_Left
81601>>>        Set Label_Col_Offset to 46
81602>>>        Set Label_row_Offset to 0
81603>>>    End_Object 
81604>>>
81604>>>    Object oAutoMotorszam is a dbForm
81606>>>        Entry_Item Auto.Motorszam
81607>>>        Set Size to 13 126
81608>>>        Set Location to 20 218
81609>>>        Set peAnchors to anTopRight
81610>>>        Set Label to "Motorszm"
81611>>>        Set Label_Justification_mode to jMode_Left
81612>>>        Set Label_Col_Offset to 36
81613>>>        Set Label_row_Offset to 0
81614>>>    End_Object 
81615>>>
81615>>>    Object oAutoMarka is a dbForm
81617>>>        Entry_Item Auto.Marka
81618>>>        Set Size to 13 126
81619>>>        Set Location to 35 51
81620>>>        Set peAnchors to anTopLeftRight
81621>>>        Set Label to "Mrka"
81622>>>        Set Label_Justification_mode to jMode_Left
81623>>>        Set Label_Col_Offset to 46
81624>>>        Set Label_row_Offset to 0
81625>>>    End_Object 
81626>>>
81626>>>    Object oAutoTipus is a dbForm
81628>>>        Entry_Item Auto.Tipus
81629>>>        Set Size to 13 126
81630>>>        Set Location to 35 201
81631>>>        Set peAnchors to anTopRight
81632>>>        Set Label to "Tipus"
81633>>>        Set Label_Justification_mode to jMode_Left
81634>>>        Set Label_Col_Offset to 19
81635>>>        Set Label_row_Offset to 0
81636>>>    End_Object 
81637>>>
81637>>>    Object oAutoEvjarat is a dbForm
81639>>>        Entry_Item Auto.Evjarat
81640>>>        Set Size to 13 34
81641>>>        Set Location to 50 51
81642>>>        Set peAnchors to anTopLeftRight
81643>>>        Set Label to "Evjarat"
81644>>>        Set Label_Justification_mode to jMode_Left
81645>>>        Set Label_Col_Offset to 46
81646>>>        Set Label_row_Offset to 0
81647>>>    End_Object 
81648>>>
81648>>>    Object oAutoUtolsoSzerviz is a dbForm
81650>>>        Entry_Item Auto.UtolsoSzerviz
81651>>>        Set Size to 13 66
81652>>>        Set Location to 65 51
81653>>>        Set peAnchors to anTopLeftRight
81654>>>        Set Label to "Utols szervz"
81655>>>        Set Label_Justification_mode to jMode_Left
81656>>>        Set Label_Col_Offset to 46
81657>>>        Set Label_row_Offset to 0
81658>>>    End_Object 
81659>>>
81659>>>    Object oAutoKmAllas is a dbForm
81661>>>        Entry_Item Auto.KmAllas
81662>>>        Set Size to 13 66
81663>>>        Set Location to 80 51
81664>>>        Set peAnchors to anTopLeftRight
81665>>>        Set Label to "Kilmter lls"
81666>>>        Set Label_Justification_mode to jMode_Left
81667>>>        Set Label_Col_Offset to 46
81668>>>        Set Label_row_Offset to 0
81669>>>    End_Object 
81670>>>
81670>>>
81670>>>End_Object 
81671>        Use Munka.vw
Including file: Munka.vw    (C:\Repos\DataFlexBeadando\AppSrc\Munka.vw)
81671>>>// C:\Repos\DataFlexBeadando\AppSrc\Munka.vw
81671>>>// Munka
81671>>>//
81671>>>
81671>>>Use DFClient.pkg
81671>>>Use DFEntry.pkg
81671>>>
81671>>>Use cMunkaDataDictionary.dd
Including file: cMunkaDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkaDataDictionary.dd)
81671>>>>>Use DataDict.pkg
81671>>>>>
81671>>>>>Open Munka
Including file: Munka.fd    (C:\Repos\DataFlexBeadando\DDSrc\Munka.fd)
81673>>>>>Open MunkaMunkalap
Including file: MunkaMunkalap.fd    (C:\Repos\DataFlexBeadando\DDSrc\MunkaMunkalap.fd)
81675>>>>>
81675>>>>>Register_Object Munka_sl
81675>>>>>
81675>>>>>Class cMunkaDataDictionary is a DataDictionary
81676>>>>>    
81676>>>>>    Procedure Construct_Object
81678>>>>>        Forward Send Construct_Object
81680>>>>>        Set Main_File to Munka.File_Number
81681>>>>>
81681>>>>>        Set Add_Client_File to MunkaMunkalap.File_Number
81682>>>>>
81682>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81683>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81684>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81685>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81686>>>>>
81686>>>>>        Set Field_Label_Long Field Munka.Id to "Munka azonost"
81687>>>>>        Set Field_Label_Short Field Munka.Id to "Munka azon."
81688>>>>>        Set Field_Prompt_Object Field Munka.Id to Munka_sl
81689>>>>>
81689>>>>>        Set Field_Label_Long Field Munka.Name to "Nv"
81690>>>>>        Set Field_Label_Short Field Munka.Name to "Nv"
81691>>>>>        Set Field_Prompt_Object Field Munka.Name to Munka_sl
81692>>>>>
81692>>>>>        Set Field_Label_Long Field Munka.Leiras to "Lers"
81693>>>>>        Set Field_Label_Short Field Munka.Leiras to "Lers"
81694>>>>>
81694>>>>>        Set Field_Label_Long Field Munka.Egysegar to "Egysgr"
81695>>>>>        Set Field_Label_Short Field Munka.Egysegar to "Egysgr"
81696>>>>>
81696>>>>>    End_Procedure
81697>>>>>
81697>>>>>End_Class
81698>>>>>
81698>>>>>Use Munka.sl
Including file: Munka.sl    (C:\Repos\DataFlexBeadando\AppSrc\Munka.sl)
81698>>>>>>>// Munka.sl
81698>>>>>>>// Munka Lookup List
81698>>>>>>>
81698>>>>>>>Use DFClient.pkg
81698>>>>>>>Use cDbCJGridPromptList.pkg
81698>>>>>>>Use cDbCJGridColumn.pkg
81698>>>>>>>Use Windows.pkg
81698>>>>>>>
81698>>>>>>>Use cMunkaDataDictionary.dd
81698>>>>>>>
81698>>>>>>>CD_Popup_Object Munka_sl is a dbModalPanel
81716>>>>>>>>
81716>>>>>>>    Set Location to 5 5
81717>>>>>>>    Set Size to 134 309
81718>>>>>>>    Set Label To "Munka Lookup List"
81719>>>>>>>    Set Border_Style to Border_Thick
81720>>>>>>>    Set Minimize_Icon to False
81721>>>>>>>
81721>>>>>>>
81721>>>>>>>    Object oMunka_DD is a cMunkaDataDictionary
81723>>>>>>>    End_Object 
81724>>>>>>>
81724>>>>>>>    Set Main_DD To oMunka_DD
81725>>>>>>>    Set Server  To oMunka_DD
81726>>>>>>>
81726>>>>>>>
81726>>>>>>>
81726>>>>>>>    Object oSelList is a cDbCJGridPromptList
81728>>>>>>>        Set Size to 105 299
81729>>>>>>>        Set Location to 5 5
81730>>>>>>>        Set peAnchors to anAll
81731>>>>>>>        Set psLayoutSection to "Munka_sl_oSelList"
81732>>>>>>>        Set Ordering to 1
81733>>>>>>>        Set pbAutoServer to True
81734>>>>>>>
81734>>>>>>>        Object oMunka_Id is a cDbCJGridColumn
81736>>>>>>>            Entry_Item Munka.Id
81737>>>>>>>            Set piWidth to 85
81738>>>>>>>            Set psCaption to "Munka azon."
81739>>>>>>>        End_Object 
81740>>>>>>>
81740>>>>>>>        Object oMunka_Name is a cDbCJGridColumn
81742>>>>>>>            Entry_Item Munka.Name
81743>>>>>>>            Set piWidth to 210
81744>>>>>>>            Set psCaption to "Nv"
81745>>>>>>>        End_Object 
81746>>>>>>>
81746>>>>>>>        Object oMunka_Leiras is a cDbCJGridColumn
81748>>>>>>>            Entry_Item Munka.Leiras
81749>>>>>>>            Set piWidth to 105
81750>>>>>>>            Set psCaption to "Lers"
81751>>>>>>>        End_Object 
81752>>>>>>>
81752>>>>>>>        Object oMunka_Egysegar is a cDbCJGridColumn
81754>>>>>>>            Entry_Item Munka.Egysegar
81755>>>>>>>            Set piWidth to 105
81756>>>>>>>            Set psCaption to "Egysgr"
81757>>>>>>>        End_Object 
81758>>>>>>>
81758>>>>>>>
81758>>>>>>>    End_Object 
81759>>>>>>>
81759>>>>>>>    Object oOk_bn is a Button
81761>>>>>>>        Set Label to "&Ok"
81762>>>>>>>        Set Location to 115 146
81763>>>>>>>        Set peAnchors to anBottomRight
81764>>>>>>>
81764>>>>>>>        Procedure OnClick
81767>>>>>>>            Send OK of oSelList
81768>>>>>>>        End_Procedure
81769>>>>>>>
81769>>>>>>>    End_Object 
81770>>>>>>>
81770>>>>>>>    Object oCancel_bn is a Button
81772>>>>>>>        Set Label to "&Cancel"
81773>>>>>>>        Set Location to 115 200
81774>>>>>>>        Set peAnchors to anBottomRight
81775>>>>>>>
81775>>>>>>>        Procedure OnClick
81778>>>>>>>            Send Cancel of oSelList
81779>>>>>>>        End_Procedure
81780>>>>>>>
81780>>>>>>>    End_Object 
81781>>>>>>>
81781>>>>>>>    Object oSearch_bn is a Button
81783>>>>>>>        Set Label to "&Search..."
81784>>>>>>>        Set Location to 115 254
81785>>>>>>>        Set peAnchors to anBottomRight
81786>>>>>>>
81786>>>>>>>        Procedure OnClick
81789>>>>>>>            Send Search of oSelList
81790>>>>>>>        End_Procedure
81791>>>>>>>
81791>>>>>>>    End_Object 
81792>>>>>>>
81792>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
81793>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
81794>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
81795>>>>>>>
81795>>>>>>>
81795>>>>>>>CD_End_Object // Munka_sl
81797>>>>>>>>
81797>>>
81797>>>ACTIVATE_VIEW Activate_oMunka FOR oMunka
81807>>>>
81807>>>Object oMunka is a dbView
81809>>>    Set Location to 5 5
81810>>>    Set Size to 38 251
81811>>>    Set Label To "Munka"
81812>>>    Set Border_Style to Border_Thick
81813>>>
81813>>>
81813>>>    Object oMunka_DD is a cMunkaDataDictionary
81815>>>    End_Object 
81816>>>
81816>>>    Set Main_DD To oMunka_DD
81817>>>    Set Server  To oMunka_DD
81818>>>
81818>>>
81818>>>
81818>>>    Object oMunkaId is a dbForm
81820>>>        Entry_Item Munka.Id
81821>>>        Set Size to 13 42
81822>>>        Set Location to 5 59
81823>>>        Set peAnchors to anTopLeftRight
81824>>>        Set Label to "Munka azonost"
81825>>>        Set Label_Justification_mode to jMode_Left
81826>>>        Set Label_Col_Offset to 54
81827>>>        Set Label_row_Offset to 0
81828>>>    End_Object 
81829>>>
81829>>>    Object oMunkaName is a dbForm
81831>>>        Entry_Item Munka.Name
81832>>>        Set Size to 13 126
81833>>>        Set Location to 5 120
81834>>>        Set peAnchors to anTopRight
81835>>>        Set Label to "Nv"
81836>>>        Set Label_Justification_mode to jMode_Left
81837>>>        Set Label_Col_Offset to 14
81838>>>        Set Label_row_Offset to 0
81839>>>    End_Object 
81840>>>
81840>>>    Object oMunkaLeiras is a dbForm
81842>>>        Entry_Item Munka.Leiras
81843>>>        Set Size to 13 66
81844>>>        Set Location to 20 59
81845>>>        Set peAnchors to anTopLeftRight
81846>>>        Set Label to "Lers"
81847>>>        Set Label_Justification_mode to jMode_Left
81848>>>        Set Label_Col_Offset to 54
81849>>>        Set Label_row_Offset to 0
81850>>>    End_Object 
81851>>>
81851>>>    Object oMunkaEgysegar is a dbForm
81853>>>        Entry_Item Munka.Egysegar
81854>>>        Set Size to 13 66
81855>>>        Set Location to 20 159
81856>>>        Set peAnchors to anTopRight
81857>>>        Set Label to "Egysgr"
81858>>>        Set Label_Justification_mode to jMode_Left
81859>>>        Set Label_Col_Offset to 29
81860>>>        Set Label_row_Offset to 0
81861>>>    End_Object 
81862>>>
81862>>>
81862>>>End_Object 
81863>        Use Ugyfel.vw
Including file: Ugyfel.vw    (C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.vw)
81863>>>// C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.vw
81863>>>// Ugyfel
81863>>>//
81863>>>
81863>>>Use DFClient.pkg
81863>>>Use DFEntry.pkg
81863>>>
81863>>>Use cUgyfelDataDictionary.dd
Including file: cUgyfelDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cUgyfelDataDictionary.dd)
81863>>>>>Use DataDict.pkg
81863>>>>>
81863>>>>>Open Ugyfel
Including file: Ugyfel.fd    (C:\Repos\DataFlexBeadando\DDSrc\Ugyfel.fd)
81865>>>>>Open Munkalap
81867>>>>>
81867>>>>>Register_Object Ugyfel_sl
81867>>>>>
81867>>>>>Class cUgyfelDataDictionary is a DataDictionary
81868>>>>>    
81868>>>>>    Procedure Construct_Object
81870>>>>>        Forward Send Construct_Object
81872>>>>>        Set Main_File to Ugyfel.File_Number
81873>>>>>
81873>>>>>        Set Add_Client_File to Munkalap.File_Number
81874>>>>>
81874>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
81875>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
81876>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
81877>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
81878>>>>>
81878>>>>>        Set Field_Label_Long Field Ugyfel.Id to "gyfl azonost"
81879>>>>>        Set Field_Label_Short Field Ugyfel.Id to "gyf. azon."
81880>>>>>        Set Field_Prompt_Object Field Ugyfel.Id to Ugyfel_sl
81881>>>>>
81881>>>>>        Set Field_Label_Long Field Ugyfel.Nev to "Nv"
81882>>>>>        Set Field_Label_Short Field Ugyfel.Nev to "Nv"
81883>>>>>        Set Field_Prompt_Object Field Ugyfel.Nev to Ugyfel_sl
81884>>>>>
81884>>>>>        Set Field_Mask Field Ugyfel.Adoszam to "########-#-##"
81885>>>>>        Set Field_Label_Long Field Ugyfel.Adoszam to "Adszm"
81886>>>>>        Set Field_Label_Short Field Ugyfel.Adoszam to "A.sz."
81887>>>>>
81887>>>>>        Set Field_Label_Long Field Ugyfel.Cim to "Cm"
81888>>>>>        Set Field_Label_Short Field Ugyfel.Cim to "Cm"
81889>>>>>
81889>>>>>        Set Field_Label_Long Field Ugyfel.Telefon to "Telefon"
81890>>>>>        Set Field_Label_Short Field Ugyfel.Telefon to "tel."
81891>>>>>        Set Field_Mask Field Ugyfel.Telefon to "+##-##-###-####"
81892>>>>>
81892>>>>>        Set Field_Label_Long Field Ugyfel.Bankszamla to "Bankszmla"
81893>>>>>        Set Field_Label_Short Field Ugyfel.Bankszamla to "Bszla."
81894>>>>>        Set Field_Mask Field Ugyfel.Bankszamla to "#######-########-########"
81895>>>>>
81895>>>>>    End_Procedure
81896>>>>>
81896>>>>>End_Class
81897>>>>>
81897>>>>>Use Ugyfel.sl
Including file: Ugyfel.sl    (C:\Repos\DataFlexBeadando\AppSrc\Ugyfel.sl)
81897>>>>>>>// Ugyfel.sl
81897>>>>>>>// Ugyfel Lookup List
81897>>>>>>>
81897>>>>>>>Use DFClient.pkg
81897>>>>>>>Use cDbCJGridPromptList.pkg
81897>>>>>>>Use cDbCJGridColumn.pkg
81897>>>>>>>Use Windows.pkg
81897>>>>>>>
81897>>>>>>>Use cUgyfelDataDictionary.dd
81897>>>>>>>
81897>>>>>>>CD_Popup_Object Ugyfel_sl is a dbModalPanel
81915>>>>>>>>
81915>>>>>>>    Set Location to 5 5
81916>>>>>>>    Set Size to 134 610
81917>>>>>>>    Set Label To "Ugyfel Lookup List"
81918>>>>>>>    Set Border_Style to Border_Thick
81919>>>>>>>    Set Minimize_Icon to False
81920>>>>>>>
81920>>>>>>>
81920>>>>>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
81922>>>>>>>    End_Object 
81923>>>>>>>
81923>>>>>>>    Set Main_DD To oUgyfel_DD
81924>>>>>>>    Set Server  To oUgyfel_DD
81925>>>>>>>
81925>>>>>>>
81925>>>>>>>
81925>>>>>>>    Object oSelList is a cDbCJGridPromptList
81927>>>>>>>        Set Size to 105 600
81928>>>>>>>        Set Location to 5 5
81929>>>>>>>        Set peAnchors to anAll
81930>>>>>>>        Set psLayoutSection to "Ugyfel_sl_oSelList"
81931>>>>>>>        Set Ordering to 1
81932>>>>>>>        Set pbAutoServer to True
81933>>>>>>>
81933>>>>>>>        Object oUgyfel_Id is a cDbCJGridColumn
81935>>>>>>>            Entry_Item Ugyfel.Id
81936>>>>>>>            Set piWidth to 77
81937>>>>>>>            Set psCaption to "gyf. azon."
81938>>>>>>>        End_Object 
81939>>>>>>>
81939>>>>>>>        Object oUgyfel_Nev is a cDbCJGridColumn
81941>>>>>>>            Entry_Item Ugyfel.Nev
81942>>>>>>>            Set piWidth to 262
81943>>>>>>>            Set psCaption to "Nv"
81944>>>>>>>        End_Object 
81945>>>>>>>
81945>>>>>>>        Object oUgyfel_Adoszam is a cDbCJGridColumn
81947>>>>>>>            Entry_Item Ugyfel.Adoszam
81948>>>>>>>            Set piWidth to 136
81949>>>>>>>            Set psCaption to "A.sz."
81950>>>>>>>        End_Object 
81951>>>>>>>
81951>>>>>>>        Object oUgyfel_Cim is a cDbCJGridColumn
81953>>>>>>>            Entry_Item Ugyfel.Cim
81954>>>>>>>            Set piWidth to 262
81955>>>>>>>            Set psCaption to "Cm"
81956>>>>>>>        End_Object 
81957>>>>>>>
81957>>>>>>>        Object oUgyfel_Telefon is a cDbCJGridColumn
81959>>>>>>>            Entry_Item Ugyfel.Telefon
81960>>>>>>>            Set piWidth to 126
81961>>>>>>>            Set psCaption to "tel."
81962>>>>>>>        End_Object 
81963>>>>>>>
81963>>>>>>>        Object oUgyfel_Bankszamla is a cDbCJGridColumn
81965>>>>>>>            Entry_Item Ugyfel.Bankszamla
81966>>>>>>>            Set piWidth to 262
81967>>>>>>>            Set psCaption to "Bszla."
81968>>>>>>>        End_Object 
81969>>>>>>>
81969>>>>>>>
81969>>>>>>>    End_Object 
81970>>>>>>>
81970>>>>>>>    Object oOk_bn is a Button
81972>>>>>>>        Set Label to "&Ok"
81973>>>>>>>        Set Location to 115 447
81974>>>>>>>        Set peAnchors to anBottomRight
81975>>>>>>>
81975>>>>>>>        Procedure OnClick
81978>>>>>>>            Send OK of oSelList
81979>>>>>>>        End_Procedure
81980>>>>>>>
81980>>>>>>>    End_Object 
81981>>>>>>>
81981>>>>>>>    Object oCancel_bn is a Button
81983>>>>>>>        Set Label to "&Cancel"
81984>>>>>>>        Set Location to 115 501
81985>>>>>>>        Set peAnchors to anBottomRight
81986>>>>>>>
81986>>>>>>>        Procedure OnClick
81989>>>>>>>            Send Cancel of oSelList
81990>>>>>>>        End_Procedure
81991>>>>>>>
81991>>>>>>>    End_Object 
81992>>>>>>>
81992>>>>>>>    Object oSearch_bn is a Button
81994>>>>>>>        Set Label to "&Search..."
81995>>>>>>>        Set Location to 115 555
81996>>>>>>>        Set peAnchors to anBottomRight
81997>>>>>>>
81997>>>>>>>        Procedure OnClick
82000>>>>>>>            Send Search of oSelList
82001>>>>>>>        End_Procedure
82002>>>>>>>
82002>>>>>>>    End_Object 
82003>>>>>>>
82003>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
82004>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
82005>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
82006>>>>>>>
82006>>>>>>>
82006>>>>>>>CD_End_Object // Ugyfel_sl
82008>>>>>>>>
82008>>>
82008>>>ACTIVATE_VIEW Activate_oUgyfel FOR oUgyfel
82018>>>>
82018>>>Object oUgyfel is a dbView
82020>>>    Set Location to 5 5
82021>>>    Set Size to 83 350
82022>>>    Set Label To "Ugyfel"
82023>>>    Set Border_Style to Border_Thick
82024>>>
82024>>>
82024>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82026>>>    End_Object 
82027>>>
82027>>>    Set Main_DD To oUgyfel_DD
82028>>>    Set Server  To oUgyfel_DD
82029>>>
82029>>>
82029>>>
82029>>>    Object oUgyfelId is a dbForm
82031>>>        Entry_Item Ugyfel.Id
82032>>>        Set Size to 13 42
82033>>>        Set Location to 5 57
82034>>>        Set peAnchors to anTopLeftRight
82035>>>        Set Label to "gyfl azonost"
82036>>>        Set Label_Justification_mode to jMode_Left
82037>>>        Set Label_Col_Offset to 52
82038>>>        Set Label_row_Offset to 0
82039>>>    End_Object 
82040>>>
82040>>>    Object oUgyfelNev is a dbForm
82042>>>        Entry_Item Ugyfel.Nev
82043>>>        Set Size to 13 250
82044>>>        Set Location to 20 57
82045>>>        Set peAnchors to anTopLeftRight
82046>>>        Set Label to "Nv"
82047>>>        Set Label_Justification_mode to jMode_Left
82048>>>        Set Label_Col_Offset to 52
82049>>>        Set Label_row_Offset to 0
82050>>>    End_Object 
82051>>>
82051>>>    Object oUgyfelAdoszam is a dbForm
82053>>>        Entry_Item Ugyfel.Adoszam
82054>>>        Set Size to 13 84
82055>>>        Set Location to 35 57
82056>>>        Set peAnchors to anTopLeftRight
82057>>>        Set Label to "Adszm"
82058>>>        Set Label_Justification_mode to jMode_Left
82059>>>        Set Label_Col_Offset to 52
82060>>>        Set Label_row_Offset to 0
82061>>>    End_Object 
82062>>>
82062>>>    Object oUgyfelCim is a dbForm
82064>>>        Entry_Item Ugyfel.Cim
82065>>>        Set Size to 13 250
82066>>>        Set Location to 50 57
82067>>>        Set peAnchors to anTopLeftRight
82068>>>        Set Label to "Cm"
82069>>>        Set Label_Justification_mode to jMode_Left
82070>>>        Set Label_Col_Offset to 52
82071>>>        Set Label_row_Offset to 0
82072>>>    End_Object 
82073>>>
82073>>>    Object oUgyfelTelefon is a dbForm
82075>>>        Entry_Item Ugyfel.Telefon
82076>>>        Set Size to 13 78
82077>>>        Set Location to 65 57
82078>>>        Set peAnchors to anTopLeftRight
82079>>>        Set Label to "Telefon"
82080>>>        Set Label_Justification_mode to jMode_Left
82081>>>        Set Label_Col_Offset to 52
82082>>>        Set Label_row_Offset to 0
82083>>>    End_Object 
82084>>>
82084>>>    Object oUgyfelBankszamla is a dbForm
82086>>>        Entry_Item Ugyfel.Bankszamla
82087>>>        Set Size to 13 168
82088>>>        Set Location to 65 177
82089>>>        Set peAnchors to anTopRight
82090>>>        Set Label to "Bankszmla"
82091>>>        Set Label_Justification_mode to jMode_Left
82092>>>        Set Label_Col_Offset to 37
82093>>>        Set Label_row_Offset to 0
82094>>>    End_Object 
82095>>>
82095>>>
82095>>>End_Object 
82096>        Use Munkalap.vw
Including file: Munkalap.vw    (C:\Repos\DataFlexBeadando\AppSrc\Munkalap.vw)
82096>>>// C:\Repos\DataFlexBeadando\AppSrc\Munkalap.vw
82096>>>// Munkalap
82096>>>//
82096>>>
82096>>>Use DFClient.pkg
82096>>>Use DFEntry.pkg
82096>>>Use cDbCJGrid.pkg
82096>>>Use cDbCJGridColumn.pkg
82096>>>
82096>>>Use cUgyfelDataDictionary.dd
82096>>>Use cAutoDataDictionary.dd
82096>>>Use cMunkalapDataDictionary.dd
Including file: cMunkalapDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkalapDataDictionary.dd)
82096>>>>>Use DataDict.pkg
82096>>>>>
82096>>>>>Open Munkalap
82098>>>>>Open Auto
82100>>>>>Open Ugyfel
82102>>>>>Open MunkaMunkalap
82104>>>>>
82104>>>>>Register_Object Munkalap_sl
82104>>>>>
82104>>>>>Class cMunkalapDataDictionary is a DataDictionary
82105>>>>>    
82105>>>>>    Procedure Construct_Object
82107>>>>>        Forward Send Construct_Object
82109>>>>>        Set Main_File to Munkalap.File_Number
82110>>>>>
82110>>>>>        Set Add_Client_File to MunkaMunkalap.File_Number
82111>>>>>
82111>>>>>        Set Add_Server_File to Auto.File_Number
82112>>>>>        Set Add_Server_File to Ugyfel.File_Number
82113>>>>>
82113>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
82114>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
82115>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
82116>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
82117>>>>>
82117>>>>>        Set Field_Label_Long Field Munkalap.Id to "Munkalap azonost"
82118>>>>>        Set Field_Label_Short Field Munkalap.Id to "Munkalap azon."
82119>>>>>        Set Field_Prompt_Object Field Munkalap.Id to Munkalap_sl
82120>>>>>
82120>>>>>        Set Field_Label_Long Field Munkalap.Rogzites to "Rgzts"
82121>>>>>        Set Field_Label_Short Field Munkalap.Rogzites to "Rgz."
82122>>>>>
82122>>>>>        Set Field_Prompt_Object Field Munkalap.UgyfelId to Munkalap_sl
82123>>>>>
82123>>>>>        Set Field_Prompt_Object Field Munkalap.AutoId to Munkalap_sl
82124>>>>>
82124>>>>>        Set Field_Label_Long Field Munkalap.Behozatal to "Behozatal"
82125>>>>>        Set Field_Label_Short Field Munkalap.Behozatal to "Behoz."
82126>>>>>
82126>>>>>        Set Field_Label_Long Field Munkalap.Elvitel to "Elvitel"
82127>>>>>        Set Field_Label_Short Field Munkalap.Elvitel to "Elvitel"
82128>>>>>
82128>>>>>        Set Field_Label_Long Field Munkalap.Akm to "Kilmter eltte"
82129>>>>>        Set Field_Label_Short Field Munkalap.Akm to "Km eltte"
82130>>>>>
82130>>>>>        Set Field_Label_Long Field Munkalap.Bkm to "Kilmterlls utns"
82131>>>>>        Set Field_Label_Short Field Munkalap.Bkm to "Km utna"
82132>>>>>        Set Protect_Key_State to False
82133>>>>>        Set Allow_Foreign_New_Save_State to True
82134>>>>>
82134>>>>>    End_Procedure
82135>>>>>
82135>>>>>End_Class
82136>>>>>
82136>>>>>Use Munkalap.sl
Including file: Munkalap.sl    (C:\Repos\DataFlexBeadando\AppSrc\Munkalap.sl)
82136>>>>>>>// Munkalap.sl
82136>>>>>>>// Munkalap Lookup List
82136>>>>>>>
82136>>>>>>>Use DFClient.pkg
82136>>>>>>>Use cDbCJGridPromptList.pkg
82136>>>>>>>Use cDbCJGridColumn.pkg
82136>>>>>>>Use Windows.pkg
82136>>>>>>>
82136>>>>>>>Use cUgyfelDataDictionary.dd
82136>>>>>>>Use cAutoDataDictionary.dd
82136>>>>>>>Use cMunkalapDataDictionary.dd
82136>>>>>>>
82136>>>>>>>CD_Popup_Object Munkalap_sl is a dbModalPanel
82154>>>>>>>>
82154>>>>>>>    Set Location to 5 5
82155>>>>>>>    Set Size to 134 450
82156>>>>>>>    Set Label To "Munkalap Lookup List"
82157>>>>>>>    Set Border_Style to Border_Thick
82158>>>>>>>    Set Minimize_Icon to False
82159>>>>>>>
82159>>>>>>>
82159>>>>>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82161>>>>>>>    End_Object 
82162>>>>>>>
82162>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
82164>>>>>>>    End_Object 
82165>>>>>>>
82165>>>>>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
82167>>>>>>>        Set DDO_Server To oAuto_DD
82168>>>>>>>        Set DDO_Server To oUgyfel_DD
82169>>>>>>>    End_Object 
82170>>>>>>>
82170>>>>>>>    Set Main_DD To oMunkalap_DD
82171>>>>>>>    Set Server  To oMunkalap_DD
82172>>>>>>>
82172>>>>>>>
82172>>>>>>>
82172>>>>>>>    Object oSelList is a cDbCJGridPromptList
82174>>>>>>>        Set Size to 105 440
82175>>>>>>>        Set Location to 5 5
82176>>>>>>>        Set peAnchors to anAll
82177>>>>>>>        Set psLayoutSection to "Munkalap_sl_oSelList"
82178>>>>>>>        Set Ordering to 1
82179>>>>>>>        Set pbAutoServer to True
82180>>>>>>>
82180>>>>>>>        Object oMunkalap_Id is a cDbCJGridColumn
82182>>>>>>>            Entry_Item Munkalap.Id
82183>>>>>>>            Set piWidth to 101
82184>>>>>>>            Set psCaption to "Munkalap azon."
82185>>>>>>>        End_Object 
82186>>>>>>>
82186>>>>>>>        Object oMunkalap_Rogzites is a cDbCJGridColumn
82188>>>>>>>            Entry_Item Munkalap.Rogzites
82189>>>>>>>            Set piWidth to 105
82190>>>>>>>            Set psCaption to "Rgz."
82191>>>>>>>        End_Object 
82192>>>>>>>
82192>>>>>>>        Object oUgyfel_Id is a cDbCJGridColumn
82194>>>>>>>            Entry_Item Ugyfel.Id
82195>>>>>>>            Set piWidth to 63
82196>>>>>>>            Set psCaption to "UgyfelId"
82197>>>>>>>        End_Object 
82198>>>>>>>
82198>>>>>>>        Object oAuto_Id is a cDbCJGridColumn
82200>>>>>>>            Entry_Item Auto.Id
82201>>>>>>>            Set piWidth to 63
82202>>>>>>>            Set psCaption to "AutoId"
82203>>>>>>>        End_Object 
82204>>>>>>>
82204>>>>>>>        Object oMunkalap_Behozatal is a cDbCJGridColumn
82206>>>>>>>            Entry_Item Munkalap.Behozatal
82207>>>>>>>            Set piWidth to 105
82208>>>>>>>            Set psCaption to "Behoz."
82209>>>>>>>        End_Object 
82210>>>>>>>
82210>>>>>>>        Object oMunkalap_Elvitel is a cDbCJGridColumn
82212>>>>>>>            Entry_Item Munkalap.Elvitel
82213>>>>>>>            Set piWidth to 105
82214>>>>>>>            Set psCaption to "Elvitel"
82215>>>>>>>        End_Object 
82216>>>>>>>
82216>>>>>>>        Object oMunkalap_Akm is a cDbCJGridColumn
82218>>>>>>>            Entry_Item Munkalap.Akm
82219>>>>>>>            Set piWidth to 105
82220>>>>>>>            Set psCaption to "Km eltte"
82221>>>>>>>        End_Object 
82222>>>>>>>
82222>>>>>>>        Object oMunkalap_Bkm is a cDbCJGridColumn
82224>>>>>>>            Entry_Item Munkalap.Bkm
82225>>>>>>>            Set piWidth to 105
82226>>>>>>>            Set psCaption to "Km utna"
82227>>>>>>>        End_Object 
82228>>>>>>>
82228>>>>>>>
82228>>>>>>>    End_Object 
82229>>>>>>>
82229>>>>>>>    Object oOk_bn is a Button
82231>>>>>>>        Set Label to "&Ok"
82232>>>>>>>        Set Location to 115 287
82233>>>>>>>        Set peAnchors to anBottomRight
82234>>>>>>>
82234>>>>>>>        Procedure OnClick
82237>>>>>>>            Send OK of oSelList
82238>>>>>>>        End_Procedure
82239>>>>>>>
82239>>>>>>>    End_Object 
82240>>>>>>>
82240>>>>>>>    Object oCancel_bn is a Button
82242>>>>>>>        Set Label to "&Cancel"
82243>>>>>>>        Set Location to 115 341
82244>>>>>>>        Set peAnchors to anBottomRight
82245>>>>>>>
82245>>>>>>>        Procedure OnClick
82248>>>>>>>            Send Cancel of oSelList
82249>>>>>>>        End_Procedure
82250>>>>>>>
82250>>>>>>>    End_Object 
82251>>>>>>>
82251>>>>>>>    Object oSearch_bn is a Button
82253>>>>>>>        Set Label to "&Search..."
82254>>>>>>>        Set Location to 115 395
82255>>>>>>>        Set peAnchors to anBottomRight
82256>>>>>>>
82256>>>>>>>        Procedure OnClick
82259>>>>>>>            Send Search of oSelList
82260>>>>>>>        End_Procedure
82261>>>>>>>
82261>>>>>>>    End_Object 
82262>>>>>>>
82262>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
82263>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
82264>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
82265>>>>>>>
82265>>>>>>>
82265>>>>>>>CD_End_Object // Munkalap_sl
82267>>>>>>>>
82267>>>Use cMunkaDataDictionary.dd
82267>>>Use cMunkaMunkalapDataDictionary.dd
Including file: cMunkaMunkalapDataDictionary.dd    (C:\Repos\DataFlexBeadando\DDSrc\cMunkaMunkalapDataDictionary.dd)
82267>>>>>Use DataDict.pkg
82267>>>>>
82267>>>>>Open MunkaMunkalap
82269>>>>>Open Munkalap
82271>>>>>Open Munka
82273>>>>>
82273>>>>>Class cMunkaMunkalapDataDictionary is a DataDictionary
82274>>>>>    
82274>>>>>    Procedure Construct_Object
82276>>>>>        Forward Send Construct_Object
82278>>>>>        Set Main_File to MunkaMunkalap.File_Number
82279>>>>>
82279>>>>>        Set Add_Server_File to Munkalap.File_Number
82280>>>>>        Set Add_Server_File to Munka.File_Number
82281>>>>>
82281>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
82282>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
82283>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
82284>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
82285>>>>>
82285>>>>>    End_Procedure
82286>>>>>
82286>>>>>End_Class
82287>>>
82287>>>ACTIVATE_VIEW Activate_oMunkalap FOR oMunkalap
82297>>>>
82297>>>Object oMunkalap is a dbView
82299>>>    Set Location to 5 5
82300>>>    Set Size to 249 369
82301>>>    Set Label To "Munkalap"
82302>>>    Set Border_Style to Border_Thick
82303>>>
82303>>>
82303>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
82305>>>    End_Object 
82306>>>
82306>>>    Object oAuto_DD is a cAutoDataDictionary
82308>>>    End_Object 
82309>>>
82309>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
82311>>>        Set DDO_Server To oAuto_DD
82312>>>        Set DDO_Server To oUgyfel_DD
82313>>>        // this lets you save a new parent DD from within child DD
82313>>>        Set Allow_Foreign_New_Save_State to True
82314>>>    End_Object 
82315>>>
82315>>>    Object oMunka_DD is a cMunkaDataDictionary
82317>>>    End_Object 
82318>>>
82318>>>    Object oMunkaMunkalap_DD is a cMunkaMunkalapDataDictionary
82320>>>        Set DDO_Server To oMunkalap_DD
82321>>>        Set DDO_Server To oMunka_DD
82322>>>        Set Constrain_File To Munkalap.File_Number
82323>>>    End_Object 
82324>>>
82324>>>    Set Main_DD To oMunkalap_DD
82325>>>    Set Server  To oMunkalap_DD
82326>>>
82326>>>
82326>>>
82326>>>    Object oMunkalapId is a dbForm
82328>>>        Entry_Item Munkalap.Id
82329>>>        Set Size to 13 42
82330>>>        Set Location to 5 68
82331>>>        Set peAnchors to anTopLeftRight
82332>>>        Set Label to "Munkalap azonost"
82333>>>        Set Label_Justification_mode to jMode_Left
82334>>>        Set Label_Col_Offset to 63
82335>>>        Set Label_row_Offset to 0
82336>>>    End_Object 
82337>>>
82337>>>    Object oUgyfelId is a dbForm
82339>>>        Entry_Item Ugyfel.Id
82340>>>        Set Size to 13 42
82341>>>        Set Location to 20 68
82342>>>        Set peAnchors to anTopLeftRight
82343>>>        Set Label to "gyfl azonost"
82344>>>        Set Label_Justification_mode to jMode_Left
82345>>>        Set Label_Col_Offset to 63
82346>>>        Set Label_row_Offset to 0
82347>>>    End_Object 
82348>>>
82348>>>    Object oUgyfelNev is a dbForm
82350>>>        Entry_Item Ugyfel.Nev
82351>>>        Set Size to 13 250
82352>>>        Set Location to 35 68
82353>>>        Set peAnchors to anTopLeftRight
82354>>>        Set Label to "Nv"
82355>>>        Set Label_Justification_mode to jMode_Left
82356>>>        Set Label_Col_Offset to 63
82357>>>        Set Label_row_Offset to 0
82358>>>    End_Object 
82359>>>
82359>>>    Object oAutoId is a dbForm
82361>>>        Entry_Item Auto.Id
82362>>>        Set Size to 13 42
82363>>>        Set Location to 50 68
82364>>>        Set peAnchors to anTopLeftRight
82365>>>        Set Label to "Azonost"
82366>>>        Set Label_Justification_mode to jMode_Left
82367>>>        Set Label_Col_Offset to 63
82368>>>        Set Label_row_Offset to 0
82369>>>    End_Object 
82370>>>
82370>>>    Object oAutoAlvazszam is a dbForm
82372>>>        Entry_Item Auto.Alvazszam
82373>>>        Set Size to 13 126
82374>>>        Set Location to 65 68
82375>>>        Set peAnchors to anTopLeftRight
82376>>>        Set Label to "Alvzszm"
82377>>>        Set Label_Justification_mode to jMode_Left
82378>>>        Set Label_Col_Offset to 63
82379>>>        Set Label_row_Offset to 0
82380>>>    End_Object 
82381>>>
82381>>>    Object oAutoMotorszam is a dbForm
82383>>>        Entry_Item Auto.Motorszam
82384>>>        Set Size to 13 126
82385>>>        Set Location to 80 68
82386>>>        Set peAnchors to anTopLeftRight
82387>>>        Set Label to "Motorszm"
82388>>>        Set Label_Justification_mode to jMode_Left
82389>>>        Set Label_Col_Offset to 63
82390>>>        Set Label_row_Offset to 0
82391>>>    End_Object 
82392>>>
82392>>>    Object oMunkalapRogzites is a dbForm
82394>>>        Entry_Item Munkalap.Rogzites
82395>>>        Set Size to 13 66
82396>>>        Set Location to 95 68
82397>>>        Set peAnchors to anTopLeftRight
82398>>>        Set Label to "Rgzts"
82399>>>        Set Label_Justification_mode to jMode_Left
82400>>>        Set Label_Col_Offset to 63
82401>>>        Set Label_row_Offset to 0
82402>>>    End_Object 
82403>>>
82403>>>    Object oMunkalapBehozatal is a dbForm
82405>>>        Entry_Item Munkalap.Behozatal
82406>>>        Set Size to 13 66
82407>>>        Set Location to 110 68
82408>>>        Set peAnchors to anTopLeftRight
82409>>>        Set Label to "Behozatal"
82410>>>        Set Label_Justification_mode to jMode_Left
82411>>>        Set Label_Col_Offset to 63
82412>>>        Set Label_row_Offset to 0
82413>>>    End_Object 
82414>>>
82414>>>    Object oMunkalapElvitel is a dbForm
82416>>>        Entry_Item Munkalap.Elvitel
82417>>>        Set Size to 13 66
82418>>>        Set Location to 125 68
82419>>>        Set peAnchors to anTopLeftRight
82420>>>        Set Label to "Elvitel"
82421>>>        Set Label_Justification_mode to jMode_Left
82422>>>        Set Label_Col_Offset to 63
82423>>>        Set Label_row_Offset to 0
82424>>>    End_Object 
82425>>>
82425>>>    Object oMunkalapAkm is a dbForm
82427>>>        Entry_Item Munkalap.Akm
82428>>>        Set Size to 13 66
82429>>>        Set Location to 140 68
82430>>>        Set peAnchors to anTopLeftRight
82431>>>        Set Label to "Kilmter eltte"
82432>>>        Set Label_Justification_mode to jMode_Left
82433>>>        Set Label_Col_Offset to 63
82434>>>        Set Label_row_Offset to 0
82435>>>    End_Object 
82436>>>
82436>>>    Object oMunkalapBkm is a dbForm
82438>>>        Entry_Item Munkalap.Bkm
82439>>>        Set Size to 13 66
82440>>>        Set Location to 155 68
82441>>>        Set peAnchors to anTopLeftRight
82442>>>        Set Label to "Kilmterlls utns"
82443>>>        Set Label_Justification_mode to jMode_Left
82444>>>        Set Label_Col_Offset to 63
82445>>>        Set Label_row_Offset to 0
82446>>>    End_Object 
82447>>>
82447>>>    Object oDetailGrid is a cDbCJGrid
82449>>>        Set Size to 66 359
82450>>>        Set Location to 178 5
82451>>>        Set Server to oMunkaMunkalap_DD
82452>>>        Set Ordering to 1
82453>>>        Set peAnchors to anAll
82454>>>        Set psLayoutSection to "oMunkalap_oDetailGrid"
82455>>>        Set pbAllowInsertRow to False
82456>>>        Set pbHeaderPrompts to True
82457>>>
82457>>>        Object oMunka_Id is a cDbCJGridColumn
82459>>>            Entry_Item Munka.Id
82460>>>            Set piWidth to 85
82461>>>            Set psCaption to "Munka azon."
82462>>>        End_Object 
82463>>>
82463>>>        Object oMunka_Name is a cDbCJGridColumn
82465>>>            Entry_Item Munka.Name
82466>>>            Set piWidth to 210
82467>>>            Set psCaption to "Nv"
82468>>>        End_Object 
82469>>>
82469>>>        Object oMunka_Leiras is a cDbCJGridColumn
82471>>>            Entry_Item Munka.Leiras
82472>>>            Set piWidth to 105
82473>>>            Set psCaption to "Lers"
82474>>>        End_Object 
82475>>>
82475>>>        Object oMunka_Egysegar is a cDbCJGridColumn
82477>>>            Entry_Item Munka.Egysegar
82478>>>            Set piWidth to 105
82479>>>            Set psCaption to "Egysgr"
82480>>>        End_Object 
82481>>>
82481>>>        Object oMunkaMunkalap_Darab is a cDbCJGridColumn
82483>>>            Entry_Item MunkaMunkalap.Darab
82484>>>            Set piWidth to 105
82485>>>            Set psCaption to "Darab"
82486>>>        End_Object 
82487>>>
82487>>>    End_Object 
82488>>>
82488>>>    //-----------------------------------------------------------------------
82488>>>    // Create custom confirmation messages for save and delete
82488>>>    // We must create the new functions and assign verify messages
82488>>>    // to them.
82488>>>    //-----------------------------------------------------------------------
82488>>>
82488>>>    Function ConfirmDeleteHeader Returns Boolean
82491>>>        Boolean bFail
82491>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
82492>>>        Function_Return bFail
82493>>>    End_Function 
82494>>>
82494>>>    // Only confirm on the saving of new records
82494>>>    Function ConfirmSaveHeader Returns Boolean
82497>>>        Boolean bNoSave bHasRecord
82497>>>        Handle  hoSrvr
82497>>>        Get Server to hoSrvr
82498>>>        Get HasRecord of hoSrvr to bHasRecord
82499>>>        If not bHasRecord Begin
82501>>>            Get Confirm "Save this NEW header?" to bNoSave
82502>>>        End
82502>>>>
82502>>>        Function_Return bNoSave
82503>>>    End_Function 
82504>>>
82504>>>    // Define alternate confirmation Messages
82504>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
82505>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
82506>>>    // Saves in header should not clear the view
82506>>>    Set Auto_Clear_Deo_State to False
82507>>>
82507>>>
82507>>>End_Object 
82508>        Use GyakorisagRiport.rv
Including file: GyakorisagRiport.rv    (C:\Repos\DataFlexBeadando\AppSrc\GyakorisagRiport.rv)
82508>>>// GyakorisagRiport.rv
82508>>>// GyakorisagRiport
82508>>>Register_Object oReport
82508>>>
82508>>>Use DFRptVw.pkg
82508>>>Use cWinReport2.pkg
Including file: cWinReport2.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cWinReport2.pkg)
82508>>>>>// cWinReport2.pkg
82508>>>>>
82508>>>>>// defines support for new Winprint2 cWinReport2 class
82508>>>>>
82508>>>>>
82508>>>>>Use DFRpt.pkg              // BasicReport RO Class for VDF
82508>>>>>Use WinPrint2.pkg          // WinPrint2 engine
Including file: Winprint2.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Winprint2.pkg)
82508>>>>>>>// WinPrint2.pkg
82508>>>>>>>//
82508>>>>>>>Use windows.pkg
82508>>>>>>>Use LanguageText.pkg
82508>>>>>>>Use DLL.pkg
82508>>>>>>>Use WinPrint2_Api.pkg
Including file: WinPrint2_API.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\WinPrint2_API.pkg)
82508>>>>>>>>>//WinPrint2_API.pkg
82508>>>>>>>>>
82508>>>>>>>>>Use DLL.pkg
82508>>>>>>>>>
82508>>>>>>>>>External_Function WP_IsPrinterValid "IsPrinterValid" WinPrint.dll ;Returns Boolean // True if the the current printer is a valid one. False, otherwise.
82509>>>>>>>>>
82509>>>>>>>>>External_Function WP_ArePrintersInstalled "ArePrintersInstalled" WinPrint.dll ; // determines whether at least one printer is installedReturns Boolean // True, if a printer is installed, False if it is not.
82510>>>>>>>>>
82510>>>>>>>>>External_Function WP_ExecutePrinterSetupDialog "ExecutePrinterSetupDialog" WinPrint.dll ; // displays the "printer setup" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
82511>>>>>>>>>
82511>>>>>>>>>External_Function WP_ExecutePrintDialog "ExecutePrintDialog" WinPrint.dll ; // displays the "Print" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
82512>>>>>>>>>
82512>>>>>>>>>External_Function WP_GetCurrentDevice "GetCurrentDevice" WinPrint.dll ; // retrieves the name of the current printer device    Address aDevice ; // address of the string (255 chars) that will hold the device name upon returnReturns Boolean // True, if success; False if error occurred
82513>>>>>>>>>
82513>>>>>>>>>External_Function WP_GetPrintDialogFlags "GetPrintDialogFlags" WinPrint.dll ; // retrieves the current print optionsReturns UInteger // array of flags representing print-related options that are currently set
82514>>>>>>>>>
82514>>>>>>>>>External_Function WP_GetUserDefinedPapersize "GetUserDefinedPapersize" WinPrint.dll ;  // gets the size of user-defined paperReturns UInteger // // hi-word=length; lo-word=width
82515>>>>>>>>>
82515>>>>>>>>>External_Function WP_IsPrintDialogFlagSet "IsPrintDialogFlagSet" WinPrint.dll ; // determines whether a specific print-flag is set    UInteger iFlag ; // the printer flagReturns Boolean // True, if the flag is set; False, if it isn't
82516>>>>>>>>>
82516>>>>>>>>>External_Function WP_SelectPrinter "SelectPrinter" WinPrint.dll ; // selects a printer programatically    String sDevice; // the name of the printerReturns Boolean // True, if success; False, if error (such as an invalid printer name)
82517>>>>>>>>>
82517>>>>>>>>>External_Function WP_SetFirstPagePaperSource "SetFirstPagePaperSource"  WinPrint.dll ;        Integer iBin ; // the bim constantReturns Boolean // True if success, false if error
82518>>>>>>>>>
82518>>>>>>>>>External_Function WP_SetNumberOfPrintCopies "SetNumberOfPrintCopies" WinPrint.dll ; // sets the number of copies to print    UInteger iNumCopies; // number of copies to makeReturns Boolean // Always True
82519>>>>>>>>>
82519>>>>>>>>>External_Function WP_SetSpecificPrintDialogFlag "SetSpecificPrintDialogFlag" WinPrint.dll; // Sets/unsets one printer flag    UInteger fFlag; // printer flagReturns Boolean // True, if success; False if error occurred
82520>>>>>>>>>
82520>>>>>>>>>External_Function WP_SetPrintDialogFlags "SetPrintDialogFlags" WinPrint.dll; // Sets/unsets all printer flags in one call    UInteger fFlags; // printer flagsReturns Boolean // True, if success; False if error occurred
82521>>>>>>>>>
82521>>>>>>>>>External_Function WP_SetUserDefinedPapersize "SetUserDefinedPapersize" WinPrint.dll ;  // sets the size of user-defined paper    UInteger iPaperSize ; // hi-word=length; lo-word=widthReturns Boolean // True, if success; False if error occurred
82522>>>>>>>>>
82522>>>>>>>>>External_Function WP_SetFontStyle "SetFontStyle" WinPrint.dll ; // sets multiple font attributes    Integer iStyles ; // series of flagsReturns Boolean // always True
82523>>>>>>>>>
82523>>>>>>>>>External_Function WP_SetFontBold "SetFontBold" WinPrint.dll ; // toggles the bold attribute of the current font    Boolean bBold ; // True to switch bold attribute on; False to switch it offReturns Boolean // always True
82524>>>>>>>>>
82524>>>>>>>>>External_Function WP_SetFontItalic "SetFontItalic" WinPrint.dll ; // toggles the italic attribute of the current font    Boolean bItalic ; // True to switch italic attribute on; False to switch it offReturns Boolean  // always True
82525>>>>>>>>>
82525>>>>>>>>>External_Function WP_SetFontUnderline "SetFontUnderline" WinPrint.dll ; // toggles the underline attribute of the current font    Boolean bUnderline ; // True to switch underline attribute on; False to switch it offReturns Boolean  // always True
82526>>>>>>>>>
82526>>>>>>>>>External_Function WP_SetFontStrikeout "SetFontStrikeout" WinPrint.dll ; // toggles the strikeout attribute of the current font    Boolean bStrikeout ; // True to switch strikeout attribute on; False to switch it offReturns Boolean  // always True
82527>>>>>>>>>
82527>>>>>>>>>External_Function WP_SetFontColor "SetFontColor" WinPrint.dll ; // sets the color of the current font    Integer iColor ; // color of the fontReturns Boolean  // always True
82528>>>>>>>>>
82528>>>>>>>>>External_Function WP_SetFontHeight "SetFontHeight" WinPrint.dll ; // sets the height of the font    UInteger iHeight ; // height of the font in points (multiplied by 100. Eg 12.5 point should be sent as 1250)Returns Boolean  // always True
82529>>>>>>>>>
82529>>>>>>>>>External_Function WP_SetFontName "SetFontName" WinPrint.dll ; // Sets the name of the font to use    String sFontName ; // name of the font to useReturns Boolean  // always True
82530>>>>>>>>>
82530>>>>>>>>>External_Function WP_DrawBitmap "DrawBitmap" WinPrint.dll ; // Draws a bitmap (BMP, JPG)    String  sBitmap;                 // Name of the bitmap    Integer iLeft;                   // distance from left edge to draw bitmap    Integer iTop;                    // distance from top edge to draw bitmap    Integer iWidth;                  // width of the bitmap    Integer iHeight;                 // height of the bitmap    Boolean bUpdateCurrentPosition;  // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
82531>>>>>>>>>
82531>>>>>>>>>External_Function WP_DrawEllipse "DrawEllipse" WinPrint.dll ; // draws an elipse within a bounding rectangle    Integer iLeft;                   // distance from left edge to draw the ellipse    Integer iTop;                    // distance from top edge to draw the ellipse    Integer iWidth;                  // width of the bounding rectangle    Integer iHeight;                 // height of the bounding rectangle    Integer iBorderColor;            // color of the ellipse's edge    Integer iFillColor;              // internal color of the ellipse    Boolean  bFill;                  // should the ellipse be filled? (False=transparent)    UInteger iThickness;             // thickness of the elipse    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the ellipse be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82532>>>>>>>>>
82532>>>>>>>>>External_Function WP_DrawLine "DrawLine" WinPrint.dll ; // draws a line from the current position    Integer iLeft;                   // distance from left edge to draw the line    Integer iTop;                    // distance from top edge to draw the line    Integer iLength;                 // length of the line    Boolean  bHorizontal;            // draw horizontal? (False=vertical)    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
82533>>>>>>>>>
82533>>>>>>>>>External_Function WP_DrawRectangle "DrawRectangle" WinPrint.dll ; // draws a rectangle    Integer iLeft;                   // distance from left edge to draw the rectangle    Integer iTop;                    // distance from top edge to draw the rectangle    Integer iWidth;                  // width of the rectangle    Integer iHeight;                 // height of the rectangle    Integer iBorderColor;            // color of the rectangle's border    Integer iFillColor;              // internal color of the rectangle    Boolean  bFill;                  // should the rectangle be filled? (False=transparent)    UInteger iThickness;             // thickness of the rectangle's border    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the rectangle be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82534>>>>>>>>>
82534>>>>>>>>>External_Function WP_DrawXYLine "DrawXYLine" WinPrint.dll ; // draws a line between two points    Integer iLeftStart;              // distance from left edge to draw from    Integer iTopStart;               // distance from top edge to draw from    Integer iLeftEnd;                // distance from left edge to draw to    Integer iTopEnd;                 // distance from top edge to draw to    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the line be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
82535>>>>>>>>>
82535>>>>>>>>>External_Function WP_SetAbsoluteMargins "SetAbsoluteMargins" WinPrint.dll ; // modifies the top/bottom non-printable margin    UInteger iTop;      // the top margin offset    UInteger iBottom;   // the bottom margin offset    Boolean  bAllPages; // should all pages be affected? True=AllPages; False=first page onlyReturns Boolean // always True
82536>>>>>>>>>
82536>>>>>>>>>External_Function WP_SetMargins "SetMargins" WinPrint.dll ; // Sets the user-margins    UInteger iLeft;   // the left margin    UInteger iTop;    // the top margin    UInteger iRight;  // the right margin    UInteger iBottom; // the bottom marginReturns Boolean // always True
82537>>>>>>>>>
82537>>>>>>>>>External_Function WP_CreateDiagram "CreateDiagram" WinPrint.dll ; // Creates a new diagram    UInteger eType;       // type of diagram (Bar, Line, Pie)    UInteger eEffect;     // how it is drawn (2d or 3d, etc)    UInteger iWidth;      // width of the diagram    UInteger iHeight;     // height of the diagram    Boolean  bDrawXyAxis; // draw the xy-axis (for bar charts only)?Returns Handle // unique id for the diagram used in other diagram funtions
82538>>>>>>>>>
82538>>>>>>>>>External_Function WP_AddDiagramEntry "AddDiagramEntry" WinPrint.dll ; // Adds an item into a diagram    Handle   hDiagram;          // diagram handle returned by CreateDiagram()    String   sValueDescription; // description of the item    String   sValue;            // value of the item    Integer iBorderColor;       // color of the item's border    Integer iFillColor;         // color of the item's interior    Boolean  bFilled;           // should the item be drawn filled (with iFillColor), or transparent?    UInteger iNumDecimals;      // Number of decimals in the sValue argument    UInteger eValueOrPercent;   // How the value should be displayed (as value or percentage, etc)    Boolean  bExploded;         // should the value be "pulled out" (pie charts only)Returns Boolean // True, if success; False, if error
82539>>>>>>>>>
82539>>>>>>>>>External_Function WP_DrawDiagram "DrawDiagram" WinPrint.dll ; // draws a diagram    Handle   hDiagram;               // diagram handle returned by CreateDiagram()    UInteger iLeft;                  // x-coordinate to draw the diagram    UInteger iTop;                   // y-coordinate to draw the diagram    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if success; False, if error
82540>>>>>>>>>
82540>>>>>>>>>External_Function WP_LockDiagram "LockDiagram" WinPrint.dll ; // Locks a diagram so that no more entries can be added    Handle hDiagram; // diagram handle returned by CreateDiagram()Returns Boolean // True, if success; False, if error
82541>>>>>>>>>
82541>>>>>>>>>External_Function WP_SetDiagramCaption "SetDiagramCaption" WinPrint.dll ; // Sets the caption of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sCaption; // the diagram's captionReturns Boolean // True, if success; False, if error
82542>>>>>>>>>
82542>>>>>>>>>External_Function WP_SetDiagramXText "SetDiagramXText" WinPrint.dll ; // Sets the horizontal label of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sText;    // the diagram's horizonal labelReturns Boolean // True, if success; False, if error
82543>>>>>>>>>
82543>>>>>>>>>External_Function WP_SetDiagramYText "SetDiagramYText" WinPrint.dll ; // Sets the vertical label of a diagram    Handle  hDiagram;      // diagram handle returned by CreateDiagram()    String  sText;         // the diagram's vertical label    Boolean bVerticalText; // should the text be drawn vertically (False=horizontally)Returns Boolean // True, if success; False, if error
82544>>>>>>>>>
82544>>>>>>>>>External_Function WP_BeginHeader "BeginHeader" WinPrint.dll ; // creates a new header    UInteger iHeaderType; // the type of header    UInteger iSubHeaderNum; // for subheaders, then number (1-0)Returns Boolean // always True
82545>>>>>>>>>
82545>>>>>>>>>External_Function WP_EndHeader "EndHeader" WinPrint.dll ; // declares the end of the current headerReturns Boolean // always True
82546>>>>>>>>>
82546>>>>>>>>>External_Function WP_SetExtraLineCheck "SetExtraLineCheck" WinPrint.dll ; // forces a soft page break if header plus number of lines don't fit on page    UInteger iNumLines; // number of lines in addition to header required before forcing a soft page-breakReturns Boolean; // always True
82547>>>>>>>>>External_Function WP_SetHeaderFrame "SetHeaderFrame" WinPrint.dll ; // sets the style, color and frame of a header    UInteger eFrame;     // style of frame (margin-to-margin, etc)    Integer iColor;      // color of the frame's edge    UInteger iThickness; // thickness of the frame    Integer iFillCol;    // the internal color of the frame (only used if bBilled=True)    Boolean  bFilled;    // True, if the frame should be filled with the iFillColor (False=Transparent)Returns Boolean // Always True
82548>>>>>>>>>
82548>>>>>>>>>External_Function WP_SetHeaderMargin "SetHeaderMargin" WinPrint.dll ; // Sets a margin of space on the inside and outside of the current header    UInteger eType;      // Specifies which margin areas is being set.    Integer  iSize;      // Size of the margin setting in the current report metricsReturns Boolean  // False if document is not started
82549>>>>>>>>>
82549>>>>>>>>>External_Function WP_SetHeaderPlacement "SetHeaderPlacement" WinPrint.dll ; // placement (left, center or right) of the header    UInteger ePlacement; // placed left, center or rightReturns Boolean //always True
82550>>>>>>>>>
82550>>>>>>>>>External_Function WP_SetHeaderWrap "SetHeaderWrap" WinPrint.dll ; // determines whether the current header is drawn on soft page-breaks    Boolean bWrap; // True, to wrap onto following pages; False, for current page onlyReturns Boolean // always True
82551>>>>>>>>>
82551>>>>>>>>>External_Function WP_WriteHeader "WriteHeader" WinPrint.dll ; // writes a header to the current page    UInteger eHeaderType;   // type of header    UInteger iSubHeaderNum; // for subheaders, the number (1-9)Returns Boolean // True, if success; False, if error
82552>>>>>>>>>
82552>>>>>>>>>External_Function WP_RGBToDFPrintColor "RGBToDFPrintColor" WinPrint.dll ; // converts R, G, and B values into a composite color that WinPrint expects    UInteger iRed;   // red component (1-255)    UInteger iGreen; // green component (1-255)    UInteger iBlue;  // blue component (1-255)Returns Integer // composite color
82553>>>>>>>>>
82553>>>>>>>>>External_Function WP_GetMetrics "GetMetrics" WinPrint.dll ; // gets the current unit of measurementReturns UInteger // unit of measurement (Inch or CM)
82554>>>>>>>>>
82554>>>>>>>>>External_Function WP_SetMetrics "SetMetrics" WinPrint.dll ; // sets the unit of measurement   UInteger eMetrics; // Inch or CMReturns Boolean // always True
82555>>>>>>>>>
82555>>>>>>>>>External_Function WP_ClearDocument "ClearDocument" WinPrint.dll ; // clears the resources of the document from memoryReturns Boolean // always True
82556>>>>>>>>>
82556>>>>>>>>>External_Function WP_NewDocument "NewDocument" WinPrint.dll ; // starts a new document, but preserves the printer settings   Boolean bAutoPreview ; // Should the Previewer be displayed immediatelyReturns Boolean // True, if success; False, if an error occurred
82557>>>>>>>>>
82557>>>>>>>>>External_Function WP_EndDocument "EndDocument" WinPrint.dll ; // Indicates that the document is finishedReturns Boolean // always True
82558>>>>>>>>>
82558>>>>>>>>>External_Function WP_ClearPrinter "ClearPrinter" WinPrint.dll ; // clears all printer and document resourcesReturns Boolean // True, if success; False, if an error occurred
82559>>>>>>>>>
82559>>>>>>>>>External_Function WP_ConfirmLines "ConfirmLines" WinPrint.dll ; // ensures that a specified number of lines will fit on the page; if not, a soft page-break is performed automatically    UInteger iNumLines; // number of lines that must fit on the pageReturns Boolean // True, if success; False, if an error occurred
82560>>>>>>>>>
82560>>>>>>>>>External_Function WP_CreatePage "CreatePage" WinPrint.dll ; // creates a new page of specified columns   UInteger iNumColumns; // number of columns (zero= no columns)Returns UInteger; // page number that was created
82561>>>>>>>>>External_Function WP_PreviewDocument "PreviewDocument" WinPrint.dll ; // previews the current document    Boolean bPrintDialog; // Determines whether the Print Dialog (range, etc) is displayed when the "print" button is clicked in the preview window.    Boolean bPrintSetup;  // Determines whether the Print Setup button is enabled (allows to change orientation, etc)    Boolean bPrint;       // Determines whether the Print button is enabledReturns Handle // non-zero = hViewerProcess; zero= error
82562>>>>>>>>>
82562>>>>>>>>>External_Function WP_ClosePreview "ClosePreview" WinPrint.dll ; // closes the preview windowReturns Boolean // True, if closed; False, if an error occurred (such as it not being already open)
82563>>>>>>>>>
82563>>>>>>>>>External_Function WP_PrintDocument "PrintDocument" WinPrint.dll ; // prints the current document    Handle hWndParent; // window handle of object to use for any modal outputReturns Boolean // True, if success; False, if an error occurred
82564>>>>>>>>>
82564>>>>>>>>>External_Function WP_SetAlign "SetAlign" WinPrint.dll ; // align future text    UInteger eAlign; // left, center or rightReturns Boolean // always True
82565>>>>>>>>>
82565>>>>>>>>>External_Function WP_WriteText "WriteText" WinPrint.dll ; // write text to the current position or column    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iColumnNum;        // number of the column to write to (zero=no column, use current position)    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
82566>>>>>>>>>
82566>>>>>>>>>External_Function WP_WriteTextAtPosition "WriteTextAtPosition" WinPrint.dll ; // writes text to a specific position    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iPosition;         // horizontal position to write the text    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
82567>>>>>>>>>
82567>>>>>>>>>External_Function WP_SetProgressCaption "SetProgressCaption" WinPrint.dll ;    String sProgressCaption ;Returns Boolean
82568>>>>>>>>>
82568>>>>>>>>>External_Function WP_SetReportTitle     "SetReportTitle"     WinPrint.dll ;    String sCaption ;Returns Boolean
82569>>>>>>>>>
82569>>>>>>>>>External_Function WP_ViewerWantsToClose "ViewerWantsToClose" WinPrint.dll ;Returns Integer
82570>>>>>>>>>
82570>>>>>>>>>External_Function WP_DisplayMessageBox  "DisplayMessageBox"  WinPrint.dll ;    String sCaption String sText ;Returns Integer
82571>>>>>>>>>
82571>>>>>>>>>External_Function WP_GetViewerWindow "GetViewerWindow" Winprint.dll ;Returns Handle
82572>>>>>>>>>
82572>>>>>>>>>External_Function WP_GetDocumentStatus "GetDocumentStatus" Winprint.dll ;Returns Integer // returns dsNotStarted, dsStarted, or dsFinished
82573>>>>>>>>>
82573>>>>>>>Use WinPrint_Constants.pkg
82573>>>>>>>Use Rgb.pkg
82573>>>>>>>Use GlobalFunctionsProcedures.pkg
82573>>>>>>>
82573>>>>>>>DEFINE INFINITE for -1
82573>>>>>>>DEFINE WAIT_TIMEOUT for |CI$00000102
82573>>>>>>>
82573>>>>>>>
82573>>>>>>>DEFINE QS_KEY            for |CI$0001
82573>>>>>>>DEFINE QS_MOUSEMOVE      for |CI$0002
82573>>>>>>>DEFINE QS_MOUSEBUTTON    for |CI$0004
82573>>>>>>>DEFINE QS_POSTMESSAGE    for |CI$0008
82573>>>>>>>DEFINE QS_TIMER          for |CI$0010
82573>>>>>>>DEFINE QS_PAINT          for |CI$0020
82573>>>>>>>DEFINE QS_SENDMESSAGE    for |CI$0040
82573>>>>>>>DEFINE QS_HOTKEY         for |CI$0080
82573>>>>>>>DEFINE QS_ALLPOSTMESSAGE for |CI$0100
82573>>>>>>>DEFINE QS_MOUSE          for (QS_MOUSEMOVE ior QS_MOUSEBUTTON)
82573>>>>>>>DEFINE QS_INPUT          for (QS_MOUSE ior QS_KEY)
82573>>>>>>>DEFINE QS_ALLEVENTS      for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY)
82573>>>>>>>DEFINE QS_ALLINPUT       for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY ior QS_SENDMESSAGE)
82573>>>>>>>
82573>>>>>>>External_Function WaitForSingleObject "WaitForSingleObject" Kernel32.dll Handle hHandle Dword dwMilliseconds Returns DWord
82574>>>>>>>External_Function GetCurrentProcessId "GetCurrentProcessId" Kernel32.dll Returns DWord
82575>>>>>>>External_Function GetCurrentProcess "GetCurrentProcess" Kernel32.dll Returns DWord
82576>>>>>>>
82576>>>>>>>External_Function MsgWaitForMultipleObjects "MsgWaitForMultipleObjects" User32.dll ;    DWORD nCount;             // number of handles in the object handle array    Address pHandles;     // pointer to the object-handle array    Boolean fWaitAll;     // wait for all or wait for one    DWORD dwMilliseconds; // time-out interval in milliseconds    DWORD dwWakeMask;     // type of input events to wait forReturns Dword
82577>>>>>>>
82577>>>>>>>Use GlobalFunctionsProcedures.pkg
82577>>>>>>>
82577>>>>>>>Class cWinPrint2 is a cObject // JJT: Will we need a windows handle for this like old one
82578>>>>>>>    Procedure Construct_Object
82580>>>>>>>        forward send construct_object
82582>>>>>>>
82582>>>>>>>        //*** internal properties
82582>>>>>>>        Property Integer DFCurrent_Color       0
82583>>>>>>>        Property String  DFCurrent_OutPut      "WinPrint"
82584>>>>>>>        Property Integer DFCurrent_Diagram     0
82585>>>>>>>        Property Integer DFCurrent_HeaderType  0
82586>>>>>>>        Property Integer DFCurrent_HeaderNr    0
82587>>>>>>>        Property Number  DFCurrent_FontSize    10
82588>>>>>>>        Property String  DFCurrent_Font        "Arial"
82589>>>>>>>
82589>>>>>>>        //*** Default values for margins 2.53 CM = 1 inch
82589>>>>>>>        Property Number  DFLeft_Margin    2.53
82590>>>>>>>        Property Number  DFTop_Margin     2.53
82591>>>>>>>        Property Number  DFright_Margin   2.53
82592>>>>>>>        Property Number  DFBottom_Margin  2.53
82593>>>>>>>
82593>>>>>>>        // If WP1 this defaults to false. In 2, it is true which means that the print job
82593>>>>>>>        // dialog appears when you hitprint in previewer.
82593>>>>>>>        Property Integer PrintDlgInPreview   1
82594>>>>>>>         // This does nothing in Wp2 (because you can't to this anyway)
82594>>>>>>>        Property Integer EnablePrintSetupFromPreview  True
82595>>>>>>>        Property Integer EnablePrintFromPreview  1
82596>>>>>>>
82596>>>>>>>        // is the GUI Suspended. This is privately maintained and is used
82596>>>>>>>        // to figure out if a preview panel is up or not
82596>>>>>>>        Property Integer pbIsSuspended False
82597>>>>>>>
82597>>>>>>>        Object oDFColorArray is an Array
82599>>>>>>>           //Moved into array
82599>>>>>>>           Set Value  0  To RGB_WHITE
82600>>>>>>>           Set Value  1  To RGB_RED
82601>>>>>>>           Set Value  2  To RGB_BLUE
82602>>>>>>>           Set Value  3  To RGB_GREEN
82603>>>>>>>           Set Value  4  To RGB_YELLOW
82604>>>>>>>           Set Value  5  To RGB_GREY
82605>>>>>>>           Set Value  6  To RGB_CYAN
82606>>>>>>>           Set Value  7  To RGB_MAGENTA
82607>>>>>>>           Set Value  8  To RGB_DRED
82608>>>>>>>           Set Value  9  To RGB_DBLUE
82609>>>>>>>           Set Value  10 To RGB_DGREEN
82610>>>>>>>           Set Value  11 To RGB_DYELLOW
82611>>>>>>>           Set Value  12 To RGB_DGREY
82612>>>>>>>           Set Value  13 To RGB_DCYAN
82613>>>>>>>           Set Value  14 To RGB_DMAGENTA
82614>>>>>>>           Set Value  15 To RGB_BLACK
82615>>>>>>>        End_Object
82616>>>>>>>
82616>>>>>>>        Object oDiagramArray is an Array
82618>>>>>>>        End_Object
82619>>>>>>>
82619>>>>>>>    End_Procedure
82620>>>>>>>
82620>>>>>>>    Function ViewerWantsToClose returns Boolean
82622>>>>>>>        Function_return (WP_ViewerWantsToClose())
82623>>>>>>>    end_Function
82624>>>>>>>
82624>>>>>>>    Function IsViewerActive returns boolean
82626>>>>>>>        Function_Return (WP_GetViewerWindow()<>0)
82627>>>>>>>    end_function
82628>>>>>>>
82628>>>>>>>    Function IsPrinterValid Returns Boolean
82630>>>>>>>        Function_Return (WP_IsPrinterValid()<>0)
82631>>>>>>>    End_Function
82632>>>>>>>
82632>>>>>>>    Function ArePrintersInstalled returns boolean
82634>>>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
82635>>>>>>>    End_Function
82636>>>>>>>
82636>>>>>>>
82636>>>>>>>    // returns docucument state: dsNotStarted, dsStarted, dsFinished
82636>>>>>>>    Function DocumentStatus returns Integer
82638>>>>>>>        Function_Return (WP_GetDocumentStatus())
82639>>>>>>>    end_function
82640>>>>>>>
82640>>>>>>>    // Might still be called from report class. Leave dummy stub
82640>>>>>>>    Procedure DFZeroCounters
82642>>>>>>>    End_Procedure
82643>>>>>>>
82643>>>>>>>    //***
82643>>>>>>>    Function DFNewPage Integer Columns Returns Integer
82645>>>>>>>        Integer iPageNum
82645>>>>>>>        // This returns a page number used in report object....(this may change)
82645>>>>>>>        Move (WP_CreatePage(Columns)) To iPageNum
82646>>>>>>>        If (iPageNum=0) Begin
82648>>>>>>>            Error DFERR_WINPRINT DFPrintError900
82649>>>>>>>>
82649>>>>>>>        End
82649>>>>>>>>
82649>>>>>>>        Function_Return iPageNum
82650>>>>>>>    End_Function
82651>>>>>>>
82651>>>>>>>    //***Return handle to use for winprint dialog. If main_window
82651>>>>>>>    //   exists, use it. Else, get object's handle
82651>>>>>>>    Function Report_Window_Handle returns handle
82653>>>>>>>        Handle hWnd
82653>>>>>>>        Handle hoObj
82653>>>>>>>        Get Focus of desktop to hoObj // start with the focus
82654>>>>>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
82655>>>>>>>        function_return hWnd
82656>>>>>>>    End_Function
82657>>>>>>>
82657>>>>>>>
82657>>>>>>>    //***
82657>>>>>>>    Function DFPrintDialog Returns Boolean
82659>>>>>>>        Handle hwnd
82659>>>>>>>        Boolean bOk
82659>>>>>>>
82659>>>>>>>        Get Report_Window_Handle to hWnd
82660>>>>>>>        Move (WP_ExecutePrintDialog(hwnd)) To bOk
82661>>>>>>>
82661>>>>>>>        Function_Return bOk
82662>>>>>>>    End_Function
82663>>>>>>>
82663>>>>>>>
82663>>>>>>>    //*** You can only invoke the print setup if the report is cleared. If you try to to do this in
82663>>>>>>>    //    the wrong state you will get an error.
82663>>>>>>>    Function DFPrintSetupDialog Returns Boolean
82665>>>>>>>        Handle hwnd
82665>>>>>>>        Boolean bOk
82665>>>>>>>        Integer iStatus
82665>>>>>>>        Get ArePrintersInstalled to bOk
82666>>>>>>>        If not bOk Begin
82668>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
82669>>>>>>>>
82669>>>>>>>        End
82669>>>>>>>>
82669>>>>>>>        Else Begin
82670>>>>>>>            Get DocumentStatus to iStatus
82671>>>>>>>            
82671>>>>>>>            If (iStatus=dsNotStarted) Begin
82673>>>>>>>                Get Report_Window_Handle to hWnd
82674>>>>>>>                Move (WP_ExecutePrinterSetupDialog(hwnd)) to bOk
82675>>>>>>>                
82675>>>>>>>                // test that the selected printer is valid....
82675>>>>>>>                If bOK Begin
82677>>>>>>>                    Get IsPrinterValid to bOk // if printer not valid, it's not ok
82678>>>>>>>                    If not bOk Begin
82680>>>>>>>                        Error DFERR_WINPRINT DFPrintError936  // could not select a valid printer
82681>>>>>>>>
82681>>>>>>>                    End
82681>>>>>>>>
82681>>>>>>>                End
82681>>>>>>>>
82681>>>>>>>            End
82681>>>>>>>>
82681>>>>>>>            Else Begin
82682>>>>>>>               Error DFERR_WINPRINT DFPrintError966      // cannot change printer when report is active
82683>>>>>>>>
82683>>>>>>>            End
82683>>>>>>>>
82683>>>>>>>        End
82683>>>>>>>>
82683>>>>>>>        Function_Return bOk
82684>>>>>>>    End_Function
82685>>>>>>>
82685>>>>>>>
82685>>>>>>>    //*** Provided for backwards compatibility. DFPrintSetupDialog is more flexible because it returns a
82685>>>>>>>    //    false if cancel was selected.
82685>>>>>>>    Procedure DFPrintSetup
82687>>>>>>>        Boolean bOk
82687>>>>>>>        Get DFPrintSetupDialog to bOk
82688>>>>>>>    End_Procedure
82689>>>>>>>
82689>>>>>>>    //*** This invokes the print job dialog, prints the report, then clears the report document.
82689>>>>>>>    //    This should be called after the report is complete.
82689>>>>>>>    Procedure DFPrint
82691>>>>>>>        Integer bOk
82691>>>>>>>        Get DFPrintDialog To bOk
82692>>>>>>>        If bOk Begin
82694>>>>>>>            Send DFPrintDoc
82695>>>>>>>            Send DFClearDoc
82696>>>>>>>        End
82696>>>>>>>>
82696>>>>>>>    End_Procedure
82697>>>>>>>
82697>>>>>>>    Procedure DFSuspendGui boolean bSuspend
82699>>>>>>>        If (bSuspend<>pbIsSuspended(self)) begin
82701>>>>>>>            Send SuspendGui of Desktop bSuspend
82702>>>>>>>            Set pbIsSuspended to bSuspend
82703>>>>>>>        end
82703>>>>>>>>
82703>>>>>>>    end_procedure
82704>>>>>>>
82704>>>>>>>    // this is protected so that the queue is only pumped if the
82704>>>>>>>    // gui is suspended.
82704>>>>>>>    Procedure PumpMsgQueue
82706>>>>>>>        If (pbIsSuspended(self)) begin
82708>>>>>>>            Send PumpMsgQueue of desktop // permit painting
82709>>>>>>>        end
82709>>>>>>>>
82709>>>>>>>    end_procedure
82710>>>>>>>
82710>>>>>>>
82710>>>>>>>    //*** This does a modeless preview. This is what you'd want during
82710>>>>>>>    //    report generation and it may be what you want for report viewing.
82710>>>>>>>    Procedure DFPreviewNoWait
82712>>>>>>>        Boolean bOk
82712>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
82712>>>>>>>        integer iStatus
82712>>>>>>>        Get PrintDlgInPreview to bPrntDlg
82713>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
82714>>>>>>>        Get EnablePrintFromPreview to bPrint
82715>>>>>>>        Get DocumentStatus to iStatus
82716>>>>>>>        If (iStatus=dsStarted) begin
82718>>>>>>>            Send DfSuspendGui True
82719>>>>>>>        end
82719>>>>>>>>
82719>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To bOk
82720>>>>>>>        If not bOk Begin
82722>>>>>>>            Error DFERR_WINPRINT DFPrintError901
82723>>>>>>>>
82723>>>>>>>            Send DfSuspendGui False
82724>>>>>>>        End
82724>>>>>>>>
82724>>>>>>>    End_Procedure
82725>>>>>>>
82725>>>>>>>
82725>>>>>>>    //*** This does a modal preview. You might want this for report
82725>>>>>>>    //    viewing as the program knows when the viewer is closed
82725>>>>>>>    // Note that this is a private message and it was never intended that this
82725>>>>>>>    // should be used. We expect winprint reports to use modeless viewers.
82725>>>>>>>    Procedure DFPreviewWait
82727>>>>>>>        Handle hViewerProcess
82727>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
82727>>>>>>>        Integer iRetVal
82727>>>>>>>        Integer hwMain hMain
82727>>>>>>>
82727>>>>>>>        Get PrintDlgInPreview to bPrntDlg
82728>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
82729>>>>>>>        Get EnablePrintFromPreview to bPrint
82730>>>>>>>
82730>>>>>>>        Send DfSuspendGui True
82731>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To hViewerProcess
82732>>>>>>>
82732>>>>>>>        If (hViewerProcess = 0) Begin
82734>>>>>>>            Error DFERR_WINPRINT DFPrintError901
82735>>>>>>>>
82735>>>>>>>        End
82735>>>>>>>>
82735>>>>>>>        Else Begin
82736>>>>>>>            // We need to wait for either the Viewer to close, or a WM_PAINT message in the thread's queue...
82736>>>>>>>            Repeat
82736>>>>>>>>
82736>>>>>>>               Move (MsgWaitForMultipleObjects(1, AddressOf(hViewerProcess), False, INFINITE, QS_PAINT)) To iRetVal
82737>>>>>>>               Send PumpMsgQueue // permit painting
82738>>>>>>>            Until (iRetVal = 0) // 0 means that the viewer process terminated
82740>>>>>>>        end
82740>>>>>>>>
82740>>>>>>>        Send DfSuspendGui False
82741>>>>>>>
82741>>>>>>>       // Do what we can to force VDF application to the top.
82741>>>>>>>       // As 12.0 dfSuspendGUI actually properly disables the underlying windows. When the viewer
82741>>>>>>>       // is closed it cannot give the focus back to this so it goes elsewhere. This will force it
82741>>>>>>>       // back. 
82741>>>>>>>
82741>>>>>>>       Get main_window of desktop to hMain
82742>>>>>>>       If hMain Begin
82744>>>>>>>          Get window_handle of hMain to hwMain
82745>>>>>>>          If hwMain Begin
82747>>>>>>>              If (GetForegroundWindow()<>hwMain) Begin
82749>>>>>>>                  Move (SetForegroundWindow(hwMain)) to hwMain
82750>>>>>>>              End
82750>>>>>>>>
82750>>>>>>>          End
82750>>>>>>>>
82750>>>>>>>       End
82750>>>>>>>>
82750>>>>>>>
82750>>>>>>>    End_Procedure
82751>>>>>>>
82751>>>>>>>    Procedure DfPreview
82753>>>>>>>        send DfPreviewNoWait
82754>>>>>>>    end_procedure
82755>>>>>>>
82755>>>>>>>
82755>>>>>>>    //***
82755>>>>>>>    Procedure DFPrintDoc
82757>>>>>>>        Handle hwnd
82757>>>>>>>        Boolean bOk
82757>>>>>>>        Get Report_Window_Handle to hWnd
82758>>>>>>>        Move (WP_PrintDocument(hwnd)) To bOk
82759>>>>>>>
82759>>>>>>>        If not bOk Begin
82761>>>>>>>            Error DFERR_WINPRINT DFPrintError902
82762>>>>>>>>
82762>>>>>>>        End
82762>>>>>>>>
82762>>>>>>>    End_Procedure
82763>>>>>>>
82763>>>>>>>
82763>>>>>>>    //***
82763>>>>>>>    Procedure DFClearDoc
82765>>>>>>>        Boolean bOk
82765>>>>>>>        Get ArePrintersInstalled to bOk
82766>>>>>>>        If bOk begin
82768>>>>>>>            Move (WP_ClearDocument()) To bOk
82769>>>>>>>            Send DFSuspendGUI False
82770>>>>>>>            If not bOk Begin
82772>>>>>>>               Error DFERR_WINPRINT DFPrintError903 // error number right?
82773>>>>>>>>
82773>>>>>>>            End
82773>>>>>>>>
82773>>>>>>>        End
82773>>>>>>>>
82773>>>>>>>    End_Procedure
82774>>>>>>>
82774>>>>>>>    Procedure DFNewDoc Boolean bAutoPreview
82776>>>>>>>        Boolean bOk
82776>>>>>>>        // this is the most likely place we will encounter when we start a report. Check for
82776>>>>>>>        // printers and return an explicit error to make it easy to identify the error
82776>>>>>>>        Get ArePrintersInstalled to bOk
82777>>>>>>>        If not bOk begin
82779>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
82780>>>>>>>>
82780>>>>>>>        end
82780>>>>>>>>
82780>>>>>>>        else begin
82781>>>>>>>            Send DfClearDoc //JJT - a new doc should always start with a clear
82782>>>>>>>            If bAutoPreview Send DFSuspendGUI True
82785>>>>>>>            Move (WP_NewDocument(bAutoPreview)) To bOk
82786>>>>>>>
82786>>>>>>>            If not bOk Begin
82788>>>>>>>               Error DFERR_WINPRINT DFPrintError902  // could not print document
82789>>>>>>>>
82789>>>>>>>               Send DFSuspendGUI False
82790>>>>>>>            End
82790>>>>>>>>
82790>>>>>>>        end
82790>>>>>>>>
82790>>>>>>>    End_Procedure
82791>>>>>>>
82791>>>>>>>    //***
82791>>>>>>>    Procedure DFSetFont String sFontName
82793>>>>>>>        boolean bOk
82793>>>>>>>        Move (WP_SetFontName(sFontName)) To bOk
82794>>>>>>>
82794>>>>>>>        If not bOK Begin
82796>>>>>>>            Error DFERR_WINPRINT DFPrintError904
82797>>>>>>>>
82797>>>>>>>        End
82797>>>>>>>>
82797>>>>>>>    End_Procedure
82798>>>>>>>
82798>>>>>>>
82798>>>>>>>    //***
82798>>>>>>>    Procedure DFSetFontSize Integer iHeight Integer iWidth
82800>>>>>>>        boolean bOk
82800>>>>>>>        // note that width is ignored in new implementation
82800>>>>>>>        Move (WP_SetFontHeight(iHeight)) To bOk
82801>>>>>>>
82801>>>>>>>        If not bOK Begin
82803>>>>>>>            Error DFERR_WINPRINT  DFPrintError905
82804>>>>>>>>
82804>>>>>>>        End
82804>>>>>>>>
82804>>>>>>>    End_Procedure
82805>>>>>>>
82805>>>>>>>
82805>>>>>>>    //***
82805>>>>>>>    Procedure DFSetFontStyle DWORD dwStyle
82807>>>>>>>        boolean bOk
82807>>>>>>>        Move (WP_SetFontStyle(dwStyle)) To bOk
82808>>>>>>>
82808>>>>>>>        If not bOK Begin
82810>>>>>>>            Error DFERR_WINPRINT DFPrintError906
82811>>>>>>>>
82811>>>>>>>        End
82811>>>>>>>>
82811>>>>>>>    End_Procedure
82812>>>>>>>
82812>>>>>>>
82812>>>>>>>    //***
82812>>>>>>>    Procedure DFSetUnderline boolean bUnderline
82814>>>>>>>        boolean bOk
82814>>>>>>>
82814>>>>>>>        Move (WP_SetFontUnderline(bUnderline)) To bOk
82815>>>>>>>
82815>>>>>>>        If not bOK Begin
82817>>>>>>>            Error DFERR_WINPRINT DFPrintError907
82818>>>>>>>>
82818>>>>>>>        End
82818>>>>>>>>
82818>>>>>>>    End_Procedure
82819>>>>>>>
82819>>>>>>>
82819>>>>>>>    //***
82819>>>>>>>    Procedure DFSetBold Boolean bBold
82821>>>>>>>        Boolean bOk
82821>>>>>>>
82821>>>>>>>        Move (WP_SetFontBold(bBold)) To bOk
82822>>>>>>>
82822>>>>>>>        If not bOK Begin
82824>>>>>>>            Error DFERR_WINPRINT DFPrintError908
82825>>>>>>>>
82825>>>>>>>        End
82825>>>>>>>>
82825>>>>>>>    End_Procedure
82826>>>>>>>
82826>>>>>>>
82826>>>>>>>    //***
82826>>>>>>>    Procedure DFSetItalic Boolean bItalic
82828>>>>>>>        Boolean bOk
82828>>>>>>>
82828>>>>>>>        Move (WP_SetFontItalic(bItalic)) To bOk
82829>>>>>>>
82829>>>>>>>        If not bOK Begin
82831>>>>>>>            Error DFERR_WINPRINT DFPrintError909
82832>>>>>>>>
82832>>>>>>>        End
82832>>>>>>>>
82832>>>>>>>    End_Procedure
82833>>>>>>>
82833>>>>>>>
82833>>>>>>>    //***
82833>>>>>>>    Procedure DFSetStrikeout Boolean bStrikeout
82835>>>>>>>        Boolean bOk
82835>>>>>>>
82835>>>>>>>        Move (WP_SetFontStrikeout(bStrikeout)) To bOk
82836>>>>>>>
82836>>>>>>>        If not bOK Begin
82838>>>>>>>            Error DFERR_WINPRINT DFPrintError910
82839>>>>>>>>
82839>>>>>>>        End
82839>>>>>>>>
82839>>>>>>>    End_Procedure
82840>>>>>>>
82840>>>>>>>
82840>>>>>>>    //***
82840>>>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
82842>>>>>>>        Boolean bOk
82842>>>>>>>        integer iLeft iRight iTop iBottom
82842>>>>>>>
82842>>>>>>>        Move (nLeft   * 100) to iLeft
82843>>>>>>>        Move (nRight  * 100) to iRight
82844>>>>>>>        Move (nTop    * 100) to iTop
82845>>>>>>>        Move (nBottom * 100) to iBottom
82846>>>>>>>
82846>>>>>>>        Move (WP_SetMargins(iLeft,iTop,iRight,iBottom)) To bOk
82847>>>>>>>
82847>>>>>>>        If bOk Begin
82849>>>>>>>            Set DFLeft_Margin   To nLeft
82850>>>>>>>            Set DFTop_Margin    To nTop
82851>>>>>>>            Set DFRight_Margin  To nRight
82852>>>>>>>            Set DFBottom_Margin To nBottom
82853>>>>>>>        End
82853>>>>>>>>
82853>>>>>>>        Else Begin
82854>>>>>>>            Error DFERR_WINPRINT DFPrintError911
82855>>>>>>>>
82855>>>>>>>        End
82855>>>>>>>>
82855>>>>>>>    End_Procedure
82856>>>>>>>
82856>>>>>>>
82856>>>>>>>    //***
82856>>>>>>>    Procedure DFSetLeftMargin Number nLeft
82858>>>>>>>        number  nTop nRight nBottom
82858>>>>>>>        Get DFTop_Margin    To nTop
82859>>>>>>>        Get DFRight_Margin  To nRight
82860>>>>>>>        Get DFBottom_Margin To nBottom
82861>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82862>>>>>>>    End_Procedure
82863>>>>>>>
82863>>>>>>>
82863>>>>>>>    //***
82863>>>>>>>    Procedure DFSetRightMargin Number nRight
82865>>>>>>>        number  nLeft nTop nBottom
82865>>>>>>>        Get DFLeft_Margin   To nLeft
82866>>>>>>>        Get DFTop_Margin    To nTop
82867>>>>>>>        Get DFBottom_Margin To nBottom
82868>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82869>>>>>>>    End_Procedure
82870>>>>>>>
82870>>>>>>>
82870>>>>>>>    //***
82870>>>>>>>    Procedure DFSetTopMargin Number nTop
82872>>>>>>>        number  nLeft nRight nBottom
82872>>>>>>>        Get DFLeft_Margin   To nLeft
82873>>>>>>>        Get DFRight_Margin  To nRight
82874>>>>>>>        Get DFBottom_Margin To nBottom
82875>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82876>>>>>>>    End_Procedure
82877>>>>>>>
82877>>>>>>>
82877>>>>>>>    //***
82877>>>>>>>    Procedure DFSetBottomMargin Number nBottom
82879>>>>>>>        number  nLeft nTop nRight
82879>>>>>>>        Get DFLeft_Margin   To nLeft
82880>>>>>>>        Get DFTop_Margin    To nTop
82881>>>>>>>        Get DFRight_Margin  To nRight
82882>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
82883>>>>>>>    End_Procedure
82884>>>>>>>
82884>>>>>>>
82884>>>>>>>    //***
82884>>>>>>>    Procedure DFWriteText String sText Integer iStyle Integer iColumn Integer iDecimal Boolean bNewLineAfterPrint
82886>>>>>>>        Boolean bOk
82886>>>>>>>
82886>>>>>>>        Send DFSetFontStyle iStyle
82887>>>>>>>        Get ToAnsi sText To sText
82888>>>>>>>        Move (WP_WriteText(sText,bNewLineAfterPrint,iColumn,iDecimal,0)) To bOk
82889>>>>>>>        If not bOk Begin
82891>>>>>>>            Error DFERR_WINPRINT DFPrintError918
82892>>>>>>>>
82892>>>>>>>        End
82892>>>>>>>>
82892>>>>>>>        Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
82893>>>>>>>    End_Procedure
82894>>>>>>>
82894>>>>>>>    //***
82894>>>>>>>    Procedure DFWrite String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
82896>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
82898>>>>>>>            Move (Rtrim(sText)) to sText
82899>>>>>>>        end
82899>>>>>>>>
82899>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal False
82900>>>>>>>    End_Procedure
82901>>>>>>>
82901>>>>>>>    //***
82901>>>>>>>    Procedure DFWriteLn String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
82903>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
82905>>>>>>>            Move (Rtrim(sText)) to sText
82906>>>>>>>        end
82906>>>>>>>>
82906>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal True
82907>>>>>>>    End_Procedure
82908>>>>>>>
82908>>>>>>>
82908>>>>>>>    //***
82908>>>>>>>    Procedure DFWriteTextAtPosition String sText integer iStyle Number nPosition Integer iDecimal ;                                    Number nMaxLength Boolean bNewLineAfterPrint
82910>>>>>>>        Boolean bOk
82910>>>>>>>        Integer iPosition iMaxLength
82910>>>>>>>        Send DFSetFontStyle iStyle
82911>>>>>>>        Get ToAnsi sText To sText
82912>>>>>>>        Move (nPosition * 100) to iPosition
82913>>>>>>>        Move (nMaxLength * 100) to iMaxLength
82914>>>>>>>        Move (WP_WriteTextAtPosition(sText,bNewLineAfterPrint,iPosition,iDecimal,iMaxLength)) To bOk
82915>>>>>>>        If not bOk Begin
82917>>>>>>>            Error DFERR_WINPRINT DFPrintError922
82918>>>>>>>>
82918>>>>>>>        End
82918>>>>>>>>
82918>>>>>>>         Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
82919>>>>>>>    End_Procedure
82920>>>>>>>
82920>>>>>>>    //***
82920>>>>>>>    Procedure DFWritePos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
82922>>>>>>>        Number nMax
82922>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
82924>>>>>>>            Move (Rtrim(sText)) to sText
82925>>>>>>>        end
82925>>>>>>>>
82925>>>>>>>
82925>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
82928>>>>>>>        Else ;            Move nMaxLength to nMax
82930>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax False
82931>>>>>>>    End_Procedure
82932>>>>>>>
82932>>>>>>>    //***
82932>>>>>>>    Procedure DFWriteLnPos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
82934>>>>>>>        Number nMax
82934>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
82936>>>>>>>            Move (Rtrim(sText)) to sText
82937>>>>>>>        end
82937>>>>>>>>
82937>>>>>>>
82937>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
82940>>>>>>>        Else ;            Move nMaxLength to nMax
82942>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax True
82943>>>>>>>    End_Procedure
82944>>>>>>>
82944>>>>>>>    Procedure DFSetMetrics String sMetrics
82946>>>>>>>        integer eMetrics
82946>>>>>>>        // for backwards compatibility support both string names and integer enumerations
82946>>>>>>>        // it is better to use the enumeration value
82946>>>>>>>        If (sMetrics="INCH" or sMetrics="CM") Begin
82948>>>>>>>            Set DFCurrent_Metrics to sMetrics
82949>>>>>>>        end
82949>>>>>>>>
82949>>>>>>>        else Begin
82950>>>>>>>            Move sMetrics to eMetrics
82951>>>>>>>            Move (WP_SetMetrics(eMetrics)) To eMetrics
82952>>>>>>>        End
82952>>>>>>>>
82952>>>>>>>    End_Procedure
82953>>>>>>>
82953>>>>>>>    Function DFGetMetrics Returns Integer
82955>>>>>>>        Integer eMetrics
82955>>>>>>>        Move (WP_GetMetrics()) To eMetrics
82956>>>>>>>        Function_return eMetrics
82957>>>>>>>    End_Function
82958>>>>>>>
82958>>>>>>>
82958>>>>>>>    //**** Properties Maintained for compatibility with old Winprint (obsolete)
82958>>>>>>>    Function DFCurrent_Metrics returns string
82960>>>>>>>        Integer eMetrics
82960>>>>>>>        Get DFGetMetrics to eMetrics
82961>>>>>>>        Function_return (if(eMetrics=WPM_INCH,"INCH","CM"))
82962>>>>>>>    end_function
82963>>>>>>>
82963>>>>>>>    Procedure Set DFCurrent_Metrics string sCMorINCH
82965>>>>>>>        Send DFSetMetrics (if(sCMorINCH="INCH", WPM_INCH, WPM_CM))
82966>>>>>>>    End_Procedure
82967>>>>>>>
82967>>>>>>>
82967>>>>>>>
82967>>>>>>>
82967>>>>>>>
82967>>>>>>>    //***
82967>>>>>>>    Procedure DFBeginHeaderType Integer iHeaderNr Integer eHeaderType
82969>>>>>>>        Boolean bOk
82969>>>>>>>
82969>>>>>>>        If (eHeaderType=DFSubHeader or eHeaderType=DFSubTotal) Begin
82971>>>>>>>            //*** Do nothing for the moment
82971>>>>>>>        End
82971>>>>>>>>
82971>>>>>>>        Else ;            Move 0 to iHeaderNr // If the user made a mistake
82973>>>>>>>
82973>>>>>>>        Set DFCurrent_HeaderType To eHeaderType
82974>>>>>>>        Set DFCurrent_HeaderNr   To iHeaderNr
82975>>>>>>>
82975>>>>>>>        Move (WP_BeginHeader(eHeaderType, iHeaderNr)) To bOk
82976>>>>>>>
82976>>>>>>>        If not bOk Begin
82978>>>>>>>            Error DFERR_WINPRINT DFPrintError925
82979>>>>>>>>
82979>>>>>>>        End
82979>>>>>>>>
82979>>>>>>>    End_Procedure
82980>>>>>>>
82980>>>>>>>
82980>>>>>>>    //***
82980>>>>>>>    Procedure DFEndHeaderType
82982>>>>>>>        Boolean bOk
82982>>>>>>>
82982>>>>>>>        Move (WP_EndHeader()) To bOk
82983>>>>>>>
82983>>>>>>>        if not bOk begin
82985>>>>>>>            Error DFERR_WINPRINT DFPrintError926
82986>>>>>>>>
82986>>>>>>>        End
82986>>>>>>>>
82986>>>>>>>    End_Procedure
82987>>>>>>>
82987>>>>>>>
82987>>>>>>>    //***
82987>>>>>>>    Procedure DFWriteHeaderType Integer iHeaderNr Integer eHeaderType
82989>>>>>>>        Boolean bOk
82989>>>>>>>        Move (WP_WriteHeader(eHeaderType, iHeaderNr)) To bOk
82990>>>>>>>        if not bOk begin
82992>>>>>>>            Error DFERR_WINPRINT DFPrintError927
82993>>>>>>>>
82993>>>>>>>        End
82993>>>>>>>>
82993>>>>>>>    End_Procedure
82994>>>>>>>
82994>>>>>>>
82994>>>>>>>    //***
82994>>>>>>>    Procedure DFHeaderPosition Integer ePlace
82996>>>>>>>        Boolean bOk
82996>>>>>>>
82996>>>>>>>         Move (WP_SetHeaderPlacement(ePlace)) To bOk
82997>>>>>>>
82997>>>>>>>         if not bOk begin
82999>>>>>>>            Error DFERR_WINPRINT DFPrintError929
83000>>>>>>>>
83000>>>>>>>        End
83000>>>>>>>>
83000>>>>>>>    End_Procedure
83001>>>>>>>
83001>>>>>>>
83001>>>>>>>    //***
83001>>>>>>>    Procedure DFHeaderFrameType Integer eFrame integer iColor Number nWeight;                                Integer iFillColor Boolean bFillFrame
83003>>>>>>>        Integer iWeight
83003>>>>>>>        Boolean bOk
83003>>>>>>>
83003>>>>>>>        move (nWeight*100) To iWeight
83004>>>>>>>
83004>>>>>>>        Move (WP_SetHeaderFrame(eFrame,iColor,iWeight,iFillColor,bFillFrame)) To bOk
83005>>>>>>>
83005>>>>>>>         if not bOk begin
83007>>>>>>>            Error DFERR_WINPRINT DFPrintError930
83008>>>>>>>>
83008>>>>>>>        End
83008>>>>>>>>
83008>>>>>>>    End_Procedure
83009>>>>>>>
83009>>>>>>>  Procedure DFHeaderMargin Integer eType Number nSize
83011>>>>>>>        Boolean bOk
83011>>>>>>>        Integer iSize
83011>>>>>>>
83011>>>>>>>        move (nSize * 100) to iSize
83012>>>>>>>
83012>>>>>>>        move (WP_SetHeaderMargin(eType, iSize)) To bOk
83013>>>>>>>
83013>>>>>>>        if not bOk begin
83015>>>>>>>            Error DFERR_WINPRINT DFPrintError930
83016>>>>>>>>
83016>>>>>>>        end
83016>>>>>>>>
83016>>>>>>>    End_Procedure
83017>>>>>>>
83017>>>>>>>
83017>>>>>>>    //***
83017>>>>>>>    Procedure DFHeaderWrap Integer eOnOff
83019>>>>>>>         Boolean bOk
83019>>>>>>>
83019>>>>>>>         Move (WP_SetHeaderWrap(eOnOff)) To bOk
83020>>>>>>>
83020>>>>>>>         if not bOk begin
83022>>>>>>>            Error DFERR_WINPRINT DFPrintError931
83023>>>>>>>>
83023>>>>>>>        End
83023>>>>>>>>
83023>>>>>>>    End_Procedure
83024>>>>>>>
83024>>>>>>>    //***
83024>>>>>>>    Procedure DFWriteBMP String sFileName Number nStartX Number nStartY Number nHeight Number nWidth Boolean bUCp
83026>>>>>>>        Boolean bOk
83026>>>>>>>        Integer iStartX iStartY iHeight iWidth
83026>>>>>>>
83026>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX to iStartX
83029>>>>>>>        else ;            move (nStartX*100) To iStartX
83031>>>>>>>
83031>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY to iStartY
83034>>>>>>>        else ;            move (nStartY*100) To iStartY
83036>>>>>>>
83036>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
83039>>>>>>>        else ;            move (nWidth*100) To iWidth
83041>>>>>>>
83041>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
83044>>>>>>>        else ;            move (nHeight*100) To iHeight
83046>>>>>>>
83046>>>>>>>        Get_File_Path sFileName To sFileName
83047>>>>>>>        Move (WP_DrawBitmap(sFileName,iStartX,iStartY,iWidth,iHeight,bUCp)) to bOk
83048>>>>>>>
83048>>>>>>>        If not bOk Begin
83050>>>>>>>            Error DFERR_WINPRINT DFPrintError932
83051>>>>>>>>
83051>>>>>>>        End
83051>>>>>>>>
83051>>>>>>>    End_Procedure
83052>>>>>>>
83052>>>>>>>
83052>>>>>>>    //***
83052>>>>>>>    Procedure DFHeaderLineCheck Integer iLines
83054>>>>>>>        Boolean bOk
83054>>>>>>>
83054>>>>>>>         Move (WP_SetExtraLineCheck(iLines)) To bOk
83055>>>>>>>
83055>>>>>>>        If not bOk begin
83057>>>>>>>            Error DFERR_WINPRINT DFPrintError934
83058>>>>>>>>
83058>>>>>>>        End
83058>>>>>>>>
83058>>>>>>>    End_Procedure
83059>>>>>>>
83059>>>>>>>
83059>>>>>>>    //***
83059>>>>>>>    Procedure DFPrintFlags Integer Flags
83061>>>>>>>        Boolean bOk
83061>>>>>>>
83061>>>>>>>         Move (WP_SetPrintDialogFlags(Flags)) To bOk
83062>>>>>>>
83062>>>>>>>        If not bOk begin
83064>>>>>>>            Error DFERR_WINPRINT DFPrintError935
83065>>>>>>>>
83065>>>>>>>        End
83065>>>>>>>>
83065>>>>>>>    End_Procedure
83066>>>>>>>
83066>>>>>>>
83066>>>>>>>    //*** obsolete and maintained for winprint-I backwards compatibility (maybe should be removed)
83066>>>>>>>    //
83066>>>>>>>    Procedure DFSelectPrinter String sDriver String sDevice String sPort Boolean bUpdate
83068>>>>>>>        Send DFSetDevice sDevice
83069>>>>>>>    End_Procedure
83070>>>>>>>
83070>>>>>>>    //*** Preferred usage for WinprintII
83070>>>>>>>    Procedure DFSetDevice String sDevice
83072>>>>>>>        Boolean bOk
83072>>>>>>>
83072>>>>>>>        Move (WP_SelectPrinter(sDevice)) To bOk
83073>>>>>>>
83073>>>>>>>        If not bOk Begin
83075>>>>>>>            Error DFERR_WINPRINT DFPrintError936
83076>>>>>>>>
83076>>>>>>>        End
83076>>>>>>>>
83076>>>>>>>    End_Procedure
83077>>>>>>>
83077>>>>>>>    Procedure DFPrinterBinFirstPage Integer eBin
83079>>>>>>>        Boolean bOk
83079>>>>>>>
83079>>>>>>>         Move (WP_SetFirstPagePaperSource(eBin)) To bOk
83080>>>>>>>
83080>>>>>>>        If not bOk Begin
83082>>>>>>>            Error DFERR_WINPRINT DFPrintError937
83083>>>>>>>>
83083>>>>>>>        End
83083>>>>>>>>
83083>>>>>>>    End_Procedure
83084>>>>>>>
83084>>>>>>>
83084>>>>>>>    //***
83084>>>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
83086>>>>>>>        Integer iColor
83086>>>>>>>
83086>>>>>>>         Move (WP_RGBToDFPrintColor(iRed,iGreen,iBlue)) To iColor
83087>>>>>>>
83087>>>>>>>        If (iColor=0) Begin
83089>>>>>>>            Error DFERR_WINPRINT DFPrintError938
83090>>>>>>>>
83090>>>>>>>        End
83090>>>>>>>>
83090>>>>>>>        Function_Return iColor
83091>>>>>>>    End_Function
83092>>>>>>>
83092>>>>>>>
83092>>>>>>>    //***
83092>>>>>>>    Procedure DFSetDFColor Dword dwColor
83094>>>>>>>        Integer bOk
83094>>>>>>>
83094>>>>>>>         Move (WP_SetFontColor(dwColor)) To bOk
83095>>>>>>>
83095>>>>>>>        If not bOk Begin
83097>>>>>>>            Error DFERR_WINPRINT DFPrintError939
83098>>>>>>>>
83098>>>>>>>        End
83098>>>>>>>>
83098>>>>>>>    End_Procedure
83099>>>>>>>
83099>>>>>>>
83099>>>>>>>    //***
83099>>>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
83101>>>>>>>        Boolean bOk
83101>>>>>>>        Integer iTop iBottom
83101>>>>>>>
83101>>>>>>>        move (nTop*100)    To iTop
83102>>>>>>>        move (nBottom*100) To iBottom
83103>>>>>>>
83103>>>>>>>        Move (WP_SetAbsoluteMargins(iTop,iBottom,bAllPages)) To bOk
83104>>>>>>>
83104>>>>>>>        If Not bOk Begin
83106>>>>>>>            Error DFERR_WINPRINT DFPrintError940
83107>>>>>>>>
83107>>>>>>>        End
83107>>>>>>>>
83107>>>>>>>    End_Procedure
83108>>>>>>>
83108>>>>>>>
83108>>>>>>>    //***
83108>>>>>>>    Procedure DFSetJMode Integer eAlign
83110>>>>>>>        Boolean bOk
83110>>>>>>>
83110>>>>>>>        Move (WP_SetAlign(eAlign)) To bOk
83111>>>>>>>
83111>>>>>>>        If Not bOk Begin
83113>>>>>>>            Error DFERR_WINPRINT DFPrintError941
83114>>>>>>>>
83114>>>>>>>        End
83114>>>>>>>>
83114>>>>>>>    End_Procedure
83115>>>>>>>
83115>>>>>>>
83115>>>>>>>    //***
83115>>>>>>>    Procedure DFWriteEllip Number nStartX Number nStartY Number nHeight Number nWidth ;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
83117>>>>>>>
83117>>>>>>>        Boolean bOk
83117>>>>>>>        Integer iWeight
83117>>>>>>>        Integer iStartX iStartY iHeight iWidth
83117>>>>>>>
83117>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
83120>>>>>>>        else ;            move (nStartX*100) To iStartX
83122>>>>>>>
83122>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
83125>>>>>>>        else ;            move (nStartY*100) To iStartY
83127>>>>>>>
83127>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
83130>>>>>>>        else ;            move (nWidth*100) To iWidth
83132>>>>>>>
83132>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
83135>>>>>>>        else ;            move (nHeight*100) To iHeight
83137>>>>>>>
83137>>>>>>>        move (nWeight*100) To iWeight
83138>>>>>>>
83138>>>>>>>
83138>>>>>>>        Move (WP_DrawEllipse(iStartX,iStartY,iWidth,iHeight,;                        dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
83139>>>>>>>
83139>>>>>>>        If Not bOk Begin
83141>>>>>>>            Error DFERR_WINPRINT DFPrintError942
83142>>>>>>>>
83142>>>>>>>        End
83142>>>>>>>>
83142>>>>>>>    End_Procedure
83143>>>>>>>
83143>>>>>>>
83143>>>>>>>
83143>>>>>>>
83143>>>>>>>    //***
83143>>>>>>>    Procedure DFWriteRect Number nStartX Number nStartY Number nHeight Number nWidth;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
83145>>>>>>>
83145>>>>>>>        Boolean bOk
83145>>>>>>>        Integer iWeight
83145>>>>>>>        Integer iStartX iStartY iHeight iWidth
83145>>>>>>>
83145>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
83148>>>>>>>        else ;            move (nStartX*100) To iStartX
83150>>>>>>>
83150>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
83153>>>>>>>        else ;            move (nStartY*100) To iStartY
83155>>>>>>>
83155>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
83158>>>>>>>        else ;            move (nWidth*100) To iWidth
83160>>>>>>>
83160>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
83163>>>>>>>        else ;            move (nHeight*100) To iHeight
83165>>>>>>>
83165>>>>>>>        move (nWeight*100) To iWeight
83166>>>>>>>
83166>>>>>>>        Move (WP_DrawRectangle(iStartX,iStartY,iWidth,iHeight,;                            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
83167>>>>>>>
83167>>>>>>>        If Not bOk Begin
83169>>>>>>>            Error DFERR_WINPRINT DFPrintError944
83170>>>>>>>>
83170>>>>>>>        End
83170>>>>>>>>
83170>>>>>>>    End_Procedure
83171>>>>>>>
83171>>>>>>>
83171>>>>>>>
83171>>>>>>>
83171>>>>>>>    //***
83171>>>>>>>    Procedure DFLineCheck Integer iLines
83173>>>>>>>        Boolean bOk
83173>>>>>>>
83173>>>>>>>        Move (WP_ConfirmLines(iLines)) To bOk
83174>>>>>>>
83174>>>>>>>        If Not bOk Begin
83176>>>>>>>            Error DFERR_WINPRINT DFPrintError946
83177>>>>>>>>
83177>>>>>>>        End
83177>>>>>>>>
83177>>>>>>>    End_Procedure
83178>>>>>>>
83178>>>>>>>
83178>>>>>>>    //***
83178>>>>>>>    Procedure DFCreateDiagram Integer eType Integer eFx Number nHeight Number nWidth Integer bXyAxis
83180>>>>>>>        Handle hDiagram
83180>>>>>>>        Integer iWidth iHeight
83180>>>>>>>
83180>>>>>>>        move (nHeight*100) To iHeight
83181>>>>>>>        move (nWidth*100)  To iWidth
83182>>>>>>>
83182>>>>>>>        Set DFCurrent_Color To 0
83183>>>>>>>
83183>>>>>>>        Move (WP_CreateDiagram(eType,eFx,iWidth,iHeight,bXyAxis)) To hDiagram
83184>>>>>>>
83184>>>>>>>        If (hDiagram) Begin
83186>>>>>>>            Error DFERR_WINPRINT DFPrintError947
83187>>>>>>>>
83187>>>>>>>        End
83187>>>>>>>>
83187>>>>>>>        Else Begin
83188>>>>>>>            Set DFCurrent_Diagram To hDiagram
83189>>>>>>>        end
83189>>>>>>>>
83189>>>>>>>    End_Procedure
83190>>>>>>>
83190>>>>>>>
83190>>>>>>>    //***
83190>>>>>>>    Procedure DFDiagram_Item handle hDiagram String sLabel Number nValue;                             Dword dwBColor Dword dwFColor Integer eFill;                             Integer iDec Integer eValueOrPercent Integer eExt
83192>>>>>>>
83192>>>>>>>        Boolean bOk
83192>>>>>>>        Integer iCurrColor iValue
83192>>>>>>>
83192>>>>>>>        If (dwFColor = -1) Begin
83194>>>>>>>            Get DFCurrent_Color To iCurrColor
83195>>>>>>>            Increment iCurrColor
83196>>>>>>>            If (iCurrColor>15) Move 1 To iCurrColor
83199>>>>>>>            Set DFCurrent_Color To iCurrColor
83200>>>>>>>            Get DFGetColor iCurrColor To dwFColor
83201>>>>>>>        End
83201>>>>>>>>
83201>>>>>>>
83201>>>>>>>        Move (nValue *100) to iValue
83202>>>>>>>
83202>>>>>>>        Get ToAnsi sLabel To sLabel
83203>>>>>>>
83203>>>>>>>        Move (WP_AddDiagramEntry(hDiagram,sLabel,iValue,dwBColor,dwFColor,eFill,iDec,eValueorPercent,eExt)) To bOk
83204>>>>>>>
83204>>>>>>>        If not bOk Begin
83206>>>>>>>            Error DFERR_WINPRINT DFPrintError948
83207>>>>>>>>
83207>>>>>>>        End
83207>>>>>>>>
83207>>>>>>>    End_Procedure
83208>>>>>>>
83208>>>>>>>
83208>>>>>>>    //***
83208>>>>>>>    Procedure DFLockDiagram Handle hDiagram
83210>>>>>>>        Boolean bOk
83210>>>>>>>
83210>>>>>>>        Move (WP_LockDiagram(hDiagram)) To bOk
83211>>>>>>>
83211>>>>>>>        If not bOk Begin
83213>>>>>>>            Error DFERR_WINPRINT DFPrintError949
83214>>>>>>>>
83214>>>>>>>        End
83214>>>>>>>>
83214>>>>>>>    End_Procedure
83215>>>>>>>
83215>>>>>>>
83215>>>>>>>
83215>>>>>>>    //***
83215>>>>>>>    Procedure DFDrawDiagram Handle hDiagram Number nYPos Number nXPos Boolean bUCp
83217>>>>>>>        Boolean bOk
83217>>>>>>>        Integer iXPos
83217>>>>>>>        Integer iYPos
83217>>>>>>>
83217>>>>>>>        move (nXPos*100) To iXPos
83218>>>>>>>        move (nYPos*100) To iYPos
83219>>>>>>>
83219>>>>>>>        If nYPos Eq -999 Move -999 To iYPos
83222>>>>>>>
83222>>>>>>>        Move (WP_DrawDiagram(hDiagram,iXPos,iYPos,bUCp)) To bOk
83223>>>>>>>
83223>>>>>>>        If not bOk Begin
83225>>>>>>>            Error DFERR_WINPRINT DFPrintError950
83226>>>>>>>>
83226>>>>>>>        End
83226>>>>>>>>
83226>>>>>>>    End_Procedure
83227>>>>>>>
83227>>>>>>>
83227>>>>>>>
83227>>>>>>>    //***
83227>>>>>>>    Procedure DFDiagramLabel handle hDiagram String sLabel
83229>>>>>>>        Boolean bOk
83229>>>>>>>        Integer iLabelLen
83229>>>>>>>
83229>>>>>>>        Get ToAnsi sLabel To sLabel
83230>>>>>>>
83230>>>>>>>        Move (WP_SetDiagramCaption(hDiagram,sLabel)) To bOk
83231>>>>>>>
83231>>>>>>>        if not bOk Begin
83233>>>>>>>            Error DFERR_WINPRINT DFPrintError952
83234>>>>>>>>
83234>>>>>>>        End
83234>>>>>>>>
83234>>>>>>>    End_Procedure
83235>>>>>>>
83235>>>>>>>
83235>>>>>>>    //***
83235>>>>>>>    Procedure DFDiagramXLabel handle hDiagram String sLabel
83237>>>>>>>        Boolean bOk
83237>>>>>>>        Get ToAnsi sLabel To sLabel
83238>>>>>>>
83238>>>>>>>        Move (WP_SetDiagramXText(hDiagram,sLabel)) To bOk
83239>>>>>>>
83239>>>>>>>        if not bOk Begin
83241>>>>>>>            Error DFERR_WINPRINT DFPrintError953
83242>>>>>>>>
83242>>>>>>>        End
83242>>>>>>>>
83242>>>>>>>    End_Procedure
83243>>>>>>>
83243>>>>>>>
83243>>>>>>>    //***
83243>>>>>>>    Procedure DFDiagramYLabel handle hDiagram String sLabel Boolean bVertical
83245>>>>>>>        Boolean bOk
83245>>>>>>>        Get ToAnsi sLabel To sLabel
83246>>>>>>>
83246>>>>>>>        Move (WP_SetDiagramYText(hDiagram,sLabel,bVertical)) To bOk
83247>>>>>>>
83247>>>>>>>        if not bOk Begin
83249>>>>>>>            Error DFERR_WINPRINT DFPrintError954
83250>>>>>>>>
83250>>>>>>>        End
83250>>>>>>>>
83250>>>>>>>    End_Procedure
83251>>>>>>>
83251>>>>>>>
83251>>>>>>>    //***
83251>>>>>>>    Procedure DFWriteXYLine Number nStartX Number nStartY Number nStopX Number nStopY;              Dword dwColor Number nWeight Boolean bWrap Boolean bUCp
83253>>>>>>>
83253>>>>>>>        Boolean bOk
83253>>>>>>>        Integer iStartX iStartY iStopX iStopY
83253>>>>>>>        Integer iWeight
83253>>>>>>>
83253>>>>>>>        move (nStartX*100)  To iStartX
83254>>>>>>>        move (nStartY*100)  To iStartY
83255>>>>>>>        move (nStopX*100)   To iStopX
83256>>>>>>>        move (nStopY*100)   To iStopY
83257>>>>>>>
83257>>>>>>>        move (nWeight*100) To iWeight
83258>>>>>>>
83258>>>>>>>        If (nStopY  = -998) Move -998 To iStopY
83261>>>>>>>        If (nStopX  = -998) Move -998 To iStopX
83264>>>>>>>
83264>>>>>>>        If (nStartY  = -999) Move -999 To iStartY
83267>>>>>>>        If (nStartX  = -999) Move -999 To iStartX
83270>>>>>>>
83270>>>>>>>        Move (WP_DrawXYLine(iStartX,iStartY,iStopX,iStopY,dwColor,iWeight,bUCp,bWrap)) To bOk
83271>>>>>>>
83271>>>>>>>        if not bOk Begin
83273>>>>>>>            Error DFERR_WINPRINT DFPrintError955
83274>>>>>>>>
83274>>>>>>>        End
83274>>>>>>>>
83274>>>>>>>    End_Procedure
83275>>>>>>>
83275>>>>>>>
83275>>>>>>>    //***
83275>>>>>>>    Procedure DFWriteLine Number nStartX Number nStartY Number nLength;                          Boolean bHorizontal Dword dwColor Number nWeight Boolean bUCp
83277>>>>>>>
83277>>>>>>>        Boolean bOk
83277>>>>>>>        Integer iStartX iStartY iLength
83277>>>>>>>        Integer iWeight
83277>>>>>>>
83277>>>>>>>        move (nStartX*100)  To iStartX
83278>>>>>>>        move (nStartY*100)  To iStartY
83279>>>>>>>        move (nLength*100)  To iLength
83280>>>>>>>        move (nWeight*100)  To iWeight
83281>>>>>>>
83281>>>>>>>        If (nStartY = -999) Move -999 To iStartY
83284>>>>>>>        If (nStartX = -999) Move -999 To iStartX
83287>>>>>>>        If (nLength = -998) Move -998 To iLength
83290>>>>>>>
83290>>>>>>>        Move (WP_DrawLine(iSTartX,iStartY,iLength,bHorizontal,dwColor,iWeight,bUCp)) To bOk
83291>>>>>>>
83291>>>>>>>        if not bOk Begin
83293>>>>>>>            Error DFERR_WINPRINT DFPrintError956
83294>>>>>>>>
83294>>>>>>>        End
83294>>>>>>>>
83294>>>>>>>    End_Procedure
83295>>>>>>>
83295>>>>>>>
83295>>>>>>>    //***
83295>>>>>>>    Procedure DFClearPrinter
83297>>>>>>>        Boolean bOk
83297>>>>>>>
83297>>>>>>>        Move (WP_ClearPrinter()) To bOk
83298>>>>>>>
83298>>>>>>>        If not bOk Begin
83300>>>>>>>            Error DFERR_WINPRINT DFPrintError957
83301>>>>>>>>
83301>>>>>>>        End
83301>>>>>>>>
83301>>>>>>>    End_Procedure
83302>>>>>>>
83302>>>>>>>
83302>>>>>>>
83302>>>>>>>    //***
83302>>>>>>>     Function DFGetCurrentDevice Returns String
83304>>>>>>>        Boolean bOk
83304>>>>>>>        String  sDFStr
83304>>>>>>>        Address pDFStr
83304>>>>>>>
83304>>>>>>>        Move (Repeat( Character(0), 255 )) to sDFStr
83305>>>>>>>        GetAddress of sDFStr to pDFStr
83306>>>>>>>
83306>>>>>>>        Move (WP_GetCurrentDevice(pDFStr)) To bOk
83307>>>>>>>
83307>>>>>>>        If not bOk Begin
83309>>>>>>>            Error DFERR_WINPRINT DFPrintError959
83310>>>>>>>>
83310>>>>>>>        End
83310>>>>>>>>
83310>>>>>>>
83310>>>>>>>        Move (CString(sDFStr)) To sDFStr
83311>>>>>>>        Function_Return sDFStr
83312>>>>>>>     End_Function
83313>>>>>>>
83313>>>>>>>
83313>>>>>>>    // Note: DfGetCurrentPort and DFGetCurrentDriver do not exist in winprint2. Trying to
83313>>>>>>>    //       use these will result in a runtime error (which is good - don't use them)
83313>>>>>>>
83313>>>>>>>
83313>>>>>>>    //***
83313>>>>>>>     Function DFGetPrintDialogFlags Returns Dword
83315>>>>>>>        Dword dwRetVal
83315>>>>>>>
83315>>>>>>>        Move (WP_GetPrintDialogFlags()) To dwRetVal
83316>>>>>>>
83316>>>>>>>        Function_Return dwRetVal
83317>>>>>>>     End_Function
83318>>>>>>>
83318>>>>>>>
83318>>>>>>>    //***
83318>>>>>>>    //*** Returns PRN_TRUE=  if the flag is set     (1)
83318>>>>>>>    //*** Returns PRN_FALSE= If the flag not is set (0)
83318>>>>>>>    //***
83318>>>>>>>     Function DFCheckPrintDialogFlag Dword dwPDFlag Returns Boolean
83320>>>>>>>        Boolean bIsSet
83320>>>>>>>
83320>>>>>>>        Move (WP_IsPrintDialogFlagSet(dwPDFlag)) To bIsSet
83321>>>>>>>
83321>>>>>>>        Function_Return bIsSet
83322>>>>>>>     End_Function
83323>>>>>>>
83323>>>>>>>
83323>>>>>>>    //***
83323>>>>>>>     Procedure DFSetSpecPrintFlag Dword dwPDFlag
83325>>>>>>>        Boolean bOk
83325>>>>>>>
83325>>>>>>>        Move (WP_SetSpecificPrintDialogFlag(dwPDFlag)) To bOk
83326>>>>>>>
83326>>>>>>>        If not bOk Begin
83328>>>>>>>            Error DFERR_WINPRINT DFPrintError961
83329>>>>>>>>
83329>>>>>>>        End
83329>>>>>>>>
83329>>>>>>>     End_Procedure
83330>>>>>>>
83330>>>>>>>
83330>>>>>>>    //***
83330>>>>>>>     Function DFGetUserDefinedLength Returns Number
83332>>>>>>>        Integer iRetVal
83332>>>>>>>        Number  nRetVal
83332>>>>>>>
83332>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
83333>>>>>>>
83333>>>>>>>        If (iRetVal=0) Begin
83335>>>>>>>            Error DFERR_WINPRINT DFPrintError962
83336>>>>>>>>
83336>>>>>>>            Function_Return 0
83337>>>>>>>        End
83337>>>>>>>>
83337>>>>>>>
83337>>>>>>>        Move (Hi(iRetVal)) To nRetVal
83338>>>>>>>        move (nRetVal/100) To nRetVal //Returns CM
83339>>>>>>>
83339>>>>>>>        Function_Return nRetVal
83340>>>>>>>     End_Function
83341>>>>>>>
83341>>>>>>>
83341>>>>>>>    //***
83341>>>>>>>     Function DFGetUserDefinedWidth Returns Number
83343>>>>>>>        Integer iRetVal
83343>>>>>>>        Number  nRetVal
83343>>>>>>>
83343>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
83344>>>>>>>
83344>>>>>>>        If (iRetVal=0) Begin
83346>>>>>>>            Error DFERR_WINPRINT DFPrintError963
83347>>>>>>>>
83347>>>>>>>            Function_Return 0
83348>>>>>>>        End
83348>>>>>>>>
83348>>>>>>>
83348>>>>>>>        Move (Low(iRetVal)) To nRetVal
83349>>>>>>>        Move (nRetVal/100) To nRetVal //Returns CM
83350>>>>>>>
83350>>>>>>>        Function_Return nRetVal
83351>>>>>>>     End_Function
83352>>>>>>>
83352>>>>>>>
83352>>>>>>>    //*** To be set in CM
83352>>>>>>>     Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
83354>>>>>>>        Integer bOk
83354>>>>>>>        Integer iLength iWidth iSize
83354>>>>>>>
83354>>>>>>>        move (nLength*100) To iLength
83355>>>>>>>        move (nWidth*100)  To iWidth
83356>>>>>>>        move ((iLength*65536)+iWidth) To iSize
83357>>>>>>>
83357>>>>>>>        Move (WP_SetUserDefinedPapersize(iSize)) To bOk
83358>>>>>>>
83358>>>>>>>        If not bOk Begin
83360>>>>>>>            Error DFERR_WINPRINT DFPrintError964
83361>>>>>>>>
83361>>>>>>>        End
83361>>>>>>>>
83361>>>>>>>     End_Procedure
83362>>>>>>>
83362>>>>>>>     Procedure DFSetNumberOfCopies Integer iNrOfCopies
83364>>>>>>>        Boolean bOk
83364>>>>>>>
83364>>>>>>>        Move (WP_SetNumberOfPrintCopies(iNrOfCopies)) to bOk
83365>>>>>>>
83365>>>>>>>        If not bOk Begin
83367>>>>>>>            Error DFERR_WINPRINT DFPrintError965
83368>>>>>>>>
83368>>>>>>>        end
83368>>>>>>>>
83368>>>>>>>     End_Procedure
83369>>>>>>>
83369>>>>>>>
83369>>>>>>>
83369>>>>>>>
83369>>>>>>>    //*************************************************************
83369>>>>>>>    //*** This procedures and functions are used when building  ***
83369>>>>>>>    //*** complex graphics when you need to change value of the ***
83369>>>>>>>    //*** current diagram, so you can mix diagrams within each  ***
83369>>>>>>>    //*** other.                                                ***
83369>>>>>>>    //*************************************************************
83369>>>>>>>
83369>>>>>>>
83369>>>>>>>    Function DFGetCurrentDiagram Returns Integer
83371>>>>>>>        Integer iRetVal
83371>>>>>>>        Get DFCurrent_Diagram To iRetVal
83372>>>>>>>        Function_Return iRetVal
83373>>>>>>>    End_Function
83374>>>>>>>
83374>>>>>>>    Procedure DFSetCurrentDiagram Integer iDiagram
83376>>>>>>>        Set DFCurrent_Diagram To iDiagram
83377>>>>>>>    End_Procedure
83378>>>>>>>
83378>>>>>>>    Procedure DFSetDiagramList Integer iItem Integer iDiagram
83380>>>>>>>        Set Value of oDiagramArray iItem To iDiagram
83381>>>>>>>    End_Procedure
83382>>>>>>>
83382>>>>>>>    Function DFGetDiagramList Integer iItem Returns Integer
83384>>>>>>>        Integer iRetVal
83384>>>>>>>        Get Value of oDiagramArray iItem To iRetVal
83385>>>>>>>        Function_Return iRetVal
83386>>>>>>>    End_Function
83387>>>>>>>
83387>>>>>>>    Procedure DFClearDiagramList
83389>>>>>>>        Send Delete_Data To oDiagramArray
83390>>>>>>>    End_Procedure
83391>>>>>>>
83391>>>>>>>
83391>>>>>>>    Function DFGetColor Integer iColor Returns Dword
83393>>>>>>>        Dword   dwRetVal
83393>>>>>>>        Get Value of oDFColorArray iColor To dwRetVal
83394>>>>>>>        Function_Return dwRetVal
83395>>>>>>>    End_Function
83396>>>>>>>
83396>>>>>>>    Function DFGetCurrentColor Returns Dword
83398>>>>>>>        Dword   dwRetVal
83398>>>>>>>        Integer iCurrColor
83398>>>>>>>
83398>>>>>>>        Get DFCurrent_Color To iCurrColor
83399>>>>>>>        Get DFGetColor iCurrColor To dwRetVal
83400>>>>>>>
83400>>>>>>>        Function_Return dwRetVal
83401>>>>>>>    End_Function
83402>>>>>>>
83402>>>>>>>    Procedure DFEndDocument
83404>>>>>>>        integer iVoid
83404>>>>>>>        Move (WP_EndDocument()) To iVoid
83405>>>>>>>        Send DfSuspendGui False
83406>>>>>>>    End_procedure
83407>>>>>>>
83407>>>>>>>    Procedure DFClosePreview
83409>>>>>>>        integer iVoid
83409>>>>>>>        Move (WP_ClosePreview()) To iVoid
83410>>>>>>>        Send DfSuspendGui False
83411>>>>>>>    End_procedure
83412>>>>>>>
83412>>>>>>>    Procedure SetProgressCaption string sCaption
83414>>>>>>>        integer iVoid
83414>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
83415>>>>>>>        Move (WP_SetProgressCaption(sCaption)) To iVoid
83416>>>>>>>    End_procedure
83417>>>>>>>
83417>>>>>>>    Procedure SetReportTitle string sTitle
83419>>>>>>>        integer iVoid
83419>>>>>>>        Move (ToAnsi(sTitle)) to sTitle
83420>>>>>>>        Move (WP_SetReportTitle(sTitle)) To iVoid
83421>>>>>>>    End_procedure
83422>>>>>>>
83422>>>>>>>    Function PreviewYesNoBox string sCaption string sText returns integer
83424>>>>>>>        integer eResult
83424>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
83425>>>>>>>        Move (ToAnsi(sText))    to sText
83426>>>>>>>        Move (WP_DisplayMessageBox(sCaption, sText)) To eResult
83427>>>>>>>        Function_return eResult
83428>>>>>>>    end_function
83429>>>>>>>
83429>>>>>>>    // internal function, used to extract different printer flags ranges based on
83429>>>>>>>    // the print flag integer. These flags use a decimal style of packing information
83429>>>>>>>    // where different printer options (paper, bin, etc) use different ranges and
83429>>>>>>>    // different steps. Everything above iTopVal is removed and everything that is not
83429>>>>>>>    // within the iStep range is removed.
83429>>>>>>>    Function PrintFlagRange integer iTopVal integer iStep returns integer
83431>>>>>>>        integer iFgs iFg
83431>>>>>>>        Get DFGetPrintDialogFlags to iFg
83432>>>>>>>        Move (mod(iFg,iTopVal) / iStep * iStep ) to iFg
83433>>>>>>>        function_return iFg
83434>>>>>>>    end_Function
83435>>>>>>>
83435>>>>>>>    Procedure DFSetPrinterPaper integer ePaperType
83437>>>>>>>        Send DFSetSpecPrintFlag ePaperType
83438>>>>>>>    End_Procedure
83439>>>>>>>
83439>>>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
83441>>>>>>>        integer ePaperType
83441>>>>>>>        Get PrintFlagRange 500 10 to ePaperType // 10-490 in steps of 10
83442>>>>>>>        function_return ePaperType
83443>>>>>>>    End_Function
83444>>>>>>>
83444>>>>>>>
83444>>>>>>>    Procedure DFSetPrinterBin integer eBinType
83446>>>>>>>        Send DFSetSpecPrintFlag eBinType
83447>>>>>>>    End_Procedure
83448>>>>>>>
83448>>>>>>>    Function DFGetPrinterBin returns integer //eBinType
83450>>>>>>>        integer eBinType
83450>>>>>>>        Get PrintFlagRange 10000 500 to eBinType // 1000-9000 steps 500
83451>>>>>>>        function_return eBinType
83452>>>>>>>    End_Function
83453>>>>>>>
83453>>>>>>>
83453>>>>>>>    Procedure DFSetPrinterResolution integer eResType
83455>>>>>>>        Send DFSetSpecPrintFlag eResType
83456>>>>>>>    End_Procedure
83457>>>>>>>
83457>>>>>>>    Function DFGetPrinterResolution returns integer //eResType
83459>>>>>>>        integer eResType
83459>>>>>>>        Get PrintFlagRange 50000 10000 to eResType // 10000-500000 steps 10000
83460>>>>>>>        function_return eResType
83461>>>>>>>    End_Function
83462>>>>>>>
83462>>>>>>>
83462>>>>>>>    Procedure DFSetLandscape boolean bIsLandscape
83464>>>>>>>        Send DFSetSpecPrintFlag (If(bIsLandscape,DF_Landscape,DF_Portrait))
83465>>>>>>>    End_Procedure
83466>>>>>>>
83466>>>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
83468>>>>>>>        boolean bIsLandscape
83468>>>>>>>        Get DFCheckPrintDialogFlag DF_Landscape to bIsLandscape
83469>>>>>>>        function_return bIsLandscape
83470>>>>>>>    End_Function
83471>>>>>>>
83471>>>>>>>    Function RGBToWPColor integer iRgb returns integer
83473>>>>>>>        integer iRed iGreen iBlue
83473>>>>>>>        integer iWPColor
83473>>>>>>>        Move (R_from_rgb(iRGB)) to iRed
83474>>>>>>>        Move (G_from_rgb(iRGB)) to iGreen
83475>>>>>>>        Move (B_from_rgb(iRGB)) to iBlue
83476>>>>>>>        Get DfGetDfColor iRed iGreen iBlue to iWPColor
83477>>>>>>>        function_Return iWPColor
83478>>>>>>>    end_function
83479>>>>>>>
83479>>>>>>>
83479>>>>>>>
83479>>>>>>>End_Class
83480>>>>>>>
83480>>>>>>>Global_Variable Integer ghoWinPrint2
83480>>>>>>>
83480>>>>>>>Get Create of desktop U_cWinPrint2 to ghoWinPrint2
83481>>>>>>>
83481>>>>>>>
83481>>>>>Use Winprint_Commands.pkg  // commands used by this class
83481>>>>>
83481>>>>>Class cWinReport2 is a BasicReport
83482>>>>>
83482>>>>>    Procedure Construct_Object
83484>>>>>        Forward send construct_object
83486>>>>>
83486>>>>>        Date Today
83486>>>>>        Sysdate Today
83487>>>>>
83487>>>>>        // should use built in DF function CurrentDateTime()
83487>>>>>        Property Date  RptToday    Today
83488>>>>>
83488>>>>>        Object RptTotal is an Array
83490>>>>>        End_Object
83491>>>>>
83491>>>>>        // If true, report is output upon completion. Either preview
83491>>>>>        // or printer depending on output_device_mode
83491>>>>>        Property Boolean AutoOutput_State True
83492>>>>>
83492>>>>>        // When a new page is created (DFNew_Page) and the number
83492>>>>>        // of columns is not passed, this is used.
83492>>>>>        Property Integer Print_Columns 0
83493>>>>>
83493>>>>>        // This determines if a DFNew_Page should be executed when the
83493>>>>>        // report starts. In some rare cases, you would not want this to
83493>>>>>        // occur until a subheader
83493>>>>>        Property Boolean AutoNew_Page_State True
83494>>>>>
83494>>>>>        // Output device (print or preview). Normally this is delegated to
83494>>>>>        // the report view.
83494>>>>>        //
83494>>>>>
83494>>>>>        Property Integer Private.Output_Device_Mode PRINT_TO_UNDEFINED
83495>>>>>
83495>>>>>        Property Handle phoWinPrint  ghoWinPrint2 // the report engine to use.
83496>>>>>
83496>>>>>        // JJT: For now this is for testing.
83496>>>>>        Property boolean pbModalViewer False
83497>>>>>
83497>>>>>        Property boolean pbMultiReports False
83498>>>>>
83498>>>>>        Property boolean pbFirstPagePrinted false
83499>>>>>
83499>>>>>    End_Procedure
83500>>>>>
83500>>>>>    // returns the current status of Winprint Document object. dsNotStarted, dsStarted, dsFinished
83500>>>>>    // note that the status can reflect a status from a different report. The winprint object is global.
83500>>>>>    Function DocumentStatus returns Boolean
83502>>>>>        integer iStatus
83502>>>>>        Get DocumentStatus of (phoWinprint(self)) to iStatus
83503>>>>>        function_return iStatus
83504>>>>>    End_function
83505>>>>>
83505>>>>>    Function IsViewerActive Returns Boolean
83507>>>>>        Boolean bIsActive
83507>>>>>        Get IsViewerActive of (phoWinPrint(Self)) to bIsActive
83508>>>>>        Function_Return bIsActive
83509>>>>>    End_Function
83510>>>>>
83510>>>>>    Function IsPrinterValid Returns Boolean
83512>>>>>        Function_Return (WP_IsPrinterValid()<>0)
83513>>>>>    End_Function
83514>>>>>
83514>>>>>    Function ArePrintersInstalled Returns Boolean
83516>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
83517>>>>>    End_Function
83518>>>>>
83518>>>>>
83518>>>>>    // All subtotal commands use the outer main report. This makes it easier to keep
83518>>>>>    // track of these numbers
83518>>>>>
83518>>>>>    Procedure Add_SubTotal Integer iCounter Number nData
83520>>>>>        Number nValue
83520>>>>>        Integer iObj
83520>>>>>        Move (RptTotal(Main_Report_Id(Self))) to iObj
83521>>>>>        Get Number_Value of iObj iCounter To nValue
83522>>>>>        Add nData To nValue
83523>>>>>        Set Array_Value of iObj iCounter To nValue
83524>>>>>    End_Procedure
83525>>>>>
83525>>>>>    Procedure Clr_SubTotal Integer iCounter
83527>>>>>        Set Array_Value of (RptTotal(Main_Report_Id(Self))) iCounter To 0
83528>>>>>    End_Procedure
83529>>>>>
83529>>>>>    Procedure Clr_AllSubTotals
83531>>>>>        Send Delete_Data of (RptTotal(Main_Report_Id(Self)))
83532>>>>>    End_Procedure
83533>>>>>
83533>>>>>    Function Sum_SubTotal Integer iTotal Returns Number
83535>>>>>        Number nRetVal
83535>>>>>        Get Number_Value of (RptTotal(Main_Report_Id(Self))) iTotal To nRetVal
83536>>>>>        Function_Return nRetVal
83537>>>>>    End_Function
83538>>>>>
83538>>>>>    //Return sub-total and clear accumulator
83538>>>>>    //
83538>>>>>    Function SubTotal Integer iTotal Returns Number
83540>>>>>        Number nRetVal
83540>>>>>        Get Sum_SubTotal  iTotal to nRetVal
83541>>>>>        Send Clr_SubTotal iTotal
83542>>>>>        Function_Return nRetVal
83543>>>>>    End_Function
83544>>>>>
83544>>>>>
83544>>>>>    // Note: Cols is optional. If no argument is passed it will use
83544>>>>>    //       the object's property Print_Columns (0 by default)
83544>>>>>    //
83544>>>>>    Procedure DFNew_Page Integer Cols
83546>>>>>        Integer PageNumber Columns
83546>>>>>        Boolean bFirstPagePrinted
83546>>>>>        // If no args passed used default setting
83546>>>>>        If (Num_Arguments=0) ;           Move (Print_Columns(Main_Report_id(Self))) to Columns
83549>>>>>        Else ;           Move Cols to Columns
83551>>>>>        Set Page_Feed   to -2   // No FormFeed
83552>>>>>        If (Child_Rpt_State(self)) ;            Send DFNew_Page of (Main_Report_Id(Self)) Columns
83555>>>>>        Else Begin
83556>>>>>            // we only want to print report_header once. When report starts
83556>>>>>            // this is set true, after the first print it is false. You can set
83556>>>>>            // this to true before and explicit dfNew_page to force a header
83556>>>>>            Get pbFirstPagePrinted to bFirstPagePrinted
83557>>>>>            Get  DFNewPage of (phoWinPrint(self)) Columns To PageNumber
83558>>>>>            If (PageNumber<>0) begin // if 0, it failed
83560>>>>>                Set No_PageCheck_State to True
83561>>>>>
83561>>>>>                //Top section
83561>>>>>                Send Page_Top
83562>>>>>                If Not bFirstPagePrinted Send Report_Header
83565>>>>>                Send Page_Header
83566>>>>>                Send Page_Title
83567>>>>>
83567>>>>>                Set New_Page_State to False
83568>>>>>                Set Page_End_State to False
83569>>>>>                Set No_PageCheck_State to False        // No longer Paging
83570>>>>>                Set pbFirstPagePrinted to True
83571>>>>>            End
83571>>>>>>
83571>>>>>        End
83571>>>>>>
83571>>>>>
83571>>>>>        // Footer section
83571>>>>>        //
83571>>>>>        // DO NOT CHANGE THE ORDER OF BOTTOM SECTIONS !!!!!
83571>>>>>        //
83571>>>>>
83571>>>>>        Send Page_Bottom
83572>>>>>
83572>>>>>        // in WinPrint it is not possible to replace Page_Footer
83572>>>>>        // with Report_Footer. If you use Report_Footer you will
83572>>>>>        // have both Page_Footer and Report_Footer
83572>>>>>        //
83572>>>>>        //If LastTime eq 0 Send Page_Footer
83572>>>>>        //else             Send Report_Footer
83572>>>>>
83572>>>>>        Send Page_Footer
83573>>>>>        Send Page_Total
83574>>>>>    End_Procedure
83575>>>>>
83575>>>>>    Procedure Ending_Main_Report
83577>>>>>        Boolean bCancel bMultiReports
83577>>>>>
83577>>>>>        Get Cancelled_state to bCancel
83578>>>>>        Get pbMultiReports to bMultiReports
83579>>>>>
83579>>>>>        Forward Send Ending_Main_Report
83581>>>>>
83581>>>>>        If bCancel Begin
83583>>>>>            Send DFEndDocument
83584>>>>>            Send DFClearDoc // this will also close the previewer
83585>>>>>        end
83585>>>>>>
83585>>>>>        Else Begin
83586>>>>>            Send Report_Footer
83587>>>>>
83587>>>>>            // if multi-reports, we don't do an end of report yet. The programmer must
83587>>>>>            // manually end the report by sending EndMultiReport
83587>>>>>            If (not(bMultiReports)) begin
83589>>>>>                Send EndWinPrintReport
83590>>>>>            end
83590>>>>>>
83590>>>>>
83590>>>>>        end
83590>>>>>>
83590>>>>>
83590>>>>>    End_Procedure
83591>>>>>
83591>>>>>    // This must get called when you are running multiple reports (pbMultiReport).
83591>>>>>    // Send this when the last report is complete.
83591>>>>>    Procedure EndMultiReport
83593>>>>>        Send EndWinPrintReport
83594>>>>>    End_procedure
83595>>>>>
83595>>>>>
83595>>>>>    Procedure EndWinPrintReport
83597>>>>>        Boolean bAutoOutput
83597>>>>>        integer iStatus eMode
83597>>>>>        Get DocumentStatus to iStatus
83598>>>>>        If (iStatus<>dsStarted) procedure_return
83601>>>>>
83601>>>>>        // this tells winprint that the report is complete
83601>>>>>        Send DFEndDocument
83602>>>>>        // if auto-output we print or display automatically.
83602>>>>>        // for winprint2, if in preview mode you must do this so the previewer can enter
83602>>>>>        // a modal state (which it may or may not need to do).
83602>>>>>        Get AutoOutput_state to bAutoOutput
83603>>>>>        Get Output_device_mode to eMode
83604>>>>>        If (bAutoOutput or eMode=PRINT_TO_WINDOW) begin
83606>>>>>            Send PrintReport
83607>>>>>            // if auto output, we assume that you are done when it is all over
83607>>>>>            // we only can do this with the modal viewer
83607>>>>>            If (bAutoOutput and pbModalViewer(self)) begin
83609>>>>>                Send DFClearDoc
83610>>>>>            end
83610>>>>>>
83610>>>>>        end
83610>>>>>>
83610>>>>>
83610>>>>>    End_Procedure
83611>>>>>
83611>>>>>
83611>>>>>    Function Setup_Report Returns Integer
83613>>>>>        Integer iErr iStatus eMode
83613>>>>>        Boolean bActiveViewer bChildReport bMultiReports bOk
83613>>>>>
83613>>>>>        Get Child_rpt_state to bChildReport
83614>>>>>
83614>>>>>        If not bChildReport Begin
83616>>>>>
83616>>>>>            // This makes sure that we are pointing to the new winprint2 engine object.
83616>>>>>            // normally this will be the new winprint, but it can be redirected
83616>>>>>            Get phoWinPrint to WinPrintID
83617>>>>>
83617>>>>>            // winprint must have installed printer. If not installed, generate error and stop the report
83617>>>>>            Get ArePrintersInstalled to bOk
83618>>>>>            If not bOk Begin
83620>>>>>                Error DFERR_WINPRINT C_$NoInstalledPrinters
83621>>>>>>
83621>>>>>                Function_Return 1
83622>>>>>            End
83622>>>>>>
83622>>>>>
83622>>>>>            // check if selected printer is valid. If not, generate error and stop the report
83622>>>>>            Get IsPrinterValid to bOk
83623>>>>>            If not bOk Begin
83625>>>>>                Error DFERR_WINPRINT DFPrintError936    // Could not select a valid printer
83626>>>>>>
83626>>>>>                Function_Return 1
83627>>>>>            End
83627>>>>>>
83627>>>>>
83627>>>>>            // make sure it is ok to start a new report but try to be smart about it.
83627>>>>>            // if a report is active (dsstarted or dsFinished) check to see if it is
83627>>>>>            // finished w/ no viewer. If so, assume the user closed the report and is done
83627>>>>>            // so just clear the report. If a viewer is present, declare an error.
83627>>>>>            Get DocumentStatus to iStatus
83628>>>>>            Get pbMultiReports to bMultiReports
83629>>>>>            // multi-report only in-progress is multi and it is started
83629>>>>>            Move (bMultiReports and iStatus=dsStarted) to bMultiReports
83630>>>>>            If not bMultiReports Begin
83632>>>>>                If (iStatus<>dsNotStarted) Begin
83634>>>>>                    Get IsViewerActive to bActiveViewer
83635>>>>>                    If (iStatus=dsFinished and not(bActiveViewer)) Begin
83637>>>>>                        Send DfClearDoc
83638>>>>>                    End
83638>>>>>>
83638>>>>>                    Else Begin
83639>>>>>                        Error DFERR_WINPRINT DFPrintError967
83640>>>>>>
83640>>>>>                        Function_Return 1
83641>>>>>                    End
83641>>>>>>
83641>>>>>                End
83641>>>>>>
83641>>>>>
83641>>>>>                // all new reports by default allow printing from viewer and they have the print job set up when you select print
83641>>>>>                // if you need to change these defaults, you can change these inside of Starting_main_report
83641>>>>>                // We only do this with non-multi-reports.
83641>>>>>                Send DFSetPrintDlgInPreview      True
83642>>>>>                Send DFSetEnablePrintFromPreview True
83643>>>>>
83643>>>>>            End
83643>>>>>>
83643>>>>>
83643>>>>>            // In the new winprint, this message is not needed and is a stub. For
83643>>>>>            // now it is in here for compatibility purposes
83643>>>>>            //You MUST always start a new report with this procedure
83643>>>>>            Send DFZeroCounters of (phoWinPrint(Self))
83644>>>>>            Send Clr_AllSubTotals
83645>>>>>
83645>>>>>        End
83645>>>>>>
83645>>>>>
83645>>>>>        Forward Get Setup_report to iErr
83647>>>>>
83647>>>>>        If (iErr=0) Begin
83649>>>>>            If not bChildReport Begin
83651>>>>>                // if part of a multi-report we don't do a new doc
83651>>>>>                If not bMultiReports Begin
83653>>>>>                    Get Output_Device_Mode to eMode
83654>>>>>                    Send DFNewDoc of (phoWinPrint(Self))  (eMode = PRINT_TO_WINDOW) // pass True of display while printing
83655>>>>>                End
83655>>>>>>
83655>>>>>                // Do new page if not part of a multi-report and we say don't do a new page
83655>>>>>                If (not(bMultiReports) or AutoNew_Page_State(Self)) Begin
83657>>>>>                    Set pbFirstPagePrinted to False // tells new page that this is the first time for this report
83658>>>>>                    Send DFNew_page
83659>>>>>                End
83659>>>>>>
83659>>>>>            End
83659>>>>>>
83659>>>>>        End
83659>>>>>>
83659>>>>>        Function_Return iErr
83660>>>>>    End_Function
83661>>>>>
83661>>>>>
83661>>>>>
83661>>>>>    // Cancel RO behavior - there is no device to close
83661>>>>>    //
83661>>>>>    Procedure Close_Output_Device
83663>>>>>    End_Procedure
83664>>>>>
83664>>>>>    // Cancel RO Behavior
83664>>>>>    //
83664>>>>>    Procedure Initialize_Output_Device
83666>>>>>    End_procedure
83667>>>>>
83667>>>>>
83667>>>>>    Function Output_Device_Mode Returns Integer
83669>>>>>        Integer hoId
83669>>>>>        String DevMode
83669>>>>>        Get Private.Output_Device_Mode to DevMode
83670>>>>>        If (DevMode=PRINT_TO_UNDEFINED) Begin
83672>>>>>            Get Report_View_Id to hoId
83673>>>>>            If hoID ;                Get OutPut_Device_Mode of hoID to DevMode
83676>>>>>            If (DevMode=PRINT_TO_UNDEFINED) ;                Move PRINT_TO_WINDOW to DevMode
83679>>>>>        End
83679>>>>>>
83679>>>>>        Function_Return DevMode
83680>>>>>    End_Function // Output_Destination
83681>>>>>
83681>>>>>    Procedure Set Output_Device_Mode Integer DevMode
83683>>>>>        Set Private.Output_Device_Mode to DevMode
83684>>>>>    End_Procedure // Set Output_Device
83685>>>>>
83685>>>>>    // displays a metric ruler in .5 increments. This can be
83685>>>>>    // sent to make it easy to see how fields and labels should
83685>>>>>    // be moved for alignment.
83685>>>>>    //
83685>>>>>    Procedure ShowRuler
83687>>>>>        integer i
83687>>>>>        number n
83687>>>>>        for i from 0 to 30
83693>>>>>>
83693>>>>>            Send DFWritePos of (phoWinPrint(self)) (String(i)) FONT_DEFAULT i -1 0
83694>>>>>            Move (i+.5) to n
83695>>>>>            Send DFWritePos of (phoWinPrint(self)) "." FONT_DEFAULT n -1 0
83696>>>>>        Loop
83697>>>>>>
83697>>>>>        Send DFWriteln of (phoWinPrint(self)) ''  FONT_DEFAULT FONT_DEFAULT -1
83698>>>>>    End_procedure
83699>>>>>
83699>>>>>      // status panel related agumentations to handle the auto-previewer
83699>>>>>
83699>>>>>      Procedure Update_Status string sVal
83701>>>>>         Integer eMode
83701>>>>>         Get Output_device_mode to eMode
83702>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83704>>>>>            Send SetProgressCaption  of (phoWinPrint(self)) sVal
83705>>>>>         End
83705>>>>>>
83705>>>>>         Else Begin
83706>>>>>            forward Send Update_Status sVal
83708>>>>>         end
83708>>>>>>
83708>>>>>      End_Procedure
83709>>>>>
83709>>>>>      Procedure Start_Status
83711>>>>>         Integer eMode
83711>>>>>         string sTitle sCaption
83711>>>>>         Get Output_device_mode to eMode
83712>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83714>>>>>            Get Report_Caption to sCaption
83715>>>>>            Get Report_Title to sTitle
83716>>>>>            If (sTitle<>"" and sCaption<>"") begin
83718>>>>>                Move ( sCaption- ":" * sTitle) to sTitle
83719>>>>>            end
83719>>>>>>
83719>>>>>            else begin
83720>>>>>                Move (sCaption - sTitle) to sTitle
83721>>>>>            end
83721>>>>>>
83721>>>>>            Send SetReportTitle of (phoWinPrint(self)) sTitle
83722>>>>>         End
83722>>>>>>
83722>>>>>         Else Begin
83723>>>>>            forward Send Start_status
83725>>>>>         end
83725>>>>>>
83725>>>>>      End_Procedure
83726>>>>>
83726>>>>>      Procedure Resume_Status
83728>>>>>         Integer eMode
83728>>>>>         Get Output_device_mode to eMode
83729>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83731>>>>>            Send DfPreviewNoWait of (phoWinPrint(self))
83732>>>>>         End
83732>>>>>>
83732>>>>>         Else Begin
83733>>>>>            forward Send Resume_Status
83735>>>>>         end
83735>>>>>>
83735>>>>>      End_Procedure
83736>>>>>
83736>>>>>      Procedure End_Status
83738>>>>>         Integer eMode
83738>>>>>         Get Output_device_mode to eMode
83739>>>>>         If (error_processing_state(self)) Begin
83741>>>>>            Send DFClosePreview
83742>>>>>         end
83742>>>>>>
83742>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
83744>>>>>         End
83744>>>>>>
83744>>>>>         Else Begin
83745>>>>>            forward Send End_Status
83747>>>>>         end
83747>>>>>>
83747>>>>>      End_Procedure
83748>>>>>
83748>>>>>    Function Report_Interrupt Returns Integer
83750>>>>>         integer eStat
83750>>>>>         String sMess
83750>>>>>         Boolean bActiveViewer
83750>>>>>         Get IsViewerActive to bActiveViewer
83751>>>>>         If (Error_Check_State(self)) begin
83753>>>>>            Move C_$AnErrorWishToCancel to sMess
83754>>>>>         end
83754>>>>>>
83754>>>>>         Else begin
83755>>>>>            Move  C_$CancelThisReport to sMess
83756>>>>>         end
83756>>>>>>
83756>>>>>         If bActiveViewer Begin
83758>>>>>            Get PreviewYesNoBox of (phoWinPrint(self)) C_$ReportInterrupt sMess to eStat
83759>>>>>         end
83759>>>>>>
83759>>>>>         Else Begin
83760>>>>>            Get YesNo_Box sMess C_$ReportInterrupt to eStat
83761>>>>>         End
83761>>>>>>
83761>>>>>
83761>>>>>         Function_Return (eStat=MBR_YES)
83762>>>>>
83762>>>>>  End_Function
83763>>>>>
83763>>>>>  Function Test_KeyPressed Returns Integer
83765>>>>>     Boolean bStop bError bActiveViewer
83765>>>>>     integer eMode
83765>>>>>     // winreport will do this also, but this makes sure that this gets called
83765>>>>>     // for each body loop -- even if the body loop prints nothing
83765>>>>>     Send PumpMsgQueue of (phoWinPrint(self)) // permit painting
83766>>>>>     Get IsViewerActive to bActiveViewer
83767>>>>>     Get Output_device_mode to eMode
83768>>>>>     If bActiveViewer Begin
83770>>>>>        Get ViewerWantsToClose of (phoWinPrint(self)) to bStop
83771>>>>>        Get Error_Check_State to bError
83772>>>>>        if (bStop or bError) begin
83774>>>>>            Get Report_Interrupt to bStop
83775>>>>>        end
83775>>>>>>
83775>>>>>     end
83775>>>>>>
83775>>>>>     Else Begin
83776>>>>>        Forward Get Test_KeyPressed to bStop
83778>>>>>        If (eMode=PRINT_TO_WINDOW and not(bStop)) Begin
83780>>>>>            Send DfPreviewNoWait
83781>>>>>        end
83781>>>>>>
83781>>>>>     End
83781>>>>>>
83781>>>>>
83781>>>>>     Function_Return bStop
83782>>>>>  End_Function
83783>>>>>
83783>>>>>    Procedure OnClosingView
83785>>>>>        Send DFClearDoc
83786>>>>>    end_procedure
83787>>>>>
83787>>>>>
83787>>>>>    // Attempt to make this as intuitive as possible. You cannot invoke this when a
83787>>>>>    // report is active. If a report is not finished, you cannot do this.
83787>>>>>    // If a report is finsihed it may or may not have a viewer present.
83787>>>>>    // If a viewer is not present, we will clear the exising report (making the assumption
83787>>>>>    // that a modeless viewer was closed and the report will not be invoked again). If a viewer
83787>>>>>    // is active, we will pass this through to the winprint object which will show an error
83787>>>>>
83787>>>>>    Function DFPrintSetupDialog Returns Boolean// invoke printer setup dialog
83789>>>>>        Integer iStatus
83789>>>>>        Boolean bActiveViewer bOk
83789>>>>>        // we must have printers installed for this to work
83789>>>>>        Get ArePrintersInstalled to bOk
83790>>>>>        If not bOk Begin
83792>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
83793>>>>>>
83793>>>>>        End
83793>>>>>>
83793>>>>>        Else Begin
83794>>>>>            Get DocumentStatus to iStatus
83795>>>>>            If (iStatus=dsFinished) Begin
83797>>>>>                Get IsViewerActive to bActiveViewer
83798>>>>>                If not bActiveViewer Begin
83800>>>>>                    Send DfClearDoc
83801>>>>>                End
83801>>>>>>
83801>>>>>            End
83801>>>>>>
83801>>>>>            // the winprint object will generate an error if the status is not dsNotStarted.
83801>>>>>            // we want those errors
83801>>>>>            Get DFPrintSetupDialog of (phoWinPrint(Self)) to bOk
83802>>>>>        End
83802>>>>>>
83802>>>>>        Function_Return bOk
83803>>>>>    End_Procedure
83804>>>>>
83804>>>>>    // It is better to use DFPrintSetupDialog which tells you if the dialog was canceled
83804>>>>>    Procedure DFPrintSetup // invoke printer setup dialog
83806>>>>>        Boolean bOk
83806>>>>>        Get DFPrintSetupDialog to bOk
83807>>>>>    End_Procedure
83808>>>>>
83808>>>>>    Procedure DFClearDoc // clear document, remove viewer
83810>>>>>        Send DFClearDoc of (phoWinPrint(self))
83811>>>>>    end_procedure
83812>>>>>
83812>>>>>    Procedure DFEndDocument // tell winprint that the report is complete
83814>>>>>        Send DfEndDocument of (phoWinPrint(self))
83815>>>>>    end_procedure
83816>>>>>
83816>>>>>    Procedure DFClosePreview //close the previewer, does not clear the document
83818>>>>>        Send DfClosePreview of (phoWinPrint(self))
83819>>>>>    end_procedure
83820>>>>>
83820>>>>>    Procedure DFPrintDialog // popup print job dialog
83822>>>>>        Send DFPrintDialog of (phoWinPrint(self))
83823>>>>>    End_procedure
83824>>>>>
83824>>>>>    Procedure DFPrint // print with printer dialog
83826>>>>>        Send DFPrint of (phoWinPrint(self))
83827>>>>>    End_procedure
83828>>>>>
83828>>>>>    Procedure DFPrintDoc // print without printer dialog
83830>>>>>        Send DFPrintDoc of (phoWinPrint(self))
83831>>>>>    End_Procedure
83832>>>>>
83832>>>>>    Procedure DFPreviewWait // invoke previewer in modal mode
83834>>>>>       Send DFPreviewWait of (phoWinPrint(self))
83835>>>>>    End_Procedure
83836>>>>>
83836>>>>>    Procedure DFPreviewNoWait // invoke previwer in modeless mode
83838>>>>>       Send DFPreviewNoWait of (phoWinPrint(self))
83839>>>>>    End_Procedure
83840>>>>>
83840>>>>>    Procedure DFPreview // invokde previewer based on pbModalViewer property
83842>>>>>       Boolean bModalViewer
83842>>>>>       Get pbModalViewer to bModalViewer
83843>>>>>       If bModalViewer Begin
83845>>>>>           Send DFPreviewWait
83846>>>>>       end
83846>>>>>>
83846>>>>>       else Begin
83847>>>>>           Send DFPreviewNoWait
83848>>>>>       end
83848>>>>>>
83848>>>>>   End_Procedure
83849>>>>>
83849>>>>>    // Print report to appropriate device (printer, preview) based
83849>>>>>    // on output_device_mode
83849>>>>>    //
83849>>>>>    Procedure PrintReport
83851>>>>>        Integer eMode
83851>>>>>        Get OutPut_Device_Mode to eMode
83852>>>>>        If ((eMode=PRINT_TO_WINDOW) or (eMode=DEFERRED_PRINT_TO_WINDOW)) Begin
83854>>>>>           Send DFPreview
83855>>>>>        end
83855>>>>>>
83855>>>>>        Else If (eMode=PRINT_TO_PRINTER_NO_DIALOG) Begin
83858>>>>>           Send DFPrintDoc // print, no print job dialog
83859>>>>>        end
83859>>>>>>
83859>>>>>        Else Begin // (eMode=PRINT_TO_PRINTER)
83860>>>>>           Send DFPrint // print with print job dialog
83861>>>>>        end
83861>>>>>>
83861>>>>>    End_Procedure
83862>>>>>
83862>>>>>
83862>>>>>    Procedure DFSetPrinterPaper integer ePaperType
83864>>>>>        Send DFSetPrinterPaper of (phoWinPrint(self)) ePaperType
83865>>>>>    End_Procedure
83866>>>>>
83866>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
83868>>>>>        integer ePaperType
83868>>>>>        Get DFGetPrinterPaper of (phoWinPrint(self)) to ePaperType
83869>>>>>        Function_return ePaperType
83870>>>>>    end_function
83871>>>>>
83871>>>>>
83871>>>>>    Procedure DFSetPrinterBin integer eBinType
83873>>>>>        Send DFSetPrinterBin of (phoWinPrint(self)) eBinType
83874>>>>>    End_Procedure
83875>>>>>
83875>>>>>    Function DFGetPrinterBin returns integer //eBinType
83877>>>>>        integer eBinType
83877>>>>>        Get DFGetPrinterBin of (phoWinPrint(self)) to eBinType
83878>>>>>        Function_return eBinType
83879>>>>>    end_function
83880>>>>>
83880>>>>>
83880>>>>>    Procedure DFSetPrinterResolution integer eResType
83882>>>>>        Send DFSetPrinterResolution of (phoWinPrint(self)) eResType
83883>>>>>    End_Procedure
83884>>>>>
83884>>>>>    Function DFGetPrinterResolution returns integer //eResType
83886>>>>>        Boolean eResType
83886>>>>>        Get DFGetPrinterResolution of (phoWinPrint(self)) to eResType
83887>>>>>        Function_return eResType
83888>>>>>    end_function
83889>>>>>
83889>>>>>
83889>>>>>    Procedure DFSetLandscape boolean bIsLandscape
83891>>>>>        Send DFSetLandscape of (phoWinPrint(self)) bIsLandscape
83892>>>>>    End_Procedure
83893>>>>>
83893>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
83895>>>>>        Boolean bIsLandscape
83895>>>>>        Get DFGetLandscape of (phoWinPrint(self)) to bIsLandscape
83896>>>>>        Function_return bIsLandscape
83897>>>>>    end_function
83898>>>>>
83898>>>>>    Procedure DFSetMetrics integer eType
83900>>>>>        Send DFSetMetrics of (phoWinPrint(self)) eType
83901>>>>>    End_Procedure
83902>>>>>
83902>>>>>    Function DFGetMetrics returns integer
83904>>>>>        integer eType
83904>>>>>        Get DFGetMetrics of (phoWinPrint(self)) to eType
83905>>>>>        Function_return eType
83906>>>>>    end_function
83907>>>>>
83907>>>>>
83907>>>>>    Procedure DFSetPrintDlgInPreview boolean bShowDialog
83909>>>>>        Set PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
83910>>>>>    End_Procedure
83911>>>>>
83911>>>>>    Function DFGetPrintDlgInPreview returns boolean
83913>>>>>        boolean bShowDialog
83913>>>>>        Get PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
83914>>>>>        Function_return bShowDialog
83915>>>>>    end_function
83916>>>>>
83916>>>>>
83916>>>>>    Procedure DFSetEnablePrintFromPreview boolean bEnablePrint
83918>>>>>        Set EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
83919>>>>>    End_Procedure
83920>>>>>
83920>>>>>    Function DFGetEnablePrintFromPreview returns boolean
83922>>>>>        boolean bEnablePrint
83922>>>>>        Get EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
83923>>>>>        Function_return bEnablePrint
83924>>>>>    end_function
83925>>>>>
83925>>>>>
83925>>>>>
83925>>>>>    Procedure DFSetMargins number nLeft number nTop number nRight number nBottom
83927>>>>>        Send DFSetMargins of (phoWinPrint(self)) nLeft nTop nRight nBottom
83928>>>>>    End_Procedure
83929>>>>>
83929>>>>>    Procedure DFSetTopBottom number nTop number nBottom Boolean bAllPages
83931>>>>>        Send DFSetTopBottom of (phoWinPrint(self)) nTop nBottom bAllPages
83932>>>>>    End_Procedure
83933>>>>>
83933>>>>>
83933>>>>>    Procedure DFSetDevice string sPrinterName
83935>>>>>        Send DFSetDevice of (phoWinPrint(self)) sPrinterName
83936>>>>>    End_Procedure
83937>>>>>
83937>>>>>    Function DFGetCurrentDevice returns string // sPrinterName
83939>>>>>        String sPrinterName
83939>>>>>        Get DFGetCurrentDevice of (phoWinPrint(self)) to sPrinterName
83940>>>>>        Function_return sPrinterName
83941>>>>>    end_function
83942>>>>>
83942>>>>>
83942>>>>>    Procedure DFSetUserDefinedPapersize number nLength number nWidth
83944>>>>>        Send DFSetUserDefinedPapersize of (phoWinPrint(self)) nLength nWidth
83945>>>>>    End_Procedure
83946>>>>>
83946>>>>>    Function DFGetUserDefinedLength returns number
83948>>>>>        number nSize
83948>>>>>        Get DFGetUserDefinedLength of (phoWinPrint(self)) to nSize
83949>>>>>        Function_return nSize
83950>>>>>    end_function
83951>>>>>
83951>>>>>    Function DFGetUserDefinedWidth returns number
83953>>>>>        number nSize
83953>>>>>        Get DFGetUserDefinedWidth of (phoWinPrint(self)) to nSize
83954>>>>>        Function_return nSize
83955>>>>>    end_function
83956>>>>>
83956>>>>>
83956>>>>>    Procedure DFSetNumberOfCopies integer iCopies
83958>>>>>        Send DFSetNumberOfCopies of (phoWinPrint(self)) iCopies
83959>>>>>    End_Procedure
83960>>>>>
83960>>>>>    Procedure DFPrinterBinFirstPage integer eBinType
83962>>>>>        Send DFPrinterBinFirstPage of (phoWinPrint(self)) eBinType
83963>>>>>    End_Procedure
83964>>>>>
83964>>>>>    Procedure DFClearPrinter
83966>>>>>        Send DFClearPrinter of (phoWinPrint(self))
83967>>>>>    End_Procedure
83968>>>>>
83968>>>>>    Function DFGetDFColor integer iRed integer iGreen integer iBlue returns integer
83970>>>>>        integer iWPColor
83970>>>>>        Get DFGetDFColor of (phoWinPrint(self)) iRed iGreen iBlue to iWPColor
83971>>>>>        Function_return iWPColor
83972>>>>>    end_function
83973>>>>>
83973>>>>>    Function RGBToWPColor integer iRgb returns integer
83975>>>>>        integer iWPColor
83975>>>>>        Get RGBToWPColor of (phoWinPrint(self)) iRGB to iWPColor
83976>>>>>        Function_return iWPColor
83977>>>>>    end_function
83978>>>>>
83978>>>>>
83978>>>>>End_Class
83979>>>Use Windows.pkg
83979>>>
83979>>>Use cUgyfelDataDictionary.dd
83979>>>Use cAutoDataDictionary.dd
83979>>>Use cMunkalapDataDictionary.dd
83979>>>
83979>>>ACTIVATE_VIEW Activate_oGyakorisagRiport FOR oGyakorisagRiport
83989>>>>
83989>>>Object oGyakorisagRiport is a ReportView
83991>>>    Set Location to 6 6
83992>>>    Set Size to 60 202
83993>>>    Set Label To "GyakorisagRiport"
83994>>>
83994>>>
83994>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
83996>>>    End_Object 
83997>>>
83997>>>    Object oAuto_DD is a cAutoDataDictionary
83999>>>    End_Object 
84000>>>
84000>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84002>>>        Set DDO_Server To oAuto_DD
84003>>>        Set DDO_Server To oUgyfel_DD
84004>>>    End_Object 
84005>>>
84005>>>    Set Main_DD To oMunkalap_DD
84006>>>
84006>>>
84006>>>
84006>>>
84006>>>    Object oPrintTo is a RadioGroup
84008>>>        Set Size to 38 118
84009>>>        Set Location to 10 12
84010>>>        Set Label to "Send Report to"
84011>>>
84011>>>        Object oRadio1 is a Radio
84013>>>            Set Label to "Report Viewer"
84014>>>            Set Size to 10 61
84015>>>            Set Location to 12 6
84016>>>            Set Status_Help to "Prints the report to screen"
84017>>>        End_Object 
84018>>>
84018>>>        Object oRadio2 is a Radio
84020>>>            Set Label to "Printer"
84021>>>            Set Size to 10 42
84022>>>            Set Location to 24 6
84023>>>            Set Status_Help to "Prints the report to printer"
84024>>>        End_Object 
84025>>>
84025>>>
84025>>>        Function IsToPrinter Returns boolean
84028>>>            integer iRadio
84028>>>            Get Current_radio to iRadio
84029>>>            Function_return (iRadio=1)
84030>>>        End_Function 
84031>>>
84031>>>    End_Object 
84032>>>
84032>>>    Object oBtnPrint is a Button
84034>>>        Set Label to "Print"
84035>>>        Set Location to 5 140
84036>>>        Set Status_Help to "Print the Selected report"
84037>>>        Set Default_State to TRUE
84038>>>        Procedure OnClick
84041>>>            Send StartReport
84042>>>        End_Procedure
84043>>>    End_Object 
84044>>>
84044>>>    Object oBtnPrinterSetup is a Button
84046>>>        Set Label to "Printer Setup"
84047>>>        Set Location to 22 140
84048>>>        Set Status_Help to "Set up printer for report"
84049>>>        Procedure OnClick
84052>>>            Send DFPrintSetup of oReport
84053>>>        End_Procedure
84054>>>    End_Object 
84055>>>
84055>>>    Object oBtnCancel is a Button
84057>>>        Set Label to "Cancel"
84058>>>        Set Location to 39 140
84059>>>        Set Status_Help to "Close this Panel"
84060>>>        Procedure OnClick
84063>>>            Send Close_Panel
84064>>>        End_Procedure
84065>>>    End_Object 
84066>>>
84066>>>
84066>>>
84066>>>    Object oReport is a cWinReport2
84068>>>
84068>>>        Set Report_Title to "GyakorisagRiport"
84069>>>
84069>>>        // Set DDO, Index and breaks for the report
84069>>>        Set Server to oMunkalap_DD
84070>>>        Set Ordering to 1
84071>>>        // Report_Breaks file.field // no breaks in this report
84071>>>
84071>>>        Function Starting_Main_Report Returns Integer
84074>>>            Boolean bErr
84074>>>            Send DFSetMetrics wpm_cm
84075>>>            Send DFSetmargins 1 1 1 1
84076>>>            //Send DFSetLandscape false // This can be used to force a page orientation
84076>>>            Forward Get Starting_Main_Report to bErr
84078>>>            Function_return bErr
84079>>>        End_Function 
84080>>>
84080>>>        // Page_Top is printed first at the top margin of each page
84080>>>        Procedure Page_Top 
84083>>>            string  sFont
84083>>>            integer iFontSize
84083>>>
84083>>>            Move "arial" to sFont
84084>>>            Move 10 to iFontSize
84085>>>
84085>>>            DFFont sFont
84086>>>            DFFontSize iFontSize
84087>>>            DFBeginHeader DFPageTop
84088>>>                DFHeaderFrame Hdr_NoFrame
84089>>>                DFHeaderPos   Hdr_Left
84090>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
84091>>>            DFEndHeader
84093>>>
84093>>>        End_Procedure 
84094>>>
84094>>>        // Report_Header is printed once in a report after Page_Top
84094>>>        //Procedure Report_Header
84094>>>        //    string  sFont
84094>>>        //    integer iFontSize
84094>>>        //    Move "arial" to sFont
84094>>>        //    Move 10 to iFontSize
84094>>>        //    DFFont sFont
84094>>>        //    DFFontSize iFontSize
84094>>>        //    DFBeginHeader  DFReportHeader
84094>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84094>>>        //        DFHeaderPos    Hdr_Left
84094>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84094>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
84094>>>        //    DFEndHeader
84094>>>        //End_Procedure
84094>>>
84094>>>        Procedure Page_Header 
84097>>>            integer iFill iBorder iStyle
84097>>>            string  sFont sReportTitle
84097>>>            integer iFontSize
84097>>>
84097>>>            Move "arial" to sFont
84098>>>            Move 16 to iFontSize
84099>>>            Move (Font_bold + rgb_White) to iStyle
84100>>>            Move (rgb_dGrey) to iFill
84101>>>            Move (rgb_dGrey) to iBorder
84102>>>            Get Report_Title to sReportTitle
84103>>>
84103>>>            DFFont sFont
84104>>>            DFFontSize iFontSize
84105>>>            DFBeginHeader DFPageHeader
84106>>>                DFHeaderPos   Hdr_Left
84107>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84108>>>                DFWritelnPos sReportTitle 0.1 iStyle
84109>>>                DFHeaderMargin HM_BottomOuter 0.08
84110>>>            DFEndHeader
84112>>>
84112>>>        End_Procedure 
84113>>>
84113>>>        Procedure Page_Title 
84116>>>            string  sFont 
84116>>>            integer iFontSize iHeaderStyle iFill iBorder
84116>>>
84116>>>            Move "arial" to sFont
84117>>>            Move 10 to iFontSize
84118>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
84119>>>            Move (rgb_Grey) to iFill
84120>>>            Move (rgb_Grey) to iBorder
84121>>>
84121>>>            DFFont sFont
84122>>>            DFFontSize iFontSize
84123>>>            DFBeginHeader DFPageTitle
84124>>>                DFHeaderPos   Hdr_Left
84125>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84126>>>                DFHeaderMargin HM_TopInner    0.04
84127>>>                DFHeaderMargin HM_BottomInner 0.04
84128>>>                DFHeaderMargin HM_BottomOuter 0.08
84129>>>
84129>>>                DFWritePos "Mrka"                        0.08 iHeaderStyle -1 4.26
84130>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
84131>>>                DFWriteLn
84132>>>            DFEndHeader
84134>>>
84134>>>        End_Procedure 
84135>>>
84135>>>        Procedure Body 
84138>>>            string  sFont 
84138>>>            integer iFontSize iStyle
84138>>>
84138>>>            Move "arial" to sFont
84139>>>            Move 10 to iFontSize
84140>>>            Move (font_default) to iStyle
84141>>>
84141>>>            DFFont sFont
84142>>>            DFFontSize iFontSize
84143>>>
84143>>>            DFWritePos Auto.Marka                     0.08 iStyle -1 4.26
84144>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
84145>>>            DFWriteLn
84146>>>
84146>>>        End_Procedure 
84147>>>
84147>>>        // Totals appear at the end of the report before Report_Footer
84147>>>        //Procedure Total
84147>>>        //    string  sFont
84147>>>        //    integer iFontSize
84147>>>        //    Move "arial" to sFont
84147>>>        //    Move 10 to iFontSize
84147>>>        //    DFFont sFont
84147>>>        //    DFFontSize iFontSize
84147>>>        //    DFBeginHeader  DFTotal
84147>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84147>>>        //        DFHeaderPos    Hdr_Left
84147>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84147>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
84147>>>        //    DFEndHeader
84147>>>        //End_Procedure
84147>>>
84147>>>        // Report_Footer is printed once on the last page before Page_Footer
84147>>>        //Procedure Report_Footer
84147>>>        //    string  sFont
84147>>>        //    integer iFontSize
84147>>>        //    Move "arial" to sFont
84147>>>        //    Move 10 to iFontSize
84147>>>        //    DFFont sFont
84147>>>        //    DFFontSize iFontSize
84147>>>        //    DFBeginHeader DFReportFooter
84147>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84147>>>        //        DFHeaderPos    Hdr_Left
84147>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84147>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
84147>>>        //    DFEndHeader
84147>>>        //End_Procedure
84147>>>
84147>>>        // // Page_Footer is printed on each page before Page_Bottom
84147>>>        //Procedure Page_Footer
84147>>>        //    string  sFont
84147>>>        //    integer iFontSize
84147>>>        //    Move "arial" to sFont
84147>>>        //    Move 10 to iFontSize
84147>>>        //    DFFont sFont
84147>>>        //    DFFontSize iFontSize
84147>>>        //    DFBeginHeader DFPageFooter
84147>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84147>>>        //        DFHeaderPos    Hdr_Left
84147>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84147>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
84147>>>        //    DFEndHeader
84147>>>        //End_Procedure
84147>>>
84147>>>
84147>>>        // Page_Bottom is printed last at the bottom margin of each page
84147>>>        Procedure Page_Bottom 
84150>>>            string sFont
84150>>>            integer iFontSize iBorder iStyle
84150>>>            DateTime dtDT
84150>>>
84150>>>            Move (CurrentDateTime()) to dtDT
84151>>>
84151>>>            Move "arial" to sFont
84152>>>            Move 10 to iFontSize
84153>>>            Move (font_default) to iStyle
84154>>>            Move (rgb_dGrey) to iBorder
84155>>>
84155>>>            DFFont sFont
84156>>>            DFFontSize iFontSize
84157>>>            DFBeginHeader DFPageBottom
84158>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
84159>>>                DFHeaderPos Hdr_Left
84160>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
84161>>>            DFEndHeader
84163>>>
84163>>>        End_Procedure 
84164>>>
84164>>>        // Returns string with description of selection ranges
84164>>>        // Pass: Selection title, start value and end value. Return: description
84164>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
84167>>>            string sText
84167>>>            If (sStart=""  AND sStop="")  function_return ""
84170>>>            If (sStart="0" AND sStop="0") function_return ""
84173>>>            If (sStart<>"" AND sStop<>"") begin
84175>>>                Move ("between" * sStart * "and" * sStop) to sText
84176>>>            end
84176>>>>
84176>>>            Else if (sStart > "") begin
84179>>>                Move ("starting at" * sStart) to sText
84180>>>            end
84180>>>>
84180>>>            Else if (sStop > "") begin
84183>>>                Move ("up to" * sStop) to sText
84184>>>            End
84184>>>>
84184>>>            function_return (sTitle * sText)
84185>>>        End_Function
84186>>>
84186>>>    End_Object 
84187>>>
84187>>>    Procedure StartReport 
84190>>>        Boolean bToPrinter
84190>>>
84190>>>        // determine if direct print
84190>>>        Get IsToPrinter of oPrintTo to bToPrinter
84191>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
84192>>>
84192>>>        // run the report
84192>>>        Send Run_Report of oReport
84193>>>
84193>>>    End_Procedure 
84194>>>
84194>>>End_Object 
84195>        Use Report.rv
Including file: Report.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report.rv)
84195>>>// Report.rv
84195>>>// Report
84195>>>Register_Object oReport
84195>>>Use DFRptVw.pkg
84195>>>Use cWinReport2.pkg
84195>>>Use Windows.pkg
84195>>>
84195>>>Use cUgyfelDataDictionary.dd
84195>>>Use cAutoDataDictionary.dd
84195>>>Use cMunkalapDataDictionary.dd
84195>>>
84195>>>ACTIVATE_VIEW Activate_oReport FOR oReport
84205>>>>
84205>>>Object oReport is a ReportView
84207>>>    Set Location to 6 6
84208>>>    Set Size to 60 202
84209>>>    Set Label To "Report"
84210>>>
84210>>>
84210>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
84212>>>    End_Object 
84213>>>
84213>>>    Object oAuto_DD is a cAutoDataDictionary
84215>>>    End_Object 
84216>>>
84216>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84218>>>        Set DDO_Server To oAuto_DD
84219>>>        Set DDO_Server To oUgyfel_DD
84220>>>        Set Constrain_File To Auto.File_Number
84221>>>    End_Object 
84222>>>
84222>>>    Set Main_DD To oAuto_DD
84223>>>
84223>>>
84223>>>
84223>>>
84223>>>    Object oPrintTo is a RadioGroup
84225>>>        Set Size to 38 118
84226>>>        Set Location to 10 12
84227>>>        Set Label to "Send Report to"
84228>>>
84228>>>        Object oRadio1 is a Radio
84230>>>            Set Label to "Report Viewer"
84231>>>            Set Size to 10 61
84232>>>            Set Location to 12 6
84233>>>            Set Status_Help to "Prints the report to screen"
84234>>>        End_Object 
84235>>>
84235>>>        Object oRadio2 is a Radio
84237>>>            Set Label to "Printer"
84238>>>            Set Size to 10 42
84239>>>            Set Location to 24 6
84240>>>            Set Status_Help to "Prints the report to printer"
84241>>>        End_Object 
84242>>>
84242>>>
84242>>>        Function IsToPrinter Returns Boolean
84245>>>            integer iRadio
84245>>>            Get Current_Radio to iRadio
84246>>>            Function_Return (iRadio=1)
84247>>>        End_Function 
84248>>>
84248>>>    End_Object 
84249>>>
84249>>>    Object oBtnPrint is a Button
84251>>>        Set Label to "Print"
84252>>>        Set Location to 5 140
84253>>>        Set Status_Help to "Print the selected report"
84254>>>        Set Default_State to TRUE
84255>>>        Procedure OnClick
84258>>>            Send StartReport
84259>>>        End_Procedure
84260>>>    End_Object 
84261>>>
84261>>>    Object oBtnPrinterSetup is a Button
84263>>>        Set Label to "Printer Setup"
84264>>>        Set Location to 22 140
84265>>>        Set Status_Help to "Set up printer for report"
84266>>>        Procedure OnClick
84269>>>            Send DFPrintSetup of oReport
84270>>>        End_Procedure
84271>>>    End_Object 
84272>>>
84272>>>    Object oBtnCancel is a Button
84274>>>        Set Label to "Cancel"
84275>>>        Set Location to 39 140
84276>>>        Set Status_Help to "Close this Panel"
84277>>>        Procedure OnClick
84280>>>            Send Close_Panel
84281>>>        End_Procedure
84282>>>    End_Object 
84283>>>
84283>>>
84283>>>
84283>>>    Object oReport is a cWinReport2
84285>>>
84285>>>        Set Report_Title to "Report"
84286>>>        Object oReport2 is a cWinReport2
84288>>>
84288>>>
84288>>>            // Set DDO, Index and breaks for the report
84288>>>            Set Server to oMunkalap_DD
84289>>>            Set Ordering to 0
84290>>>            Procedure Body 
84293>>>                string  sFont 
84293>>>                integer iFontSize iStyle
84293>>>
84293>>>                Move "Times New Roman" to sFont
84294>>>                Move 10 to iFontSize
84295>>>                Move (font_default) to iStyle
84296>>>
84296>>>                DFFont sFont
84297>>>                DFFontSize iFontSize
84298>>>
84298>>>                DFWritePos Munkalap.Rogzites              0.08 iStyle -1 2.13
84299>>>                DFWriteLn
84300>>>
84300>>>            End_Procedure 
84301>>>
84301>>>        End_Object 
84302>>>
84302>>>        // Set DDO, Index and breaks for the report
84302>>>        Set Server to oAuto_DD
84303>>>        Set Ordering to 1
84304>>>        Report_Breaks (SerializeRowId(GetRowId(Auto.File_Number)))
84318>>>
84318>>>        Function Starting_Main_Report Returns Integer
84321>>>            Boolean bErr
84321>>>            Send DFSetMetrics wpm_cm
84322>>>            Send DFSetmargins 1 1 1 1
84323>>>            //Send DFSetLandscape false // This can be used to force a page orientation
84323>>>            Forward Get Starting_Main_Report to bErr
84325>>>            Function_return bErr
84326>>>        End_Function 
84327>>>
84327>>>        // Page_Top is printed first at the top margin of each page
84327>>>        Procedure Page_Top 
84330>>>            string  sFont
84330>>>            integer iFontSize
84330>>>
84330>>>            Move "Times New Roman" to sFont
84331>>>            Move 10 to iFontSize
84332>>>
84332>>>            DFFont sFont
84333>>>            DFFontSize iFontSize
84334>>>            DFBeginHeader DFPageTop
84335>>>                DFHeaderFrame Hdr_NoFrame
84336>>>                DFHeaderPos   Hdr_Left
84337>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
84338>>>            DFEndHeader
84340>>>
84340>>>        End_Procedure 
84341>>>
84341>>>        // Report_Header is printed once in a report after Page_Top
84341>>>        //Procedure Report_Header
84341>>>        //    string  sFont
84341>>>        //    integer iFontSize
84341>>>        //    Move "Times New Roman" to sFont
84341>>>        //    Move 10 to iFontSize
84341>>>        //    DFFont sFont
84341>>>        //    DFFontSize iFontSize
84341>>>        //    DFBeginHeader  DFReportHeader
84341>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84341>>>        //        DFHeaderPos    Hdr_Left
84341>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84341>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
84341>>>        //    DFEndHeader
84341>>>        //End_Procedure
84341>>>
84341>>>        Procedure Page_Header 
84344>>>            integer iFill iBorder iStyle
84344>>>            string  sFont sReportTitle
84344>>>            integer iFontSize
84344>>>
84344>>>            Move "Times New Roman" to sFont
84345>>>            Move 16 to iFontSize
84346>>>            Move (Font_bold + rgb_White) to iStyle
84347>>>            Move (rgb_dGrey) to iFill
84348>>>            Move (rgb_dGrey) to iBorder
84349>>>            Get Report_Title to sReportTitle
84350>>>
84350>>>            DFFont sFont
84351>>>            DFFontSize iFontSize
84352>>>            DFBeginHeader DFPageHeader
84353>>>                DFHeaderPos   Hdr_Left
84354>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84355>>>                DFWritelnPos sReportTitle 0.1 iStyle
84356>>>                DFHeaderMargin HM_BottomOuter 0.08
84357>>>            DFEndHeader
84359>>>
84359>>>        End_Procedure 
84360>>>
84360>>>        // Page_Title appears on every page after Page_Header
84360>>>        //Procedure Page_Title
84360>>>        //    string  sFont
84360>>>        //    integer iFontSize
84360>>>        //    Move "Times New Roman" to sFont
84360>>>        //    Move 10 to iFontSize
84360>>>        //    DFFont sFont
84360>>>        //    DFFontSize iFontSize
84360>>>        //    DFBeginHeader  DFPageTitle
84360>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84360>>>        //        DFHeaderPos    Hdr_Left
84360>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84360>>>        //        DFWrite     "Page_Title" (Font_Bold+Font_Center)
84360>>>        //    DFEndHeader
84360>>>        //End_Procedure
84360>>>
84360>>>        Procedure SubHeader1 
84363>>>            string  sFont 
84363>>>            integer iFontSize iStyle
84363>>>            integer iFill iBorder iHeaderStyle
84363>>>
84363>>>
84363>>>            // If (Page_end_State(self)) Begin // Page_end_State must get set in subtotal 1
84363>>>            //    Send DFNew_Page // this will force a new page
84363>>>            // End
84363>>>
84363>>>            Move "Times New Roman" to sFont
84364>>>            Move 10 to iFontSize
84365>>>            Move (font_bold) to iStyle
84366>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
84367>>>            Move (rgb_dGrey) to iBorder
84368>>>            Get DFGetDFColor 242 242 242 to iFill
84369>>>
84369>>>            DFFont sFont
84370>>>            DFFontSize iFontSize
84371>>>            DFBeginHeader DFSubHeader 1
84372>>>                DFHeaderLineCheck 5
84373>>>                DFHeaderWrap   HDR_Wrap
84374>>>                DFHeaderPos    HDR_Left
84375>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
84376>>>                DFHeaderMargin hm_BottomOuter 0.08
84377>>>                DFHeaderMargin hm_TopInner    0.04
84378>>>                DFHeaderMargin hm_BottomInner 0.04
84379>>>
84379>>>                // display fields to be placed in this sub-header
84379>>>                DFWritePos "Mrka:"                      0.1 iHeaderStyle -1 4.9
84380>>>                DFWritePos Auto.Marka                     5 iStyle -1
84381>>>                DFWriteLn
84382>>>
84382>>>                // write the heading for the body section
84382>>>                DFFontSize 1 // create a very small space on top of and below the horizontal bar
84383>>>                DFWriteLn
84384>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
84385>>>                DFWriteLn
84386>>>                DFFontSize iFontSize
84387>>>                DFWritePos "Rgz."                        0.08 iHeaderStyle -1 2.13
84388>>>                DFWriteLn
84389>>>
84389>>>            DFEndHeader
84391>>>
84391>>>        End_Procedure 
84392>>>
84392>>>        Procedure SubTotal1 
84395>>>            // SubTotal section is not used
84395>>>
84395>>>            // Set Page_end_State to True // force a page-break when this section ends
84395>>>
84395>>>        End_Procedure 
84396>>>
84396>>>        // Totals appear at the end of the report before Report_Footer
84396>>>        //Procedure Total
84396>>>        //    string  sFont
84396>>>        //    integer iFontSize
84396>>>        //    Move "Times New Roman" to sFont
84396>>>        //    Move 10 to iFontSize
84396>>>        //    DFFont sFont
84396>>>        //    DFFontSize iFontSize
84396>>>        //    DFBeginHeader  DFTotal
84396>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84396>>>        //        DFHeaderPos    Hdr_Left
84396>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84396>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
84396>>>        //    DFEndHeader
84396>>>        //End_Procedure
84396>>>
84396>>>        // Report_Footer is printed once on the last page before Page_Footer
84396>>>        //Procedure Report_Footer
84396>>>        //    string  sFont
84396>>>        //    integer iFontSize
84396>>>        //    Move "Times New Roman" to sFont
84396>>>        //    Move 10 to iFontSize
84396>>>        //    DFFont sFont
84396>>>        //    DFFontSize iFontSize
84396>>>        //    DFBeginHeader DFReportFooter
84396>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84396>>>        //        DFHeaderPos    Hdr_Left
84396>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84396>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
84396>>>        //    DFEndHeader
84396>>>        //End_Procedure
84396>>>
84396>>>        // // Page_Footer is printed on each page before Page_Bottom
84396>>>        //Procedure Page_Footer
84396>>>        //    string  sFont
84396>>>        //    integer iFontSize
84396>>>        //    Move "Times New Roman" to sFont
84396>>>        //    Move 10 to iFontSize
84396>>>        //    DFFont sFont
84396>>>        //    DFFontSize iFontSize
84396>>>        //    DFBeginHeader DFPageFooter
84396>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84396>>>        //        DFHeaderPos    Hdr_Left
84396>>>        //        DFHeaderMargin HM_BottomOuter 0.08
84396>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
84396>>>        //    DFEndHeader
84396>>>        //End_Procedure
84396>>>
84396>>>
84396>>>        // Page_Bottom is printed last at the bottom margin of each page
84396>>>        Procedure Page_Bottom 
84399>>>            string sFont
84399>>>            integer iFontSize iBorder iStyle
84399>>>            DateTime dtDT
84399>>>
84399>>>            Move (CurrentDateTime()) to dtDT
84400>>>
84400>>>            Move "Times New Roman" to sFont
84401>>>            Move 10 to iFontSize
84402>>>            Move (font_default) to iStyle
84403>>>            Move (rgb_dGrey) to iBorder
84404>>>
84404>>>            DFFont sFont
84405>>>            DFFontSize iFontSize
84406>>>            DFBeginHeader DFPageBottom
84407>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
84408>>>                DFHeaderPos Hdr_Left
84409>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
84410>>>            DFEndHeader
84412>>>
84412>>>        End_Procedure 
84413>>>
84413>>>        // Returns string with description of selection ranges
84413>>>        // Pass: Selection title, start value and end value. Return: description
84413>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
84416>>>            string sText
84416>>>            If (sStart=""  AND sStop="")  function_return ""
84419>>>            If (sStart="0" AND sStop="0") function_return ""
84422>>>            If (sStart<>"" AND sStop<>"") begin
84424>>>                Move ("between" * sStart * "and" * sStop) to sText
84425>>>            end
84425>>>>
84425>>>            Else if (sStart > "") Begin
84428>>>                Move ("starting at" * sStart) to sText
84429>>>            end
84429>>>>
84429>>>            Else if (sStop > "") begin
84432>>>                Move ("up to" * sStop) to sText
84433>>>            End
84433>>>>
84433>>>            function_return (sTitle * sText)
84434>>>        End_Function
84435>>>
84435>>>    End_Object 
84436>>>
84436>>>    Procedure StartReport 
84439>>>        Boolean bToPrinter
84439>>>
84439>>>        // determine if direct print
84439>>>        Get IsToPrinter of oPrintTo to bToPrinter
84440>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
84441>>>
84441>>>        // run the report
84441>>>        Send Run_Report of oReport
84442>>>
84442>>>    End_Procedure 
84443>>>
84443>>>End_Object 
84444>        Use MunkalapKeszites.vw
Including file: MunkalapKeszites.vw    (C:\Repos\DataFlexBeadando\AppSrc\MunkalapKeszites.vw)
84444>>>// C:\Repos\DataFlexBeadando\AppSrc\MunkalapKeszites.vw
84444>>>// MunkalapKeszites
84444>>>//
84444>>>
84444>>>Use DFClient.pkg
84444>>>Use DFEntry.pkg
84444>>>Use cDbCJGrid.pkg
84444>>>Use cDbCJGridColumn.pkg
84444>>>
84444>>>Use cUgyfelDataDictionary.dd
84444>>>Use cAutoDataDictionary.dd
84444>>>Use cMunkalapDataDictionary.dd
84444>>>Use cMunkaDataDictionary.dd
84444>>>Use cMunkaMunkalapDataDictionary.dd
84444>>>
84444>>>ACTIVATE_VIEW Activate_oMunkalapKeszites FOR oMunkalapKeszites
84454>>>>
84454>>>Object oMunkalapKeszites is a dbView
84456>>>    Set Location to 5 5
84457>>>    Set Size to 204 309
84458>>>    Set Label To "MunkalapKeszites"
84459>>>    Set Border_Style to Border_Thick
84460>>>
84460>>>
84460>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
84462>>>    End_Object 
84463>>>
84463>>>    Object oAuto_DD is a cAutoDataDictionary
84465>>>    End_Object 
84466>>>
84466>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84468>>>        Set DDO_Server To oAuto_DD
84469>>>        Set DDO_Server To oUgyfel_DD
84470>>>        // this lets you save a new parent DD from within child DD
84470>>>        Set Allow_Foreign_New_Save_State to True
84471>>>    End_Object 
84472>>>
84472>>>    Object oMunka_DD is a cMunkaDataDictionary
84474>>>    End_Object 
84475>>>
84475>>>    Object oMunkaMunkalap_DD is a cMunkaMunkalapDataDictionary
84477>>>        Set DDO_Server To oMunkalap_DD
84478>>>        Set DDO_Server To oMunka_DD
84479>>>        Set Constrain_File To Munkalap.File_Number
84480>>>    End_Object 
84481>>>
84481>>>    Set Main_DD To oMunkalap_DD
84482>>>    Set Server  To oMunkalap_DD
84483>>>
84483>>>
84483>>>
84483>>>    Object oMunkalapId is a dbForm
84485>>>        Entry_Item Munkalap.Id
84486>>>        Set Size to 13 42
84487>>>        Set Location to 5 68
84488>>>        Set peAnchors to anTopLeftRight
84489>>>        Set Label to "Munkalap azonost"
84490>>>        Set Label_Justification_mode to jMode_Left
84491>>>        Set Label_Col_Offset to 63
84492>>>        Set Label_row_Offset to 0
84493>>>    End_Object 
84494>>>
84494>>>    Object oUgyfelId is a dbForm
84496>>>        Entry_Item Ugyfel.Id
84497>>>        Set Size to 13 42
84498>>>        Set Location to 20 68
84499>>>        Set peAnchors to anTopLeftRight
84500>>>        Set Label to "gyfl azonost"
84501>>>        Set Label_Justification_mode to jMode_Left
84502>>>        Set Label_Col_Offset to 63
84503>>>        Set Label_row_Offset to 0
84504>>>    End_Object 
84505>>>
84505>>>    Object oAutoId is a dbForm
84507>>>        Entry_Item Auto.Id
84508>>>        Set Size to 13 42
84509>>>        Set Location to 35 68
84510>>>        Set peAnchors to anTopLeftRight
84511>>>        Set Label to "Azonost"
84512>>>        Set Label_Justification_mode to jMode_Left
84513>>>        Set Label_Col_Offset to 63
84514>>>        Set Label_row_Offset to 0
84515>>>    End_Object 
84516>>>
84516>>>    Object oMunkalapBehozatal is a dbForm
84518>>>        Entry_Item Munkalap.Behozatal
84519>>>        Set Size to 13 66
84520>>>        Set Location to 50 68
84521>>>        Set peAnchors to anTopLeftRight
84522>>>        Set Label to "Behozatal"
84523>>>        Set Label_Justification_mode to jMode_Left
84524>>>        Set Label_Col_Offset to 63
84525>>>        Set Label_row_Offset to 0
84526>>>    End_Object 
84527>>>
84527>>>    Object oMunkalapElvitel is a dbForm
84529>>>        Entry_Item Munkalap.Elvitel
84530>>>        Set Size to 13 66
84531>>>        Set Location to 65 68
84532>>>        Set peAnchors to anTopLeftRight
84533>>>        Set Label to "Elvitel"
84534>>>        Set Label_Justification_mode to jMode_Left
84535>>>        Set Label_Col_Offset to 63
84536>>>        Set Label_row_Offset to 0
84537>>>    End_Object 
84538>>>
84538>>>    Object oMunkalapAkm is a dbForm
84540>>>        Entry_Item Munkalap.Akm
84541>>>        Set Size to 13 66
84542>>>        Set Location to 80 68
84543>>>        Set peAnchors to anTopLeftRight
84544>>>        Set Label to "Kilmter eltte"
84545>>>        Set Label_Justification_mode to jMode_Left
84546>>>        Set Label_Col_Offset to 63
84547>>>        Set Label_row_Offset to 0
84548>>>    End_Object 
84549>>>
84549>>>    Object oMunkalapBkm is a dbForm
84551>>>        Entry_Item Munkalap.Bkm
84552>>>        Set Size to 13 66
84553>>>        Set Location to 95 68
84554>>>        Set peAnchors to anTopLeftRight
84555>>>        Set Label to "Kilmterlls utns"
84556>>>        Set Label_Justification_mode to jMode_Left
84557>>>        Set Label_Col_Offset to 63
84558>>>        Set Label_row_Offset to 0
84559>>>    End_Object 
84560>>>
84560>>>    Object oAutoMarka is a dbForm
84562>>>        Entry_Item Auto.Marka
84563>>>        Set Size to 13 126
84564>>>        Set Location to 110 68
84565>>>        Set peAnchors to anTopLeftRight
84566>>>        Set Label to "AutoMarka"
84567>>>        Set Label_Justification_mode to jMode_Left
84568>>>        Set Label_Col_Offset to 63
84569>>>        Set Label_row_Offset to 0
84570>>>    End_Object 
84571>>>
84571>>>    Object oDetailGrid is a cDbCJGrid
84573>>>        Set Size to 66 299
84574>>>        Set Location to 133 5
84575>>>        Set Server to oMunkaMunkalap_DD
84576>>>        Set Ordering to 1
84577>>>        Set peAnchors to anAll
84578>>>        Set psLayoutSection to "oMunkalapKeszites_oDetailGrid"
84579>>>        Set pbAllowInsertRow to False
84580>>>        Set pbHeaderPrompts to True
84581>>>
84581>>>        Object oMunka_Id is a cDbCJGridColumn
84583>>>            Entry_Item Munka.Id
84584>>>            Set piWidth to 85
84585>>>            Set psCaption to "Munka azon."
84586>>>        End_Object 
84587>>>
84587>>>        Object oMunka_Name is a cDbCJGridColumn
84589>>>            Entry_Item Munka.Name
84590>>>            Set piWidth to 210
84591>>>            Set psCaption to "Nv"
84592>>>        End_Object 
84593>>>
84593>>>        Object oMunka_Leiras is a cDbCJGridColumn
84595>>>            Entry_Item Munka.Leiras
84596>>>            Set piWidth to 105
84597>>>            Set psCaption to "Lers"
84598>>>        End_Object 
84599>>>
84599>>>        Object oMunka_Egysegar is a cDbCJGridColumn
84601>>>            Entry_Item Munka.Egysegar
84602>>>            Set piWidth to 105
84603>>>            Set psCaption to "Egysgr"
84604>>>        End_Object 
84605>>>
84605>>>    End_Object 
84606>>>
84606>>>    //-----------------------------------------------------------------------
84606>>>    // Create custom confirmation messages for save and delete
84606>>>    // We must create the new functions and assign verify messages
84606>>>    // to them.
84606>>>    //-----------------------------------------------------------------------
84606>>>
84606>>>    Function ConfirmDeleteHeader Returns Boolean
84609>>>        Boolean bFail
84609>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
84610>>>        Function_Return bFail
84611>>>    End_Function 
84612>>>
84612>>>    // Only confirm on the saving of new records
84612>>>    Function ConfirmSaveHeader Returns Boolean
84615>>>        Boolean bNoSave bHasRecord
84615>>>        Handle  hoSrvr
84615>>>        Get Server to hoSrvr
84616>>>        Get HasRecord of hoSrvr to bHasRecord
84617>>>        If not bHasRecord Begin
84619>>>            Get Confirm "Save this NEW header?" to bNoSave
84620>>>        End
84620>>>>
84620>>>        Function_Return bNoSave
84621>>>    End_Function 
84622>>>
84622>>>    // Define alternate confirmation Messages
84622>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
84623>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
84624>>>    // Saves in header should not clear the view
84624>>>    Set Auto_Clear_Deo_State to False
84625>>>
84625>>>
84625>>>End_Object 
84626>        Use Report2.rv
Including file: Report2.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report2.rv)
84626>>>// Report2.rv
84626>>>// Report2
84626>>>Register_Object oReport
84626>>>
84626>>>Use DFRptVw.pkg
84626>>>Use cWinReport2.pkg
84626>>>Use Windows.pkg
84626>>>
84626>>>Use cUgyfelDataDictionary.dd
84626>>>Use cAutoDataDictionary.dd
84626>>>Use cMunkalapDataDictionary.dd
84626>>>
84626>>>ACTIVATE_VIEW Activate_oReport2 FOR oReport2
84636>>>>
84636>>>Object oReport2 is a ReportView
84638>>>    Set Location to 6 6
84639>>>    Set Size to 100 202
84640>>>    Set Label To "Report2"
84641>>>
84641>>>
84641>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
84643>>>    End_Object 
84644>>>
84644>>>    Object oAuto_DD is a cAutoDataDictionary
84646>>>    End_Object 
84647>>>
84647>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
84649>>>        Set DDO_Server To oAuto_DD
84650>>>        Set DDO_Server To oUgyfel_DD
84651>>>        Property Date pdStartRogzites
84653>>>        Property Date pdStopRogzites
84655>>>
84655>>>        Procedure OnConstrain 
84658>>>            Date dStart dStop
84658>>>
84658>>>            Get pdStartRogzites To dStart
84659>>>            Get pdStopRogzites To dStop
84660>>>
84660>>>            Case Begin
84660>>>                Case (dStart <> 0 and dStop <> 0)
84662>>>                    Constrain Munkalap.Rogzites between dStart and dStop
84666>>>                    Case Break
84667>>>                Case (dStart <> 0)
84670>>>                    Constrain Munkalap.Rogzites GE dStart
84672>>>                    Case Break
84673>>>                Case (dStop <> 0)
84676>>>                    Constrain Munkalap.Rogzites LE dStop
84678>>>            Case End
84678>>>        End_Procedure 
84679>>>    End_Object 
84680>>>
84680>>>    Set Main_DD To oMunkalap_DD
84681>>>
84681>>>
84681>>>
84681>>>    Object oRogzitesSelection is a Group
84683>>>        Set Size to 35 179
84684>>>        Set Location to 5 12
84685>>>        Set Label to "Select Rgzts"
84686>>>
84686>>>        Object oSelStart is a Form
84688>>>            Set Label to "From:"
84689>>>            Set Size to 13 60
84690>>>            Set Location to 13 30
84691>>>            Set Status_Help to "First value in selection range."
84692>>>            Set Label_Col_Offset to 2
84693>>>            Set Label_Justification_Mode to jMode_Right
84694>>>            Set Form_datatype to mask_date_window
84695>>>        End_Object 
84696>>>
84696>>>        Object oSelStop is a Form
84698>>>            Set Label to "To:"
84699>>>            Set Size to 14 60
84700>>>            Set Location to 13 111
84701>>>            Set Status_Help to "Last value in selection range."
84702>>>            Set Label_Col_Offset to 2
84703>>>            Set Label_Justification_Mode to jMode_Right
84704>>>            Set Form_datatype to mask_date_window
84705>>>        End_Object 
84706>>>
84706>>>
84706>>>        Function StartValue returns String
84709>>>            string sValue
84709>>>            Get Value of oSelStart to sValue
84710>>>            Function_return sValue
84711>>>        End_Function 
84712>>>
84712>>>        Function StopValue returns String
84715>>>            string sValue
84715>>>            Get Value of oSelStop to sValue
84716>>>            Function_return sValue
84717>>>        End_Function 
84718>>>
84718>>>    End_Object 
84719>>>
84719>>>    Object oPrintTo is a RadioGroup
84721>>>        Set Size to 38 118
84722>>>        Set Location to 50 12
84723>>>        Set Label to "Send Report to"
84724>>>
84724>>>        Object oRadio1 is a Radio
84726>>>            Set Label to "Report Viewer"
84727>>>            Set Size to 10 61
84728>>>            Set Location to 12 6
84729>>>            Set Status_Help to "Prints the report to screen"
84730>>>        End_Object 
84731>>>
84731>>>        Object oRadio2 is a Radio
84733>>>            Set Label to "Printer"
84734>>>            Set Size to 10 42
84735>>>            Set Location to 24 6
84736>>>            Set Status_Help to "Prints the report to printer"
84737>>>        End_Object 
84738>>>
84738>>>
84738>>>        Function IsToPrinter Returns boolean
84741>>>            integer iRadio
84741>>>            Get Current_radio to iRadio
84742>>>            Function_return (iRadio=1)
84743>>>        End_Function 
84744>>>
84744>>>    End_Object 
84745>>>
84745>>>    Object oBtnPrint is a Button
84747>>>        Set Label to "Print"
84748>>>        Set Location to 45 140
84749>>>        Set Status_Help to "Print the Selected report"
84750>>>        Set Default_State to TRUE
84751>>>        Procedure OnClick
84754>>>            Send StartReport
84755>>>        End_Procedure
84756>>>    End_Object 
84757>>>
84757>>>    Object oBtnPrinterSetup is a Button
84759>>>        Set Label to "Printer Setup"
84760>>>        Set Location to 62 140
84761>>>        Set Status_Help to "Set up printer for report"
84762>>>        Procedure OnClick
84765>>>            Send DFPrintSetup of oReport
84766>>>        End_Procedure
84767>>>    End_Object 
84768>>>
84768>>>    Object oBtnCancel is a Button
84770>>>        Set Label to "Cancel"
84771>>>        Set Location to 79 140
84772>>>        Set Status_Help to "Close this Panel"
84773>>>        Procedure OnClick
84776>>>            Send Close_Panel
84777>>>        End_Procedure
84778>>>    End_Object 
84779>>>
84779>>>
84779>>>
84779>>>    Object oReport is a cWinReport2
84781>>>
84781>>>        Set Report_Title to "Report2"
84782>>>
84782>>>        // Set DDO, Index and breaks for the report
84782>>>        Set Server to oMunkalap_DD
84783>>>        Set Ordering to 3
84784>>>        Report_Breaks Munkalap.AutoMarka
84798>>>
84798>>>        Function Starting_Main_Report Returns Integer
84801>>>            Boolean bErr
84801>>>            Send DFSetMetrics wpm_cm
84802>>>            Send DFSetmargins 1 1 1 1
84803>>>            //Send DFSetLandscape false // This can be used to force a page orientation
84803>>>            Forward Get Starting_Main_Report to bErr
84805>>>            Function_return bErr
84806>>>        End_Function 
84807>>>
84807>>>        // Page_Top is printed first at the top margin of each page
84807>>>        Procedure Page_Top 
84810>>>            string  sFont
84810>>>            integer iFontSize
84810>>>
84810>>>            Move "arial" to sFont
84811>>>            Move 10 to iFontSize
84812>>>
84812>>>            DFFont sFont
84813>>>            DFFontSize iFontSize
84814>>>            DFBeginHeader DFPageTop
84815>>>                DFHeaderFrame Hdr_NoFrame
84816>>>                DFHeaderPos   Hdr_Left
84817>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
84818>>>            DFEndHeader
84820>>>
84820>>>        End_Procedure 
84821>>>
84821>>>        // Report_Header is printed once in a report after Page_Top
84821>>>        //Procedure Report_Header
84821>>>        //    string  sFont
84821>>>        //    integer iFontSize
84821>>>        //    Move "arial" to sFont
84821>>>        //    Move 10 to iFontSize
84821>>>        //    DFFont sFont
84821>>>        //    DFFontSize iFontSize
84821>>>        //    DFBeginHeader  DFReportHeader
84821>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84821>>>        //        DFHeaderPos    Hdr_Left
84821>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84821>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
84821>>>        //    DFEndHeader
84821>>>        //End_Procedure
84821>>>
84821>>>        Procedure Page_Header 
84824>>>            integer iFill iBorder iStyle
84824>>>            string  sFont sReportTitle
84824>>>            integer iFontSize
84824>>>
84824>>>            Move "arial" to sFont
84825>>>            Move 16 to iFontSize
84826>>>            Move (Font_bold + rgb_White) to iStyle
84827>>>            Move (rgb_dGrey) to iFill
84828>>>            Move (rgb_dGrey) to iBorder
84829>>>            Get Report_Title to sReportTitle
84830>>>
84830>>>            DFFont sFont
84831>>>            DFFontSize iFontSize
84832>>>            DFBeginHeader DFPageHeader
84833>>>                DFHeaderPos   Hdr_Left
84834>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84835>>>                DFWritelnPos sReportTitle 0.1 iStyle
84836>>>                DFHeaderMargin HM_BottomOuter 0.08
84837>>>            DFEndHeader
84839>>>
84839>>>        End_Procedure 
84840>>>
84840>>>        Procedure Page_Title 
84843>>>            string  sFont 
84843>>>            integer iFontSize iHeaderStyle iFill iBorder
84843>>>
84843>>>            Move "arial" to sFont
84844>>>            Move 10 to iFontSize
84845>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
84846>>>            Move (rgb_Grey) to iFill
84847>>>            Move (rgb_Grey) to iBorder
84848>>>
84848>>>            DFFont sFont
84849>>>            DFFontSize iFontSize
84850>>>            DFBeginHeader DFPageTitle
84851>>>                DFHeaderPos   Hdr_Left
84852>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84853>>>                DFHeaderMargin HM_TopInner    0.04
84854>>>                DFHeaderMargin HM_BottomInner 0.04
84855>>>                DFHeaderMargin HM_BottomOuter 0.08
84856>>>
84856>>>                DFWritePos "AutoMarka"                    0.08 iHeaderStyle -1 4.26
84857>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
84858>>>                DFWriteLn
84859>>>            DFEndHeader
84861>>>
84861>>>        End_Procedure 
84862>>>
84862>>>        Procedure SubHeader1 
84865>>>            string  sFont 
84865>>>            integer iFontSize iStyle
84865>>>
84865>>>            Move "arial" to sFont
84866>>>            Move 10 to iFontSize
84867>>>            Move (font_bold) to iStyle
84868>>>
84868>>>            DFFont sFont
84869>>>            DFFontSize iFontSize
84870>>>            DFBeginHeader DFSubHeader 1
84871>>>                DFHeaderLineCheck 5
84872>>>                DFHeaderWrap   HDR_Wrap
84873>>>                DFHeaderPos    HDR_Left
84874>>>                DFHeaderFrame HDR_NoFrame
84875>>>                DFWritePos ("Recnum: Munkalap.Recnum") 0.1 iStyle
84876>>>            DFEndHeader
84878>>>
84878>>>        End_Procedure 
84879>>>
84879>>>        Procedure Body 
84882>>>            string  sFont 
84882>>>            integer iFontSize iStyle
84882>>>
84882>>>            Move "arial" to sFont
84883>>>            Move 10 to iFontSize
84884>>>            Move (font_default) to iStyle
84885>>>
84885>>>            DFFont sFont
84886>>>            DFFontSize iFontSize
84887>>>
84887>>>            DFWritePos Munkalap.AutoMarka             0.08 iStyle -1 4.26
84888>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
84889>>>            DFWriteLn
84890>>>            Send Add_SubTotal 1 1
84891>>>
84891>>>        End_Procedure 
84892>>>
84892>>>        Procedure SubTotal1 
84895>>>            string  sFont 
84895>>>            integer iFontSize iStyle iFill iBorder
84895>>>            number  nAmount
84895>>>
84895>>>            Move "arial" to sFont
84896>>>            Move 10 to iFontSize
84897>>>            Move (font_bold) to iStyle
84898>>>            Move (rgb_dGrey) to iBorder
84899>>>            Get DFGetDFColor 242 242 242 to iFill
84900>>>
84900>>>            DFFont sFont
84901>>>            DFFontSize iFontSize
84902>>>            DFBeginHeader DFSubTotal 1
84903>>>                DFHeaderPos   Hdr_Left
84904>>>                DFHeaderWrap  Hdr_NoWrap
84905>>>                DFHeaderFrame HDR_NoFrame
84906>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84907>>>
84907>>>                Get SubTotal ( 1 + 0) to nAmount
84908>>>                Send Add_SubTotal ( 1 + 2) 1
84909>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
84910>>>                DFWriteLn
84911>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
84912>>>                DFWriteLn
84913>>>            DFEndHeader
84915>>>
84915>>>        End_Procedure 
84916>>>
84916>>>        Procedure Total 
84919>>>            string  sFont 
84919>>>            integer iFontSize iStyle iFill iBorder
84919>>>            number  nAmount
84919>>>
84919>>>            Move "arial" to sFont
84920>>>            Move 10 to iFontSize
84921>>>            Move (font_bold) to iStyle
84922>>>            Move (rgb_Grey) to iFill
84923>>>            Move (rgb_dGrey) to iBorder
84924>>>
84924>>>            DFFont sFont
84925>>>            DFFontSize iFontSize
84926>>>            DFBeginHeader DFTotal
84927>>>                DFHeaderPos   Hdr_Left
84928>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
84929>>>
84929>>>                Get SubTotal ( 1 + 2) to nAmount
84930>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
84931>>>                DFWriteLn
84932>>>            DFEndHeader
84934>>>
84934>>>        End_Procedure 
84935>>>
84935>>>        // Report_Footer is printed once on the last page before Page_Footer
84935>>>        //Procedure Report_Footer
84935>>>        //    string  sFont
84935>>>        //    integer iFontSize
84935>>>        //    Move "arial" to sFont
84935>>>        //    Move 10 to iFontSize
84935>>>        //    DFFont sFont
84935>>>        //    DFFontSize iFontSize
84935>>>        //    DFBeginHeader DFReportFooter
84935>>>        //        DFHeaderFrame  Hdr_Margins 0.01
84935>>>        //        DFHeaderPos    Hdr_Left
84935>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
84935>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
84935>>>        //    DFEndHeader
84935>>>        //End_Procedure
84935>>>
84935>>>        Procedure Page_Footer 
84938>>>            string sStart sStop sText
84938>>>            string  sFont 
84938>>>            integer iFontSize iStyle
84938>>>
84938>>>            Move "arial" to sFont
84939>>>            Move 10 to iFontSize
84940>>>            Move (font_default) to iStyle
84941>>>
84941>>>            DFFont sFont
84942>>>            DFFontSize iFontSize
84943>>>            DFBeginHeader DFPageFooter
84944>>>                DFHeaderFrame hdr_NoFrame
84945>>>                DFHeaderPos   hdr_Left
84946>>>
84946>>>                Get pdStartRogzites of oMunkalap_DD to sStart
84947>>>                Get pdStopRogzites  of oMunkalap_DD to sStop
84948>>>                Get SelectionCriteraDescription "Munkalap.Rogzites" sStart sStop to sText
84949>>>                If (sText<>"") begin
84951>>>                    DFWriteLnPos sText 0.1
84952>>>                end
84952>>>>
84952>>>
84952>>>            DFEndHeader
84954>>>        End_Procedure 
84955>>>
84955>>>        // Page_Bottom is printed last at the bottom margin of each page
84955>>>        Procedure Page_Bottom 
84958>>>            string sFont
84958>>>            integer iFontSize iBorder iStyle
84958>>>            DateTime dtDT
84958>>>
84958>>>            Move (CurrentDateTime()) to dtDT
84959>>>
84959>>>            Move "arial" to sFont
84960>>>            Move 10 to iFontSize
84961>>>            Move (font_default) to iStyle
84962>>>            Move (rgb_dGrey) to iBorder
84963>>>
84963>>>            DFFont sFont
84964>>>            DFFontSize iFontSize
84965>>>            DFBeginHeader DFPageBottom
84966>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
84967>>>                DFHeaderPos Hdr_Left
84968>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
84969>>>            DFEndHeader
84971>>>
84971>>>        End_Procedure 
84972>>>
84972>>>        // Returns string with description of selection ranges
84972>>>        // Pass: Selection title, start value and end value. Return: description
84972>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
84975>>>            string sText
84975>>>            If (sStart=""  AND sStop="")  function_return ""
84978>>>            If (sStart="0" AND sStop="0") function_return ""
84981>>>            If (sStart<>"" AND sStop<>"") begin
84983>>>                Move ("between" * sStart * "and" * sStop) to sText
84984>>>            end
84984>>>>
84984>>>            Else if (sStart > "") begin
84987>>>                Move ("starting at" * sStart) to sText
84988>>>            end
84988>>>>
84988>>>            Else if (sStop > "") begin
84991>>>                Move ("up to" * sStop) to sText
84992>>>            End
84992>>>>
84992>>>            function_return (sTitle * sText)
84993>>>        End_Function
84994>>>
84994>>>    End_Object 
84995>>>
84995>>>    Procedure StartReport 
84998>>>        Boolean bToPrinter
84998>>>        String sValue
84998>>>        Date dStart dStop
84998>>>
84998>>>        // Set all selection critera properties
84998>>>        Get StartValue of oRogzitesSelection to sValue
84999>>>        Set pdStartRogzites of oMunkalap_DD To sValue
85000>>>
85000>>>        Get StopValue of oRogzitesSelection to sValue
85001>>>        Set pdStopRogzites of oMunkalap_DD To sValue
85002>>>
85002>>>
85002>>>        // determine if direct print
85002>>>        Get IsToPrinter of oPrintTo to bToPrinter
85003>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
85004>>>
85004>>>        // run the report
85004>>>        Send Run_Report of oReport
85005>>>
85005>>>    End_Procedure 
85006>>>
85006>>>End_Object 
85007>        Use Report3.rv
Including file: Report3.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report3.rv)
85007>>>// Report3.rv
85007>>>// Report3
85007>>>Register_Object oReport
85007>>>
85007>>>Use DFRptVw.pkg
85007>>>Use cWinReport2.pkg
85007>>>Use Windows.pkg
85007>>>
85007>>>Use cUgyfelDataDictionary.dd
85007>>>Use cAutoDataDictionary.dd
85007>>>Use cMunkalapDataDictionary.dd
85007>>>
85007>>>ACTIVATE_VIEW Activate_oReport3 FOR oReport3
85017>>>>
85017>>>Object oReport3 is a ReportView
85019>>>    Set Location to 6 6
85020>>>    Set Size to 60 202
85021>>>    Set Label To "Report3"
85022>>>
85022>>>
85022>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
85024>>>    End_Object 
85025>>>
85025>>>    Object oAuto_DD is a cAutoDataDictionary
85027>>>    End_Object 
85028>>>
85028>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
85030>>>        Set DDO_Server To oAuto_DD
85031>>>        Set DDO_Server To oUgyfel_DD
85032>>>    End_Object 
85033>>>
85033>>>    Set Main_DD To oMunkalap_DD
85034>>>
85034>>>
85034>>>
85034>>>
85034>>>    Object oPrintTo is a RadioGroup
85036>>>        Set Size to 38 118
85037>>>        Set Location to 10 12
85038>>>        Set Label to "Send Report to"
85039>>>
85039>>>        Object oRadio1 is a Radio
85041>>>            Set Label to "Report Viewer"
85042>>>            Set Size to 10 61
85043>>>            Set Location to 12 6
85044>>>            Set Status_Help to "Prints the report to screen"
85045>>>        End_Object 
85046>>>
85046>>>        Object oRadio2 is a Radio
85048>>>            Set Label to "Printer"
85049>>>            Set Size to 10 42
85050>>>            Set Location to 24 6
85051>>>            Set Status_Help to "Prints the report to printer"
85052>>>        End_Object 
85053>>>
85053>>>
85053>>>        Function IsToPrinter Returns boolean
85056>>>            integer iRadio
85056>>>            Get Current_radio to iRadio
85057>>>            Function_return (iRadio=1)
85058>>>        End_Function 
85059>>>
85059>>>    End_Object 
85060>>>
85060>>>    Object oBtnPrint is a Button
85062>>>        Set Label to "Print"
85063>>>        Set Location to 5 140
85064>>>        Set Status_Help to "Print the Selected report"
85065>>>        Set Default_State to TRUE
85066>>>        Procedure OnClick
85069>>>            Send StartReport
85070>>>        End_Procedure
85071>>>    End_Object 
85072>>>
85072>>>    Object oBtnPrinterSetup is a Button
85074>>>        Set Label to "Printer Setup"
85075>>>        Set Location to 22 140
85076>>>        Set Status_Help to "Set up printer for report"
85077>>>        Procedure OnClick
85080>>>            Send DFPrintSetup of oReport
85081>>>        End_Procedure
85082>>>    End_Object 
85083>>>
85083>>>    Object oBtnCancel is a Button
85085>>>        Set Label to "Cancel"
85086>>>        Set Location to 39 140
85087>>>        Set Status_Help to "Close this Panel"
85088>>>        Procedure OnClick
85091>>>            Send Close_Panel
85092>>>        End_Procedure
85093>>>    End_Object 
85094>>>
85094>>>
85094>>>
85094>>>    Object oReport is a cWinReport2
85096>>>
85096>>>        Set Report_Title to "Report3"
85097>>>
85097>>>        // Set DDO, Index and breaks for the report
85097>>>        Set Server to oMunkalap_DD
85098>>>        Set Ordering to 3
85099>>>        Report_Breaks Munkalap.AutoMarka
85113>>>
85113>>>        Function Starting_Main_Report Returns Integer
85116>>>            Boolean bErr
85116>>>            Send DFSetMetrics wpm_cm
85117>>>            Send DFSetmargins 1 1 1 1
85118>>>            //Send DFSetLandscape false // This can be used to force a page orientation
85118>>>            Forward Get Starting_Main_Report to bErr
85120>>>            Function_return bErr
85121>>>        End_Function 
85122>>>
85122>>>        // Page_Top is printed first at the top margin of each page
85122>>>        Procedure Page_Top 
85125>>>            string  sFont
85125>>>            integer iFontSize
85125>>>
85125>>>            Move "arial" to sFont
85126>>>            Move 10 to iFontSize
85127>>>
85127>>>            DFFont sFont
85128>>>            DFFontSize iFontSize
85129>>>            DFBeginHeader DFPageTop
85130>>>                DFHeaderFrame Hdr_NoFrame
85131>>>                DFHeaderPos   Hdr_Left
85132>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
85133>>>            DFEndHeader
85135>>>
85135>>>        End_Procedure 
85136>>>
85136>>>        // Report_Header is printed once in a report after Page_Top
85136>>>        //Procedure Report_Header
85136>>>        //    string  sFont
85136>>>        //    integer iFontSize
85136>>>        //    Move "arial" to sFont
85136>>>        //    Move 10 to iFontSize
85136>>>        //    DFFont sFont
85136>>>        //    DFFontSize iFontSize
85136>>>        //    DFBeginHeader  DFReportHeader
85136>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85136>>>        //        DFHeaderPos    Hdr_Left
85136>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85136>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
85136>>>        //    DFEndHeader
85136>>>        //End_Procedure
85136>>>
85136>>>        Procedure Page_Header 
85139>>>            integer iFill iBorder iStyle
85139>>>            string  sFont sReportTitle
85139>>>            integer iFontSize
85139>>>
85139>>>            Move "arial" to sFont
85140>>>            Move 16 to iFontSize
85141>>>            Move (Font_bold + rgb_White) to iStyle
85142>>>            Move (rgb_dGrey) to iFill
85143>>>            Move (rgb_dGrey) to iBorder
85144>>>            Get Report_Title to sReportTitle
85145>>>
85145>>>            DFFont sFont
85146>>>            DFFontSize iFontSize
85147>>>            DFBeginHeader DFPageHeader
85148>>>                DFHeaderPos   Hdr_Left
85149>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85150>>>                DFWritelnPos sReportTitle 0.1 iStyle
85151>>>                DFHeaderMargin HM_BottomOuter 0.08
85152>>>            DFEndHeader
85154>>>
85154>>>        End_Procedure 
85155>>>
85155>>>        Procedure Page_Title 
85158>>>            string  sFont 
85158>>>            integer iFontSize iHeaderStyle iFill iBorder
85158>>>
85158>>>            Move "arial" to sFont
85159>>>            Move 10 to iFontSize
85160>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
85161>>>            Move (rgb_Grey) to iFill
85162>>>            Move (rgb_Grey) to iBorder
85163>>>
85163>>>            DFFont sFont
85164>>>            DFFontSize iFontSize
85165>>>            DFBeginHeader DFPageTitle
85166>>>                DFHeaderPos   Hdr_Left
85167>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85168>>>                DFHeaderMargin HM_TopInner    0.04
85169>>>                DFHeaderMargin HM_BottomInner 0.04
85170>>>                DFHeaderMargin HM_BottomOuter 0.08
85171>>>
85171>>>                DFWritePos "AutoMarka"                    0.08 iHeaderStyle -1 4.26
85172>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
85173>>>                DFWriteLn
85174>>>            DFEndHeader
85176>>>
85176>>>        End_Procedure 
85177>>>
85177>>>        Procedure SubHeader1 
85180>>>            string  sFont 
85180>>>            integer iFontSize iStyle
85180>>>
85180>>>            Move "arial" to sFont
85181>>>            Move 10 to iFontSize
85182>>>            Move (font_bold) to iStyle
85183>>>
85183>>>            DFFont sFont
85184>>>            DFFontSize iFontSize
85185>>>            DFBeginHeader DFSubHeader 1
85186>>>                DFHeaderLineCheck 5
85187>>>                DFHeaderWrap   HDR_Wrap
85188>>>                DFHeaderPos    HDR_Left
85189>>>                DFHeaderFrame HDR_NoFrame
85190>>>                DFWritePos ("Recnum: Munkalap.Recnum") 0.1 iStyle
85191>>>            DFEndHeader
85193>>>
85193>>>        End_Procedure 
85194>>>
85194>>>        Procedure Body 
85197>>>            string  sFont 
85197>>>            integer iFontSize iStyle
85197>>>
85197>>>            Move "arial" to sFont
85198>>>            Move 10 to iFontSize
85199>>>            Move (font_default) to iStyle
85200>>>
85200>>>            DFFont sFont
85201>>>            DFFontSize iFontSize
85202>>>
85202>>>            DFWritePos Munkalap.AutoMarka             0.08 iStyle -1 4.26
85203>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
85204>>>            DFWriteLn
85205>>>            Send Add_SubTotal 1 1
85206>>>
85206>>>        End_Procedure 
85207>>>
85207>>>        Procedure SubTotal1 
85210>>>            string  sFont 
85210>>>            integer iFontSize iStyle iFill iBorder
85210>>>            number  nAmount
85210>>>
85210>>>            Move "arial" to sFont
85211>>>            Move 10 to iFontSize
85212>>>            Move (font_bold) to iStyle
85213>>>            Move (rgb_dGrey) to iBorder
85214>>>            Get DFGetDFColor 242 242 242 to iFill
85215>>>
85215>>>            DFFont sFont
85216>>>            DFFontSize iFontSize
85217>>>            DFBeginHeader DFSubTotal 1
85218>>>                DFHeaderPos   Hdr_Left
85219>>>                DFHeaderWrap  Hdr_NoWrap
85220>>>                DFHeaderFrame HDR_NoFrame
85221>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85222>>>
85222>>>                Get SubTotal ( 1 + 0) to nAmount
85223>>>                Send Add_SubTotal ( 1 + 2) 1
85224>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85225>>>                DFWriteLn
85226>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
85227>>>                DFWriteLn
85228>>>            DFEndHeader
85230>>>
85230>>>        End_Procedure 
85231>>>
85231>>>        Procedure Total 
85234>>>            string  sFont 
85234>>>            integer iFontSize iStyle iFill iBorder
85234>>>            number  nAmount
85234>>>
85234>>>            Move "arial" to sFont
85235>>>            Move 10 to iFontSize
85236>>>            Move (font_bold) to iStyle
85237>>>            Move (rgb_Grey) to iFill
85238>>>            Move (rgb_dGrey) to iBorder
85239>>>
85239>>>            DFFont sFont
85240>>>            DFFontSize iFontSize
85241>>>            DFBeginHeader DFTotal
85242>>>                DFHeaderPos   Hdr_Left
85243>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85244>>>
85244>>>                Get SubTotal ( 1 + 2) to nAmount
85245>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85246>>>                DFWriteLn
85247>>>            DFEndHeader
85249>>>
85249>>>        End_Procedure 
85250>>>
85250>>>        // Report_Footer is printed once on the last page before Page_Footer
85250>>>        //Procedure Report_Footer
85250>>>        //    string  sFont
85250>>>        //    integer iFontSize
85250>>>        //    Move "arial" to sFont
85250>>>        //    Move 10 to iFontSize
85250>>>        //    DFFont sFont
85250>>>        //    DFFontSize iFontSize
85250>>>        //    DFBeginHeader DFReportFooter
85250>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85250>>>        //        DFHeaderPos    Hdr_Left
85250>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85250>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
85250>>>        //    DFEndHeader
85250>>>        //End_Procedure
85250>>>
85250>>>        // // Page_Footer is printed on each page before Page_Bottom
85250>>>        //Procedure Page_Footer
85250>>>        //    string  sFont
85250>>>        //    integer iFontSize
85250>>>        //    Move "arial" to sFont
85250>>>        //    Move 10 to iFontSize
85250>>>        //    DFFont sFont
85250>>>        //    DFFontSize iFontSize
85250>>>        //    DFBeginHeader DFPageFooter
85250>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85250>>>        //        DFHeaderPos    Hdr_Left
85250>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85250>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
85250>>>        //    DFEndHeader
85250>>>        //End_Procedure
85250>>>
85250>>>
85250>>>        // Page_Bottom is printed last at the bottom margin of each page
85250>>>        Procedure Page_Bottom 
85253>>>            string sFont
85253>>>            integer iFontSize iBorder iStyle
85253>>>            DateTime dtDT
85253>>>
85253>>>            Move (CurrentDateTime()) to dtDT
85254>>>
85254>>>            Move "arial" to sFont
85255>>>            Move 10 to iFontSize
85256>>>            Move (font_default) to iStyle
85257>>>            Move (rgb_dGrey) to iBorder
85258>>>
85258>>>            DFFont sFont
85259>>>            DFFontSize iFontSize
85260>>>            DFBeginHeader DFPageBottom
85261>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
85262>>>                DFHeaderPos Hdr_Left
85263>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
85264>>>            DFEndHeader
85266>>>
85266>>>        End_Procedure 
85267>>>
85267>>>        // Returns string with description of selection ranges
85267>>>        // Pass: Selection title, start value and end value. Return: description
85267>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
85270>>>            string sText
85270>>>            If (sStart=""  AND sStop="")  function_return ""
85273>>>            If (sStart="0" AND sStop="0") function_return ""
85276>>>            If (sStart<>"" AND sStop<>"") begin
85278>>>                Move ("between" * sStart * "and" * sStop) to sText
85279>>>            end
85279>>>>
85279>>>            Else if (sStart > "") begin
85282>>>                Move ("starting at" * sStart) to sText
85283>>>            end
85283>>>>
85283>>>            Else if (sStop > "") begin
85286>>>                Move ("up to" * sStop) to sText
85287>>>            End
85287>>>>
85287>>>            function_return (sTitle * sText)
85288>>>        End_Function
85289>>>
85289>>>    End_Object 
85290>>>
85290>>>    Procedure StartReport 
85293>>>        Boolean bToPrinter
85293>>>
85293>>>        // determine if direct print
85293>>>        Get IsToPrinter of oPrintTo to bToPrinter
85294>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
85295>>>
85295>>>        // run the report
85295>>>        Send Run_Report of oReport
85296>>>
85296>>>    End_Procedure 
85297>>>
85297>>>End_Object 
85298>        Use Report4.rv
Including file: Report4.rv    (C:\Repos\DataFlexBeadando\AppSrc\Report4.rv)
85298>>>// Report4.rv
85298>>>// Report4
85298>>>Register_Object oReport
85298>>>
85298>>>Use DFRptVw.pkg
85298>>>Use cWinReport2.pkg
85298>>>Use Windows.pkg
85298>>>
85298>>>Use cUgyfelDataDictionary.dd
85298>>>Use cAutoDataDictionary.dd
85298>>>Use cMunkalapDataDictionary.dd
85298>>>
85298>>>ACTIVATE_VIEW Activate_oReport4 FOR oReport4
85308>>>>
85308>>>Object oReport4 is a ReportView
85310>>>    Set Location to 6 6
85311>>>    Set Size to 60 202
85312>>>    Set Label To "Report4"
85313>>>
85313>>>
85313>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
85315>>>    End_Object 
85316>>>
85316>>>    Object oAuto_DD is a cAutoDataDictionary
85318>>>    End_Object 
85319>>>
85319>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
85321>>>        Set DDO_Server To oAuto_DD
85322>>>        Set DDO_Server To oUgyfel_DD
85323>>>    End_Object 
85324>>>
85324>>>    Set Main_DD To oMunkalap_DD
85325>>>
85325>>>
85325>>>
85325>>>
85325>>>    Object oPrintTo is a RadioGroup
85327>>>        Set Size to 38 118
85328>>>        Set Location to 10 12
85329>>>        Set Label to "Send Report to"
85330>>>
85330>>>        Object oRadio1 is a Radio
85332>>>            Set Label to "Report Viewer"
85333>>>            Set Size to 10 61
85334>>>            Set Location to 12 6
85335>>>            Set Status_Help to "Prints the report to screen"
85336>>>        End_Object 
85337>>>
85337>>>        Object oRadio2 is a Radio
85339>>>            Set Label to "Printer"
85340>>>            Set Size to 10 42
85341>>>            Set Location to 24 6
85342>>>            Set Status_Help to "Prints the report to printer"
85343>>>        End_Object 
85344>>>
85344>>>
85344>>>        Function IsToPrinter Returns boolean
85347>>>            integer iRadio
85347>>>            Get Current_radio to iRadio
85348>>>            Function_return (iRadio=1)
85349>>>        End_Function 
85350>>>
85350>>>    End_Object 
85351>>>
85351>>>    Object oBtnPrint is a Button
85353>>>        Set Label to "Print"
85354>>>        Set Location to 5 140
85355>>>        Set Status_Help to "Print the Selected report"
85356>>>        Set Default_State to TRUE
85357>>>        Procedure OnClick
85360>>>            Send StartReport
85361>>>        End_Procedure
85362>>>    End_Object 
85363>>>
85363>>>    Object oBtnPrinterSetup is a Button
85365>>>        Set Label to "Printer Setup"
85366>>>        Set Location to 22 140
85367>>>        Set Status_Help to "Set up printer for report"
85368>>>        Procedure OnClick
85371>>>            Send DFPrintSetup of oReport
85372>>>        End_Procedure
85373>>>    End_Object 
85374>>>
85374>>>    Object oBtnCancel is a Button
85376>>>        Set Label to "Cancel"
85377>>>        Set Location to 39 140
85378>>>        Set Status_Help to "Close this Panel"
85379>>>        Procedure OnClick
85382>>>            Send Close_Panel
85383>>>        End_Procedure
85384>>>    End_Object 
85385>>>
85385>>>
85385>>>
85385>>>    Object oReport is a cWinReport2
85387>>>
85387>>>        Set Report_Title to "Report4"
85388>>>
85388>>>        // Set DDO, Index and breaks for the report
85388>>>        Set Server to oMunkalap_DD
85389>>>        Set Ordering to 4
85390>>>        Report_Breaks Munkalap.AutoMarka
85404>>>
85404>>>        Function Starting_Main_Report Returns Integer
85407>>>            Boolean bErr
85407>>>            Send DFSetMetrics wpm_cm
85408>>>            Send DFSetmargins 1 1 1 1
85409>>>            //Send DFSetLandscape false // This can be used to force a page orientation
85409>>>            Forward Get Starting_Main_Report to bErr
85411>>>            Function_return bErr
85412>>>        End_Function 
85413>>>
85413>>>        // Page_Top is printed first at the top margin of each page
85413>>>        Procedure Page_Top 
85416>>>            string  sFont
85416>>>            integer iFontSize
85416>>>
85416>>>            Move "arial" to sFont
85417>>>            Move 10 to iFontSize
85418>>>
85418>>>            DFFont sFont
85419>>>            DFFontSize iFontSize
85420>>>            DFBeginHeader DFPageTop
85421>>>                DFHeaderFrame Hdr_NoFrame
85422>>>                DFHeaderPos   Hdr_Left
85423>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
85424>>>            DFEndHeader
85426>>>
85426>>>        End_Procedure 
85427>>>
85427>>>        // Report_Header is printed once in a report after Page_Top
85427>>>        //Procedure Report_Header
85427>>>        //    string  sFont
85427>>>        //    integer iFontSize
85427>>>        //    Move "arial" to sFont
85427>>>        //    Move 10 to iFontSize
85427>>>        //    DFFont sFont
85427>>>        //    DFFontSize iFontSize
85427>>>        //    DFBeginHeader  DFReportHeader
85427>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85427>>>        //        DFHeaderPos    Hdr_Left
85427>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85427>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
85427>>>        //    DFEndHeader
85427>>>        //End_Procedure
85427>>>
85427>>>        Procedure Page_Header 
85430>>>            integer iFill iBorder iStyle
85430>>>            string  sFont sReportTitle
85430>>>            integer iFontSize
85430>>>
85430>>>            Move "arial" to sFont
85431>>>            Move 16 to iFontSize
85432>>>            Move (Font_bold + rgb_White) to iStyle
85433>>>            Move (rgb_dGrey) to iFill
85434>>>            Move (rgb_dGrey) to iBorder
85435>>>            Get Report_Title to sReportTitle
85436>>>
85436>>>            DFFont sFont
85437>>>            DFFontSize iFontSize
85438>>>            DFBeginHeader DFPageHeader
85439>>>                DFHeaderPos   Hdr_Left
85440>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85441>>>                DFWritelnPos sReportTitle 0.1 iStyle
85442>>>                DFHeaderMargin HM_BottomOuter 0.08
85443>>>            DFEndHeader
85445>>>
85445>>>        End_Procedure 
85446>>>
85446>>>        Procedure Page_Title 
85449>>>            string  sFont 
85449>>>            integer iFontSize iHeaderStyle iFill iBorder
85449>>>
85449>>>            Move "arial" to sFont
85450>>>            Move 10 to iFontSize
85451>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
85452>>>            Move (rgb_Grey) to iFill
85453>>>            Move (rgb_Grey) to iBorder
85454>>>
85454>>>            DFFont sFont
85455>>>            DFFontSize iFontSize
85456>>>            DFBeginHeader DFPageTitle
85457>>>                DFHeaderPos   Hdr_Left
85458>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85459>>>                DFHeaderMargin HM_TopInner    0.04
85460>>>                DFHeaderMargin HM_BottomInner 0.04
85461>>>                DFHeaderMargin HM_BottomOuter 0.08
85462>>>
85462>>>                DFWritePos "AutoMarka"                    0.08 iHeaderStyle -1 4.26
85463>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
85464>>>                DFWriteLn
85465>>>            DFEndHeader
85467>>>
85467>>>        End_Procedure 
85468>>>
85468>>>        Procedure SubHeader1 
85471>>>            string  sFont 
85471>>>            integer iFontSize iStyle
85471>>>
85471>>>            Move "arial" to sFont
85472>>>            Move 10 to iFontSize
85473>>>            Move (font_bold) to iStyle
85474>>>
85474>>>            DFFont sFont
85475>>>            DFFontSize iFontSize
85476>>>            DFBeginHeader DFSubHeader 1
85477>>>                DFHeaderLineCheck 5
85478>>>                DFHeaderWrap   HDR_Wrap
85479>>>                DFHeaderPos    HDR_Left
85480>>>                DFHeaderFrame HDR_NoFrame
85481>>>                DFWritePos ("Recnum: Munkalap.Recnum") 0.1 iStyle
85482>>>            DFEndHeader
85484>>>
85484>>>        End_Procedure 
85485>>>
85485>>>        Procedure Body 
85488>>>            string  sFont 
85488>>>            integer iFontSize iStyle
85488>>>
85488>>>            Move "arial" to sFont
85489>>>            Move 10 to iFontSize
85490>>>            Move (font_default) to iStyle
85491>>>
85491>>>            DFFont sFont
85492>>>            DFFontSize iFontSize
85493>>>
85493>>>            DFWritePos Munkalap.AutoMarka             0.08 iStyle -1 4.26
85494>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
85495>>>            DFWriteLn
85496>>>            Send Add_SubTotal 1 1
85497>>>
85497>>>        End_Procedure 
85498>>>
85498>>>        Procedure SubTotal1 
85501>>>            string  sFont 
85501>>>            integer iFontSize iStyle iFill iBorder
85501>>>            number  nAmount
85501>>>
85501>>>            Move "arial" to sFont
85502>>>            Move 10 to iFontSize
85503>>>            Move (font_bold) to iStyle
85504>>>            Move (rgb_dGrey) to iBorder
85505>>>            Get DFGetDFColor 242 242 242 to iFill
85506>>>
85506>>>            DFFont sFont
85507>>>            DFFontSize iFontSize
85508>>>            DFBeginHeader DFSubTotal 1
85509>>>                DFHeaderPos   Hdr_Left
85510>>>                DFHeaderWrap  Hdr_NoWrap
85511>>>                DFHeaderFrame HDR_NoFrame
85512>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85513>>>
85513>>>                Get SubTotal ( 1 + 0) to nAmount
85514>>>                Send Add_SubTotal ( 1 + 2) 1
85515>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85516>>>                DFWriteLn
85517>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
85518>>>                DFWriteLn
85519>>>            DFEndHeader
85521>>>
85521>>>        End_Procedure 
85522>>>
85522>>>        Procedure Total 
85525>>>            string  sFont 
85525>>>            integer iFontSize iStyle iFill iBorder
85525>>>            number  nAmount
85525>>>
85525>>>            Move "arial" to sFont
85526>>>            Move 10 to iFontSize
85527>>>            Move (font_bold) to iStyle
85528>>>            Move (rgb_Grey) to iFill
85529>>>            Move (rgb_dGrey) to iBorder
85530>>>
85530>>>            DFFont sFont
85531>>>            DFFontSize iFontSize
85532>>>            DFBeginHeader DFTotal
85533>>>                DFHeaderPos   Hdr_Left
85534>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85535>>>
85535>>>                Get SubTotal ( 1 + 2) to nAmount
85536>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85537>>>                DFWriteLn
85538>>>            DFEndHeader
85540>>>
85540>>>        End_Procedure 
85541>>>
85541>>>        // Report_Footer is printed once on the last page before Page_Footer
85541>>>        //Procedure Report_Footer
85541>>>        //    string  sFont
85541>>>        //    integer iFontSize
85541>>>        //    Move "arial" to sFont
85541>>>        //    Move 10 to iFontSize
85541>>>        //    DFFont sFont
85541>>>        //    DFFontSize iFontSize
85541>>>        //    DFBeginHeader DFReportFooter
85541>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85541>>>        //        DFHeaderPos    Hdr_Left
85541>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85541>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
85541>>>        //    DFEndHeader
85541>>>        //End_Procedure
85541>>>
85541>>>        // // Page_Footer is printed on each page before Page_Bottom
85541>>>        //Procedure Page_Footer
85541>>>        //    string  sFont
85541>>>        //    integer iFontSize
85541>>>        //    Move "arial" to sFont
85541>>>        //    Move 10 to iFontSize
85541>>>        //    DFFont sFont
85541>>>        //    DFFontSize iFontSize
85541>>>        //    DFBeginHeader DFPageFooter
85541>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85541>>>        //        DFHeaderPos    Hdr_Left
85541>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85541>>>        //        DFWrite     "Page_Footer" (Font_Bold+Font_Center)
85541>>>        //    DFEndHeader
85541>>>        //End_Procedure
85541>>>
85541>>>
85541>>>        // Page_Bottom is printed last at the bottom margin of each page
85541>>>        Procedure Page_Bottom 
85544>>>            string sFont
85544>>>            integer iFontSize iBorder iStyle
85544>>>            DateTime dtDT
85544>>>
85544>>>            Move (CurrentDateTime()) to dtDT
85545>>>
85545>>>            Move "arial" to sFont
85546>>>            Move 10 to iFontSize
85547>>>            Move (font_default) to iStyle
85548>>>            Move (rgb_dGrey) to iBorder
85549>>>
85549>>>            DFFont sFont
85550>>>            DFFontSize iFontSize
85551>>>            DFBeginHeader DFPageBottom
85552>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
85553>>>                DFHeaderPos Hdr_Left
85554>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
85555>>>            DFEndHeader
85557>>>
85557>>>        End_Procedure 
85558>>>
85558>>>        // Returns string with description of selection ranges
85558>>>        // Pass: Selection title, start value and end value. Return: description
85558>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
85561>>>            string sText
85561>>>            If (sStart=""  AND sStop="")  function_return ""
85564>>>            If (sStart="0" AND sStop="0") function_return ""
85567>>>            If (sStart<>"" AND sStop<>"") begin
85569>>>                Move ("between" * sStart * "and" * sStop) to sText
85570>>>            end
85570>>>>
85570>>>            Else if (sStart > "") begin
85573>>>                Move ("starting at" * sStart) to sText
85574>>>            end
85574>>>>
85574>>>            Else if (sStop > "") begin
85577>>>                Move ("up to" * sStop) to sText
85578>>>            End
85578>>>>
85578>>>            function_return (sTitle * sText)
85579>>>        End_Function
85580>>>
85580>>>    End_Object 
85581>>>
85581>>>    Procedure StartReport 
85584>>>        Boolean bToPrinter
85584>>>
85584>>>        // determine if direct print
85584>>>        Get IsToPrinter of oPrintTo to bToPrinter
85585>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
85586>>>
85586>>>        // run the report
85586>>>        Send Run_Report of oReport
85587>>>
85587>>>    End_Procedure 
85588>>>
85588>>>End_Object 
85589>        Use VeglegesReport.rv
Including file: VeglegesReport.rv    (C:\Repos\DataFlexBeadando\AppSrc\VeglegesReport.rv)
85589>>>// VeglegesReport.rv
85589>>>// VeglegesReport
85589>>>Register_Object oReport
85589>>>
85589>>>Use DFRptVw.pkg
85589>>>Use cWinReport2.pkg
85589>>>Use Windows.pkg
85589>>>
85589>>>Use cUgyfelDataDictionary.dd
85589>>>Use cAutoDataDictionary.dd
85589>>>Use cMunkalapDataDictionary.dd
85589>>>
85589>>>ACTIVATE_VIEW Activate_oVeglegesReport FOR oVeglegesReport
85599>>>>
85599>>>Object oVeglegesReport is a ReportView
85601>>>    Set Location to 6 6
85602>>>    Set Size to 100 202
85603>>>    Set Label To "VeglegesReport"
85604>>>
85604>>>
85604>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
85606>>>    End_Object 
85607>>>
85607>>>    Object oAuto_DD is a cAutoDataDictionary
85609>>>    End_Object 
85610>>>
85610>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
85612>>>        Set DDO_Server To oAuto_DD
85613>>>        Set DDO_Server To oUgyfel_DD
85614>>>        Property Date pdStartRogzites
85616>>>        Property Date pdStopRogzites
85618>>>
85618>>>        Procedure OnConstrain 
85621>>>            Date dStart dStop
85621>>>
85621>>>            Get pdStartRogzites To dStart
85622>>>            Get pdStopRogzites To dStop
85623>>>
85623>>>            Case Begin
85623>>>                Case (dStart <> 0 and dStop <> 0)
85625>>>                    Constrain Munkalap.Rogzites between dStart and dStop
85629>>>                    Case Break
85630>>>                Case (dStart <> 0)
85633>>>                    Constrain Munkalap.Rogzites GE dStart
85635>>>                    Case Break
85636>>>                Case (dStop <> 0)
85639>>>                    Constrain Munkalap.Rogzites LE dStop
85641>>>            Case End
85641>>>        End_Procedure 
85642>>>    End_Object 
85643>>>
85643>>>    Set Main_DD To oMunkalap_DD
85644>>>
85644>>>
85644>>>
85644>>>    Object oRogzitesSelection is a Group
85646>>>        Set Size to 35 179
85647>>>        Set Location to 5 12
85648>>>        Set Label to "Select Rgzts"
85649>>>
85649>>>        Object oSelStart is a Form
85651>>>            Set Label to "From:"
85652>>>            Set Size to 13 60
85653>>>            Set Location to 13 30
85654>>>            Set Status_Help to "First value in selection range."
85655>>>            Set Label_Col_Offset to 2
85656>>>            Set Label_Justification_Mode to jMode_Right
85657>>>            Set Form_datatype to mask_date_window
85658>>>        End_Object 
85659>>>
85659>>>        Object oSelStop is a Form
85661>>>            Set Label to "To:"
85662>>>            Set Size to 14 60
85663>>>            Set Location to 13 111
85664>>>            Set Status_Help to "Last value in selection range."
85665>>>            Set Label_Col_Offset to 2
85666>>>            Set Label_Justification_Mode to jMode_Right
85667>>>            Set Form_datatype to mask_date_window
85668>>>        End_Object 
85669>>>
85669>>>
85669>>>        Function StartValue returns String
85672>>>            string sValue
85672>>>            Get Value of oSelStart to sValue
85673>>>            Function_return sValue
85674>>>        End_Function 
85675>>>
85675>>>        Function StopValue returns String
85678>>>            string sValue
85678>>>            Get Value of oSelStop to sValue
85679>>>            Function_return sValue
85680>>>        End_Function 
85681>>>
85681>>>    End_Object 
85682>>>
85682>>>    Object oPrintTo is a RadioGroup
85684>>>        Set Size to 38 118
85685>>>        Set Location to 50 12
85686>>>        Set Label to "Send Report to"
85687>>>
85687>>>        Object oRadio1 is a Radio
85689>>>            Set Label to "Report Viewer"
85690>>>            Set Size to 10 61
85691>>>            Set Location to 12 6
85692>>>            Set Status_Help to "Prints the report to screen"
85693>>>        End_Object 
85694>>>
85694>>>        Object oRadio2 is a Radio
85696>>>            Set Label to "Printer"
85697>>>            Set Size to 10 42
85698>>>            Set Location to 24 6
85699>>>            Set Status_Help to "Prints the report to printer"
85700>>>        End_Object 
85701>>>
85701>>>
85701>>>        Function IsToPrinter Returns boolean
85704>>>            integer iRadio
85704>>>            Get Current_radio to iRadio
85705>>>            Function_return (iRadio=1)
85706>>>        End_Function 
85707>>>
85707>>>    End_Object 
85708>>>
85708>>>    Object oBtnPrint is a Button
85710>>>        Set Label to "Print"
85711>>>        Set Location to 45 140
85712>>>        Set Status_Help to "Print the Selected report"
85713>>>        Set Default_State to TRUE
85714>>>        Procedure OnClick
85717>>>            Send StartReport
85718>>>        End_Procedure
85719>>>    End_Object 
85720>>>
85720>>>    Object oBtnPrinterSetup is a Button
85722>>>        Set Label to "Printer Setup"
85723>>>        Set Location to 62 140
85724>>>        Set Status_Help to "Set up printer for report"
85725>>>        Procedure OnClick
85728>>>            Send DFPrintSetup of oReport
85729>>>        End_Procedure
85730>>>    End_Object 
85731>>>
85731>>>    Object oBtnCancel is a Button
85733>>>        Set Label to "Cancel"
85734>>>        Set Location to 79 140
85735>>>        Set Status_Help to "Close this Panel"
85736>>>        Procedure OnClick
85739>>>            Send Close_Panel
85740>>>        End_Procedure
85741>>>    End_Object 
85742>>>
85742>>>
85742>>>
85742>>>    Object oReport is a cWinReport2
85744>>>
85744>>>        Set Report_Title to "VeglegesReport"
85745>>>
85745>>>        // Set DDO, Index and breaks for the report
85745>>>        Set Server to oMunkalap_DD
85746>>>        Set Ordering to 4
85747>>>        Report_Breaks Munkalap.AutoMarka
85761>>>
85761>>>        Function Starting_Main_Report Returns Integer
85764>>>            Boolean bErr
85764>>>            Send DFSetMetrics wpm_cm
85765>>>            Send DFSetmargins 1 1 1 1
85766>>>            //Send DFSetLandscape false // This can be used to force a page orientation
85766>>>            Forward Get Starting_Main_Report to bErr
85768>>>            Function_return bErr
85769>>>        End_Function 
85770>>>
85770>>>        // Page_Top is printed first at the top margin of each page
85770>>>        Procedure Page_Top 
85773>>>            string  sFont
85773>>>            integer iFontSize
85773>>>
85773>>>            Move "arial" to sFont
85774>>>            Move 10 to iFontSize
85775>>>
85775>>>            DFFont sFont
85776>>>            DFFontSize iFontSize
85777>>>            DFBeginHeader DFPageTop
85778>>>                DFHeaderFrame Hdr_NoFrame
85779>>>                DFHeaderPos   Hdr_Left
85780>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
85781>>>            DFEndHeader
85783>>>
85783>>>        End_Procedure 
85784>>>
85784>>>        // Report_Header is printed once in a report after Page_Top
85784>>>        //Procedure Report_Header
85784>>>        //    string  sFont
85784>>>        //    integer iFontSize
85784>>>        //    Move "arial" to sFont
85784>>>        //    Move 10 to iFontSize
85784>>>        //    DFFont sFont
85784>>>        //    DFFontSize iFontSize
85784>>>        //    DFBeginHeader  DFReportHeader
85784>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85784>>>        //        DFHeaderPos    Hdr_Left
85784>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85784>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
85784>>>        //    DFEndHeader
85784>>>        //End_Procedure
85784>>>
85784>>>        Procedure Page_Header 
85787>>>            integer iFill iBorder iStyle
85787>>>            string  sFont sReportTitle
85787>>>            integer iFontSize
85787>>>
85787>>>            Move "arial" to sFont
85788>>>            Move 16 to iFontSize
85789>>>            Move (Font_bold + rgb_White) to iStyle
85790>>>            Move (rgb_dGrey) to iFill
85791>>>            Move (rgb_dGrey) to iBorder
85792>>>            Get Report_Title to sReportTitle
85793>>>
85793>>>            DFFont sFont
85794>>>            DFFontSize iFontSize
85795>>>            DFBeginHeader DFPageHeader
85796>>>                DFHeaderPos   Hdr_Left
85797>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85798>>>                DFWritelnPos sReportTitle 0.1 iStyle
85799>>>                DFHeaderMargin HM_BottomOuter 0.08
85800>>>            DFEndHeader
85802>>>
85802>>>        End_Procedure 
85803>>>
85803>>>        Procedure Page_Title 
85806>>>            string  sFont 
85806>>>            integer iFontSize iHeaderStyle iFill iBorder
85806>>>
85806>>>            Move "arial" to sFont
85807>>>            Move 10 to iFontSize
85808>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
85809>>>            Move (rgb_Grey) to iFill
85810>>>            Move (rgb_Grey) to iBorder
85811>>>
85811>>>            DFFont sFont
85812>>>            DFFontSize iFontSize
85813>>>            DFBeginHeader DFPageTitle
85814>>>                DFHeaderPos   Hdr_Left
85815>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85816>>>                DFHeaderMargin HM_TopInner    0.04
85817>>>                DFHeaderMargin HM_BottomInner 0.04
85818>>>                DFHeaderMargin HM_BottomOuter 0.08
85819>>>
85819>>>                DFWritePos "AutoMarka"                    0.08 iHeaderStyle -1 4.26
85820>>>                DFWritePos "Rgz."                        4.42 iHeaderStyle -1 2.13
85821>>>                DFWritePos "Nv"                          6.63 iHeaderStyle -1 21.33
85822>>>                DFWriteLn
85823>>>            DFEndHeader
85825>>>
85825>>>        End_Procedure 
85826>>>
85826>>>        Procedure SubHeader1 
85829>>>            string  sFont 
85829>>>            integer iFontSize iStyle
85829>>>
85829>>>            Move "arial" to sFont
85830>>>            Move 10 to iFontSize
85831>>>            Move (font_bold) to iStyle
85832>>>
85832>>>            DFFont sFont
85833>>>            DFFontSize iFontSize
85834>>>            DFBeginHeader DFSubHeader 1
85835>>>                DFHeaderLineCheck 5
85836>>>                DFHeaderWrap   HDR_Wrap
85837>>>                DFHeaderPos    HDR_Left
85838>>>                DFHeaderFrame HDR_NoFrame
85839>>>                DFWritePos ("Recnum: Munkalap.Recnum") 0.1 iStyle
85840>>>            DFEndHeader
85842>>>
85842>>>        End_Procedure 
85843>>>
85843>>>        Procedure Body 
85846>>>            string  sFont 
85846>>>            integer iFontSize iStyle
85846>>>
85846>>>            Move "arial" to sFont
85847>>>            Move 10 to iFontSize
85848>>>            Move (font_default) to iStyle
85849>>>
85849>>>            DFFont sFont
85850>>>            DFFontSize iFontSize
85851>>>
85851>>>            DFWritePos Munkalap.AutoMarka             0.08 iStyle -1 4.26
85852>>>            DFWritePos Munkalap.Rogzites              4.42 iStyle -1 2.13
85853>>>            Send Add_SubTotal 1 1
85854>>>            DFWritePos Ugyfel.Nev                     6.63 iStyle -1 21.33
85855>>>            DFWriteLn
85856>>>
85856>>>        End_Procedure 
85857>>>
85857>>>        Procedure SubTotal1 
85860>>>            string  sFont 
85860>>>            integer iFontSize iStyle iFill iBorder
85860>>>            number  nAmount
85860>>>
85860>>>            Move "arial" to sFont
85861>>>            Move 10 to iFontSize
85862>>>            Move (font_bold) to iStyle
85863>>>            Move (rgb_dGrey) to iBorder
85864>>>            Get DFGetDFColor 242 242 242 to iFill
85865>>>
85865>>>            DFFont sFont
85866>>>            DFFontSize iFontSize
85867>>>            DFBeginHeader DFSubTotal 1
85868>>>                DFHeaderPos   Hdr_Left
85869>>>                DFHeaderWrap  Hdr_NoWrap
85870>>>                DFHeaderFrame HDR_NoFrame
85871>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85872>>>
85872>>>                Get SubTotal ( 1 + 0) to nAmount
85873>>>                Send Add_SubTotal ( 1 + 3) 1
85874>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85875>>>                DFWriteLn
85876>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
85877>>>                DFWriteLn
85878>>>            DFEndHeader
85880>>>
85880>>>        End_Procedure 
85881>>>
85881>>>        Procedure Total 
85884>>>            string  sFont 
85884>>>            integer iFontSize iStyle iFill iBorder
85884>>>            number  nAmount
85884>>>
85884>>>            Move "arial" to sFont
85885>>>            Move 10 to iFontSize
85886>>>            Move (font_bold) to iStyle
85887>>>            Move (rgb_Grey) to iFill
85888>>>            Move (rgb_dGrey) to iBorder
85889>>>
85889>>>            DFFont sFont
85890>>>            DFFontSize iFontSize
85891>>>            DFBeginHeader DFTotal
85892>>>                DFHeaderPos   Hdr_Left
85893>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
85894>>>
85894>>>                Get SubTotal ( 1 + 3) to nAmount
85895>>>                DFWritePos nAmount 4.42 iStyle -1 2.13
85896>>>                DFWriteLn
85897>>>            DFEndHeader
85899>>>
85899>>>        End_Procedure 
85900>>>
85900>>>        // Report_Footer is printed once on the last page before Page_Footer
85900>>>        //Procedure Report_Footer
85900>>>        //    string  sFont
85900>>>        //    integer iFontSize
85900>>>        //    Move "arial" to sFont
85900>>>        //    Move 10 to iFontSize
85900>>>        //    DFFont sFont
85900>>>        //    DFFontSize iFontSize
85900>>>        //    DFBeginHeader DFReportFooter
85900>>>        //        DFHeaderFrame  Hdr_Margins 0.01
85900>>>        //        DFHeaderPos    Hdr_Left
85900>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
85900>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
85900>>>        //    DFEndHeader
85900>>>        //End_Procedure
85900>>>
85900>>>        Procedure Page_Footer 
85903>>>            string sStart sStop sText
85903>>>            string  sFont 
85903>>>            integer iFontSize iStyle
85903>>>
85903>>>            Move "arial" to sFont
85904>>>            Move 10 to iFontSize
85905>>>            Move (font_default) to iStyle
85906>>>
85906>>>            DFFont sFont
85907>>>            DFFontSize iFontSize
85908>>>            DFBeginHeader DFPageFooter
85909>>>                DFHeaderFrame hdr_NoFrame
85910>>>                DFHeaderPos   hdr_Left
85911>>>
85911>>>                Get pdStartRogzites of oMunkalap_DD to sStart
85912>>>                Get pdStopRogzites  of oMunkalap_DD to sStop
85913>>>                Get SelectionCriteraDescription "Munkalap.Rogzites" sStart sStop to sText
85914>>>                If (sText<>"") begin
85916>>>                    DFWriteLnPos sText 0.1
85917>>>                end
85917>>>>
85917>>>
85917>>>            DFEndHeader
85919>>>        End_Procedure 
85920>>>
85920>>>        // Page_Bottom is printed last at the bottom margin of each page
85920>>>        Procedure Page_Bottom 
85923>>>            string sFont
85923>>>            integer iFontSize iBorder iStyle
85923>>>            DateTime dtDT
85923>>>
85923>>>            Move (CurrentDateTime()) to dtDT
85924>>>
85924>>>            Move "arial" to sFont
85925>>>            Move 10 to iFontSize
85926>>>            Move (font_default) to iStyle
85927>>>            Move (rgb_dGrey) to iBorder
85928>>>
85928>>>            DFFont sFont
85929>>>            DFFontSize iFontSize
85930>>>            DFBeginHeader DFPageBottom
85931>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
85932>>>                DFHeaderPos Hdr_Left
85933>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
85934>>>            DFEndHeader
85936>>>
85936>>>        End_Procedure 
85937>>>
85937>>>        // Returns string with description of selection ranges
85937>>>        // Pass: Selection title, start value and end value. Return: description
85937>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
85940>>>            string sText
85940>>>            If (sStart=""  AND sStop="")  function_return ""
85943>>>            If (sStart="0" AND sStop="0") function_return ""
85946>>>            If (sStart<>"" AND sStop<>"") begin
85948>>>                Move ("between" * sStart * "and" * sStop) to sText
85949>>>            end
85949>>>>
85949>>>            Else if (sStart > "") begin
85952>>>                Move ("starting at" * sStart) to sText
85953>>>            end
85953>>>>
85953>>>            Else if (sStop > "") begin
85956>>>                Move ("up to" * sStop) to sText
85957>>>            End
85957>>>>
85957>>>            function_return (sTitle * sText)
85958>>>        End_Function
85959>>>
85959>>>    End_Object 
85960>>>
85960>>>    Procedure StartReport 
85963>>>        Boolean bToPrinter
85963>>>        String sValue
85963>>>        Date dStart dStop
85963>>>
85963>>>        // Set all selection critera properties
85963>>>        Get StartValue of oRogzitesSelection to sValue
85964>>>        Set pdStartRogzites of oMunkalap_DD To sValue
85965>>>
85965>>>        Get StopValue of oRogzitesSelection to sValue
85966>>>        Set pdStopRogzites of oMunkalap_DD To sValue
85967>>>
85967>>>
85967>>>        // determine if direct print
85967>>>        Get IsToPrinter of oPrintTo to bToPrinter
85968>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
85969>>>
85969>>>        // run the report
85969>>>        Send Run_Report of oReport
85970>>>
85970>>>    End_Procedure 
85971>>>
85971>>>End_Object 
85972>        Use MunkalapVegleges2.vw
Including file: MunkalapVegleges2.vw    (C:\Repos\DataFlexBeadando\AppSrc\MunkalapVegleges2.vw)
85972>>>// C:\Repos\DataFlexBeadando\AppSrc\MunkalapVegleges2.vw
85972>>>// MunkalapVegleges2
85972>>>//
85972>>>
85972>>>Use DFClient.pkg
85972>>>Use DFEntry.pkg
85972>>>Use cDbCJGrid.pkg
85972>>>Use cDbCJGridColumn.pkg
85972>>>
85972>>>Use cUgyfelDataDictionary.dd
85972>>>Use cAutoDataDictionary.dd
85972>>>Use cMunkalapDataDictionary.dd
85972>>>Use cMunkaDataDictionary.dd
85972>>>Use cMunkaMunkalapDataDictionary.dd
85972>>>
85972>>>ACTIVATE_VIEW Activate_oMunkalapVegleges2 FOR oMunkalapVegleges2
85982>>>>
85982>>>Object oMunkalapVegleges2 is a dbView
85984>>>    Set Location to 5 5
85985>>>    Set Size to 219 323
85986>>>    Set Label To "MunkalapVegleges2"
85987>>>    Set Border_Style to Border_Thick
85988>>>
85988>>>
85988>>>    Object oUgyfel_DD is a cUgyfelDataDictionary
85990>>>    End_Object 
85991>>>
85991>>>    Object oAuto_DD is a cAutoDataDictionary
85993>>>    End_Object 
85994>>>
85994>>>    Object oMunkalap_DD is a cMunkalapDataDictionary
85996>>>        Set DDO_Server To oAuto_DD
85997>>>        Set DDO_Server To oUgyfel_DD
85998>>>        // this lets you save a new parent DD from within child DD
85998>>>        Set Allow_Foreign_New_Save_State to True
85999>>>    End_Object 
86000>>>
86000>>>    Object oMunka_DD is a cMunkaDataDictionary
86002>>>    End_Object 
86003>>>
86003>>>    Object oMunkaMunkalap_DD is a cMunkaMunkalapDataDictionary
86005>>>        Set DDO_Server To oMunkalap_DD
86006>>>        Set DDO_Server To oMunka_DD
86007>>>        Set Constrain_File To Munkalap.File_Number
86008>>>    End_Object 
86009>>>
86009>>>    Set Main_DD To oMunkalap_DD
86010>>>    Set Server  To oMunkalap_DD
86011>>>
86011>>>
86011>>>
86011>>>    Object oMunkalapId is a dbForm
86013>>>        Entry_Item Munkalap.Id
86014>>>        Set Size to 13 42
86015>>>        Set Location to 5 68
86016>>>        Set peAnchors to anTopLeftRight
86017>>>        Set Label to "Munkalap azonost"
86018>>>        Set Label_Justification_mode to jMode_Left
86019>>>        Set Label_Col_Offset to 63
86020>>>        Set Label_row_Offset to 0
86021>>>    End_Object 
86022>>>
86022>>>    Object oUgyfelId is a dbForm
86024>>>        Entry_Item Ugyfel.Id
86025>>>        Set Size to 13 42
86026>>>        Set Location to 20 68
86027>>>        Set peAnchors to anTopLeftRight
86028>>>        Set Label to "gyfl azonost"
86029>>>        Set Label_Justification_mode to jMode_Left
86030>>>        Set Label_Col_Offset to 63
86031>>>        Set Label_row_Offset to 0
86032>>>    End_Object 
86033>>>
86033>>>    Object oUgyfelNev is a dbForm
86035>>>        Entry_Item Ugyfel.Nev
86036>>>        Set Size to 13 250
86037>>>        Set Location to 35 68
86038>>>        Set peAnchors to anTopLeftRight
86039>>>        Set Label to "Nv"
86040>>>        Set Label_Justification_mode to jMode_Left
86041>>>        Set Label_Col_Offset to 63
86042>>>        Set Label_row_Offset to 0
86043>>>    End_Object 
86044>>>
86044>>>    Object oAutoId is a dbForm
86046>>>        Entry_Item Auto.Id
86047>>>        Set Size to 13 42
86048>>>        Set Location to 50 68
86049>>>        Set peAnchors to anTopLeftRight
86050>>>        Set Label to "Azonost"
86051>>>        Set Label_Justification_mode to jMode_Left
86052>>>        Set Label_Col_Offset to 63
86053>>>        Set Label_row_Offset to 0
86054>>>    End_Object 
86055>>>
86055>>>    Object oAutoMarka is a dbForm
86057>>>        Entry_Item Auto.Marka
86058>>>        Set Size to 13 126
86059>>>        Set Location to 65 68
86060>>>        Set peAnchors to anTopLeftRight
86061>>>        Set Label to "Mrka"
86062>>>        Set Label_Justification_mode to jMode_Left
86063>>>        Set Label_Col_Offset to 63
86064>>>        Set Label_row_Offset to 0
86065>>>    End_Object 
86066>>>
86066>>>    Object oMunkalapBehozatal is a dbForm
86068>>>        Entry_Item Munkalap.Behozatal
86069>>>        Set Size to 13 66
86070>>>        Set Location to 80 68
86071>>>        Set peAnchors to anTopLeftRight
86072>>>        Set Label to "Behozatal"
86073>>>        Set Label_Justification_mode to jMode_Left
86074>>>        Set Label_Col_Offset to 63
86075>>>        Set Label_row_Offset to 0
86076>>>    End_Object 
86077>>>
86077>>>    Object oMunkalapElvitel is a dbForm
86079>>>        Entry_Item Munkalap.Elvitel
86080>>>        Set Size to 13 66
86081>>>        Set Location to 95 68
86082>>>        Set peAnchors to anTopLeftRight
86083>>>        Set Label to "Elvitel"
86084>>>        Set Label_Justification_mode to jMode_Left
86085>>>        Set Label_Col_Offset to 63
86086>>>        Set Label_row_Offset to 0
86087>>>    End_Object 
86088>>>
86088>>>    Object oMunkalapAkm is a dbForm
86090>>>        Entry_Item Munkalap.Akm
86091>>>        Set Size to 13 66
86092>>>        Set Location to 110 68
86093>>>        Set peAnchors to anTopLeftRight
86094>>>        Set Label to "Kilmter eltte"
86095>>>        Set Label_Justification_mode to jMode_Left
86096>>>        Set Label_Col_Offset to 63
86097>>>        Set Label_row_Offset to 0
86098>>>    End_Object 
86099>>>
86099>>>    Object oMunkalapBkm is a dbForm
86101>>>        Entry_Item Munkalap.Bkm
86102>>>        Set Size to 13 66
86103>>>        Set Location to 125 68
86104>>>        Set peAnchors to anTopLeftRight
86105>>>        Set Label to "Kilmterlls utns"
86106>>>        Set Label_Justification_mode to jMode_Left
86107>>>        Set Label_Col_Offset to 63
86108>>>        Set Label_row_Offset to 0
86109>>>    End_Object 
86110>>>
86110>>>    Object oDetailGrid is a cDbCJGrid
86112>>>        Set Size to 66 299
86113>>>        Set Location to 148 5
86114>>>        Set Server to oMunkaMunkalap_DD
86115>>>        Set Ordering to 1
86116>>>        Set peAnchors to anAll
86117>>>        Set psLayoutSection to "oMunkalapVegleges2_oDetailGrid"
86118>>>        Set pbAllowInsertRow to False
86119>>>        Set pbHeaderPrompts to True
86120>>>
86120>>>        Object oMunka_Id is a cDbCJGridColumn
86122>>>            Entry_Item Munka.Id
86123>>>            Set piWidth to 85
86124>>>            Set psCaption to "Munka azon."
86125>>>        End_Object 
86126>>>
86126>>>        Object oMunka_Name is a cDbCJGridColumn
86128>>>            Entry_Item Munka.Name
86129>>>            Set piWidth to 210
86130>>>            Set psCaption to "Nv"
86131>>>        End_Object 
86132>>>
86132>>>        Object oMunka_Leiras is a cDbCJGridColumn
86134>>>            Entry_Item Munka.Leiras
86135>>>            Set piWidth to 105
86136>>>            Set psCaption to "Lers"
86137>>>        End_Object 
86138>>>
86138>>>        Object oMunka_Egysegar is a cDbCJGridColumn
86140>>>            Entry_Item Munka.Egysegar
86141>>>            Set piWidth to 105
86142>>>            Set psCaption to "Egysgr"
86143>>>        End_Object 
86144>>>
86144>>>    End_Object 
86145>>>
86145>>>    //-----------------------------------------------------------------------
86145>>>    // Create custom confirmation messages for save and delete
86145>>>    // We must create the new functions and assign verify messages
86145>>>    // to them.
86145>>>    //-----------------------------------------------------------------------
86145>>>
86145>>>    Function ConfirmDeleteHeader Returns Boolean
86148>>>        Boolean bFail
86148>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
86149>>>        Function_Return bFail
86150>>>    End_Function 
86151>>>
86151>>>    // Only confirm on the saving of new records
86151>>>    Function ConfirmSaveHeader Returns Boolean
86154>>>        Boolean bNoSave bHasRecord
86154>>>        Handle  hoSrvr
86154>>>        Get Server to hoSrvr
86155>>>        Get HasRecord of hoSrvr to bHasRecord
86156>>>        If not bHasRecord Begin
86158>>>            Get Confirm "Save this NEW header?" to bNoSave
86159>>>        End
86159>>>>
86159>>>        Function_Return bNoSave
86160>>>    End_Function 
86161>>>
86161>>>    // Define alternate confirmation Messages
86161>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
86162>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
86163>>>    // Saves in header should not clear the view
86163>>>    Set Auto_Clear_Deo_State to False
86164>>>
86164>>>
86164>>>End_Object 
86165>
86165>        Procedure Activate_About
86168>            Send DoAbout "" "" "" "" ""
86169>        End_Procedure
86170>
86170>    End_Object
86171>
86171>End_Object
86172>
86172>Start_UI
86173>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 47928
Total Resources: 0
Total Commands : 86172
Total Windows  : 1
Total Pages    : 1
Static Data    : 543775
Message area   : 604529
Total Blocks   : 30834
